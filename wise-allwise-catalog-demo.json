{"version":2,"kind":"Notebook","sha256":"9eb5e0f9a1cf957e88b7d75e8b76d989086e90fa159939ba1662727d01fc0743","slug":"wise-allwise-catalog-demo","location":"/tutorials/parquet-catalog-demos/wise-allwise-catalog-demo.md","dependencies":[],"frontmatter":{"title":"Analyzing cloud-hosted AllWISE Source Catalog in Parquet format","kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"jupytext":{"text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.16.7"}},"content_includes_title":false,"authors":[{"id":"IRSA Scientists and Developers","name":"IRSA Scientists and Developers"}],"github":"https://github.com/Caltech-IPAC/irsa-tutorials/","subject":"IRSA Tutorials","keywords":["astronomy"],"settings":{"output_matplotlib_strings":"remove"},"numbering":{"title":{"offset":2}},"edit_url":"https://github.com/Caltech-IPAC/irsa-tutorials//blob/main/tutorials/parquet-catalog-demos/wise-allwise-catalog-demo.md","exports":[{"format":"md","filename":"wise-allwise-catalog-demo.md","url":"/build/wise-allwise-catalog-887a96f452b57c38f0dd5431a8f8d96b.md"}]},"mdast":{"type":"root","children":[{"type":"block","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Learning Goals","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"kvMQMDJTH2"}],"identifier":"learning-goals","label":"Learning Goals","html_id":"learning-goals","implicit":true,"key":"bFwo5RHeRZ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":20,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Learn how to load data from the AllWISE parquet catalog that is partitioned by HEALPix pixel index at order 5.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"aNaBeOGsh8"}],"key":"M0qlsNf9hG"}],"key":"xBCJUJysjz"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Learn efficient methods for performing common types of searches. This includes:","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"KjX3hn1125"}],"key":"YJ2Fsvjg5H"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":24,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"query/load using pandas, applying basic filters","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"LxcjXPKbxM"}],"key":"wNsLP2Q2mu"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"query/load using pyarrow, applying advanced filters that combine and/or compare columns","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"UJiy7bQz9A"}],"key":"V3OHN4AzOT"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"perform nearest neighbor searches using pyarrow and astropy","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"v4dtFdwA03"}],"key":"yYEWn59FDW"}],"key":"S5MeixEEkv"}],"key":"RdsVTjNB4K"}],"key":"BhIbPb57aO"}],"key":"YZPhKfDVHQ"},{"type":"block","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"aVVt6QC5rY"}],"identifier":"introduction","label":"Introduction","html_id":"introduction","implicit":true,"key":"iNp9upVLy4"},{"type":"paragraph","position":{"start":{"line":32,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"This notebook demonstrates access to the ","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"nedcBGbNzK"},{"type":"link","url":"https://ui.adsabs.harvard.edu/abs/2005ApJ...622..759G/abstract","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"HEALPix","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"lrE7VT8oRE"}],"urlSource":"https://ui.adsabs.harvard.edu/abs/2005ApJ...622..759G/abstract","key":"bAlXmjjxVV"},{"type":"text","value":"-partitioned (order 5), ","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"gaCDHLFnSX"},{"type":"link","url":"https://parquet.apache.org/","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"Apache Parquet","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"djvjWSwWuV"}],"urlSource":"https://parquet.apache.org/","key":"Vewo4KQNta"},{"type":"text","value":" version of the ","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"EyQX8Qmlpo"},{"type":"link","url":"https://wise2.ipc.caltech.edu/docs/release/allwise/expsup/sec1_3.html#src_cat","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"AllWISE Source Catalog","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"vPCbfLMShz"}],"urlSource":"https://wise2.ipc.caltech.edu/docs/release/allwise/expsup/sec1_3.html#src_cat","key":"GbRc4p25GW"},{"type":"text","value":".\nThe catalog is available through the ","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"DtBUwL8SP1"},{"type":"link","url":"https://aws.amazon.com/opendata","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"AWS Open Data","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"ey2FCwSz7U"}],"urlSource":"https://aws.amazon.com/opendata","key":"YxqP7B2DOu"},{"type":"text","value":" program, as part of the ","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"ORDowbTRx6"},{"type":"link","url":"https://science.nasa.gov/open-science-overview","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"NASA Open-Source Science Initiative","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"K3yHeNwM2r"}],"urlSource":"https://science.nasa.gov/open-science-overview","key":"mL5cOhIaBv"},{"type":"text","value":".","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"ajPJFLdytC"}],"key":"T5CeOsnNlZ"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Parquet is convenient for large astronomical catalogs in part because the storage format supports efficient database-style queries on the files themselves, without having to load the catalog into a database (or into memory) first.\nThe AllWISE catalog is fairly large at 340 GB.\nThe examples below demonstrate different methods that can be used to query the catalog, filtering the data and loading only the results.\nEach method accesses the parquet files a bit differently and is useful for different types of queries.","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"Rehp4ILno0"}],"key":"rK0vkUhOzS"}],"key":"s4gArNN1ZI"},{"type":"block","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"shNOb06unk"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"PL52yFsAo7"}],"key":"kN2o2iOLhJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Uncomment the next line to install dependencies if needed.\n# !pip install 'pandas>=1.5.2' 'pyarrow>=10.0.1' matplotlib hpgeom astropy","key":"vMHgESUHSj"},{"type":"output","id":"qZik3n487jqHawGsRfI9d","data":[],"key":"V0XMHYzQsK"}],"key":"RPvYiDWmbu"},{"type":"block","children":[],"key":"F7l2Xx3FFu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import sys\n\nimport hpgeom as hp\nimport pandas as pd\nimport pyarrow.compute as pc\nimport pyarrow.dataset as ds\nfrom astropy import units as u\nfrom astropy.coordinates import SkyCoord\nfrom matplotlib import colors\nfrom matplotlib import pyplot as plt\nfrom pyarrow.fs import S3FileSystem","key":"zql94FOvDQ"},{"type":"output","id":"2cdbzMNIgCETc2zmFv7dK","data":[],"key":"Gv1L9sTrrm"}],"key":"zeOXoggQ3Y"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"Setup catalog paths and query filters","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"Q91TDcW9xO"}],"identifier":"setup-catalog-paths-and-query-filters","label":"Setup catalog paths and query filters","html_id":"setup-catalog-paths-and-query-filters","implicit":true,"key":"e2b7VNPvq2"}],"key":"mOW2vTFMsd"},{"type":"block","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":67,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"This AllWISE catalog is stored in an ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"hOdTojYFOn"},{"type":"link","url":"https://aws.amazon.com/s3/","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"AWS S3","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"GR16l8y1P5"}],"urlSource":"https://aws.amazon.com/s3/","key":"oSh17AD4Ae"},{"type":"text","value":" bucket.\nTo connect to an S3 bucket we just need to point the reader at S3 instead of the local filesystem, and pass in AWS credentials.\n(Here, a “reader” is a python library that reads parquet files.)\nWe’ll use ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"ZSAv5b5ZqS"},{"type":"link","url":"https://arrow.apache.org/docs/python/generated/pyarrow.fs.S3FileSystem.html","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"pyarrow​.fs​.S3FileSystem","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"AzHIUKtHpe"}],"urlSource":"https://arrow.apache.org/docs/python/generated/pyarrow.fs.S3FileSystem.html","key":"oEBZOTkouv"},{"type":"text","value":" for this because it is recognized by every reader in examples below, and we’re already using pyarrow.\n","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"NkvaEkn4wa"},{"type":"link","url":"https://s3fs.readthedocs.io/en/latest/index.html","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"s3fs","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"dKFTuQn3YX"}],"urlSource":"https://s3fs.readthedocs.io/en/latest/index.html","key":"ePUechO8l4"},{"type":"text","value":" is another common option.\nThe call to ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"hE5hEMHWxw"},{"type":"inlineCode","value":"S3FileSystem","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"UmsmB236yI"},{"type":"text","value":" will look for AWS credentials in environment variables and/or the file ~/.aws/credentials.\nCredentials can also be passed as keyword arguments.","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"coQNbwiN6f"}],"key":"FN1h8RQ9hB"}],"key":"iHHf7fMetM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"bucket = \"nasa-irsa-wise\"\nfolder = \"wise/allwise/catalogs/p3as_psd/healpix_k5\"\nparquet_root = f\"{bucket}/{folder}/wise-allwise.parquet\"\n\nfs = S3FileSystem(region=\"us-west-2\", anonymous=True)  # the bucket is in region us-west-2","key":"qXtXgRNfXu"},{"type":"output","id":"8ci9I-vEKjR1jFBPbisif","data":[],"key":"VDxfroNxlb"}],"key":"ap43X1l0YZ"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":83,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"These limits will be used to query the catalog using specific filters created in examples below.\nThe Schema Access section (below) shows how to access column names and other schema information.","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"qmOqSQidgf"}],"key":"N9ADhwQbzb"}],"key":"P4v0I7LVM1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"w1mpro_min = 10.0\nra_min, ra_max = 15, 25  # deg\ndec_min, dec_max = 62, 72  # deg\npolygon_corners = [(ra_min, dec_min), (ra_min, dec_max), (ra_max, dec_max), (ra_max, dec_min)]\nradius = 5 * u.arcmin.to(u.deg)","key":"prb1KhXVWF"},{"type":"output","id":"tK0EFDkvrQmPoRjGCm4zx","data":[],"key":"NjDx3AEwiA"}],"key":"KzmvWVetdo"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":94,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"text","value":"The catalog is partitioned by HEALPix pixel index at order 5.\nQueries can be most efficient when a filter on the partition column is included, since the reader can skip those partitions entirely.\nThus, for queries that include ra/dec constraints, we can usually speed up load times significantly by including a constraint on the HEALPix order 5 pixel index.\nThe required pixel indexes can be calculated using ","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"n1lhKvoUCG"},{"type":"link","url":"https://hpgeom.readthedocs.io/en/latest/index.html","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"children":[{"type":"text","value":"hpgeom","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"q7iAWFgaI2"}],"urlSource":"https://hpgeom.readthedocs.io/en/latest/index.html","key":"hwHaW3ejPO"},{"type":"text","value":", as demonstrated here.","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"scGiPb88RA"}],"key":"CZHQjJ3NXa"}],"key":"G7XetEqA0U"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"order = 5  # the catalog is partitioned by HEALPix pixel index at order 5\nnside = hp.order_to_nside(order)  # number of order 5 pixels along one side of a base pixel","key":"rg7J3IxJVu"},{"type":"output","id":"ebGNl4zHKqNuwM_C9lnUO","data":[],"key":"ja91Shikmf"}],"key":"d7QVqLlvYD"},{"type":"block","children":[],"key":"dSmqoAcMWx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# polygon search: get the set of pixel indexes that overlap the ra/dec polygon\npolygon_pixels = hp.query_polygon(\n    nside=nside,\n    a=[corner[0] for corner in polygon_corners],  # ra values\n    b=[corner[1] for corner in polygon_corners],  # dec values\n    nest=True,  # catalog uses nested ordering scheme for pixel index\n    inclusive=True,  # return all pixels that overlap with the polygon, and maybe a few more\n)\n\nprint(f\"polygon_pixels contains {len(polygon_pixels)} of a possible {hp.nside_to_npixel(nside)} pixels\")","key":"bADP2dmHM6"},{"type":"output","id":"EyEBlx_5Cdowz51cbNuQE","data":[{"output_type":"stream","name":"stdout","text":"polygon_pixels contains 25 of a possible 12288 pixels\n"}],"key":"yhyV6MLcXe"}],"key":"pv3h1jmBpm"},{"type":"block","children":[],"key":"fcH3K5aCFM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# cone search: get the set of pixel indexes that overlap a 5' circle around the ra/dec min\ncone_pixels = hp.query_circle(\n    nside=nside,\n    a=ra_min,\n    b=dec_min,\n    radius=radius,\n    nest=True,  # catalog uses nested ordering scheme for pixel index\n    inclusive=True,  # return all pixels that overlap with the disk, and maybe a few more\n)\n\n# this can reduce the number of partitions the reader needs to look at from 12288 down to 2\nprint(f\"cone_pixels contains {len(cone_pixels)} of a possible {hp.nside_to_npixel(nside)} pixels\")","key":"cgCPbGFhxz"},{"type":"output","id":"FZ4-yFX-1ozF0TvIMfCLn","data":[{"output_type":"stream","name":"stdout","text":"cone_pixels contains 2 of a possible 12288 pixels\n"}],"key":"lHKk0g8bCh"}],"key":"ZYES3b4TIb"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Example 1:  Pandas with basic filters (magnitude limit and ra/dec polygon)","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"Na9BDqUZ9F"}],"identifier":"example-1-pandas-with-basic-filters-magnitude-limit-and-ra-dec-polygon","label":"Example 1:  Pandas with basic filters (magnitude limit and ra/dec polygon)","html_id":"example-1-pandas-with-basic-filters-magnitude-limit-and-ra-dec-polygon","implicit":true,"key":"PJUYCJ0Q5A"}],"key":"K9g9F17DrQ"},{"type":"block","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":136,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"Load using ","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"EKaB0zCQ05"},{"type":"link","url":"https://pandas.pydata.org/docs/reference/api/pandas.read_parquet.html","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"children":[{"type":"text","value":"pandas.read_parquet","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"q2WMNqMKr6"}],"urlSource":"https://pandas.pydata.org/docs/reference/api/pandas.read_parquet.html","key":"fF9OjmUUb2"},{"type":"text","value":".\nFilter for magnitudes above our w1mpro limit and a sky-area limited to the ra/dec polygon.","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"TlRfAJenaj"}],"key":"UkP6tCAyY6"},{"type":"paragraph","position":{"start":{"line":139,"column":1},"end":{"line":141,"column":1}},"children":[{"type":"text","value":"Pandas actually uses either pyarrow or fastparquet to interact with parquet files.\nWe’ll choose pyarrow (the default).\nFor filter options, see the ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"iazKNEWnIh"},{"type":"inlineCode","value":"filters","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"dDUq10g66p"},{"type":"text","value":" arg description in ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"JjBR27agi5"},{"type":"link","url":"https://arrow.apache.org/docs/python/generated/pyarrow.parquet.ParquetDataset.html#pyarrow.parquet.ParquetDataset","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"text","value":"ParquetDataset","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"hlKAIMvDCw"}],"urlSource":"https://arrow.apache.org/docs/python/generated/pyarrow.parquet.ParquetDataset.html#pyarrow.parquet.ParquetDataset","key":"jJyUSHCmVA"},{"type":"text","value":".","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"vJQaKDxzvh"}],"key":"RKmy1Pzr3G"}],"key":"Q1dwy9WtMB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# expect this to take 40-90 seconds\npandas_df = pd.read_parquet(\n    parquet_root,\n    filesystem=fs,\n    # columns to be returned. similar to a SQL SELECT clause.\n    columns=[\"designation\", \"ra\", \"dec\", \"w1mpro\", \"healpix_k5\"],\n    # row filters. similar to a SQL WHERE clause.\n    # tuple conditions are joined by AND (for OR, use a list of lists)\n    # supported operators: ==, !=, <, >, <=, >=, in, not in\n    filters=[\n        (\"w1mpro\", \">\", w1mpro_min),\n        (\"ra\", \">\", ra_min),\n        (\"ra\", \"<\", ra_max),\n        (\"dec\", \">\", dec_min),\n        (\"dec\", \"<\", dec_max),\n        # include filter on partition column for most efficient loading\n        (\"healpix_k5\", \"in\", polygon_pixels),\n    ],\n)\n\npandas_df.describe()","key":"tF9XxhFsTU"},{"type":"output","id":"kX0Wb7CCMfRHpkUVf_l-L","data":[{"output_type":"stream","name":"stdout","text":"CPU times: user 9.07 s, sys: 2.25 s, total: 11.3 s\nWall time: 31.5 s\n"},{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"                  ra            dec         w1mpro\ncount  870641.000000  870641.000000  870641.000000\nmean       20.014620      66.582893      14.788122\nstd         2.900022       2.835385       1.441931\nmin        15.000000      62.000001      10.001000\n25%        17.489370      64.121702      14.003000\n50%        20.038686      66.416329      14.992000\n75%        22.525137      68.928682      15.792000\nmax        25.000000      71.999960      19.079000","content_type":"text/plain"},"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>ra</th>\n      <th>dec</th>\n      <th>w1mpro</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>870641.000000</td>\n      <td>870641.000000</td>\n      <td>870641.000000</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>20.014620</td>\n      <td>66.582893</td>\n      <td>14.788122</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>2.900022</td>\n      <td>2.835385</td>\n      <td>1.441931</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>15.000000</td>\n      <td>62.000001</td>\n      <td>10.001000</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>17.489370</td>\n      <td>64.121702</td>\n      <td>14.003000</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>20.038686</td>\n      <td>66.416329</td>\n      <td>14.992000</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>22.525137</td>\n      <td>68.928682</td>\n      <td>15.792000</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>25.000000</td>\n      <td>71.999960</td>\n      <td>19.079000</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"}}}],"key":"uiS8aYkeMf"}],"key":"Ldm3xnXOt2"},{"type":"block","children":[],"key":"tMRsST3P9b"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Delete pandas_df to save memory. This is useful when running on a machine with a small amount of RAM.\ndel pandas_df","key":"irGGRIrtPs"},{"type":"output","id":"EbHW1MS_E0onNZ6UFh_yu","data":[],"key":"Dof4lF83ba"}],"key":"JHFs9hqGZa"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"children":[{"type":"text","value":"Example 2:  Pyarrow with advanced filters (color-color cuts for AGN)","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"nEh3JQMwH8"}],"identifier":"example-2-pyarrow-with-advanced-filters-color-color-cuts-for-agn","label":"Example 2:  Pyarrow with advanced filters (color-color cuts for AGN)","html_id":"example-2-pyarrow-with-advanced-filters-color-color-cuts-for-agn","implicit":true,"key":"b5GNK7UVQB"}],"key":"xafyj689ef"},{"type":"block","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":177,"column":1},"end":{"line":178,"column":1}},"children":[{"type":"text","value":"Load using ","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"R7Bf0P1xAi"},{"type":"link","url":"https://arrow.apache.org/docs/python/generated/pyarrow.dataset.parquet_dataset.html","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"children":[{"type":"text","value":"pyarrow​.dataset​.parquet​_dataset","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"umkARB87rc"}],"urlSource":"https://arrow.apache.org/docs/python/generated/pyarrow.dataset.parquet_dataset.html","key":"AiquLc7xr4"},{"type":"text","value":" and convert to pandas.\nUseful for:","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"Aj7kldeCMb"}],"key":"repYH8FbS6"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":180,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"text","value":"advanced filters that combine, compare, and/or create new columns. (this example)","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"PEINugf7I6"}],"key":"YGWuqNC6Ie"},{"type":"listItem","spread":true,"position":{"start":{"line":181,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"text","value":"speed. This method is more efficient at “discovering” the dataset than pandas. It also provides a persistent dataset object that can be reused for future queries, where pandas must re-discover the dataset every time. (this example and Example 3)","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"WVVMH0TmZl"}],"key":"VFIRaatKjc"}],"key":"Z1CwbCTNOS"},{"type":"paragraph","position":{"start":{"line":183,"column":1},"end":{"line":184,"column":1}},"children":[{"type":"text","value":"This example filters the catalog for AGN by making cuts in color-color space using the selection limits from ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"Cy7roq5Xve"},{"type":"link","url":"https://arxiv.org/pdf/1208.2530.pdf","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"text","value":"Mateos et al. (2012)","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"p9uSgGBr7K"}],"urlSource":"https://arxiv.org/pdf/1208.2530.pdf","key":"mk03qWhOeM"},{"type":"text","value":".\nThis is a more complicated filter than in Example 1 (it requires both constructing new columns and comparing values between columns) but this load is generally faster, demonstrating the efficiency of this method.","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"hnARhment6"}],"key":"liIBD95ec0"},{"type":"paragraph","position":{"start":{"line":186,"column":1},"end":{"line":190,"column":1}},"children":[{"type":"text","value":"For basic info about the ","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"slETHVINfB"},{"type":"inlineCode","value":"columns","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"BUmFptcqbS"},{"type":"text","value":" and ","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"BGiIDfiLuA"},{"type":"inlineCode","value":"filter","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"Dfq0Lytu8V"},{"type":"text","value":" arguments, see ","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"OCyy9a4Igi"},{"type":"link","url":"https://arrow.apache.org/docs/python/generated/pyarrow.dataset.Scanner.html#pyarrow.dataset.Scanner.from_dataset","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"text","value":"Scanner","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"WbltVJCdSh"}],"urlSource":"https://arrow.apache.org/docs/python/generated/pyarrow.dataset.Scanner.html#pyarrow.dataset.Scanner.from_dataset","key":"j1RkAonnT3"},{"type":"text","value":".\nThe construction of columns/filters is more involved than before because they must be passed as ","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"US59OBZwR6"},{"type":"link","url":"https://arrow.apache.org/docs/python/generated/pyarrow.dataset.Expression.html#pyarrow.dataset.Expression","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"text","value":"Expressions","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"zYYSszUW5n"}],"urlSource":"https://arrow.apache.org/docs/python/generated/pyarrow.dataset.Expression.html#pyarrow.dataset.Expression","key":"YcOjT5dLwc"},{"type":"text","value":", and all operations must be done using pyarrow.compute ","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"xNXEtABWwq"},{"type":"link","url":"https://arrow.apache.org/docs/python/api/compute.html","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"text","value":"functions","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"lxt0kEl0c1"}],"urlSource":"https://arrow.apache.org/docs/python/api/compute.html","key":"JxhEpkZSOK"},{"type":"text","value":" and ","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"JwgXkK9XuY"},{"type":"inlineCode","value":"field","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"ubAOa0nA6r"},{"type":"text","value":"s.\nThis is demonstrated below.\nNote that the catalog uses a file naming scheme called “hive”, which the reader uses to identify partitions.\nIn other examples this is recognized automatically, but here we must pass it explicitly.","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"hNJaqaLGv6"}],"key":"gfOcojhOsO"}],"key":"kHvHkvMjJQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# define new columns for colors W1-W2 and W3-W4\nw1w2 = pc.subtract(pc.field(\"w1mpro\"), pc.field(\"w2mpro\"))\nw3w4 = pc.subtract(pc.field(\"w3mpro\"), pc.field(\"w4mpro\"))\n\n# define the AGN locus, as in Mateos et al., 2012\nlocus = pc.multiply(pc.scalar(0.5), w3w4)","key":"EtZUrRP2mO"},{"type":"output","id":"N_hMh3V9bepWgFrzeoHgi","data":[],"key":"yRKxUZ0nQ9"}],"key":"z7IBXkpQi8"},{"type":"block","children":[],"key":"zJrQ6nyPip"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# expect this to take 20-60 seconds.\n# notice this is generally faster than example 1 using pandas even though\n# this filter is much more complicated, highlighting the efficiency of this method.\n\n# load catalog metadata as a pyarrow dataset\npyarrow_ds = ds.parquet_dataset(f\"{parquet_root}/_metadata\", filesystem=fs, partitioning=\"hive\")\n\n# query for AGN using selection limits from Mateos et al., 2012\npyarrow_df = pyarrow_ds.to_table(\n    # column filter. similar to a SQL SELECT clause.\n    columns={\n        \"w1w2\": w1w2,\n        \"w3w4\": w3w4,\n        \"cntr\": pc.field(\"cntr\"),\n        \"ra\": pc.field(\"ra\"),\n        \"dec\": pc.field(\"dec\"),\n        \"healpix_k5\": pc.field(\"healpix_k5\"),\n    },\n    # row filter. similar to a SQL WHERE clause.\n    filter=(\n        # color-color cuts\n        (w1w2 < pc.add(locus, pc.scalar(0.979)))\n        & (w1w2 > pc.subtract(locus, pc.scalar(0.405)))\n        & (w3w4 > pc.scalar(1.76))\n        # to do an all-sky search, comment out the rest of the filter. expect it to take 30-60 min\n        # same ra/dec polygon as before\n        & (pc.field(\"ra\") > ra_min)\n        & (pc.field(\"ra\") < ra_max)\n        & (pc.field(\"dec\") > dec_min)\n        & (pc.field(\"dec\") < dec_max)\n        # same partition-column filter as before\n        & (pc.field(\"healpix_k5\").isin(polygon_pixels))\n    ),\n).to_pandas()","key":"QRiUYURnSH"},{"type":"output","id":"eIEQGbCg-tC1bX1HZpMx4","data":[{"output_type":"stream","name":"stdout","text":"CPU times: user 7.37 s, sys: 4.59 s, total: 12 s\nWall time: 37.5 s\n"}],"key":"Z0slcM8BIw"}],"key":"O9Oi5j1hB1"},{"type":"block","children":[],"key":"VgJZoDZ5Vl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"len(pyarrow_df.index)","key":"n7qhcGURjz"},{"type":"output","id":"UH_cXf_CxUnqxDeTA7o5O","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"3750","content_type":"text/plain"}}}],"key":"Q4am18Ktri"}],"key":"L13re3j2U9"},{"type":"block","children":[],"key":"qtuWU86rdj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"colorbar_norm = colors.LogNorm(vmin=1, vmax=10)  # for an all-sky search, use vmax=100_000\npyarrow_df.plot.hexbin(\"w3w4\", \"w1w2\", norm=colorbar_norm)","key":"bDBFX7bSjV"},{"type":"output","id":"r5U4vKwFO4eKqgrYb2Qrn","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/plain":{"content":"<Axes: xlabel='w3w4', ylabel='w1w2'>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"b348b34bb36d35eb4f57b30cdc290a23","path":"/build/b348b34bb36d35eb4f57b30cdc290a23.png"}}}],"key":"a7Hec5mvMX"}],"key":"R31nVLjLHR"},{"type":"block","children":[],"key":"MAsvon9YPV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Delete variables to save memory. This is useful when running on a machine with a small amount of RAM.\ndel pyarrow_ds\ndel pyarrow_df","key":"YuAYrE6zCI"},{"type":"output","id":"CmlD8JanFr9w0PwDF9pIo","data":[],"key":"YUtNBRKu4t"}],"key":"AtRrhrLRCZ"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"children":[{"type":"text","value":"Example 3:  Nearest-neighbor search (using pyarrow and astropy)","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"key":"xNDuyLwFE8"}],"identifier":"example-3-nearest-neighbor-search-using-pyarrow-and-astropy","label":"Example 3:  Nearest-neighbor search (using pyarrow and astropy)","html_id":"example-3-nearest-neighbor-search-using-pyarrow-and-astropy","implicit":true,"key":"jj2pHWxzSh"}],"key":"lWzjGQT2wu"},{"type":"block","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":258,"column":1},"end":{"line":260,"column":1}},"children":[{"type":"text","value":"Nearest-neighbor searches and cone searches generally use the on-sky separation distance to determine the matches.\nIt would be cumbersome to construct the new column and filter on it using the methods shown above because the separation distance is a fairly complicated function of ra and dec.\nHowever, we can get pretty fast results by filtering down to the HEALPix pixels that cover the region, loading all the data in those partitions, and then using astropy to compute the separations and find the matches.","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"Z5bN8wQOgd"}],"key":"ruef2zl2EB"},{"type":"paragraph","position":{"start":{"line":262,"column":1},"end":{"line":265,"column":1}},"children":[{"type":"text","value":"Here, we’ll search for the 3 nearest neighbors to each of the 4 corners of our ra/dec polygon.\nWe’ll load the data with pyarrow because because it makes this query significantly faster than with pandas (see explanation in Example 2).\n(Note that astropy can also read parquet, but it can only read a single file at a time and so is less convenient.)\nWe’ll use ","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"key":"FZkvyfuG2G"},{"type":"link","url":"https://docs.astropy.org/en/stable/api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord.match_to_catalog_sky","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"children":[{"type":"text","value":"astropy​.coordinates​.SkyCoord​.match​_to​_catalog​_sky","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"key":"OakSxlZieB"}],"urlSource":"https://docs.astropy.org/en/stable/api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord.match_to_catalog_sky","key":"Gj5QbgYhsq"},{"type":"text","value":" to do the actual nearest neighbor search.","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"key":"vBNTXstXOc"}],"key":"j5OOGW5sgo"}],"key":"AT85LIV7GA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# construct dictionary of pixels covering a cone around each polygon corner\n# we did this once before but now we want all 4 corners\ncorner_cone_pixels = {\n    (ra, dec): hp.query_circle(nside=nside, a=ra, b=dec, radius=radius, nest=True, inclusive=True)\n    for (ra, dec) in polygon_corners\n}\ncorner_cone_pixels","key":"pZmpYvz215"},{"type":"output","id":"KX9IGRhBFddlXUEggMtNg","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/plain":{"content":"{(15, 62): array([757, 928]),\n (15, 72): array([947, 950, 953]),\n (25, 72): array([948, 949]),\n (25, 62): array([908])}","content_type":"text/plain"}}}],"key":"LxaGYOJu5L"}],"key":"UjZXbfogeT"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"children":[{"type":"text","value":"Find the 3 nearest neighbors of each corner:","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"MTpGduvAHr"}],"key":"uzLkLQGrdH"}],"key":"E1Q5ZGaPV6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# expect this to take 30-60 seconds\nidcol = \"cntr\"\nneighbor_ids = []  # store the allwise source id (cntr) of each neighbor\ncorner_neighbors = {}  # record neighbor info for each corner (for reference. not actually used)\n\n# use same pyarrow dataset as before, but get it again to include the load time in this cell\npyarrow_ds = ds.parquet_dataset(f\"{parquet_root}/_metadata\", filesystem=fs, partitioning=\"hive\")\n\nfor (ra, dec), cone_pixels in corner_cone_pixels.items():\n\n    # load data from all pixels/partitions/files covering this corner\n    src_tbl = pyarrow_ds.to_table(\n        columns=[idcol, \"ra\", \"dec\"], filter=(pc.field(\"healpix_k5\").isin(cone_pixels))\n    )\n\n    # get list of 3 nearest neighbors to this corner\n    corner = SkyCoord(ra=ra * u.degree, dec=dec * u.degree)\n    allwise_sources = SkyCoord(ra=src_tbl[\"ra\"] * u.degree, dec=src_tbl[\"dec\"] * u.degree)\n    neighbors = [corner.match_to_catalog_sky(allwise_sources, nthneighbor=i) for i in range(1, 4)]\n\n    # get the allwise source ids. record/report some info\n    corner_neighbors[(ra, dec)] = []\n    for n, (idx, sep, _) in enumerate(neighbors):\n        srcid = src_tbl[idcol][idx.item()].as_py()\n        neighbor_ids.append(srcid)\n        corner_neighbors[(ra, dec)].append((srcid, sep))\n        print(f\"neighbor {n+1}, corner ({ra}, {dec}): {srcid} at on-sky dist {sep.to('arcsec')}\")\n\nneighbor_ids","key":"z6HKZZk4t9"},{"type":"output","id":"BL88riHVmVb1WZr21slHE","data":[{"output_type":"stream","name":"stdout","text":"neighbor 1, corner (15, 62): 157162001351035963 at on-sky dist [7.90224006] arcsec\nneighbor 2, corner (15, 62): 157162001351036469 at on-sky dist [8.50715008] arcsec\nneighbor 3, corner (15, 62): 157162001351035211 at on-sky dist [10.86567525] arcsec\n"},{"output_type":"stream","name":"stdout","text":"neighbor 1, corner (15, 72): 145172601351006308 at on-sky dist [10.93439298] arcsec\nneighbor 2, corner (15, 72): 145172601351005598 at on-sky dist [25.54305849] arcsec\nneighbor 3, corner (15, 72): 145172601351004924 at on-sky dist [28.06138449] arcsec\n"},{"output_type":"stream","name":"stdout","text":"neighbor 1, corner (25, 72): 243172601351002865 at on-sky dist [12.86477229] arcsec\nneighbor 2, corner (25, 72): 243172601351004919 at on-sky dist [22.84314776] arcsec\nneighbor 3, corner (25, 72): 243172601351003808 at on-sky dist [22.86047987] arcsec\n"},{"output_type":"stream","name":"stdout","text":"neighbor 1, corner (25, 62): 252162001351031532 at on-sky dist [7.458129] arcsec\nneighbor 2, corner (25, 62): 252162001351031550 at on-sky dist [14.2719862] arcsec\nneighbor 3, corner (25, 62): 252162001351031549 at on-sky dist [18.96407889] arcsec\nCPU times: user 6.16 s, sys: 3.21 s, total: 9.38 s\nWall time: 42.4 s\n"},{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"[157162001351035963,\n 157162001351036469,\n 157162001351035211,\n 145172601351006308,\n 145172601351005598,\n 145172601351004924,\n 243172601351002865,\n 243172601351004919,\n 243172601351003808,\n 252162001351031532,\n 252162001351031550,\n 252162001351031549]","content_type":"text/plain"}}}],"key":"PeWd4YKa4W"}],"key":"E3GNfQAJdk"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"children":[{"type":"text","value":"Load all the data (all columns) for all nearest neighbors:","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"KKWNuZVV0X"}],"key":"NOZTMzSrqg"}],"key":"ojBsrLaKWB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# expect this to take 15-25 seconds\ncone_pixels = [pixel for cone_pixels in corner_cone_pixels.values() for pixel in cone_pixels]\nneighbors_df = pyarrow_ds.to_table(\n    filter=((pc.field(idcol).isin(neighbor_ids)) & (pc.field(\"healpix_k5\").isin(cone_pixels)))\n).to_pandas()\n\nneighbors_df","key":"D8kNncGTQH"},{"type":"output","id":"gAD-njkbYV2dJ7ozNFR1s","data":[{"output_type":"stream","name":"stdout","text":"CPU times: user 1.88 s, sys: 580 ms, total: 2.46 s\nWall time: 2.81 s\n"},{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/plain":{"content":"            designation         ra        dec   sigra  sigdec  sigradec  \\\n0   J013958.40+620015.2  24.993333  62.004237  0.0398  0.0489   -0.0058   \n1   J013958.51+620009.7  24.993832  62.002708  0.1038  0.1627   -0.0660   \n2   J014000.56+615953.6  25.002354  61.998248  0.0398  0.0379    0.0094   \n3   J005959.07+615955.5  14.996146  61.998757  0.0868  0.0854   -0.0219   \n4   J005959.19+620006.3  14.996627  62.001754  0.1677  0.1633   -0.0432   \n5   J010001.07+620007.7  15.004480  62.002165  0.0534  0.0510    0.0053   \n6   J005956.32+720019.0  14.984687  72.005287  0.0997  0.0960   -0.0153   \n7   J010001.48+715951.5  15.006188  71.997640  0.2109  0.2034   -0.0539   \n8   J010002.55+720025.4  15.010649  72.007066  0.0514  0.0498    0.0083   \n9   J013956.82+720017.4  24.986791  72.004858  0.5317  0.5261   -0.1661   \n10  J013958.03+715950.9  24.991821  71.997474  0.0579  0.0571   -0.0024   \n11  J013959.48+715937.2  24.997836  71.993685  0.1479  0.1445   -0.0417   \n\n          glon      glat       elon       elat  ...  h_msig_2mass  k_m_2mass  \\\n0   128.594461 -0.332646  51.412734  46.989544  ...         0.040     11.843   \n1   128.594977 -0.334105  51.411840  46.988121  ...         0.054     13.759   \n2   128.599742 -0.337737  51.413364  46.982221  ...         0.032     11.662   \n3   123.934996 -0.856265  45.573400  49.619268  ...         0.162     15.280   \n4   123.935122 -0.853262  45.576424  49.621547  ...           NaN        NaN   \n5   123.938794 -0.852729  45.581382  49.619691  ...         0.055     13.940   \n6   123.596773  9.144601  56.543000  57.227891  ...         0.125     15.182   \n7   123.603758  9.137181  56.541620  57.217789  ...           NaN     15.436   \n8   123.604831  9.146649  56.555769  57.223452  ...         0.038     13.571   \n9   126.704895  9.489459  60.653660  55.154163  ...           NaN        NaN   \n10  126.707862  9.482503  60.647616  55.147453  ...         0.057     14.207   \n11  126.710442  9.479135  60.645958  55.143341  ...         0.284     15.672   \n\n    k_msig_2mass         x         y         z    spt_ind           htm20  \\\n0          0.030  0.425450  0.198330  0.882982  231130002  16887982685832   \n1          0.054  0.425469  0.198344  0.882970  231130002  16887982683755   \n2          0.019  0.425502  0.198436  0.882933  231130002  16887983158948   \n3          0.162  0.453501  0.121483  0.882937  231122233  16882422834846   \n4            NaN  0.453456  0.121474  0.882962  231122233  16882422833160   \n5          0.059  0.453433  0.121535  0.882965  231122233  16882422783986   \n6          0.143  0.298424  0.079877  0.951085  231010101  16785925865144   \n7          0.165  0.298517  0.080022  0.951044  231010101  16785926933871   \n8          0.043  0.298359  0.080005  0.951095  231010101  16785925808192   \n9            NaN  0.280022  0.130498  0.951083  231322133  17018750630425   \n10         0.064  0.280121  0.130574  0.951043  231322133  17018750602154   \n11         0.239  0.280164  0.130630  0.951022  231322133  17018750518198   \n\n    healpix_k0  healpix_k5  \n0            0         908  \n1            0         908  \n2            0         908  \n3            0         928  \n4            0         928  \n5            0         928  \n6            0         947  \n7            0         947  \n8            0         947  \n9            0         949  \n10           0         949  \n11           0         949  \n\n[12 rows x 300 columns]","content_type":"text/plain"},"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>designation</th>\n      <th>ra</th>\n      <th>dec</th>\n      <th>sigra</th>\n      <th>sigdec</th>\n      <th>sigradec</th>\n      <th>glon</th>\n      <th>glat</th>\n      <th>elon</th>\n      <th>elat</th>\n      <th>...</th>\n      <th>h_msig_2mass</th>\n      <th>k_m_2mass</th>\n      <th>k_msig_2mass</th>\n      <th>x</th>\n      <th>y</th>\n      <th>z</th>\n      <th>spt_ind</th>\n      <th>htm20</th>\n      <th>healpix_k0</th>\n      <th>healpix_k5</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>J013958.40+620015.2</td>\n      <td>24.993333</td>\n      <td>62.004237</td>\n      <td>0.0398</td>\n      <td>0.0489</td>\n      <td>-0.0058</td>\n      <td>128.594461</td>\n      <td>-0.332646</td>\n      <td>51.412734</td>\n      <td>46.989544</td>\n      <td>...</td>\n      <td>0.040</td>\n      <td>11.843</td>\n      <td>0.030</td>\n      <td>0.425450</td>\n      <td>0.198330</td>\n      <td>0.882982</td>\n      <td>231130002</td>\n      <td>16887982685832</td>\n      <td>0</td>\n      <td>908</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>J013958.51+620009.7</td>\n      <td>24.993832</td>\n      <td>62.002708</td>\n      <td>0.1038</td>\n      <td>0.1627</td>\n      <td>-0.0660</td>\n      <td>128.594977</td>\n      <td>-0.334105</td>\n      <td>51.411840</td>\n      <td>46.988121</td>\n      <td>...</td>\n      <td>0.054</td>\n      <td>13.759</td>\n      <td>0.054</td>\n      <td>0.425469</td>\n      <td>0.198344</td>\n      <td>0.882970</td>\n      <td>231130002</td>\n      <td>16887982683755</td>\n      <td>0</td>\n      <td>908</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>J014000.56+615953.6</td>\n      <td>25.002354</td>\n      <td>61.998248</td>\n      <td>0.0398</td>\n      <td>0.0379</td>\n      <td>0.0094</td>\n      <td>128.599742</td>\n      <td>-0.337737</td>\n      <td>51.413364</td>\n      <td>46.982221</td>\n      <td>...</td>\n      <td>0.032</td>\n      <td>11.662</td>\n      <td>0.019</td>\n      <td>0.425502</td>\n      <td>0.198436</td>\n      <td>0.882933</td>\n      <td>231130002</td>\n      <td>16887983158948</td>\n      <td>0</td>\n      <td>908</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>J005959.07+615955.5</td>\n      <td>14.996146</td>\n      <td>61.998757</td>\n      <td>0.0868</td>\n      <td>0.0854</td>\n      <td>-0.0219</td>\n      <td>123.934996</td>\n      <td>-0.856265</td>\n      <td>45.573400</td>\n      <td>49.619268</td>\n      <td>...</td>\n      <td>0.162</td>\n      <td>15.280</td>\n      <td>0.162</td>\n      <td>0.453501</td>\n      <td>0.121483</td>\n      <td>0.882937</td>\n      <td>231122233</td>\n      <td>16882422834846</td>\n      <td>0</td>\n      <td>928</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>J005959.19+620006.3</td>\n      <td>14.996627</td>\n      <td>62.001754</td>\n      <td>0.1677</td>\n      <td>0.1633</td>\n      <td>-0.0432</td>\n      <td>123.935122</td>\n      <td>-0.853262</td>\n      <td>45.576424</td>\n      <td>49.621547</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>0.453456</td>\n      <td>0.121474</td>\n      <td>0.882962</td>\n      <td>231122233</td>\n      <td>16882422833160</td>\n      <td>0</td>\n      <td>928</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>J010001.07+620007.7</td>\n      <td>15.004480</td>\n      <td>62.002165</td>\n      <td>0.0534</td>\n      <td>0.0510</td>\n      <td>0.0053</td>\n      <td>123.938794</td>\n      <td>-0.852729</td>\n      <td>45.581382</td>\n      <td>49.619691</td>\n      <td>...</td>\n      <td>0.055</td>\n      <td>13.940</td>\n      <td>0.059</td>\n      <td>0.453433</td>\n      <td>0.121535</td>\n      <td>0.882965</td>\n      <td>231122233</td>\n      <td>16882422783986</td>\n      <td>0</td>\n      <td>928</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>J005956.32+720019.0</td>\n      <td>14.984687</td>\n      <td>72.005287</td>\n      <td>0.0997</td>\n      <td>0.0960</td>\n      <td>-0.0153</td>\n      <td>123.596773</td>\n      <td>9.144601</td>\n      <td>56.543000</td>\n      <td>57.227891</td>\n      <td>...</td>\n      <td>0.125</td>\n      <td>15.182</td>\n      <td>0.143</td>\n      <td>0.298424</td>\n      <td>0.079877</td>\n      <td>0.951085</td>\n      <td>231010101</td>\n      <td>16785925865144</td>\n      <td>0</td>\n      <td>947</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>J010001.48+715951.5</td>\n      <td>15.006188</td>\n      <td>71.997640</td>\n      <td>0.2109</td>\n      <td>0.2034</td>\n      <td>-0.0539</td>\n      <td>123.603758</td>\n      <td>9.137181</td>\n      <td>56.541620</td>\n      <td>57.217789</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>15.436</td>\n      <td>0.165</td>\n      <td>0.298517</td>\n      <td>0.080022</td>\n      <td>0.951044</td>\n      <td>231010101</td>\n      <td>16785926933871</td>\n      <td>0</td>\n      <td>947</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>J010002.55+720025.4</td>\n      <td>15.010649</td>\n      <td>72.007066</td>\n      <td>0.0514</td>\n      <td>0.0498</td>\n      <td>0.0083</td>\n      <td>123.604831</td>\n      <td>9.146649</td>\n      <td>56.555769</td>\n      <td>57.223452</td>\n      <td>...</td>\n      <td>0.038</td>\n      <td>13.571</td>\n      <td>0.043</td>\n      <td>0.298359</td>\n      <td>0.080005</td>\n      <td>0.951095</td>\n      <td>231010101</td>\n      <td>16785925808192</td>\n      <td>0</td>\n      <td>947</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>J013956.82+720017.4</td>\n      <td>24.986791</td>\n      <td>72.004858</td>\n      <td>0.5317</td>\n      <td>0.5261</td>\n      <td>-0.1661</td>\n      <td>126.704895</td>\n      <td>9.489459</td>\n      <td>60.653660</td>\n      <td>55.154163</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>0.280022</td>\n      <td>0.130498</td>\n      <td>0.951083</td>\n      <td>231322133</td>\n      <td>17018750630425</td>\n      <td>0</td>\n      <td>949</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>J013958.03+715950.9</td>\n      <td>24.991821</td>\n      <td>71.997474</td>\n      <td>0.0579</td>\n      <td>0.0571</td>\n      <td>-0.0024</td>\n      <td>126.707862</td>\n      <td>9.482503</td>\n      <td>60.647616</td>\n      <td>55.147453</td>\n      <td>...</td>\n      <td>0.057</td>\n      <td>14.207</td>\n      <td>0.064</td>\n      <td>0.280121</td>\n      <td>0.130574</td>\n      <td>0.951043</td>\n      <td>231322133</td>\n      <td>17018750602154</td>\n      <td>0</td>\n      <td>949</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>J013959.48+715937.2</td>\n      <td>24.997836</td>\n      <td>71.993685</td>\n      <td>0.1479</td>\n      <td>0.1445</td>\n      <td>-0.0417</td>\n      <td>126.710442</td>\n      <td>9.479135</td>\n      <td>60.645958</td>\n      <td>55.143341</td>\n      <td>...</td>\n      <td>0.284</td>\n      <td>15.672</td>\n      <td>0.239</td>\n      <td>0.280164</td>\n      <td>0.130630</td>\n      <td>0.951022</td>\n      <td>231322133</td>\n      <td>17018750518198</td>\n      <td>0</td>\n      <td>949</td>\n    </tr>\n  </tbody>\n</table>\n<p>12 rows × 300 columns</p>\n</div>","content_type":"text/html"}}}],"key":"IeKCtXuDWE"}],"key":"SmyaUvsqhu"},{"type":"block","children":[],"key":"bBrwHU63VS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Delete variables to save memory. This is useful when running on a machine with a small amount of RAM.\ndel pyarrow_ds\ndel neighbors_df","key":"uWMrRbfxyW"},{"type":"output","id":"RZd-l8P1owjk65JuaE8gw","data":[],"key":"xz41sC6FAs"}],"key":"kMoJPrUd5X"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"children":[{"type":"text","value":"Schema Access","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"LqdgxcZMyI"}],"identifier":"schema-access","label":"Schema Access","html_id":"schema-access","implicit":true,"key":"JRkOWGUvvs"}],"key":"LZkY42QGUv"},{"type":"block","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":335,"column":1},"end":{"line":338,"column":1}},"children":[{"type":"text","value":"The schema can be viewed ","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"sa75ZFyl46"},{"type":"link","url":"http://wise2.ipac.caltech.edu/docs/release/allwise/expsup/sec2_1a.html","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"children":[{"type":"text","value":"online","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"oJKaYfgCFr"}],"urlSource":"http://wise2.ipac.caltech.edu/docs/release/allwise/expsup/sec2_1a.html","key":"cvpRvcHEGj"},{"type":"text","value":" and also accessed from the parquet catalog itself.\nThe example below loads it using the ","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"BHpjFpDbuf"},{"type":"inlineCode","value":"_common_metadata","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"tUE4iPnnUc"},{"type":"text","value":" file and ","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"uQEZKNlWDk"},{"type":"link","url":"https://arrow.apache.org/docs/python/generated/pyarrow.dataset.parquet_dataset.html","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"children":[{"type":"text","value":"pyarrow​.dataset​.parquet​_dataset","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"ahRpEdLoXS"}],"urlSource":"https://arrow.apache.org/docs/python/generated/pyarrow.dataset.parquet_dataset.html","key":"YcSBI5zSYv"},{"type":"text","value":".\nNote that the schema can also be accessed from the metadata in the footer of each Parquet file and from the ","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"uGTHARTs3I"},{"type":"inlineCode","value":"_metadata","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"V6l63ebeGI"},{"type":"text","value":" file, but the method used here is generally faster and easier.\nIn addition, this ","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"t8aYqsMV2K"},{"type":"inlineCode","value":"_common_metadata","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"WRBZmUeNbC"},{"type":"text","value":" file has extra information (units and descriptions) stored in the custom metadata of each column.","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"E6KUAiwfL1"}],"key":"HFINKT4opX"}],"key":"iFY58JI3Ww"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"schema = ds.parquet_dataset(f\"{parquet_root}/_common_metadata\", filesystem=fs).schema","key":"CkqfIzW03I"},{"type":"output","id":"Pnj-tXQ4wg2cIbzl7yfjQ","data":[],"key":"Xgc7jri779"}],"key":"rKkQ5HylF1"},{"type":"block","children":[],"key":"moUAzzy0Zh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# access individual columns by name or index\nfld = schema.field(1)  # equivalently: fld = schema.field(\"ra\")\n\n# basic column information\nprint(fld.name)\nprint(fld.type)\nprint(fld.nullable)\n\n# units and descriptions are in the `metadata` attribute, always as bytestrings\nprint(fld.metadata)\nprint(fld.metadata[b\"units\"].decode())  # use decode to get a regular string\nprint(fld.metadata[b\"description\"].decode())","key":"paLVDZ4Ped"},{"type":"output","id":"dwcycr2HmwwxLSVEMWNXp","data":[{"output_type":"stream","name":"stdout","text":"ra\ndouble\nFalse\n{b'units': b'deg', b'description': b'J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction.'}\ndeg\nJ2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction.\n"}],"key":"W3VnbNi2Ej"}],"key":"KrxZ262a8t"},{"type":"block","children":[],"key":"iHgWxjElGz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# full list of column names\nschema.names","key":"bcUT0PWOBy"},{"type":"output","id":"2pYGQb-cW_HjSz7a53Ezb","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/plain":{"content":"['designation',\n 'ra',\n 'dec',\n 'sigra',\n 'sigdec',\n 'sigradec',\n 'glon',\n 'glat',\n 'elon',\n 'elat',\n 'wx',\n 'wy',\n 'cntr',\n 'source_id',\n 'coadd_id',\n 'src',\n 'w1mpro',\n 'w1sigmpro',\n 'w1snr',\n 'w1rchi2',\n 'w2mpro',\n 'w2sigmpro',\n 'w2snr',\n 'w2rchi2',\n 'w3mpro',\n 'w3sigmpro',\n 'w3snr',\n 'w3rchi2',\n 'w4mpro',\n 'w4sigmpro',\n 'w4snr',\n 'w4rchi2',\n 'rchi2',\n 'nb',\n 'na',\n 'w1sat',\n 'w2sat',\n 'w3sat',\n 'w4sat',\n 'satnum',\n 'ra_pm',\n 'dec_pm',\n 'sigra_pm',\n 'sigdec_pm',\n 'sigradec_pm',\n 'pmra',\n 'sigpmra',\n 'pmdec',\n 'sigpmdec',\n 'w1rchi2_pm',\n 'w2rchi2_pm',\n 'w3rchi2_pm',\n 'w4rchi2_pm',\n 'rchi2_pm',\n 'pmcode',\n 'cc_flags',\n 'rel',\n 'ext_flg',\n 'var_flg',\n 'ph_qual',\n 'det_bit',\n 'moon_lev',\n 'w1nm',\n 'w1m',\n 'w2nm',\n 'w2m',\n 'w3nm',\n 'w3m',\n 'w4nm',\n 'w4m',\n 'w1cov',\n 'w2cov',\n 'w3cov',\n 'w4cov',\n 'w1cc_map',\n 'w1cc_map_str',\n 'w2cc_map',\n 'w2cc_map_str',\n 'w3cc_map',\n 'w3cc_map_str',\n 'w4cc_map',\n 'w4cc_map_str',\n 'best_use_cntr',\n 'ngrp',\n 'w1flux',\n 'w1sigflux',\n 'w1sky',\n 'w1sigsk',\n 'w1conf',\n 'w2flux',\n 'w2sigflux',\n 'w2sky',\n 'w2sigsk',\n 'w2conf',\n 'w3flux',\n 'w3sigflux',\n 'w3sky',\n 'w3sigsk',\n 'w3conf',\n 'w4flux',\n 'w4sigflux',\n 'w4sky',\n 'w4sigsk',\n 'w4conf',\n 'w1mag',\n 'w1sigm',\n 'w1flg',\n 'w1mcor',\n 'w2mag',\n 'w2sigm',\n 'w2flg',\n 'w2mcor',\n 'w3mag',\n 'w3sigm',\n 'w3flg',\n 'w3mcor',\n 'w4mag',\n 'w4sigm',\n 'w4flg',\n 'w4mcor',\n 'w1mag_1',\n 'w1sigm_1',\n 'w1flg_1',\n 'w2mag_1',\n 'w2sigm_1',\n 'w2flg_1',\n 'w3mag_1',\n 'w3sigm_1',\n 'w3flg_1',\n 'w4mag_1',\n 'w4sigm_1',\n 'w4flg_1',\n 'w1mag_2',\n 'w1sigm_2',\n 'w1flg_2',\n 'w2mag_2',\n 'w2sigm_2',\n 'w2flg_2',\n 'w3mag_2',\n 'w3sigm_2',\n 'w3flg_2',\n 'w4mag_2',\n 'w4sigm_2',\n 'w4flg_2',\n 'w1mag_3',\n 'w1sigm_3',\n 'w1flg_3',\n 'w2mag_3',\n 'w2sigm_3',\n 'w2flg_3',\n 'w3mag_3',\n 'w3sigm_3',\n 'w3flg_3',\n 'w4mag_3',\n 'w4sigm_3',\n 'w4flg_3',\n 'w1mag_4',\n 'w1sigm_4',\n 'w1flg_4',\n 'w2mag_4',\n 'w2sigm_4',\n 'w2flg_4',\n 'w3mag_4',\n 'w3sigm_4',\n 'w3flg_4',\n 'w4mag_4',\n 'w4sigm_4',\n 'w4flg_4',\n 'w1mag_5',\n 'w1sigm_5',\n 'w1flg_5',\n 'w2mag_5',\n 'w2sigm_5',\n 'w2flg_5',\n 'w3mag_5',\n 'w3sigm_5',\n 'w3flg_5',\n 'w4mag_5',\n 'w4sigm_5',\n 'w4flg_5',\n 'w1mag_6',\n 'w1sigm_6',\n 'w1flg_6',\n 'w2mag_6',\n 'w2sigm_6',\n 'w2flg_6',\n 'w3mag_6',\n 'w3sigm_6',\n 'w3flg_6',\n 'w4mag_6',\n 'w4sigm_6',\n 'w4flg_6',\n 'w1mag_7',\n 'w1sigm_7',\n 'w1flg_7',\n 'w2mag_7',\n 'w2sigm_7',\n 'w2flg_7',\n 'w3mag_7',\n 'w3sigm_7',\n 'w3flg_7',\n 'w4mag_7',\n 'w4sigm_7',\n 'w4flg_7',\n 'w1mag_8',\n 'w1sigm_8',\n 'w1flg_8',\n 'w2mag_8',\n 'w2sigm_8',\n 'w2flg_8',\n 'w3mag_8',\n 'w3sigm_8',\n 'w3flg_8',\n 'w4mag_8',\n 'w4sigm_8',\n 'w4flg_8',\n 'w1magp',\n 'w1sigp1',\n 'w1sigp2',\n 'w1k',\n 'w1ndf',\n 'w1mlq',\n 'w1mjdmin',\n 'w1mjdmax',\n 'w1mjdmean',\n 'w2magp',\n 'w2sigp1',\n 'w2sigp2',\n 'w2k',\n 'w2ndf',\n 'w2mlq',\n 'w2mjdmin',\n 'w2mjdmax',\n 'w2mjdmean',\n 'w3magp',\n 'w3sigp1',\n 'w3sigp2',\n 'w3k',\n 'w3ndf',\n 'w3mlq',\n 'w3mjdmin',\n 'w3mjdmax',\n 'w3mjdmean',\n 'w4magp',\n 'w4sigp1',\n 'w4sigp2',\n 'w4k',\n 'w4ndf',\n 'w4mlq',\n 'w4mjdmin',\n 'w4mjdmax',\n 'w4mjdmean',\n 'rho12',\n 'rho23',\n 'rho34',\n 'q12',\n 'q23',\n 'q34',\n 'xscprox',\n 'w1rsemi',\n 'w1ba',\n 'w1pa',\n 'w1gmag',\n 'w1gerr',\n 'w1gflg',\n 'w2rsemi',\n 'w2ba',\n 'w2pa',\n 'w2gmag',\n 'w2gerr',\n 'w2gflg',\n 'w3rsemi',\n 'w3ba',\n 'w3pa',\n 'w3gmag',\n 'w3gerr',\n 'w3gflg',\n 'w4rsemi',\n 'w4ba',\n 'w4pa',\n 'w4gmag',\n 'w4gerr',\n 'w4gflg',\n 'tmass_key',\n 'r_2mass',\n 'pa_2mass',\n 'n_2mass',\n 'j_m_2mass',\n 'j_msig_2mass',\n 'h_m_2mass',\n 'h_msig_2mass',\n 'k_m_2mass',\n 'k_msig_2mass',\n 'x',\n 'y',\n 'z',\n 'spt_ind',\n 'htm20',\n 'healpix_k0',\n 'healpix_k5']","content_type":"text/plain"}}}],"key":"z4juTAQQzJ"}],"key":"lyR4vdwJE4"},{"type":"block","children":[{"type":"thematicBreak","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"key":"YOleW52S51"},{"type":"heading","depth":2,"position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"children":[{"type":"text","value":"About this notebook","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"key":"IPXIXnxt86"}],"identifier":"about-this-notebook","label":"About this notebook","html_id":"about-this-notebook","implicit":true,"key":"y1lTHxWNYi"},{"type":"paragraph","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"children":[{"type":"strong","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"children":[{"type":"text","value":"Author:","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"key":"OgfbG6fmgl"}],"key":"xCqqSwEhQJ"},{"type":"text","value":" Troy Raen (IRSA Developer) in conjunction with David Shupe, Jessica Krick and the IPAC Science Platform team","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"key":"VydT7dsfSZ"}],"key":"ucu4yw2t5E"},{"type":"paragraph","position":{"start":{"line":370,"column":1},"end":{"line":370,"column":1}},"children":[{"type":"strong","position":{"start":{"line":370,"column":1},"end":{"line":370,"column":1}},"children":[{"type":"text","value":"Updated:","position":{"start":{"line":370,"column":1},"end":{"line":370,"column":1}},"key":"oESrlOhFC1"}],"key":"HMb8ed9ijz"},{"type":"text","value":" 2023-07-27","position":{"start":{"line":370,"column":1},"end":{"line":370,"column":1}},"key":"p8vrkXmrJT"}],"key":"srk1qvsL56"},{"type":"paragraph","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"children":[{"type":"strong","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"children":[{"type":"text","value":"Contact:","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"GgsVFmraRD"}],"key":"bNyIs4ZPlA"},{"type":"text","value":" ","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"kQlIfNgOIs"},{"type":"link","url":"https://irsa.ipac.caltech.edu/docs/help_desk.html","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"children":[{"type":"text","value":"the IRSA Helpdesk","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"DI9TgDswX7"}],"urlSource":"https://irsa.ipac.caltech.edu/docs/help_desk.html","key":"LlbUicvpHG"},{"type":"text","value":" with questions or reporting problems.","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"xJSfgo2DPc"}],"key":"Dx3w5F17hg"}],"key":"jUNozaxNCw"}],"key":"f2zfRjL9eJ"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Searching for AllWISE Atlas Images","url":"/sia-allwise-atlas","group":"AllWISE"},"next":{"title":"Using Firefly visualization tools to understand the light curves of Solar System objects","url":"/neowise-light-curve-demo","group":"NEOWISE"}}},"domain":"http://localhost:3000"}