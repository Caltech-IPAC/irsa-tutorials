<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Using Firefly visualization tools in Python to vet SEDs - IRSA Tutorials</title><meta property="og:title" content="Using Firefly visualization tools in Python to vet SEDs - IRSA Tutorials"/><meta name="generator" content="mystmd"/><meta name="description" content="IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)"/><meta property="og:description" content="IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)"/><meta name="keywords" content="astronomy"/><link rel="stylesheet" href="/irsa-tutorials/build/_assets/app-AIT5GAEP.css"/><link rel="stylesheet" href="/irsa-tutorials/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/irsa-tutorials/favicon.ico"/><link rel="stylesheet" href="/irsa-tutorials/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="myst-skip-to-article fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article content</a></div><dialog id="myst-no-css" style="position:fixed;left:0px;top:0px;width:100vw;height:100vh;font-size:4rem;padding:1rem;color:black;background:white"><strong>Site not loading correctly?</strong><p>This may be due to an incorrect <code>BASE_URL</code> configuration. See<!-- --> <a href="https://mystmd.org/guide/deployment#deploy-base-url">the MyST Documentation</a> <!-- -->for reference.</p><script>
    (() => {
            // Test for has-styling variable set by the MyST stylesheet
            const node = document.currentScript.parentNode;
            const hasCSS = window.getComputedStyle(node).getPropertyValue("--has-styling");
            if (hasCSS === ""){
                    node.showModal();
            }

    })()
</script></dialog><div class="myst-top-nav bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="myst-top-nav-bar flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="myst-top-nav-menu-button flex items-center justify-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100 w-10 h-10"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="myst-home-link flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/irsa-tutorials/"><div class="myst-home-link-logo mr-3 flex items-center dark:bg-white dark:rounded px-1"><img src="/irsa-tutorials/build/irsa_logo-af1759d1435265940356a93d3c7de2f4.png" class="h-9" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R75cp:" data-state="closed" class="myst-search-bar flex items-center h-10 aspect-square sm:w-64 text-left text-gray-600 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 myst-search-bar-disabled hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="myst-search-text-placeholder hidden sm:block grow">Search</span><div aria-hidden="true" class="myst-search-shortcut items-center hidden mx-1 font-mono text-sm text-gray-600 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="myst-theme-button theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-10 h-10 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-moon-icon h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-sun-icon h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="myst-primary-sidebar fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="myst-primary-sidebar-pointer pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="myst-primary-sidebar-nav flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="myst-primary-sidebar-topnav overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="myst-primary-sidebar-toc flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="myst-toc w-full px-1 dark:text-white"><a title="IRSA Tutorials" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/irsa-tutorials/">IRSA Tutorials</a><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="SPHEREx" class="block break-words rounded py-2 grow cursor-pointer">SPHEREx</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmpsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmpsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Euclid" class="block break-words rounded py-2 grow cursor-pointer">Euclid</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rupsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rupsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="WISE" class="block break-words rounded py-2 grow cursor-pointer">WISE</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R16psp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R16psp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Spitzer" class="block break-words rounded py-2 grow cursor-pointer">Spitzer</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1epsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1epsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="2MASS" class="block break-words rounded py-2 grow cursor-pointer">2MASS</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1mpsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1mpsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="COSMOS" class="block break-words rounded py-2 grow cursor-pointer">COSMOS</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1upsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1upsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Simulated Data" class="block break-words rounded py-2 grow cursor-pointer">Simulated Data</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R26psp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R26psp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Special Topics" class="block break-words rounded py-2 grow cursor-pointer">Special Topics</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R2epsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R2epsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="myst-primary-sidebar-footer flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="myst-made-with-myst flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="myst-fm-block mb-8 pt-9"><div class="myst-fm-block-header flex items-center mb-5 h-6 text-sm font-light"><div class="myst-fm-block-subject flex-none pr-2 smallcaps">IRSA Tutorials</div><div class="flex-grow"></div><div class="myst-fm-block-badges"><a href="https://github.com/Caltech-IPAC/irsa-tutorials/" title="GitHub Repository: Caltech-IPAC/irsa-tutorials/" target="_blank" rel="noopener noreferrer" class="myst-fm-github-link text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="myst-fm-github-icon inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a></div><a href="https://github.com/Caltech-IPAC/irsa-tutorials//edit/main/tutorials/firefly/SEDs_in_Firefly.md" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="myst-fm-edit-link text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-edit-icon inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="myst-fm-downloads-dropdown relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="myst-fm-downloads-button relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8ucp:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-downloads-icon"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div><button class="myst-fm-launch-button inline-flex size-[24px] hover:text-[#E18435] items-center justify-center" aria-label="Launch in external computing interface" title="Launch in external computing interface" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Re8ucp:" data-state="closed"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg" class="myst-fm-launch-icon"><path d="M6.85357 3.85355L7.65355 3.05353C8.2981 2.40901 9.42858 1.96172 10.552 1.80125C11.1056 1.72217 11.6291 1.71725 12.0564 1.78124C12.4987 1.84748 12.7698 1.97696 12.8965 2.10357C13.0231 2.23018 13.1526 2.50125 13.2188 2.94357C13.2828 3.37086 13.2779 3.89439 13.1988 4.44801C13.0383 5.57139 12.591 6.70188 11.9464 7.34645L7.49999 11.7929L6.35354 10.6465C6.15827 10.4512 5.84169 10.4512 5.64643 10.6465C5.45117 10.8417 5.45117 11.1583 5.64643 11.3536L7.14644 12.8536C7.34171 13.0488 7.65829 13.0488 7.85355 12.8536L8.40073 12.3064L9.57124 14.2572C9.65046 14.3893 9.78608 14.4774 9.9389 14.4963C10.0917 14.5151 10.2447 14.4624 10.3535 14.3536L12.3535 12.3536C12.4648 12.2423 12.5172 12.0851 12.495 11.9293L12.0303 8.67679L12.6536 8.05355C13.509 7.19808 14.0117 5.82855 14.1887 4.58943C14.2784 3.9618 14.2891 3.33847 14.2078 2.79546C14.1287 2.26748 13.9519 1.74482 13.6035 1.39645C13.2552 1.04809 12.7325 0.871332 12.2045 0.792264C11.6615 0.710945 11.0382 0.721644 10.4105 0.8113C9.17143 0.988306 7.80189 1.491 6.94644 2.34642L6.32322 2.96968L3.07071 2.50504C2.91492 2.48278 2.75773 2.53517 2.64645 2.64646L0.646451 4.64645C0.537579 4.75533 0.484938 4.90829 0.50375 5.0611C0.522563 5.21391 0.61073 5.34954 0.742757 5.42876L2.69364 6.59928L2.14646 7.14645C2.0527 7.24022 2.00002 7.3674 2.00002 7.50001C2.00002 7.63261 2.0527 7.75979 2.14646 7.85356L3.64647 9.35356C3.84173 9.54883 4.15831 9.54883 4.35357 9.35356C4.54884 9.1583 4.54884 8.84172 4.35357 8.64646L3.20712 7.50001L3.85357 6.85356L6.85357 3.85355ZM10.0993 13.1936L9.12959 11.5775L11.1464 9.56067L11.4697 11.8232L10.0993 13.1936ZM3.42251 5.87041L5.43935 3.85356L3.17678 3.53034L1.80638 4.90074L3.42251 5.87041ZM2.35356 10.3535C2.54882 10.1583 2.54882 9.8417 2.35356 9.64644C2.1583 9.45118 1.84171 9.45118 1.64645 9.64644L0.646451 10.6464C0.451188 10.8417 0.451188 11.1583 0.646451 11.3535C0.841713 11.5488 1.1583 11.5488 1.35356 11.3535L2.35356 10.3535ZM3.85358 11.8536C4.04884 11.6583 4.04885 11.3417 3.85359 11.1465C3.65833 10.9512 3.34175 10.9512 3.14648 11.1465L1.14645 13.1464C0.95119 13.3417 0.951187 13.6583 1.14645 13.8535C1.34171 14.0488 1.65829 14.0488 1.85355 13.8536L3.85358 11.8536ZM5.35356 13.3535C5.54882 13.1583 5.54882 12.8417 5.35356 12.6464C5.1583 12.4512 4.84171 12.4512 4.64645 12.6464L3.64645 13.6464C3.45119 13.8417 3.45119 14.1583 3.64645 14.3535C3.84171 14.5488 4.1583 14.5488 4.35356 14.3535L5.35356 13.3535ZM9.49997 6.74881C10.1897 6.74881 10.7488 6.1897 10.7488 5.5C10.7488 4.8103 10.1897 4.25118 9.49997 4.25118C8.81026 4.25118 8.25115 4.8103 8.25115 5.5C8.25115 6.1897 8.81026 6.74881 9.49997 6.74881Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button></div><h1 class="myst-fm-block-title mb-0">Using Firefly visualization tools in Python to vet SEDs</h1><header class="myst-fm-authors-affiliations mt-4 not-prose"><div class="myst-fm-authors-list"><span class="myst-fm-author font-semibold text-sm myst-fm-author-item inline-block"><button class="myst-fm-author-popover focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78ucp:" data-state="closed"><span class="myst-fm-author-name">IRSA Scientists and Developers</span></button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div class="myst-jp-nb-toolbar sticky top-[60px] pb-[14px] flex justify-end w-full z-20 pointer-events-none"><div class="myst-jp-nb-toolbar-inner flex p-1 m-1 space-x-1 border rounded-full shadow pointer-events-auto border-stone-300 bg-white/80 dark:bg-stone-900/80 backdrop-blur"><div class="myst-jp-nb-toolbar-power rounded"><button class="myst-jp-nb-toolbar-power-btn flex text-center rounded-full cursor-pointer text-stone-800 dark:text-white hover:opacity-100 opacity-60" aria-label="start compute environment"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="inline-block w-6 h-6 align-top"><title>Launch kernel</title><path stroke-linecap="round" stroke-linejoin="round" d="M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"></path></svg></button></div></div></div><div id="skip-to-article"></div><h2 id="learning-goals" class="relative group"><span class="heading-text">Learning Goals</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#learning-goals" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>By the end of this tutorial, the following goals can be accomplished:</p><ul><li><p>Select a position and categories of data for search of possible nearby sources</p></li><li><p>Pull photometry for different bands via TAP queries on chosen IRSA catalogs</p></li><li><p>Add data columns from result to table, including energy density values (converted from magnitudes)</p></li><li><p>Create a simple SED plot using compiled photometric data</p></li><li><p>Display matching image cutouts from IRSA data sets for selected position</p></li></ul><h2 id="introduction" class="relative group"><span class="heading-text">Introduction</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#introduction" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The purpose of this notebook is to show how to make and vet Spectral Energy Distributions (SEDs) using Firefly. All examples use the python package <code>pyvo</code> to search for catalogs and images from IRSA.</p><p>Detailed specifications for this notebook come from a paper led by Luisa Rebull on the selection of possible Young Stellar Objects (YSOs) in IC 417 (<cite class="" data-state="closed"><a href="https://doi.org/10.3847/1538-3881/ace32f" target="_blank" rel="noreferrer" class="hover-link">Rebull <em>et al.</em> (2023)</a></cite>).</p><p>In this case, the SEDs generated by photometry data (from several different survey catalogs) near a given position can be compared with corresponding images to verify the location of a point source that could also be considered as a YSO if the graph shape is sound.</p><h2 id="imports" class="relative group"><span class="heading-text">Imports</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#imports" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Prior to starting Jupyterlab, you should specify the Firefly server by setting the <code>FIREFLY_URL</code> environment variable (use the value <a target="_blank" rel="noreferrer" href="https://irsa.ipac.caltech.edu/irsaviewer" class="">https://<wbr/>irsa<wbr/>.ipac<wbr/>.caltech<wbr/>.edu<wbr/>/irsaviewer</a> if you’re not sure), or by one of the other ways listed on the <a target="_blank" rel="noreferrer" href="https://github.com/Caltech-IPAC/jupyter_firefly_extensions" class="">jupyter_firefly_extension page</a>.</p><p>The packages needed for this notebook are in the <code>requirements.txt</code> file. They can be installed with <code>pip install -r requirements.txt</code> before you start your Jupyterlab session.</p><ul><li><p><em>astropy.units</em> - for specifying and manipulating units</p></li><li><p><em>astropy.constants</em> - for constants</p></li><li><p><em>astropy.coordinates.Skycoord</em> - for representing coordinates</p></li><li><p><em>astropy.table.QTable</em> - for tables with units</p></li><li><p><em>firefly_client.FireflyClient</em> - Python API to Firefly for displaying tables, images and charts</p></li><li><p><em>numpy</em> - for working with arrays</p></li><li><p><em>pyvo</em> - for queries to Virtual Observatory services at the archives</p></li></ul><div id="sySGLRxWgu" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Uncomment the next line to install dependencies if needed.
# !pip install numpy astropy pyvo firefly_client</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="3AObF6nK8rIa5Fpe_9srQ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Call the imports below:</p><div id="kwlDeVOkdU" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import astropy.units as u
from astropy import constants as const
from astropy.coordinates import SkyCoord
from astropy.table import QTable
from astropy.utils.data import download_file
from firefly_client import FireflyClient
import numpy as np
import pyvo</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="9BoOEQykRzQu_TBf86BTK" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="choose-target-as-example" class="relative group"><span class="heading-text">Choose Target as Example</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#choose-target-as-example" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>From <cite class="" data-state="closed"><a href="https://doi.org/10.3847/1538-3881/ace32f" target="_blank" rel="noreferrer" class="hover-link">Figure 10</a></cite> of the referenced paper, pick the source in the upper right corner (J052736.37+344940.6):</p><div id="mn4MUKuxH4" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">target = SkyCoord(ra=&quot;05h27m36.37s&quot;, dec=&quot;+34d49m40.6s&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="We71PbT2JX2Pu1teLsuej" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="get-photometry-from-irsa" class="relative group"><span class="heading-text">Get Photometry from IRSA</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#get-photometry-from-irsa" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The available data at IRSA include the following catalogs (with matching radius at 1 arcsec except where noted by reference paper):</p><ul><li><p>Gaia DR3</p></li><li><p>2MASS</p></li><li><p>Spitzer-IRAC (GLIMPSE? SEIP Source List?)</p></li><li><p>Spitzer-MIPS-24 (GLIMPSE? SEIP Source List?)</p></li><li><p>AllWISE</p></li><li><p>CatWISE</p></li><li><p>unWISE</p></li><li><p>MSX</p></li><li><p>Akari</p></li><li><p>Herschel-PACS (70um and 160um)</p></li></ul><p>The <a target="_blank" rel="noreferrer" href="https://vmcoolwiki.ipac.caltech.edu/index.php/Central_wavelengths_and_zero_points" class="">NITARP Wiki page</a> on central wavelengths may be helpful for finding zero-point information for specific catalogs, as well as the more general <a target="_blank" rel="noreferrer" href="https://astroquery.readthedocs.io/en/latest/svo_fps/svo_fps.html" class="">astroquery service</a> on SVO filter data.</p><p>Whlie this notebook will focus on a subset of the above list (2MASS, Gaia DR3, and WISE data), note that there is a section where additional data can be included as well.</p><p>The variable <code>phot_tbl</code> is the table containing the photometry for the target and all the derived quantities needed to make SED plots:</p><ul><li><p>Right ascension (in degrees)</p></li><li><p>Declination (in degrees)</p></li><li><p>Wavelength for the bandpass (in microns)</p></li><li><p>Photometry measurement</p></li><li><p>Photometry uncertainty</p></li><li><p>Is the measurement an upper limit? (Note: 1 means yes, 0 means no)</p></li><li><p>Zeropoint for the bandpass in units of Janskys (needed for converting photometric measurements to energy densities)</p></li></ul><p>Set the variables for the photmetry table and each quantity in that data structure:</p><div id="sPseGTWghi" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">phot_tbl = QTable(names=[&#x27;ra&#x27;, &#x27;dec&#x27;, &#x27;wavelength&#x27;, &#x27;mag&#x27;, &#x27;magerr&#x27;, &#x27;upper_limit&#x27;, &#x27;zeropoint&#x27;],
                  units=[u.deg, u.deg, u.micron, None, None, None, u.Jy])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="P2sapJrTFVC7BdD9Wf1Io" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>We query catalog data using IRSA’s TAP (VO Table Access Protocol) service. It’s sufficient to set up the service once, at the beginning of the session:</p><div id="b0HHN0EQve" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">irsa_tap = pyvo.dal.TAPService(&quot;https://irsa.ipac.caltech.edu/TAP&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="FKish1zuXcXU3b8vqfz7e" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h3 id="retrieve-2mass-photometry" class="relative group"><span class="heading-text">Retrieve 2MASS photometry</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#retrieve-2mass-photometry" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>To start, define a function to retrieve 2MASS photometry via a TAP query to IRSA that includes upper limits (note that only the <code>ph_qual</code> column on photometric quality of source is used and not the <code>rd_flg</code> column on “read flag”):</p><div id="JmC6my1596" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def get_2mass_phot(target, radius=1*u.arcsec):
    &quot;&quot;&quot;Get photometry from 2MASS

    Parameters:
    -----------
    target: astropy.coordinates.SkyCoord
          coordinates of the target(s)

    radius: astropy.units.Quantity
          matching radius, default 1*u.arcsec

    Returns:
    --------
    rows: list
         lists of photometry points to add to table
    &quot;&quot;&quot;

    query = f&quot;&quot;&quot;
    SELECT ra,dec,j_m,j_msigcom,h_m,h_msigcom,k_m,k_msigcom,ph_qual,rd_flg
    FROM fp_psc
    WHERE CONTAINS(POINT(&#x27;ICRS&#x27;, ra, dec),
    CIRCLE(&#x27;ICRS&#x27;, {target.ra.deg}, {target.dec.deg},
    {radius.to(&#x27;deg&#x27;).value}))=1
    &quot;&quot;&quot;

    results = irsa_tap.search(query)

    rowj = [results[&quot;ra&quot;]*u.deg,
            results[&quot;dec&quot;]*u.deg,
            1.235*u.micron,
            results[&quot;j_m&quot;][0],
            results[&quot;j_msigcom&quot;][0],
            1 if results[&quot;ph_qual&quot;] == &quot;U&quot; else 0,
            1594*u.Jy]

    rowh = [results[&quot;ra&quot;]*u.deg,
            results[&quot;dec&quot;]*u.deg,
            1.662*u.micron,
            results[&quot;h_m&quot;][0],
            results[&quot;h_msigcom&quot;][0],
            1 if results[&quot;ph_qual&quot;] == &quot;U&quot; else 0,
            1024*u.Jy]

    rowks = [results[&quot;ra&quot;]*u.deg,
            results[&quot;dec&quot;]*u.deg,
            2.159*u.micron,
            results[&quot;k_m&quot;][0],
            results[&quot;k_msigcom&quot;][0],
            1 if results[&quot;ph_qual&quot;] == &quot;U&quot; else 0,
            666.7*u.Jy]

    return([rowj, rowh, rowks])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="ZON-zDI4tssyGQ6EBCIfr" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Consider that while the search radius is currently set at 1 degree from the position, that value can be adjusted by changing what the number on the <code>radius</code> line is.</p><p>Now gather the rows of 2MASS data and add each of them to the photometry table:</p><div id="eB96LAM06i" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">rows = get_2mass_phot(target)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Ts0fonUfm5wstZ-ZwWysX" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ek2sk18CTd" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">for row in rows:
    phot_tbl.add_row(row)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="1HFpY0gAvW_Mr3xixJ_h2" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h3 id="retrieve-allwise-photometry" class="relative group"><span class="heading-text">Retrieve AllWISE Photometry</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#retrieve-allwise-photometry" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>According to the paper referenced above, the detections from the AllWISE catalog were retained if the data quality flags were A, B, or C; if the data quality flag was Z, then the data were provisionally retained with a very large error bar, 30% larger than what appears in the catalog.</p><p>Based on that information, define a function to release AllWISE photometry via a TAP query to IRSA that includes the needed data quality flags and retains upper limits:</p><div id="HnQj5p7RyM" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def get_allwise_phot(target, radius=1*u.arcsec):
    &quot;&quot;&quot;Get photometry from AllWISE

    Parameters:
    -----------
    target: astropy.coordinates.SkyCoord
          coordinates of the target(s)

    radius: astropy.units.Quantity
          matching radius, defaults to 1*u.arcsec

    Returns:
    --------
    rows: list
         lists of photometry points to add to table
    &quot;&quot;&quot;

    query = f&quot;&quot;&quot;
    SELECT ra,dec,w1mpro,w1sigmpro,w2mpro,w2sigmpro,w3mpro,
          w3sigmpro,w4mpro,w4sigmpro,ph_qual
    FROM allwise_p3as_psd
    WHERE CONTAINS(POINT(&#x27;ICRS&#x27;, ra, dec),
    CIRCLE(&#x27;ICRS&#x27;, {target.ra.deg}, {target.dec.deg},
    {radius.to(&#x27;deg&#x27;).value}))=1
    &quot;&quot;&quot;

    results = irsa_tap.search(query)

    roww1 = [results[&quot;ra&quot;]*u.deg,
             results[&quot;dec&quot;]*u.deg,
             3.4*u.micron,
             results[&quot;w1mpro&quot;][0],
             results[&quot;w1sigmpro&quot;][0],
             1 if results[&quot;ph_qual&quot;] == &quot;U&quot; else 0,
             309.54*u.Jy]

    roww2 = [results[&quot;ra&quot;]*u.deg,
             results[&quot;dec&quot;]*u.deg,
             4.6*u.micron,
             results[&quot;w2mpro&quot;][0],
             results[&quot;w2sigmpro&quot;][0],
             1 if results[&quot;ph_qual&quot;] == &quot;U&quot; else 0,
             171.79*u.Jy]

    roww3 = [results[&quot;ra&quot;]*u.deg,
             results[&quot;dec&quot;]*u.deg,
             12*u.micron,
             results[&quot;w3mpro&quot;][0],
             results[&quot;w3sigmpro&quot;][0],
             1 if results[&quot;ph_qual&quot;] == &quot;U&quot; else 0,
             31.676*u.Jy]

    roww4 = [results[&quot;ra&quot;]*u.deg,
             results[&quot;dec&quot;]*u.deg,
             22*u.micron,
             results[&quot;w4mpro&quot;][0],
             results[&quot;w4sigmpro&quot;][0],
             1 if results[&quot;ph_qual&quot;] == &quot;U&quot; else 0,
             8.3635*u.Jy]

    return([roww1, roww2, roww3, roww4])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="UN3YwdmI2njeCH4IWcGTm" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="VBGHxDanhb" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">rows = get_allwise_phot(target)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="IAm7GhGy_CIHKTZ3niUKk" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="r9gxnun64P" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">for row in rows:
    phot_tbl.add_row(row)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="MkaCUJX9ck3HOgsWBPTuy" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h3 id="retrieve-gaia-dr3-photometry" class="relative group"><span class="heading-text">Retrieve Gaia DR3 Photometry</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#retrieve-gaia-dr3-photometry" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Define a function to retrieve Gaia DR3 photometry via a TAP query to IRSA (not considering upper limits as Gaia DR3 ony provides “detections or not” info so actual limits are not given):</p><div id="Fa8oFAYUcA" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def get_gaia_phot(target, radius=1*u.arcsec):
    &quot;&quot;&quot;Get photometry from Gaia DR3

    Parameters:
    -----------
    target: astropy.coordinates.SkyCoord
          coordinates of the target(s)

    radius: astropy.units.Quantity
          matching radius, default is 1*u.arcsec

    Returns:
    --------
    rows: list
         lists of photometry points to add to table
    &quot;&quot;&quot;

    query = f&quot;&quot;&quot;
    SELECT designation,ra,ra_error,dec,dec_error,ra_dec_corr,phot_g_mean_flux_over_error,phot_g_mean_mag,
       phot_bp_mean_flux_over_error,phot_bp_mean_mag,phot_rp_mean_flux_over_error,phot_rp_mean_mag
    FROM gaia_dr3_source
    WHERE CONTAINS(POINT(&#x27;ICRS&#x27;, ra, dec),
    CIRCLE(&#x27;ICRS&#x27;, {target.ra.deg}, {target.dec.deg},
    {radius.to(&#x27;deg&#x27;).value}))=1
    &quot;&quot;&quot;

    results = irsa_tap.search(query)

    rowg = [results[&quot;ra&quot;]*u.deg,
            results[&quot;dec&quot;]*u.deg,
            0.622*u.micron,
            results[&quot;phot_g_mean_mag&quot;][0],
            2.5/(np.log(10)*results[&quot;phot_g_mean_flux_over_error&quot;][0]),
            0,
            3228.75*u.Jy]

    rowbp = [results[&quot;ra&quot;]*u.deg,
            results[&quot;dec&quot;]*u.deg,
            0.511*u.micron,
            results[&quot;phot_bp_mean_mag&quot;][0],
            2.5/(np.log(10)*results[&quot;phot_bp_mean_flux_over_error&quot;][0]),
            0,
            3552.01*u.Jy]

    rowrp = [results[&quot;ra&quot;]*u.deg,
            results[&quot;dec&quot;]*u.deg,
            0.7769*u.micron,
            results[&quot;phot_rp_mean_mag&quot;][0],
            2.5/(np.log(10)*results[&quot;phot_rp_mean_flux_over_error&quot;][0]),
            0,
            2554.95*u.Jy]

    return([rowg, rowbp, rowrp])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="UXf-IGleKKXA6ilTSRH0Y" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="tNXg6y0uCn" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">rows = get_gaia_phot(target)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="ShdOBRzqTgcyd2ncVeeEz" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="mS0ZNQ8xUt" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">for row in rows:
    phot_tbl.add_row(row)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="eNbQpx5NPZdg9DvBKVb71" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h3 id="retrieve-catwise-photometry" class="relative group"><span class="heading-text">Retrieve CatWISE Photometry</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#retrieve-catwise-photometry" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Define a function to retrieve CatWISE photometry via a TAP query to IRSA that includes upper limits (note that CatWISE2020 Catalog is being used rather than CatWISE Preliminary Catalog):</p><div id="MTsN7kCFd2" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def get_catwise_phot(target, radius=1*u.arcsec):
    &quot;&quot;&quot;Get photometry from CatWISE

    Parameters:
    -----------
    target: astropy.coordinates.SkyCoord
          coordinates of the target(s)

    radius: astropy.units.Quantity
          matching radius, defaults to 1*u.arcsec

    Returns:
    --------
    rows: list
         lists of photometry points to add to table
    &quot;&quot;&quot;

    query = f&quot;&quot;&quot;
    SELECT ra,dec,w1mpro,w1sigmpro,w2mpro,w2sigmpro
    FROM catwise_2020
    WHERE CONTAINS(POINT(&#x27;ICRS&#x27;, ra, dec),
    CIRCLE(&#x27;ICRS&#x27;, {target.ra.deg}, {target.dec.deg},
    {radius.to(&#x27;deg&#x27;).value}))=1
    &quot;&quot;&quot;

    results = irsa_tap.search(query)

    roww1 = [results[&quot;ra&quot;]*u.deg,
             results[&quot;dec&quot;]*u.deg,
             3.4*u.micron,
             results[&quot;w1mpro&quot;][0],
             results[&quot;w1sigmpro&quot;][0],
             1 if results[&quot;w1sigmpro&quot;] is None else 0,
             309.54*u.Jy]

    roww2 = [results[&quot;ra&quot;]*u.deg,
             results[&quot;dec&quot;]*u.deg,
             4.6*u.micron,
             results[&quot;w2mpro&quot;][0],
             results[&quot;w2sigmpro&quot;][0],
             1 if results[&quot;w2sigmpro&quot;] is None else 0,
             171.79*u.Jy]

    return([roww1, roww2])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="9F3DhKXA-PgOJFagToJPa" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Fz1YxYc5Ey" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">rows = get_catwise_phot(target)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="HTWdOvELJKYD1U_tL-m9_" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="q4fP2xKeuQ" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">for row in rows:
    phot_tbl.add_row(row)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="-BxAwwDQqDhpJIw18PJam" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h3 id="retrieve-unwise-photometry" class="relative group"><span class="heading-text">Retrieve unWISE Photometry</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#retrieve-unwise-photometry" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Define a function to retrieve unWISE photometry via a TAP query to IRSA(note that flux units are given in nano-mag, zero-point is carried over from AllWISE, and no flag for upper limits is given):</p><div id="P760eDLvDy" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def get_unwise_phot(target, radius=1*u.arcsec):
    &quot;&quot;&quot;Get photometry from CatWISE

    Parameters:
    -----------
    target: astropy.coordinates.SkyCoord
          coordinates of the target(s)

    radius: astropy.units.Quantity
          matching radius, defaults to 1*u.arcsec

    Returns:
    --------
    rows: list
         lists of photometry points to add to table
    &quot;&quot;&quot;

    query = f&quot;&quot;&quot;
    SELECT ra,dec,flux_1,dflux_1,flux_2,dflux_2,fluxlbs_1
    FROM unwise_2019
    WHERE CONTAINS(POINT(&#x27;ICRS&#x27;, ra, dec),
    CIRCLE(&#x27;ICRS&#x27;, {target.ra.deg}, {target.dec.deg},
    {radius.to(&#x27;deg&#x27;).value}))=1
    &quot;&quot;&quot;

    results = irsa_tap.search(query)

    roww1 = [results[&quot;ra&quot;]*u.deg,
             results[&quot;dec&quot;]*u.deg,
             3.4*u.micron,
             pow(10,9)*results[&quot;flux_1&quot;][0],
             pow(10,9)*results[&quot;dflux_1&quot;][0],
             0,
             309.54*u.Jy]

    roww2 = [results[&quot;ra&quot;]*u.deg,
             results[&quot;dec&quot;]*u.deg,
             4.6*u.micron,
             pow(10,9)*results[&quot;flux_2&quot;][0],
             pow(10,9)*results[&quot;dflux_2&quot;][0],
             0,
             171.79*u.Jy]

    return([roww1, roww2])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="j-bLrs3wZHskcEMhxCp1-" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="UkSIZrQzMu" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">rows = get_unwise_phot(target)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="aT7Vcphh7JnYn27wkuHhq" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="lLyru40zc5" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">for row in rows:
    phot_tbl.add_row(row)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="59XvJxpXHloC1TRuApq0m" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h3 id="retrieve-optional-photometry" class="relative group"><span class="heading-text">Retrieve Optional Photometry</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#retrieve-optional-photometry" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Insert more data retrievals here, following the above formats.</p><p>Note: After more columns are added in the conversion to spectral energy density, the <code>phot_tbl.add_row</code> functions will thrown an exception that number of values doesn’t match the number of columns.</p><div id="Xpx0RJQHKK" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># SEIP
# GLIMPSE

# MSX, AKARI, Herschel PACS

# Pan-STARRS, UKIDSS?</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="hR03y1OaJdk-ky2-VQGzr" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="convert-magnitudes-to-energy-densities" class="relative group"><span class="heading-text">Convert Magnitudes to Energy Densities</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#convert-magnitudes-to-energy-densities" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Use the zeropoint information embedded by the catalog retrieval functions to compute energy densities:</p><div id="IjIdgUtazV" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">factor = (const.c*phot_tbl[&quot;wavelength&quot;]**-1).to(u.Hz)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="66hqSFPgh981_JQPPbABF" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="V4eeOXGRFZ" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">phot_tbl[&quot;lam_flam&quot;] = ((factor*phot_tbl[&quot;zeropoint&quot;] *
                            10**(-0.4*phot_tbl[&quot;mag&quot;]))
                       ).to(u.erg*u.s**-1*u.cm**-2)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="4GV5VYC5fbfvJLxRzTVKu" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>As the above formula was for the photometry measurements given, compute the photometry uncertainty using a similar formula:</p><div id="HXXCJodGmc" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">phot_tbl[&quot;lam_flam_err&quot;] = phot_tbl[&quot;lam_flam&quot;]*phot_tbl[&quot;magerr&quot;]*np.log(10)/2.5</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="RAtPEgMUWdXH61CMrW67I" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Check the energy density values for each converted value below:</p><div id="GNRtHMx6XF" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">phot_tbl[&quot;lam_flam&quot;]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="PqNyJDs94pdQuGlytfQ2N" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="kEvScT9fac" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">phot_tbl[&quot;lam_flam_err&quot;]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="XI_7gTtywyUJbDyf1aF1G" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Run the following cell to view the full photometry table and its values for each column (ex. zeropoint, upper limit):</p><div id="peQxsh95MI" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">phot_tbl</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="M66LDb-wDZBKQElrIgPSM" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><h2 id="upload-to-firefly" class="relative group"><span class="heading-text">Upload to Firefly</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#upload-to-firefly" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>There are two ways to initialize a Firefly client from Python, depending on whether you’re running the notebook in JupyterLab or not. Assuming you have <code>jupyter-firefly-extensions</code> set up in your environment as explained <a href="https://github.com/Caltech-IPAC/jupyter_firefly_extensions/blob/master/README.md" class="italic" target="_blank" rel="noreferrer" data-state="closed">here</a>, you can use <code>make_lab_client()</code> in JupyterLab, which will open the Firefly viewer in a new tab within the Lab. Otherwise, you can use <code>make_client()</code> in a Jupyter Notebook (or even a Python shell), which will open the Firefly viewer in a new web browser tab.</p><p>You also need a Firefly server to communicate with your Firefly Python client. In this notebook, we use a public Firefly server: the IRSA Viewer (<a target="_blank" rel="noreferrer" href="https://irsa.ipac.caltech.edu/irsaviewer" class="">https://<wbr/>irsa<wbr/>.ipac<wbr/>.caltech<wbr/>.edu<wbr/>/irsaviewer</a>). However, you can also run a local Firefly server via a <a target="_blank" rel="noreferrer" href="https://hub.docker.com/r/ipac/firefly" class="">Firefly Docker image</a> and access it at <code>http://localhost:8080/firefly</code>. The URL of the Firefly server is read by both <code>make_client()</code> and <code>make_lab_client()</code> through the environment variable <code>FIREFLY_URL</code>. However, <code>make_client()</code> also allows you to pass the URL directly as the <code>url</code> parameter.</p><div id="nw1u1pb2Ji" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Uncomment when using within Jupyter Lab with jupyter_firefly_extensions installed
# fc = FireflyClient.make_lab_client()

# Uncomment for contexts other than above 
fc = FireflyClient.make_client(url=&quot;https://irsa.ipac.caltech.edu/irsaviewer&quot;)

fc.reinit_viewer() # to clean the state, if this cell ran earlier</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="DXGLSR2ZwXBq7tgoG1xDN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div><div data-name="safe-output-text" class="font-mono text-sm whitespace-pre-wrap myst-jp-safe-output-text"><code><span>{&#x27;success&#x27;: True}</span></code></div></div></div><p>In the event that there are problems with the tab opened above, run the below command to obtain a web link that can be opened in a browser directly:</p><div id="ubGGneKinL" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fc.display_url()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="YvgEICEJgwkWGbX0d-9YZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Write the photometry table to a FITS file:</p><div id="SWgo4ktJ4c" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">tblpath = &quot;./phot_tbl.fits&quot;
phot_tbl.write(tblpath, format=&quot;fits&quot;, overwrite=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="4dyr_aXbuFl_oiPSyy0BM" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Upload the table (FITS file) to Firefly:</p><div id="nJQsXdFKWD" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">tval = fc.upload_file(tblpath)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="JYhgpTz3aIP1WBgICnA39" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Show the table in Firefly:</p><div id="SMmh2FRpww" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fc.show_table(tval, tbl_id=&quot;photometry&quot;, title=&quot;SED Photometry&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="1p6Pc1z5gtfUJYJmS57AM" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-text" class="font-mono text-sm whitespace-pre-wrap myst-jp-safe-output-text"><code><span>{&#x27;success&#x27;: True}</span></code></div></div></div><p>Specify the columns and markers for the SED plot:</p><div id="QmyQyQ09wB" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">trace1 = dict(tbl_id=&quot;photometry&quot;, x=&quot;tables::wavelength&quot;, y=&quot;tables::lam_flam&quot;, mode=&quot;markers&quot;,
            type=&quot;scatter&quot;, error_y=dict(array=&quot;tables::lam_flam_err&quot;),
            marker=dict(size=4))
trace_data = [trace1]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="uW3EOr8B75cd0wMqxPL08" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Specify the title and axes for the SED plot:</p><div id="tbOdymwOSx" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">layout_s = dict(title=&quot;SED&quot;, xaxis=dict(title=&quot;Wavelength (microns)&quot;, type=&quot;log&quot;),
                yaxis=dict(title=&quot;Energy density (erg/s/cm2)&quot;, type=&quot;log&quot;))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="hv-8QcLz-d_TZwIZJM0om" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Display the SED plot in Firefly:</p><div id="KAgOA71xiP" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fc.show_chart(layout=layout_s, data=trace_data)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="NHZ68iG7nt46vxKbbDhBh" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-text" class="font-mono text-sm whitespace-pre-wrap myst-jp-safe-output-text"><code><span>{&#x27;success&#x27;: True,
 &#x27;warning&#x27;: &#x27;group_id unnecessary and ignored in triview mode&#x27;}</span></code></div></div></div><h2 id="retrieve-and-display-images" class="relative group"><span class="heading-text">Retrieve and Display Images</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#retrieve-and-display-images" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Use queries directed at Simple Image Access services to retrieve images:</p><div id="BBuXETC0Iz" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">irsa_sia = pyvo.dal.SIAService(&quot;https://irsa.ipac.caltech.edu/cgi-bin/2MASS/IM/nph-im_sia?type=at&amp;ds=asky&amp;&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="I3R08uhtLwtapBCbZmhv1" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h3 id="get-2mass-images" class="relative group"><span class="heading-text">Get 2MASS Images</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#get-2mass-images" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><div id="vskoBqIGNf" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def get_2mass_images(target, search_size=1*u.arcsec):
    &quot;&quot;&quot;Retrieve 2MASS images

    Parameters:
    -----------
    target: astropy.coordinates.SkyCoord
        coordinates of the target(s)

    search_size: astropy.units.Quantity
        matching radius, defaults to 1*u.arcsec

    Returns:
    --------
    j_filename: `str`
         path to J-band image in FITS format

    h_filename: `str`
         path to H-band image in FITS format

    k_filename: `str`
         path to K-band image in FITS format
    &quot;&quot;&quot;
    im_table = irsa_sia.search(pos=target, size=search_size)
    url_j = url_h = url_k = None
    # Get URL for the first instance of each band
    for i in range(len(im_table)):
        if url_j is None and im_table[i][&quot;band&quot;] == &quot;J&quot;:
            url_j = im_table[i].getdataurl()
        if url_h is None and im_table[i][&quot;band&quot;] == &quot;H&quot;:
            url_h = im_table[i].getdataurl()
        if url_k is None and im_table[i][&quot;band&quot;] == &quot;K&quot;:
            url_k = im_table[i].getdataurl()
    j_filename = download_file(url_j, cache=True)
    h_filename = download_file(url_h, cache=True)
    k_filename = download_file(url_k, cache=True)
    return (j_filename, h_filename, k_filename)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="rQ2poLO0k9h6rWv2uXj_J" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="XpuIWq4jlB" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">j_fname, h_fname, k_fname = get_2mass_images(target)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="yVeTUsLF8scA7kvXt5TzT" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="azzRDbIDVs" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fc.show_fits(fc.upload_file(j_fname), plot_id=&quot;2MASS J&quot;, title=&quot;2MASS J&quot;)
fc.show_fits(fc.upload_file(h_fname), plot_id=&quot;2MASS H&quot;, title=&quot;2MASS H&quot;)
fc.show_fits(fc.upload_file(k_fname), plot_id=&quot;2MASS K&quot;, title=&quot;2MASS K&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="-P7ySponNZv2eFpfTDsMZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>WARNING: show_fits() is deprecated. Use show_fits_image() instead.
WARNING: show_fits() is deprecated. Use show_fits_image() instead.
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>WARNING: show_fits() is deprecated. Use show_fits_image() instead.
</span></code></pre></div></div><div data-name="safe-output-text" class="font-mono text-sm whitespace-pre-wrap myst-jp-safe-output-text"><code><span>{&#x27;success&#x27;: True}</span></code></div></div></div><div id="RV8junnGOz" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fc.set_zoom(plot_id=&quot;2MASS J&quot;, factor=4.0)
fc.set_pan(plot_id=&quot;2MASS J&quot;, x=target.ra.deg,
           y=target.dec.deg, coord=&quot;j2000&quot;)
fc.set_zoom(plot_id=&quot;2MASS H&quot;, factor=4.0)
fc.set_pan(plot_id=&quot;2MASS H&quot;, x=target.ra.deg,
           y=target.dec.deg, coord=&quot;j2000&quot;)
fc.set_zoom(plot_id=&quot;2MASS K&quot;, factor=4.0)
fc.set_pan(plot_id=&quot;2MASS K&quot;, x=target.ra.deg,
           y=target.dec.deg, coord=&quot;j2000&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="9D36zJ8zlvulxxfjzmm0K" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-text" class="font-mono text-sm whitespace-pre-wrap myst-jp-safe-output-text"><code><span>{&#x27;success&#x27;: True}</span></code></div></div></div><p>For turning on “Align and Lock by WCS” in these images, use:</p><div id="gXI4EBWQbe" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fc.align_images(lock_match=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="AW91vhxy6jXXbAZJSCG5Z" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-text" class="font-mono text-sm whitespace-pre-wrap myst-jp-safe-output-text"><code><span>{&#x27;success&#x27;: True}</span></code></div></div></div><p>Note that zooming or panning one image will do the same in the other images as well.</p><hr class="py-2 my-5 translate-y-2"/><h2 id="about-this-notebook" class="relative group"><span class="heading-text">About This Notebook</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#about-this-notebook" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p><strong>Author:</strong> David Shupe (IRSA Scientist) and Joyce Kim (IRSA Scientist) in conjunction with the IRSA Science Team</p><p><strong>Updated:</strong> 2024-12-19</p><p><strong>Contact:</strong> <a target="_blank" rel="noreferrer" href="https://irsa.ipac.caltech.edu/docs/help_desk.html" class="">the IRSA Helpdesk</a> with questions or reporting problems.</p><div class="myst-backmatter-parts"></div><section id="references" class="myst-bibliography article-grid subgrid-gap col-screen"><div><header class="myst-bibliography-header text-lg font-semibold text-stone-900 dark:text-white group">References<a class="no-underline text-inherit hover:text-inherit ml-2 select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#references" title="Link to References" aria-label="Link to References">¶</a></header></div><div class="myst-bibliography-list pl-3 mb-8 text-xs text-stone-500 dark:text-stone-300"><ol><li class="myst-bibliography-item break-words" id="cite-Rebull_2023">Rebull, L. M., Anderson, R. L., Hall, G., Kirkpatrick, J. D., Koenig, X., Odden, C. E., Rodriguez, B., Sanchez, R., Senson, B., Urbanowski, V., Austin, M., Blood, K., Kerman, E., Long, J., & Roosa, N. (2023). Young Stellar Object Candidates in IC 417. <i>The Astronomical Journal</i>, <i>166</i>(3), 87. <a target="_blank" rel="noreferrer" href="https://doi.org/10.3847/1538-3881/ace32f">10.3847/1538-3881/ace32f</a></li></ol></div></section><div class="myst-footer-links flex pt-10 mb-10 space-x-4"><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-prev" href="/irsa-tutorials/irsa-hats-with-lsdb"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">Special Topics</div>Access HATS Collections Using LSDB: Euclid Q1 and ZTF DR23</div></div></a><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-next" href="/irsa-tutorials/parallelize-convolution"><div class="flex h-full align-middle"><div class="flex-grow"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">Special Topics</div>Parallelizing image convolution</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></article></main><script>((a,l)=>{if(!window.history.state||!window.history.state.key){let u=Math.random().toString(32).slice(2);window.history.replaceState({key:u},"")}try{let d=JSON.parse(sessionStorage.getItem(a)||"{}")[l||window.history.state.key];typeof d=="number"&&window.scrollTo(0,d)}catch(u){console.error(u),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/irsa-tutorials/build/entry.client-PCJPW7TK.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-AQ2CODAG.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-JJXTQVMA.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-OZE3FFNP.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-OYMW4E3D.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-C4DFGG5C.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-J7TUH54J.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-FZ2S7OYD.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-JEM6JXYA.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-34XIY2DH.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-KQM5FBHR.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-7HNKBP4B.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-CUKUDK3R.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-3EBOCCHJ.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-O4VQNZ62.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-4OEDG4JQ.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/irsa-tutorials/build/root-CXYA7X5D.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-DATP5P2X.js"/><link rel="modulepreload" href="/irsa-tutorials/build/routes/$-JRBPULBO.js"/><script>window.__remixContext = {"url":"/seds-in-firefly","state":{"loaderData":{"root":{"config":{"version":3,"myst":"1.7.0","options":{"outline_maxdepth":1,"favicon":"/irsa-tutorials/build/irsa-favicon-ab5ecfaec3f77f83cc5cd059dc49432f.ico","logo":"/irsa-tutorials/build/irsa_logo-af1759d1435265940356a93d3c7de2f4.png"},"nav":[],"actions":[],"projects":[{"subject":"IRSA Tutorials","settings":{"output_matplotlib_strings":"remove"},"title":"IRSA Tutorials","description":"IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)","authors":[{"id":"IRSA Scientists and Developers","name":"IRSA Scientists and Developers"}],"github":"https://github.com/Caltech-IPAC/irsa-tutorials/","keywords":["astronomy"],"thebe":{"binder":{"url":"https://mybinder.org","provider":"github","repo":"https://github.com/Caltech-IPAC/irsa-tutorials/","ref":"HEAD"}},"toc":[{"file":"index.md","title":"IRSA Tutorials"},{"children":[{"file":"tutorials/spherex/spherex_intro.md"},{"file":"tutorials/spherex/spherex_cutouts.md"},{"file":"tutorials/spherex/spherex_psf.md"}],"title":"SPHEREx"},{"children":[{"children":[{"file":"tutorials/euclid_access/Euclid_ERO.md"}],"title":"Euclid Early Release Observations"},{"children":[{"file":"tutorials/euclid_access/1_Euclid_intro_MER_images.md"},{"file":"tutorials/euclid_access/2_Euclid_intro_MER_catalog.md"},{"file":"tutorials/euclid_access/3_Euclid_intro_1D_spectra.md"},{"file":"tutorials/euclid_access/4_Euclid_intro_PHZ_catalog.md"},{"file":"tutorials/euclid_access/5_Euclid_intro_SPE_catalog.md"},{"file":"tutorials/cloud_access/euclid-cloud-access.md"}],"title":"Euclid Quick Release 1"}],"title":"Euclid"},{"children":[{"children":[{"file":"tutorials/irsa-sia-examples/sia_allwise_atlas.md"},{"file":"tutorials/parquet-catalog-demos/wise-allwise-catalog-demo.md"}],"title":"AllWISE"},{"children":[{"file":"tutorials/firefly/NEOWISE_light_curve_demo.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-strategies.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-lightcurves.md"}],"title":"NEOWISE"}],"title":"WISE"},{"children":[{"file":"tutorials/irsa-sia-examples/siav2_seip.md"}],"title":"Spitzer"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_2mass_allsky.md"}],"title":"2MASS"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_cosmos.md"}],"title":"COSMOS"},{"children":[{"children":[{"file":"tutorials/roman_simulations/roman_hlss_number_density.md"}],"title":"Roman HLSS Galaxy Mock Catalog"},{"children":[{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_wideareasurvey.md"},{"file":"tutorials/firefly/OpenUniverse2024Preview_Firefly.md"},{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_timedomainsurvey.md"}],"title":"OpenUniverse 2024"},{"children":[{"file":"tutorials/cosmodc2/cosmoDC2_TAP_access.md"}],"title":"CosmoDC2"}],"title":"Simulated Data"},{"children":[{"file":"tutorials/cloud_access/cloud-access-intro.md"},{"file":"tutorials/parquet-catalog-demos/irsa-hats-with-lsdb.md"},{"file":"tutorials/firefly/SEDs_in_Firefly.md"},{"file":"tutorials/parallelize/Parallelize_Convolution.md"}],"title":"Special Topics"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"SPHEREx"},{"slug":"spherex-intro","title":"Introduction to SPHEREx Spectral Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-cutouts","title":"Download a collection of SPHEREx Spectral Image cutouts as a multi-extension FITS file","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-psf","title":"Understanding and Extracting the PSF Extension in a SPHEREx Cutout","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Euclid"},{"level":2,"title":"Euclid Early Release Observations"},{"slug":"euclid-ero","title":"Exploring Star Clusters in the Euclid ERO Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Euclid Quick Release 1"},{"slug":"euclid-intro-mer-images","title":"Euclid Q1: MER mosaics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-mer-catalog","title":"Euclid Q1: MER catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-1d-spectra","title":"Euclid Q1: 1D spectra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-phz-catalog","title":"Euclid Q1: PHZ catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-spe-catalog","title":"Euclid Q1: SPE catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-cloud-access","title":"Euclid Q1: cloud access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"WISE"},{"level":2,"title":"AllWISE"},{"slug":"sia-allwise-atlas","title":"Searching for AllWISE Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"wise-allwise-catalog-demo","title":"Analyzing cloud-hosted AllWISE Source Catalog in Parquet format","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"NEOWISE"},{"slug":"neowise-light-curve-demo","title":"Using Firefly visualization tools to understand the light curves of Solar System objects","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-strategies","title":"Strategies to Efficiently Work with NEOWISE Single-exposure Source Table in Parquet","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-lightcurves","title":"Make Light Curves from NEOWISE Single-exposure Source Table","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Spitzer"},{"slug":"siav2-seip","title":"Searching for Spitzer Enhanced Imaging Products","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"2MASS"},{"slug":"sia-2mass-allsky","title":"Searching for 2MASS All-Sky Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"COSMOS"},{"slug":"sia-cosmos","title":"Searching for contributed COSMOS images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Simulated Data"},{"level":2,"title":"Roman HLSS Galaxy Mock Catalog"},{"slug":"roman-hlss-number-density","title":"Number Density as a Function of Redshift","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"OpenUniverse 2024"},{"slug":"openuniverse2024-roman-simulated-wideareasurvey","title":"Analyzing cloud-hosted simulated Roman coadded images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024preview-firefly","title":"Using Firefly to Explore OpenUniverse2024 Data Preview Simulated Roman and Rubin Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024-roman-simulated-timedomainsurvey","title":"Analyzing cloud-hosted simulated Roman Time Domain Survey images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"CosmoDC2"},{"slug":"cosmodc2-tap-access","title":"Querying the CosmoDC2 Mock v1 Catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Special Topics"},{"slug":"cloud-access-intro","title":"IRSA cloud access introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"irsa-hats-with-lsdb","title":"Access HATS Collections Using LSDB: Euclid Q1 and ZTF DR23","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"seds-in-firefly","title":"Using Firefly visualization tools in Python to vet SEDs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"parallelize-convolution","title":"Parallelizing image convolution","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/irsa-tutorials"},"routes/$":{"config":{"version":3,"myst":"1.7.0","options":{"outline_maxdepth":1,"favicon":"/irsa-tutorials/build/irsa-favicon-ab5ecfaec3f77f83cc5cd059dc49432f.ico","logo":"/irsa-tutorials/build/irsa_logo-af1759d1435265940356a93d3c7de2f4.png"},"nav":[],"actions":[],"projects":[{"subject":"IRSA Tutorials","settings":{"output_matplotlib_strings":"remove"},"title":"IRSA Tutorials","description":"IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)","authors":[{"id":"IRSA Scientists and Developers","name":"IRSA Scientists and Developers"}],"github":"https://github.com/Caltech-IPAC/irsa-tutorials/","keywords":["astronomy"],"thebe":{"binder":{"url":"https://mybinder.org","provider":"github","repo":"https://github.com/Caltech-IPAC/irsa-tutorials/","ref":"HEAD"}},"toc":[{"file":"index.md","title":"IRSA Tutorials"},{"children":[{"file":"tutorials/spherex/spherex_intro.md"},{"file":"tutorials/spherex/spherex_cutouts.md"},{"file":"tutorials/spherex/spherex_psf.md"}],"title":"SPHEREx"},{"children":[{"children":[{"file":"tutorials/euclid_access/Euclid_ERO.md"}],"title":"Euclid Early Release Observations"},{"children":[{"file":"tutorials/euclid_access/1_Euclid_intro_MER_images.md"},{"file":"tutorials/euclid_access/2_Euclid_intro_MER_catalog.md"},{"file":"tutorials/euclid_access/3_Euclid_intro_1D_spectra.md"},{"file":"tutorials/euclid_access/4_Euclid_intro_PHZ_catalog.md"},{"file":"tutorials/euclid_access/5_Euclid_intro_SPE_catalog.md"},{"file":"tutorials/cloud_access/euclid-cloud-access.md"}],"title":"Euclid Quick Release 1"}],"title":"Euclid"},{"children":[{"children":[{"file":"tutorials/irsa-sia-examples/sia_allwise_atlas.md"},{"file":"tutorials/parquet-catalog-demos/wise-allwise-catalog-demo.md"}],"title":"AllWISE"},{"children":[{"file":"tutorials/firefly/NEOWISE_light_curve_demo.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-strategies.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-lightcurves.md"}],"title":"NEOWISE"}],"title":"WISE"},{"children":[{"file":"tutorials/irsa-sia-examples/siav2_seip.md"}],"title":"Spitzer"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_2mass_allsky.md"}],"title":"2MASS"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_cosmos.md"}],"title":"COSMOS"},{"children":[{"children":[{"file":"tutorials/roman_simulations/roman_hlss_number_density.md"}],"title":"Roman HLSS Galaxy Mock Catalog"},{"children":[{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_wideareasurvey.md"},{"file":"tutorials/firefly/OpenUniverse2024Preview_Firefly.md"},{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_timedomainsurvey.md"}],"title":"OpenUniverse 2024"},{"children":[{"file":"tutorials/cosmodc2/cosmoDC2_TAP_access.md"}],"title":"CosmoDC2"}],"title":"Simulated Data"},{"children":[{"file":"tutorials/cloud_access/cloud-access-intro.md"},{"file":"tutorials/parquet-catalog-demos/irsa-hats-with-lsdb.md"},{"file":"tutorials/firefly/SEDs_in_Firefly.md"},{"file":"tutorials/parallelize/Parallelize_Convolution.md"}],"title":"Special Topics"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"SPHEREx"},{"slug":"spherex-intro","title":"Introduction to SPHEREx Spectral Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-cutouts","title":"Download a collection of SPHEREx Spectral Image cutouts as a multi-extension FITS file","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-psf","title":"Understanding and Extracting the PSF Extension in a SPHEREx Cutout","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Euclid"},{"level":2,"title":"Euclid Early Release Observations"},{"slug":"euclid-ero","title":"Exploring Star Clusters in the Euclid ERO Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Euclid Quick Release 1"},{"slug":"euclid-intro-mer-images","title":"Euclid Q1: MER mosaics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-mer-catalog","title":"Euclid Q1: MER catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-1d-spectra","title":"Euclid Q1: 1D spectra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-phz-catalog","title":"Euclid Q1: PHZ catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-spe-catalog","title":"Euclid Q1: SPE catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-cloud-access","title":"Euclid Q1: cloud access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"WISE"},{"level":2,"title":"AllWISE"},{"slug":"sia-allwise-atlas","title":"Searching for AllWISE Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"wise-allwise-catalog-demo","title":"Analyzing cloud-hosted AllWISE Source Catalog in Parquet format","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"NEOWISE"},{"slug":"neowise-light-curve-demo","title":"Using Firefly visualization tools to understand the light curves of Solar System objects","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-strategies","title":"Strategies to Efficiently Work with NEOWISE Single-exposure Source Table in Parquet","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-lightcurves","title":"Make Light Curves from NEOWISE Single-exposure Source Table","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Spitzer"},{"slug":"siav2-seip","title":"Searching for Spitzer Enhanced Imaging Products","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"2MASS"},{"slug":"sia-2mass-allsky","title":"Searching for 2MASS All-Sky Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"COSMOS"},{"slug":"sia-cosmos","title":"Searching for contributed COSMOS images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Simulated Data"},{"level":2,"title":"Roman HLSS Galaxy Mock Catalog"},{"slug":"roman-hlss-number-density","title":"Number Density as a Function of Redshift","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"OpenUniverse 2024"},{"slug":"openuniverse2024-roman-simulated-wideareasurvey","title":"Analyzing cloud-hosted simulated Roman coadded images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024preview-firefly","title":"Using Firefly to Explore OpenUniverse2024 Data Preview Simulated Roman and Rubin Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024-roman-simulated-timedomainsurvey","title":"Analyzing cloud-hosted simulated Roman Time Domain Survey images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"CosmoDC2"},{"slug":"cosmodc2-tap-access","title":"Querying the CosmoDC2 Mock v1 Catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Special Topics"},{"slug":"cloud-access-intro","title":"IRSA cloud access introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"irsa-hats-with-lsdb","title":"Access HATS Collections Using LSDB: Euclid Q1 and ZTF DR23","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"seds-in-firefly","title":"Using Firefly visualization tools in Python to vet SEDs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"parallelize-convolution","title":"Parallelizing image convolution","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":3,"kind":"Notebook","sha256":"d5c4afcd5066fa699838ca508f55d833efab6540092eb6544c7c26e703f422f7","slug":"seds-in-firefly","location":"/tutorials/firefly/SEDs_in_Firefly.md","dependencies":[],"frontmatter":{"title":"Using Firefly visualization tools in Python to vet SEDs","kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"jupytext":{"text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.16.3"}},"content_includes_title":false,"authors":[{"id":"IRSA Scientists and Developers","name":"IRSA Scientists and Developers"}],"github":"https://github.com/Caltech-IPAC/irsa-tutorials/","subject":"IRSA Tutorials","keywords":["astronomy"],"settings":{"output_matplotlib_strings":"remove"},"numbering":{"title":{"offset":1}},"source_url":"https://github.com/Caltech-IPAC/irsa-tutorials//blob/main/tutorials/firefly/SEDs_in_Firefly.md","edit_url":"https://github.com/Caltech-IPAC/irsa-tutorials//edit/main/tutorials/firefly/SEDs_in_Firefly.md","exports":[{"format":"md","filename":"SEDs_in_Firefly.md","url":"/irsa-tutorials/build/SEDs_in_Firefly-62eede684bd8a4e38a5eedb473bc6d30.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Learning Goals","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"NO3RQVyU2d"}],"identifier":"learning-goals","label":"Learning Goals","html_id":"learning-goals","implicit":true,"key":"XPVvwMpM9G"}],"key":"HmiUyWowy9"},{"type":"block","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"By the end of this tutorial, the following goals can be accomplished:","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"Gu3NERjRkl"}],"key":"xBKGvm12xG"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":21,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Select a position and categories of data for search of possible nearby sources","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"Pm0a72tDrs"}],"key":"GIOGO2awM1"}],"key":"hebsLwbgoV"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Pull photometry for different bands via TAP queries on chosen IRSA catalogs","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"LX9WTMjoto"}],"key":"cEsRdUwGH8"}],"key":"Ih6iH0u2SY"},{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Add data columns from result to table, including energy density values (converted from magnitudes)","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"OL9hdjrTiU"}],"key":"mQW4005q08"}],"key":"MpBbbbxNNv"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Create a simple SED plot using compiled photometric data","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"V3IvUdveYb"}],"key":"js7JHGb4Jy"}],"key":"OrDoteNVQj"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Display matching image cutouts from IRSA data sets for selected position","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"ESUkoCEiCF"}],"key":"ujph0AnjJv"}],"key":"B7PnLgImEr"}],"key":"uAhiybXm8b"}],"key":"AeWhfSEudw"},{"type":"block","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"zFnVjKtXo3"}],"identifier":"introduction","label":"Introduction","html_id":"introduction","implicit":true,"key":"nhc374kk8u"}],"key":"zaoIyWPBMl"},{"type":"block","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"The purpose of this notebook is to show how to make and vet Spectral Energy Distributions (SEDs) using Firefly. All examples use the python package ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"OJLGWw9RVB"},{"type":"inlineCode","value":"pyvo","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"mrsgyGuLIN"},{"type":"text","value":" to search for catalogs and images from IRSA.","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"RuwUg5vuiq"}],"key":"WquLTcshuE"}],"key":"BVuD3tI782"},{"type":"block","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Detailed specifications for this notebook come from a paper led by Luisa Rebull on the selection of possible Young Stellar Objects (YSOs) in IC 417 (","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"HwiRRqTrlo"},{"type":"cite","url":"https://doi.org/10.3847/1538-3881/ace32f","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Rebull ","key":"TUffCwvr7M"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"EK417ietZB"}],"key":"PtXJ1Pgpy0"},{"type":"text","value":" (2023)","key":"O2ZdCwYkbB"}],"kind":"narrative","label":"Rebull_2023","identifier":"https://doi.org/10.3847/1538-3881/ace32f","enumerator":"1","key":"JH2O8GoELf"},{"type":"text","value":").","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"sbJ4SicxhS"}],"key":"CnLvWZbGqI"}],"key":"JuOUvFwmkn"},{"type":"block","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"In this case, the SEDs generated by photometry data (from several different survey catalogs) near a given position can be compared with corresponding images to verify the location of a point source that could also be considered as a YSO if the graph shape is sound.","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"Rou5FpHEyx"}],"key":"Eoulj5Xi7Y"}],"key":"VWhDfFubON"},{"type":"block","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"lQMBvZlid8"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"rPnTPnzFVj"}],"key":"liCRfHaUOT"},{"type":"block","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"Prior to starting Jupyterlab, you should specify the Firefly server by setting the ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"Z13ic7GM5n"},{"type":"inlineCode","value":"FIREFLY_URL","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"TAcKopRQFn"},{"type":"text","value":" environment variable (use the value ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"i8EDxMADlS"},{"type":"link","url":"https://irsa.ipac.caltech.edu/irsaviewer","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"https://​irsa​.ipac​.caltech​.edu​/irsaviewer","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"ReKRLfhjW9"}],"urlSource":"https://irsa.ipac.caltech.edu/irsaviewer","key":"ZiriHI1ALs"},{"type":"text","value":" if you’re not sure), or by one of the other ways listed on the ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"d9NUYF7Xan"},{"type":"link","url":"https://github.com/Caltech-IPAC/jupyter_firefly_extensions","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"jupyter_firefly_extension page","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"LtuumEv82c"}],"urlSource":"https://github.com/Caltech-IPAC/jupyter_firefly_extensions","error":true,"key":"SYNBdoLin3"},{"type":"text","value":".","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"wSujxCHVTS"}],"key":"bgKdCtCT28"}],"key":"IqLZAdRDKB"},{"type":"block","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"The packages needed for this notebook are in the ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"o3Ntb34que"},{"type":"inlineCode","value":"requirements.txt","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"Yv55a5Cnt8"},{"type":"text","value":" file. They can be installed with ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"KiurrypNpn"},{"type":"inlineCode","value":"pip install -r requirements.txt","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"w5jD9YLP3e"},{"type":"text","value":" before you start your Jupyterlab session.","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"jEULmpdlPk"}],"key":"pX7GY3ExoE"}],"key":"clnATcFpvk"},{"type":"block","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":57,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"paragraph","children":[{"type":"emphasis","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"astropy.units","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"anflJUILWI"}],"key":"QCMqdxWaCF"},{"type":"text","value":" - for specifying and manipulating units","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"ntwR9rkccc"}],"key":"DJsOmpRgDm"}],"key":"ewH3ajBz6t"},{"type":"listItem","spread":true,"position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"paragraph","children":[{"type":"emphasis","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"astropy.constants","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"mj9o159DNQ"}],"key":"wwRLYjfDZ2"},{"type":"text","value":" - for constants","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"LFL59htJy5"}],"key":"hZlDU05567"}],"key":"g6aBulfOnh"},{"type":"listItem","spread":true,"position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"paragraph","children":[{"type":"emphasis","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"astropy.coordinates.Skycoord","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"D971M4Ohxr"}],"key":"a3FvCffvCq"},{"type":"text","value":" - for representing coordinates","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"cfsZdpcWZ9"}],"key":"EBZLbPlEKl"}],"key":"E97ut2zgPl"},{"type":"listItem","spread":true,"position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"paragraph","children":[{"type":"emphasis","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"astropy.table.QTable","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"dg1PFzLVw1"}],"key":"yvgVeFPzDF"},{"type":"text","value":" - for tables with units","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"jh6UYzpxtA"}],"key":"iuZMYvTaeU"}],"key":"v9LKVxKRTW"},{"type":"listItem","spread":true,"position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"paragraph","children":[{"type":"emphasis","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"firefly_client.FireflyClient","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"W4jYnN55xp"}],"key":"IBtJfpxcgg"},{"type":"text","value":" - Python API to Firefly for displaying tables, images and charts","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"k1M4vWtkFW"}],"key":"ClNTkjstKV"}],"key":"PEtEok8g7n"},{"type":"listItem","spread":true,"position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"paragraph","children":[{"type":"emphasis","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"numpy","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"fPlUWgMdhe"}],"key":"Lk2BfypdYR"},{"type":"text","value":" - for working with arrays","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"wS4PT0oVem"}],"key":"AMDcoFfaoB"}],"key":"SjSOwlIQ6f"},{"type":"listItem","spread":true,"position":{"start":{"line":63,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"paragraph","children":[{"type":"emphasis","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"pyvo","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"JpxMiouBHw"}],"key":"BVY73zwJ8i"},{"type":"text","value":" - for queries to Virtual Observatory services at the archives","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"dWj7TVtPH3"}],"key":"nkNmBNQS58"}],"key":"A6gziANOy4"}],"key":"GS48HIFNtA"}],"key":"LKWQTkSBJr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Uncomment the next line to install dependencies if needed.\n# !pip install numpy astropy pyvo firefly_client","key":"dX1is2um2B"},{"type":"outputs","id":"3AObF6nK8rIa5Fpe_9srQ","children":[],"key":"waZiIfNV6f"}],"key":"sySGLRxWgu"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"text","value":"Call the imports below:","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"NfOECJAJN2"}],"key":"iI27iXYn9o"}],"key":"jnvor3im80"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import astropy.units as u\nfrom astropy import constants as const\nfrom astropy.coordinates import SkyCoord\nfrom astropy.table import QTable\nfrom astropy.utils.data import download_file\nfrom firefly_client import FireflyClient\nimport numpy as np\nimport pyvo","key":"mfZnCXF3Oo"},{"type":"outputs","id":"9BoOEQykRzQu_TBf86BTK","children":[],"key":"xQm41dphuC"}],"key":"kwlDeVOkdU"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"text","value":"Choose Target as Example","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"EBQf4DVLNn"}],"identifier":"choose-target-as-example","label":"Choose Target as Example","html_id":"choose-target-as-example","implicit":true,"key":"zvOpbCZ7U2"}],"key":"MalvsVGsTb"},{"type":"block","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"From ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"AYI2635Jta"},{"type":"cite","url":"https://doi.org/10.3847/1538-3881/ace32f#ajace32ff10","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"Figure 10","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"UTAYdIzJXr"}],"kind":"narrative","label":"Rebull_2023","identifier":"https://doi.org/10.3847/1538-3881/ace32f#ajace32ff10","enumerator":"1","key":"eA6HYEfqQP"},{"type":"text","value":" of the referenced paper, pick the source in the upper right corner (J052736.37+344940.6):","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"RUjt98cJl1"}],"key":"ROtcLFq7sM"}],"key":"QzLeU3Vtg1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"target = SkyCoord(ra=\"05h27m36.37s\", dec=\"+34d49m40.6s\")","key":"ienVGmUvqu"},{"type":"outputs","id":"We71PbT2JX2Pu1teLsuej","children":[],"key":"sHZN75Grhw"}],"key":"mn4MUKuxH4"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"Get Photometry from IRSA","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"eU2u9lgFGa"}],"identifier":"get-photometry-from-irsa","label":"Get Photometry from IRSA","html_id":"get-photometry-from-irsa","implicit":true,"key":"dSM3SIlakm"}],"key":"OzExeXKWxY"},{"type":"block","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"text","value":"The available data at IRSA include the following catalogs (with matching radius at 1 arcsec except where noted by reference paper):","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"Duom1UdX5Z"}],"key":"WijbA4lBr4"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":98,"column":1},"end":{"line":108,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Gaia DR3","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"lqrpIXn6eY"}],"key":"jjVrWv3G69"}],"key":"PyYTZM7Z6t"},{"type":"listItem","spread":true,"position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"2MASS","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"EAU8UGPgcL"}],"key":"UqQZxd9gIr"}],"key":"LiAWO4PTaP"},{"type":"listItem","spread":true,"position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Spitzer-IRAC (GLIMPSE? SEIP Source List?)","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"key":"UZia0AbQk8"}],"key":"bECoIsxDjh"}],"key":"SjcgvWB0NH"},{"type":"listItem","spread":true,"position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Spitzer-MIPS-24 (GLIMPSE? SEIP Source List?)","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"t5VId21riu"}],"key":"eDJ9gP4ztS"}],"key":"VagM380vsY"},{"type":"listItem","spread":true,"position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"AllWISE","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"sn0xo9r1jS"}],"key":"UWcm1XNqzq"}],"key":"zi8EbLf2uO"},{"type":"listItem","spread":true,"position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"CatWISE","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"PpHdHksEzS"}],"key":"uC1ToyOEe7"}],"key":"ngjdWR8pD7"},{"type":"listItem","spread":true,"position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"unWISE","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"PesXxVVuJ5"}],"key":"PvUgVIQPGN"}],"key":"MQDziBgzrC"},{"type":"listItem","spread":true,"position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"MSX","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"sPaFm1V0qb"}],"key":"aOg3BymCDT"}],"key":"UMPeUJ7OY2"},{"type":"listItem","spread":true,"position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Akari","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"HJT1vW8NbP"}],"key":"U7dnewKNqj"}],"key":"iJmB1zZj5A"},{"type":"listItem","spread":true,"position":{"start":{"line":107,"column":1},"end":{"line":108,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Herschel-PACS (70um and 160um)","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"GdO74m8hOY"}],"key":"lcnASKlkO8"}],"key":"Av2Srs6uKR"}],"key":"G5Cp47FFcv"},{"type":"paragraph","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"X8mPjDFH0n"},{"type":"link","url":"https://vmcoolwiki.ipac.caltech.edu/index.php/Central_wavelengths_and_zero_points","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"NITARP Wiki page","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"ONzWVgEXkZ"}],"urlSource":"https://vmcoolwiki.ipac.caltech.edu/index.php/Central_wavelengths_and_zero_points","key":"QtFaqYGPwE"},{"type":"text","value":" on central wavelengths may be helpful for finding zero-point information for specific catalogs, as well as the more general ","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"H1Trw4hcyg"},{"type":"link","url":"https://astroquery.readthedocs.io/en/latest/svo_fps/svo_fps.html","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"astroquery service","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"DhRdyFtdbE"}],"urlSource":"https://astroquery.readthedocs.io/en/latest/svo_fps/svo_fps.html","key":"teb21RTgzI"},{"type":"text","value":" on SVO filter data.","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"HKjnoHxQGY"}],"key":"DKNhQQ6c1o"}],"key":"CfX8jeRPDT"},{"type":"block","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"text","value":"Whlie this notebook will focus on a subset of the above list (2MASS, Gaia DR3, and WISE data), note that there is a section where additional data can be included as well.","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"FPZSYpJ8TJ"}],"key":"rhOUfNG9Kv"}],"key":"vdCJrtZMcp"},{"type":"block","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"The variable ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"SxilCwWZnS"},{"type":"inlineCode","value":"phot_tbl","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"wJglhrT6PJ"},{"type":"text","value":" is the table containing the photometry for the target and all the derived quantities needed to make SED plots:","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"fs2jYeLOtN"}],"key":"FNOOJ2WQTu"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":118,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Right ascension (in degrees)","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"NlRxJIaVVg"}],"key":"OLglhplZf3"}],"key":"qvxQ1d2mKu"},{"type":"listItem","spread":true,"position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Declination (in degrees)","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"MS2fUeNbdO"}],"key":"VAUhe1nxmc"}],"key":"Ac7SRUfYGU"},{"type":"listItem","spread":true,"position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Wavelength for the bandpass (in microns)","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"mDdY0EkMKX"}],"key":"gPec9hdPCD"}],"key":"ENd2x55mbZ"},{"type":"listItem","spread":true,"position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Photometry measurement","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"QB0EHu9BiU"}],"key":"Or2VKJM9OL"}],"key":"S2nuJojwW0"},{"type":"listItem","spread":true,"position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Photometry uncertainty","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"KUIi2YS0ZY"}],"key":"LkJ3HLN16N"}],"key":"aPO36xOgSt"},{"type":"listItem","spread":true,"position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Is the measurement an upper limit? (Note: 1 means yes, 0 means no)","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"dUcpfHEieV"}],"key":"TxBNCx4L34"}],"key":"fwy899ogYs"},{"type":"listItem","spread":true,"position":{"start":{"line":124,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Zeropoint for the bandpass in units of Janskys (needed for converting photometric measurements to energy densities)","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"L5fgtQaxA9"}],"key":"oSv2jLBzlC"}],"key":"VLhs5gPwhf"}],"key":"MbHWgxqjKy"}],"key":"C0EWcD27yW"},{"type":"block","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"text","value":"Set the variables for the photmetry table and each quantity in that data structure:","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"ETSnNrufzt"}],"key":"dc8gT9e1aS"}],"key":"bHN7NXxwn8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"phot_tbl = QTable(names=['ra', 'dec', 'wavelength', 'mag', 'magerr', 'upper_limit', 'zeropoint'],\n                  units=[u.deg, u.deg, u.micron, None, None, None, u.Jy])","key":"oX8EK9cqvv"},{"type":"outputs","id":"P2sapJrTFVC7BdD9Wf1Io","children":[],"key":"M3ZXkO4Bnh"}],"key":"sPseGTWghi"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"text","value":"We query catalog data using IRSA’s TAP (VO Table Access Protocol) service. It’s sufficient to set up the service once, at the beginning of the session:","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"Lcd8SxlxUJ"}],"key":"infeqDGMkU"}],"key":"PB1kd8eAhN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"irsa_tap = pyvo.dal.TAPService(\"https://irsa.ipac.caltech.edu/TAP\")","key":"Aita61lrwI"},{"type":"outputs","id":"FKish1zuXcXU3b8vqfz7e","children":[],"key":"u0wukdD9GD"}],"key":"b0HHN0EQve"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"children":[{"type":"text","value":"Retrieve 2MASS photometry","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"vsBLyrYe0k"}],"identifier":"retrieve-2mass-photometry","label":"Retrieve 2MASS photometry","html_id":"retrieve-2mass-photometry","implicit":true,"key":"qMzmgGcYpU"}],"key":"L1qx37JSgY"},{"type":"block","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"children":[{"type":"text","value":"To start, define a function to retrieve 2MASS photometry via a TAP query to IRSA that includes upper limits (note that only the ","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"eVoRysZysD"},{"type":"inlineCode","value":"ph_qual","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"tjFPMSZRU7"},{"type":"text","value":" column on photometric quality of source is used and not the ","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"j1FjmSo6ET"},{"type":"inlineCode","value":"rd_flg","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"vgmnJgHIA9"},{"type":"text","value":" column on “read flag”):","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"HvJRkmPKcF"}],"key":"phC1UK4ZUu"}],"key":"gaM5RMm0G1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def get_2mass_phot(target, radius=1*u.arcsec):\n    \"\"\"Get photometry from 2MASS\n\n    Parameters:\n    -----------\n    target: astropy.coordinates.SkyCoord\n          coordinates of the target(s)\n\n    radius: astropy.units.Quantity\n          matching radius, default 1*u.arcsec\n\n    Returns:\n    --------\n    rows: list\n         lists of photometry points to add to table\n    \"\"\"\n\n    query = f\"\"\"\n    SELECT ra,dec,j_m,j_msigcom,h_m,h_msigcom,k_m,k_msigcom,ph_qual,rd_flg\n    FROM fp_psc\n    WHERE CONTAINS(POINT('ICRS', ra, dec),\n    CIRCLE('ICRS', {target.ra.deg}, {target.dec.deg},\n    {radius.to('deg').value}))=1\n    \"\"\"\n\n    results = irsa_tap.search(query)\n\n    rowj = [results[\"ra\"]*u.deg,\n            results[\"dec\"]*u.deg,\n            1.235*u.micron,\n            results[\"j_m\"][0],\n            results[\"j_msigcom\"][0],\n            1 if results[\"ph_qual\"] == \"U\" else 0,\n            1594*u.Jy]\n\n    rowh = [results[\"ra\"]*u.deg,\n            results[\"dec\"]*u.deg,\n            1.662*u.micron,\n            results[\"h_m\"][0],\n            results[\"h_msigcom\"][0],\n            1 if results[\"ph_qual\"] == \"U\" else 0,\n            1024*u.Jy]\n\n    rowks = [results[\"ra\"]*u.deg,\n            results[\"dec\"]*u.deg,\n            2.159*u.micron,\n            results[\"k_m\"][0],\n            results[\"k_msigcom\"][0],\n            1 if results[\"ph_qual\"] == \"U\" else 0,\n            666.7*u.Jy]\n\n    return([rowj, rowh, rowks])","key":"GTw6CYHyz2"},{"type":"outputs","id":"ZON-zDI4tssyGQ6EBCIfr","children":[],"key":"NimdAIh1n5"}],"key":"JmC6my1596"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"children":[{"type":"text","value":"Consider that while the search radius is currently set at 1 degree from the position, that value can be adjusted by changing what the number on the ","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"Lc9vU1PK7i"},{"type":"inlineCode","value":"radius","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"FcwJ6zlKhB"},{"type":"text","value":" line is.","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"S6pYH3niOp"}],"key":"Z8W8sCNYS4"},{"type":"paragraph","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"text","value":"Now gather the rows of 2MASS data and add each of them to the photometry table:","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"cy4ZE5sv15"}],"key":"YxDYhrSZMl"}],"key":"IFisAMoVI3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"rows = get_2mass_phot(target)","key":"xyOJWJ8PIn"},{"type":"outputs","id":"Ts0fonUfm5wstZ-ZwWysX","children":[],"key":"LM0oP9OsPw"}],"key":"eB96LAM06i"},{"type":"block","children":[],"key":"PAqvZsysGf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for row in rows:\n    phot_tbl.add_row(row)","key":"eBjtM2mGqJ"},{"type":"outputs","id":"1HFpY0gAvW_Mr3xixJ_h2","children":[],"key":"EUnW2Bl6Ww"}],"key":"ek2sk18CTd"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"children":[{"type":"text","value":"Retrieve AllWISE Photometry","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"g9IFrX2zJe"}],"identifier":"retrieve-allwise-photometry","label":"Retrieve AllWISE Photometry","html_id":"retrieve-allwise-photometry","implicit":true,"key":"tZz3yBBiCL"}],"key":"Z6AIqd7d9j"},{"type":"block","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"children":[{"type":"text","value":"According to the paper referenced above, the detections from the AllWISE catalog were retained if the data quality flags were A, B, or C; if the data quality flag was Z, then the data were provisionally retained with a very large error bar, 30% larger than what appears in the catalog.","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"QwGf2N0VNe"}],"key":"EhI8xFlG15"}],"key":"a2JIMMzwHI"},{"type":"block","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"children":[{"type":"text","value":"Based on that information, define a function to release AllWISE photometry via a TAP query to IRSA that includes the needed data quality flags and retains upper limits:","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"AglzeHvmH7"}],"key":"JPIHZhmkih"}],"key":"BxLQh1n6GR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def get_allwise_phot(target, radius=1*u.arcsec):\n    \"\"\"Get photometry from AllWISE\n\n    Parameters:\n    -----------\n    target: astropy.coordinates.SkyCoord\n          coordinates of the target(s)\n\n    radius: astropy.units.Quantity\n          matching radius, defaults to 1*u.arcsec\n\n    Returns:\n    --------\n    rows: list\n         lists of photometry points to add to table\n    \"\"\"\n\n    query = f\"\"\"\n    SELECT ra,dec,w1mpro,w1sigmpro,w2mpro,w2sigmpro,w3mpro,\n          w3sigmpro,w4mpro,w4sigmpro,ph_qual\n    FROM allwise_p3as_psd\n    WHERE CONTAINS(POINT('ICRS', ra, dec),\n    CIRCLE('ICRS', {target.ra.deg}, {target.dec.deg},\n    {radius.to('deg').value}))=1\n    \"\"\"\n\n    results = irsa_tap.search(query)\n\n    roww1 = [results[\"ra\"]*u.deg,\n             results[\"dec\"]*u.deg,\n             3.4*u.micron,\n             results[\"w1mpro\"][0],\n             results[\"w1sigmpro\"][0],\n             1 if results[\"ph_qual\"] == \"U\" else 0,\n             309.54*u.Jy]\n\n    roww2 = [results[\"ra\"]*u.deg,\n             results[\"dec\"]*u.deg,\n             4.6*u.micron,\n             results[\"w2mpro\"][0],\n             results[\"w2sigmpro\"][0],\n             1 if results[\"ph_qual\"] == \"U\" else 0,\n             171.79*u.Jy]\n\n    roww3 = [results[\"ra\"]*u.deg,\n             results[\"dec\"]*u.deg,\n             12*u.micron,\n             results[\"w3mpro\"][0],\n             results[\"w3sigmpro\"][0],\n             1 if results[\"ph_qual\"] == \"U\" else 0,\n             31.676*u.Jy]\n\n    roww4 = [results[\"ra\"]*u.deg,\n             results[\"dec\"]*u.deg,\n             22*u.micron,\n             results[\"w4mpro\"][0],\n             results[\"w4sigmpro\"][0],\n             1 if results[\"ph_qual\"] == \"U\" else 0,\n             8.3635*u.Jy]\n\n    return([roww1, roww2, roww3, roww4])","key":"JwDJ006GiI"},{"type":"outputs","id":"UN3YwdmI2njeCH4IWcGTm","children":[],"key":"zAjsagOEEC"}],"key":"HnQj5p7RyM"},{"type":"block","children":[],"key":"bSiLalHTxh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"rows = get_allwise_phot(target)","key":"XVFWHenWYM"},{"type":"outputs","id":"IAm7GhGy_CIHKTZ3niUKk","children":[],"key":"lFSCUxMhvQ"}],"key":"VBGHxDanhb"},{"type":"block","children":[],"key":"sBERpvfKvh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for row in rows:\n    phot_tbl.add_row(row)","key":"V8JBmFowJY"},{"type":"outputs","id":"MkaCUJX9ck3HOgsWBPTuy","children":[],"key":"da46PPD2X6"}],"key":"r9gxnun64P"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"children":[{"type":"text","value":"Retrieve Gaia DR3 Photometry","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"yAGoUnTcfm"}],"identifier":"retrieve-gaia-dr3-photometry","label":"Retrieve Gaia DR3 Photometry","html_id":"retrieve-gaia-dr3-photometry","implicit":true,"key":"IFMJYYrKMv"}],"key":"mb9HS34C7R"},{"type":"block","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"children":[{"type":"text","value":"Define a function to retrieve Gaia DR3 photometry via a TAP query to IRSA (not considering upper limits as Gaia DR3 ony provides “detections or not” info so actual limits are not given):","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"CYfGZumCCv"}],"key":"jlctzfbO8T"}],"key":"fGt4vJhk35"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def get_gaia_phot(target, radius=1*u.arcsec):\n    \"\"\"Get photometry from Gaia DR3\n\n    Parameters:\n    -----------\n    target: astropy.coordinates.SkyCoord\n          coordinates of the target(s)\n\n    radius: astropy.units.Quantity\n          matching radius, default is 1*u.arcsec\n\n    Returns:\n    --------\n    rows: list\n         lists of photometry points to add to table\n    \"\"\"\n\n    query = f\"\"\"\n    SELECT designation,ra,ra_error,dec,dec_error,ra_dec_corr,phot_g_mean_flux_over_error,phot_g_mean_mag,\n       phot_bp_mean_flux_over_error,phot_bp_mean_mag,phot_rp_mean_flux_over_error,phot_rp_mean_mag\n    FROM gaia_dr3_source\n    WHERE CONTAINS(POINT('ICRS', ra, dec),\n    CIRCLE('ICRS', {target.ra.deg}, {target.dec.deg},\n    {radius.to('deg').value}))=1\n    \"\"\"\n\n    results = irsa_tap.search(query)\n\n    rowg = [results[\"ra\"]*u.deg,\n            results[\"dec\"]*u.deg,\n            0.622*u.micron,\n            results[\"phot_g_mean_mag\"][0],\n            2.5/(np.log(10)*results[\"phot_g_mean_flux_over_error\"][0]),\n            0,\n            3228.75*u.Jy]\n\n    rowbp = [results[\"ra\"]*u.deg,\n            results[\"dec\"]*u.deg,\n            0.511*u.micron,\n            results[\"phot_bp_mean_mag\"][0],\n            2.5/(np.log(10)*results[\"phot_bp_mean_flux_over_error\"][0]),\n            0,\n            3552.01*u.Jy]\n\n    rowrp = [results[\"ra\"]*u.deg,\n            results[\"dec\"]*u.deg,\n            0.7769*u.micron,\n            results[\"phot_rp_mean_mag\"][0],\n            2.5/(np.log(10)*results[\"phot_rp_mean_flux_over_error\"][0]),\n            0,\n            2554.95*u.Jy]\n\n    return([rowg, rowbp, rowrp])","key":"mBCgIEQ9y9"},{"type":"outputs","id":"UXf-IGleKKXA6ilTSRH0Y","children":[],"key":"aLYsYpQUGp"}],"key":"Fa8oFAYUcA"},{"type":"block","children":[],"key":"KmWG6S4DHJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"rows = get_gaia_phot(target)","key":"voeBQFC4t7"},{"type":"outputs","id":"ShdOBRzqTgcyd2ncVeeEz","children":[],"key":"oFsCmCNlfC"}],"key":"tNXg6y0uCn"},{"type":"block","children":[],"key":"i7krjdG3xZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for row in rows:\n    phot_tbl.add_row(row)","key":"Uc2QSnSBwx"},{"type":"outputs","id":"eNbQpx5NPZdg9DvBKVb71","children":[],"key":"wTG5Mm1kYA"}],"key":"mS0ZNQ8xUt"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"children":[{"type":"text","value":"Retrieve CatWISE Photometry","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"AMUeBjwlyy"}],"identifier":"retrieve-catwise-photometry","label":"Retrieve CatWISE Photometry","html_id":"retrieve-catwise-photometry","implicit":true,"key":"rTUc41zAWF"}],"key":"yjTljsh8Ek"},{"type":"block","position":{"start":{"line":371,"column":1},"end":{"line":371,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":373,"column":1},"end":{"line":373,"column":1}},"children":[{"type":"text","value":"Define a function to retrieve CatWISE photometry via a TAP query to IRSA that includes upper limits (note that CatWISE2020 Catalog is being used rather than CatWISE Preliminary Catalog):","position":{"start":{"line":373,"column":1},"end":{"line":373,"column":1}},"key":"NtW1M6ddBa"}],"key":"BDM8iwfla8"}],"key":"Pfklqhi1Dp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def get_catwise_phot(target, radius=1*u.arcsec):\n    \"\"\"Get photometry from CatWISE\n\n    Parameters:\n    -----------\n    target: astropy.coordinates.SkyCoord\n          coordinates of the target(s)\n\n    radius: astropy.units.Quantity\n          matching radius, defaults to 1*u.arcsec\n\n    Returns:\n    --------\n    rows: list\n         lists of photometry points to add to table\n    \"\"\"\n\n    query = f\"\"\"\n    SELECT ra,dec,w1mpro,w1sigmpro,w2mpro,w2sigmpro\n    FROM catwise_2020\n    WHERE CONTAINS(POINT('ICRS', ra, dec),\n    CIRCLE('ICRS', {target.ra.deg}, {target.dec.deg},\n    {radius.to('deg').value}))=1\n    \"\"\"\n\n    results = irsa_tap.search(query)\n\n    roww1 = [results[\"ra\"]*u.deg,\n             results[\"dec\"]*u.deg,\n             3.4*u.micron,\n             results[\"w1mpro\"][0],\n             results[\"w1sigmpro\"][0],\n             1 if results[\"w1sigmpro\"] is None else 0,\n             309.54*u.Jy]\n\n    roww2 = [results[\"ra\"]*u.deg,\n             results[\"dec\"]*u.deg,\n             4.6*u.micron,\n             results[\"w2mpro\"][0],\n             results[\"w2sigmpro\"][0],\n             1 if results[\"w2sigmpro\"] is None else 0,\n             171.79*u.Jy]\n\n    return([roww1, roww2])","key":"oPpdCM5QGZ"},{"type":"outputs","id":"9F3DhKXA-PgOJFagToJPa","children":[],"key":"IyQU6bP4WD"}],"key":"MTsN7kCFd2"},{"type":"block","children":[],"key":"sGyNC5czmP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"rows = get_catwise_phot(target)","key":"boUGpB1V5C"},{"type":"outputs","id":"HTWdOvELJKYD1U_tL-m9_","children":[],"key":"DSgXyBWQYh"}],"key":"Fz1YxYc5Ey"},{"type":"block","children":[],"key":"XsC0oogSkn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for row in rows:\n    phot_tbl.add_row(row)","key":"OPXVEDl2yV"},{"type":"outputs","id":"-BxAwwDQqDhpJIw18PJam","children":[],"key":"cxyF1vLUD8"}],"key":"q4fP2xKeuQ"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"children":[{"type":"text","value":"Retrieve unWISE Photometry","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"key":"G8lDEFv0Lc"}],"identifier":"retrieve-unwise-photometry","label":"Retrieve unWISE Photometry","html_id":"retrieve-unwise-photometry","implicit":true,"key":"lGrUx3ROgm"}],"key":"a2vucxAcG4"},{"type":"block","position":{"start":{"line":433,"column":1},"end":{"line":433,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":435,"column":1},"end":{"line":435,"column":1}},"children":[{"type":"text","value":"Define a function to retrieve unWISE photometry via a TAP query to IRSA(note that flux units are given in nano-mag, zero-point is carried over from AllWISE, and no flag for upper limits is given):","position":{"start":{"line":435,"column":1},"end":{"line":435,"column":1}},"key":"TlpfomUe6M"}],"key":"Yvw54k6b04"}],"key":"sBOdLIdaOE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def get_unwise_phot(target, radius=1*u.arcsec):\n    \"\"\"Get photometry from CatWISE\n\n    Parameters:\n    -----------\n    target: astropy.coordinates.SkyCoord\n          coordinates of the target(s)\n\n    radius: astropy.units.Quantity\n          matching radius, defaults to 1*u.arcsec\n\n    Returns:\n    --------\n    rows: list\n         lists of photometry points to add to table\n    \"\"\"\n\n    query = f\"\"\"\n    SELECT ra,dec,flux_1,dflux_1,flux_2,dflux_2,fluxlbs_1\n    FROM unwise_2019\n    WHERE CONTAINS(POINT('ICRS', ra, dec),\n    CIRCLE('ICRS', {target.ra.deg}, {target.dec.deg},\n    {radius.to('deg').value}))=1\n    \"\"\"\n\n    results = irsa_tap.search(query)\n\n    roww1 = [results[\"ra\"]*u.deg,\n             results[\"dec\"]*u.deg,\n             3.4*u.micron,\n             pow(10,9)*results[\"flux_1\"][0],\n             pow(10,9)*results[\"dflux_1\"][0],\n             0,\n             309.54*u.Jy]\n\n    roww2 = [results[\"ra\"]*u.deg,\n             results[\"dec\"]*u.deg,\n             4.6*u.micron,\n             pow(10,9)*results[\"flux_2\"][0],\n             pow(10,9)*results[\"dflux_2\"][0],\n             0,\n             171.79*u.Jy]\n\n    return([roww1, roww2])","key":"NPguZ6bqmV"},{"type":"outputs","id":"j-bLrs3wZHskcEMhxCp1-","children":[],"key":"kJL7IjAbeU"}],"key":"P760eDLvDy"},{"type":"block","children":[],"key":"Rw2ooIRxKk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"rows = get_unwise_phot(target)","key":"gE6zsjOJUW"},{"type":"outputs","id":"aT7Vcphh7JnYn27wkuHhq","children":[],"key":"uUdnhjR4hU"}],"key":"UkSIZrQzMu"},{"type":"block","children":[],"key":"IOAX79whHL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for row in rows:\n    phot_tbl.add_row(row)","key":"TffvEOij3q"},{"type":"outputs","id":"59XvJxpXHloC1TRuApq0m","children":[],"key":"K8sDO0LOlu"}],"key":"lLyru40zc5"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":493,"column":1},"end":{"line":493,"column":1}},"children":[{"type":"text","value":"Retrieve Optional Photometry","position":{"start":{"line":493,"column":1},"end":{"line":493,"column":1}},"key":"Fa8Cq7clT4"}],"identifier":"retrieve-optional-photometry","label":"Retrieve Optional Photometry","html_id":"retrieve-optional-photometry","implicit":true,"key":"CGFe4K0M5x"}],"key":"AL65VrzBjc"},{"type":"block","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"children":[{"type":"text","value":"Insert more data retrievals here, following the above formats.","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"iU1lw3LEl7"}],"key":"dVqdP0lxpZ"},{"type":"paragraph","position":{"start":{"line":499,"column":1},"end":{"line":499,"column":1}},"children":[{"type":"text","value":"Note: After more columns are added in the conversion to spectral energy density, the ","position":{"start":{"line":499,"column":1},"end":{"line":499,"column":1}},"key":"kCOIDRETNX"},{"type":"inlineCode","value":"phot_tbl.add_row","position":{"start":{"line":499,"column":1},"end":{"line":499,"column":1}},"key":"y3le8IL1iO"},{"type":"text","value":" functions will thrown an exception that number of values doesn’t match the number of columns.","position":{"start":{"line":499,"column":1},"end":{"line":499,"column":1}},"key":"tgbaOibM6N"}],"key":"CK6GniXVsv"}],"key":"imGj5rZfTg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# SEIP\n# GLIMPSE\n\n# MSX, AKARI, Herschel PACS\n\n# Pan-STARRS, UKIDSS?","key":"EYYTLoAS0G"},{"type":"outputs","id":"hR03y1OaJdk-ky2-VQGzr","children":[],"key":"dpqI1qBjl3"}],"key":"Xpx0RJQHKK"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":510,"column":1},"end":{"line":510,"column":1}},"children":[{"type":"text","value":"Convert Magnitudes to Energy Densities","position":{"start":{"line":510,"column":1},"end":{"line":510,"column":1}},"key":"bEvClvzRff"}],"identifier":"convert-magnitudes-to-energy-densities","label":"Convert Magnitudes to Energy Densities","html_id":"convert-magnitudes-to-energy-densities","implicit":true,"key":"OUJhwJ4WrB"}],"key":"jzrS2YyhOF"},{"type":"block","position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":514,"column":1},"end":{"line":514,"column":1}},"children":[{"type":"text","value":"Use the zeropoint information embedded by the catalog retrieval functions to compute energy densities:","position":{"start":{"line":514,"column":1},"end":{"line":514,"column":1}},"key":"VT2YLy57rk"}],"key":"g18ZNL5YEu"}],"key":"oofGpzlnms"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"factor = (const.c*phot_tbl[\"wavelength\"]**-1).to(u.Hz)","key":"Q5l02hEX6n"},{"type":"outputs","id":"66hqSFPgh981_JQPPbABF","children":[],"key":"abIuCXAW9P"}],"key":"IjIdgUtazV"},{"type":"block","children":[],"key":"blUpswoesa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"phot_tbl[\"lam_flam\"] = ((factor*phot_tbl[\"zeropoint\"] *\n                            10**(-0.4*phot_tbl[\"mag\"]))\n                       ).to(u.erg*u.s**-1*u.cm**-2)","key":"OF8rwXuaAO"},{"type":"outputs","id":"4GV5VYC5fbfvJLxRzTVKu","children":[],"key":"x0U6vMEtSe"}],"key":"V4eeOXGRFZ"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":526,"column":1},"end":{"line":526,"column":1}},"children":[{"type":"text","value":"As the above formula was for the photometry measurements given, compute the photometry uncertainty using a similar formula:","position":{"start":{"line":526,"column":1},"end":{"line":526,"column":1}},"key":"UkCnO2yLO9"}],"key":"VxGn4R76pN"}],"key":"JPQnCBvodi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"phot_tbl[\"lam_flam_err\"] = phot_tbl[\"lam_flam\"]*phot_tbl[\"magerr\"]*np.log(10)/2.5","key":"WvlL7g2ON7"},{"type":"outputs","id":"RAtPEgMUWdXH61CMrW67I","children":[],"key":"d02G6aSTCG"}],"key":"HXXCJodGmc"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"children":[{"type":"text","value":"Check the energy density values for each converted value below:","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"BciwdgkUJ2"}],"key":"VoiqiQuK67"}],"key":"WTceDrRYOF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"phot_tbl[\"lam_flam\"]","key":"LJsYLvCimH"},{"type":"outputs","id":"PqNyJDs94pdQuGlytfQ2N","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"text/plain":{"content":"\u003cQuantity [2.54473225e-12, 2.61631327e-12, 1.85395163e-12, 1.22027784e-12,\n           1.01920291e-12, 1.00547177e-12, 1.08439155e-12, 6.69480348e-13,\n           2.73150345e-13, 1.30280174e-12, 1.21467105e-12, 9.65296319e-13,\n           0.00000000e+00, 0.00000000e+00] erg / (s cm2)\u003e","content_type":"text/plain"},"text/latex":{"content":"$[2.5447322 \\times 10^{-12},~2.6163133 \\times 10^{-12},~1.8539516 \\times 10^{-12},~1.2202778 \\times 10^{-12},~1.0192029 \\times 10^{-12},~1.0054718 \\times 10^{-12},~1.0843915 \\times 10^{-12},~6.6948035 \\times 10^{-13},~2.7315035 \\times 10^{-13},~1.3028017 \\times 10^{-12},~1.214671 \\times 10^{-12},~9.6529632 \\times 10^{-13},~0,~0] \\; \\mathrm{\\frac{erg}{s\\,cm^{2}}}$","content_type":"text/latex"}}},"key":"oIIzM5SjLS"}],"key":"N70kIexBJg"}],"key":"GNRtHMx6XF"},{"type":"block","children":[],"key":"GuQcWpGFPf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"phot_tbl[\"lam_flam_err\"]","key":"uxXEwLAkr7"},{"type":"outputs","id":"XI_7gTtywyUJbDyf1aF1G","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/plain":{"content":"\u003cQuantity [1.41564619e-13, 1.44582811e-13, 1.10478650e-13, 3.03457714e-14,\n           2.53454562e-14, 4.53776114e-14, 1.85769648e-13, 3.22930752e-15,\n           1.87913286e-14, 1.48973786e-14, 1.67813003e-14, 9.77977837e-15,\n           0.00000000e+00, 0.00000000e+00] erg / (s cm2)\u003e","content_type":"text/plain"},"text/latex":{"content":"$[1.4156462 \\times 10^{-13},~1.4458281 \\times 10^{-13},~1.1047865 \\times 10^{-13},~3.0345771 \\times 10^{-14},~2.5345456 \\times 10^{-14},~4.5377611 \\times 10^{-14},~1.8576965 \\times 10^{-13},~3.2293075 \\times 10^{-15},~1.8791329 \\times 10^{-14},~1.4897379 \\times 10^{-14},~1.67813 \\times 10^{-14},~9.7797784 \\times 10^{-15},~0,~0] \\; \\mathrm{\\frac{erg}{s\\,cm^{2}}}$","content_type":"text/latex"}}},"key":"ckcT7JjY0u"}],"key":"f5tuiqUGft"}],"key":"kEvScT9fac"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":542,"column":1},"end":{"line":542,"column":1}},"children":[{"type":"text","value":"Run the following cell to view the full photometry table and its values for each column (ex. zeropoint, upper limit):","position":{"start":{"line":542,"column":1},"end":{"line":542,"column":1}},"key":"aG7hlZzGWQ"}],"key":"eq3KQE7uK5"}],"key":"xilHw7FsLQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"phot_tbl","key":"kmIT8th1cA"},{"type":"outputs","id":"M66LDb-wDZBKQElrIgPSM","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/plain":{"content":"\u003cQTable length=14\u003e\n        ra               dec        ...      lam_flam_err     \n       deg               deg        ...     erg / (s cm2)     \n     float64           float64      ...        float64        \n----------------- ----------------- ... ----------------------\n        81.901542         34.827953 ... 1.4156461879395113e-13\n        81.901542         34.827953 ... 1.4458281115775113e-13\n        81.901542         34.827953 ... 1.1047865042002163e-13\n       81.9014998        34.8279561 ... 3.0345771361898645e-14\n       81.9014998        34.8279561 ... 2.5345456151042028e-14\n       81.9014998        34.8279561 ...  4.537761137846731e-14\n       81.9014998        34.8279561 ... 1.8576964773270986e-13\n81.90155029515088 34.82794419355041 ...  3.229307516617325e-15\n81.90155029515088 34.82794419355041 ...  1.879132860246366e-14\n81.90155029515088 34.82794419355041 ... 1.4897378634343012e-14\n       81.9015322        34.8279704 ... 1.6781300313770818e-14\n       81.9015322        34.8279704 ...  9.779778373796877e-15\n81.90154794582688 34.82797707740865 ...                    0.0\n81.90154794582688 34.82797707740865 ...                    0.0","content_type":"text/plain"},"text/html":{"content":"\u003cdiv\u003e\u003ci\u003eQTable length=14\u003c/i\u003e\n\u003ctable id=\"table139678989586016\" class=\"table-striped table-bordered table-condensed\"\u003e\n\u003cthead\u003e\u003ctr\u003e\u003cth\u003era\u003c/th\u003e\u003cth\u003edec\u003c/th\u003e\u003cth\u003ewavelength\u003c/th\u003e\u003cth\u003emag\u003c/th\u003e\u003cth\u003emagerr\u003c/th\u003e\u003cth\u003eupper_limit\u003c/th\u003e\u003cth\u003ezeropoint\u003c/th\u003e\u003cth\u003elam_flam\u003c/th\u003e\u003cth\u003elam_flam_err\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\n\u003cthead\u003e\u003ctr\u003e\u003cth\u003edeg\u003c/th\u003e\u003cth\u003edeg\u003c/th\u003e\u003cth\u003emicron\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003eJy\u003c/th\u003e\u003cth\u003eerg / (s cm2)\u003c/th\u003e\u003cth\u003eerg / (s cm2)\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\n\u003cthead\u003e\u003ctr\u003e\u003cth\u003efloat64\u003c/th\u003e\u003cth\u003efloat64\u003c/th\u003e\u003cth\u003efloat64\u003c/th\u003e\u003cth\u003efloat64\u003c/th\u003e\u003cth\u003efloat64\u003c/th\u003e\u003cth\u003efloat64\u003c/th\u003e\u003cth\u003efloat64\u003c/th\u003e\u003cth\u003efloat64\u003c/th\u003e\u003cth\u003efloat64\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\n\u003ctr\u003e\u003ctd\u003e81.901542\u003c/td\u003e\u003ctd\u003e34.827953\u003c/td\u003e\u003ctd\u003e1.235\u003c/td\u003e\u003ctd\u003e15.454999923706055\u003c/td\u003e\u003ctd\u003e0.06040000170469284\u003c/td\u003e\u003ctd\u003e0.0\u003c/td\u003e\u003ctd\u003e1594.0\u003c/td\u003e\u003ctd\u003e2.544732245022997e-12\u003c/td\u003e\u003ctd\u003e1.4156461879395113e-13\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e81.901542\u003c/td\u003e\u003ctd\u003e34.827953\u003c/td\u003e\u003ctd\u003e1.662\u003c/td\u003e\u003ctd\u003e14.621999740600586\u003c/td\u003e\u003ctd\u003e0.05999999865889549\u003c/td\u003e\u003ctd\u003e0.0\u003c/td\u003e\u003ctd\u003e1024.0\u003c/td\u003e\u003ctd\u003e2.6163132694737926e-12\u003c/td\u003e\u003ctd\u003e1.4458281115775113e-13\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e81.901542\u003c/td\u003e\u003ctd\u003e34.827953\u003c/td\u003e\u003ctd\u003e2.159\u003c/td\u003e\u003ctd\u003e14.246000289916992\u003c/td\u003e\u003ctd\u003e0.06469999998807907\u003c/td\u003e\u003ctd\u003e0.0\u003c/td\u003e\u003ctd\u003e666.7\u003c/td\u003e\u003ctd\u003e1.8539516327037902e-12\u003c/td\u003e\u003ctd\u003e1.1047865042002163e-13\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e81.9014998\u003c/td\u003e\u003ctd\u003e34.8279561\u003c/td\u003e\u003ctd\u003e3.4\u003c/td\u003e\u003ctd\u003e13.37399959564209\u003c/td\u003e\u003ctd\u003e0.027000000700354576\u003c/td\u003e\u003ctd\u003e0.0\u003c/td\u003e\u003ctd\u003e309.54\u003c/td\u003e\u003ctd\u003e1.2202778434925405e-12\u003c/td\u003e\u003ctd\u003e3.0345771361898645e-14\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e81.9014998\u003c/td\u003e\u003ctd\u003e34.8279561\u003c/td\u003e\u003ctd\u003e4.6\u003c/td\u003e\u003ctd\u003e12.60200023651123\u003c/td\u003e\u003ctd\u003e0.027000000700354576\u003c/td\u003e\u003ctd\u003e0.0\u003c/td\u003e\u003ctd\u003e171.79\u003c/td\u003e\u003ctd\u003e1.0192029131663901e-12\u003c/td\u003e\u003ctd\u003e2.5345456151042028e-14\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e81.9014998\u003c/td\u003e\u003ctd\u003e34.8279561\u003c/td\u003e\u003ctd\u003e12.0\u003c/td\u003e\u003ctd\u003e9.739999771118164\u003c/td\u003e\u003ctd\u003e0.04899999871850014\u003c/td\u003e\u003ctd\u003e0.0\u003c/td\u003e\u003ctd\u003e31.676\u003c/td\u003e\u003ctd\u003e1.0054717723991499e-12\u003c/td\u003e\u003ctd\u003e4.537761137846731e-14\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e81.9014998\u003c/td\u003e\u003ctd\u003e34.8279561\u003c/td\u003e\u003ctd\u003e22.0\u003c/td\u003e\u003ctd\u003e7.553999900817871\u003c/td\u003e\u003ctd\u003e0.1860000044107437\u003c/td\u003e\u003ctd\u003e0.0\u003c/td\u003e\u003ctd\u003e8.3635\u003c/td\u003e\u003ctd\u003e1.0843915457289992e-12\u003c/td\u003e\u003ctd\u003e1.8576964773270986e-13\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e81.90155029515088\u003c/td\u003e\u003ctd\u003e34.82794419355041\u003c/td\u003e\u003ctd\u003e0.622\u003c/td\u003e\u003ctd\u003e18.415817260742188\u003c/td\u003e\u003ctd\u003e0.005237160580221164\u003c/td\u003e\u003ctd\u003e0.0\u003c/td\u003e\u003ctd\u003e3228.75\u003c/td\u003e\u003ctd\u003e6.694803478683729e-13\u003c/td\u003e\u003ctd\u003e3.229307516617325e-15\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e81.90155029515088\u003c/td\u003e\u003ctd\u003e34.82794419355041\u003c/td\u003e\u003ctd\u003e0.511\u003c/td\u003e\u003ctd\u003e19.706180572509766\u003c/td\u003e\u003ctd\u003e0.07469302588797017\u003c/td\u003e\u003ctd\u003e0.0\u003c/td\u003e\u003ctd\u003e3552.01\u003c/td\u003e\u003ctd\u003e2.731503451179333e-13\u003c/td\u003e\u003ctd\u003e1.879132860246366e-14\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e81.90155029515088\u003c/td\u003e\u003ctd\u003e34.82794419355041\u003c/td\u003e\u003ctd\u003e0.7769\u003c/td\u003e\u003ctd\u003e17.197399139404297\u003c/td\u003e\u003ctd\u003e0.012415260738196378\u003c/td\u003e\u003ctd\u003e0.0\u003c/td\u003e\u003ctd\u003e2554.95\u003c/td\u003e\u003ctd\u003e1.3028017437873149e-12\u003c/td\u003e\u003ctd\u003e1.4897378634343012e-14\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e81.9015322\u003c/td\u003e\u003ctd\u003e34.8279704\u003c/td\u003e\u003ctd\u003e3.4\u003c/td\u003e\u003ctd\u003e13.378999710083008\u003c/td\u003e\u003ctd\u003e0.014999999664723873\u003c/td\u003e\u003ctd\u003e0.0\u003c/td\u003e\u003ctd\u003e309.54\u003c/td\u003e\u003ctd\u003e1.2146710480553427e-12\u003c/td\u003e\u003ctd\u003e1.6781300313770818e-14\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e81.9015322\u003c/td\u003e\u003ctd\u003e34.8279704\u003c/td\u003e\u003ctd\u003e4.6\u003c/td\u003e\u003ctd\u003e12.66100025177002\u003c/td\u003e\u003ctd\u003e0.010999999940395355\u003c/td\u003e\u003ctd\u003e0.0\u003c/td\u003e\u003ctd\u003e171.79\u003c/td\u003e\u003ctd\u003e9.652963193161815e-13\u003c/td\u003e\u003ctd\u003e9.779778373796877e-15\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e81.90154794582688\u003c/td\u003e\u003ctd\u003e34.82797707740865\u003c/td\u003e\u003ctd\u003e3.4\u003c/td\u003e\u003ctd\u003e4388652343750.0\u003c/td\u003e\u003ctd\u003e14832420349.121094\u003c/td\u003e\u003ctd\u003e0.0\u003c/td\u003e\u003ctd\u003e309.54\u003c/td\u003e\u003ctd\u003e0.0\u003c/td\u003e\u003ctd\u003e0.0\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e81.90154794582688\u003c/td\u003e\u003ctd\u003e34.82797707740865\u003c/td\u003e\u003ctd\u003e4.6\u003c/td\u003e\u003ctd\u003e8759030273437.5\u003c/td\u003e\u003ctd\u003e45745952606.20117\u003c/td\u003e\u003ctd\u003e0.0\u003c/td\u003e\u003ctd\u003e171.79\u003c/td\u003e\u003ctd\u003e0.0\u003c/td\u003e\u003ctd\u003e0.0\u003c/td\u003e\u003c/tr\u003e\n\u003c/table\u003e\u003c/div\u003e","content_type":"text/html"}}},"key":"bWPDbH7KoZ"}],"key":"xKPQglha7G"}],"key":"peQxsh95MI"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":548,"column":1},"end":{"line":548,"column":1}},"children":[{"type":"text","value":"Upload to Firefly","position":{"start":{"line":548,"column":1},"end":{"line":548,"column":1}},"key":"yYr6x8vOTD"}],"identifier":"upload-to-firefly","label":"Upload to Firefly","html_id":"upload-to-firefly","implicit":true,"key":"cMupwO0lQW"}],"key":"TJ3zcn0kU6"},{"type":"block","position":{"start":{"line":550,"column":1},"end":{"line":550,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"children":[{"type":"text","value":"There are two ways to initialize a Firefly client from Python, depending on whether you’re running the notebook in JupyterLab or not. Assuming you have ","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"key":"Ku5JcWw7gP"},{"type":"inlineCode","value":"jupyter-firefly-extensions","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"key":"LRlx98Hqxg"},{"type":"text","value":" set up in your environment as explained ","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"key":"CpFZXrnQNN"},{"type":"link","url":"https://github.com/Caltech-IPAC/jupyter_firefly_extensions/blob/master/README.md","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"key":"C8knPrzAPj"}],"urlSource":"https://github.com/Caltech-IPAC/jupyter_firefly_extensions/blob/master/README.md","data":{"kind":"file","org":"Caltech-IPAC","repo":"jupyter_firefly_extensions","reference":"master","file":"README.md","raw":"https://raw.githubusercontent.com/Caltech-IPAC/jupyter_firefly_extensions/master/README.md"},"internal":false,"protocol":"github","key":"rBdhhWEbek"},{"type":"text","value":", you can use ","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"key":"xfDdRdg1XX"},{"type":"inlineCode","value":"make_lab_client()","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"key":"rbhyTfrdqN"},{"type":"text","value":" in JupyterLab, which will open the Firefly viewer in a new tab within the Lab. Otherwise, you can use ","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"key":"yvBT66eKN7"},{"type":"inlineCode","value":"make_client()","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"key":"yckvpXTSv8"},{"type":"text","value":" in a Jupyter Notebook (or even a Python shell), which will open the Firefly viewer in a new web browser tab.","position":{"start":{"line":552,"column":1},"end":{"line":552,"column":1}},"key":"M6dTYPo2Os"}],"key":"OO1pDexGZA"},{"type":"paragraph","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"children":[{"type":"text","value":"You also need a Firefly server to communicate with your Firefly Python client. In this notebook, we use a public Firefly server: the IRSA Viewer (","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"key":"HB1wB1ic6b"},{"type":"link","url":"https://irsa.ipac.caltech.edu/irsaviewer","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"children":[{"type":"text","value":"https://​irsa​.ipac​.caltech​.edu​/irsaviewer","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"key":"MpR6UsIlM1"}],"urlSource":"https://irsa.ipac.caltech.edu/irsaviewer","key":"o1BIE8scbr"},{"type":"text","value":"). However, you can also run a local Firefly server via a ","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"key":"HSa7ubNJOG"},{"type":"link","url":"https://hub.docker.com/r/ipac/firefly","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"children":[{"type":"text","value":"Firefly Docker image","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"key":"NGuuTL21Qs"}],"urlSource":"https://hub.docker.com/r/ipac/firefly","key":"NwQUbQgv8E"},{"type":"text","value":" and access it at ","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"key":"SQHC7uBhWH"},{"type":"inlineCode","value":"http://localhost:8080/firefly","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"key":"VYZue1UsVq"},{"type":"text","value":". The URL of the Firefly server is read by both ","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"key":"Ynp1chr2ng"},{"type":"inlineCode","value":"make_client()","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"key":"G5uuoFoMnM"},{"type":"text","value":" and ","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"key":"ZShmIif1fq"},{"type":"inlineCode","value":"make_lab_client()","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"key":"lcxAsxueYt"},{"type":"text","value":" through the environment variable ","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"key":"WEu4AfPbKm"},{"type":"inlineCode","value":"FIREFLY_URL","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"key":"xGTCPpnFjU"},{"type":"text","value":". However, ","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"key":"olxzRM1NCe"},{"type":"inlineCode","value":"make_client()","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"key":"y9nYMoMJM0"},{"type":"text","value":" also allows you to pass the URL directly as the ","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"key":"MUQiJRGrGm"},{"type":"inlineCode","value":"url","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"key":"NKUMYKNxPp"},{"type":"text","value":" parameter.","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"key":"MtNlQHiXu5"}],"key":"QbRz9ebd6t"}],"key":"nUZHF5xyay"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Uncomment when using within Jupyter Lab with jupyter_firefly_extensions installed\n# fc = FireflyClient.make_lab_client()\n\n# Uncomment for contexts other than above \nfc = FireflyClient.make_client(url=\"https://irsa.ipac.caltech.edu/irsaviewer\")\n\nfc.reinit_viewer() # to clean the state, if this cell ran earlier","key":"GIBS4dZfoO"},{"type":"outputs","id":"DXGLSR2ZwXBq7tgoG1xDN","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cIPython.core.display.HTML object\u003e","content_type":"text/plain"},"text/html":{"content":"Open your web browser to \u003ca href=\"https://irsa.ipac.caltech.edu/irsaviewer/?__wsch=MjAyNS0xMi0xNw\"\" target=\"_blank\"\u003ethis link\u003c/a\u003e","content_type":"text/html"}}},"key":"TuxfcNctEJ"},{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/plain":{"content":"{'success': True}","content_type":"text/plain"}}},"key":"Dxupf7rpCm"}],"key":"UjyYanKJY8"}],"key":"nw1u1pb2Ji"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":566,"column":1},"end":{"line":566,"column":1}},"children":[{"type":"text","value":"In the event that there are problems with the tab opened above, run the below command to obtain a web link that can be opened in a browser directly:","position":{"start":{"line":566,"column":1},"end":{"line":566,"column":1}},"key":"KwcUmoM5Wp"}],"key":"qaQTvp4xKe"}],"key":"D2puQctHw1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fc.display_url()","key":"RhyXoOwmds"},{"type":"outputs","id":"YvgEICEJgwkWGbX0d-9YZ","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cIPython.core.display.HTML object\u003e","content_type":"text/plain"},"text/html":{"content":"Open your web browser to \u003ca href=\"https://irsa.ipac.caltech.edu/irsaviewer/?__wsch=MjAyNS0xMi0xNw\"\" target=\"_blank\"\u003ethis link\u003c/a\u003e","content_type":"text/html"}}},"key":"DywvsdDGIy"}],"key":"HxpMSEqOnF"}],"key":"ubGGneKinL"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":572,"column":1},"end":{"line":572,"column":1}},"children":[{"type":"text","value":"Write the photometry table to a FITS file:","position":{"start":{"line":572,"column":1},"end":{"line":572,"column":1}},"key":"x7a2RLOCBn"}],"key":"yv5Am7bXE0"}],"key":"NKmKHsLySW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"tblpath = \"./phot_tbl.fits\"\nphot_tbl.write(tblpath, format=\"fits\", overwrite=True)","key":"OTIAPDQc3q"},{"type":"outputs","id":"4dyr_aXbuFl_oiPSyy0BM","children":[],"key":"dXxCqhJVrZ"}],"key":"SWgo4ktJ4c"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"children":[{"type":"text","value":"Upload the table (FITS file) to Firefly:","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"XrX4GqHXog"}],"key":"QxeLDTdjdu"}],"key":"HJmfLkrkBD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"tval = fc.upload_file(tblpath)","key":"V6rtJ3w9dA"},{"type":"outputs","id":"JYhgpTz3aIP1WBgICnA39","children":[],"key":"EnZ6DiVGaU"}],"key":"nJQsXdFKWD"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"children":[{"type":"text","value":"Show the table in Firefly:","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"key":"XQiAIwnOa2"}],"key":"mv40RGiFYL"}],"key":"RkaI5sEu92"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fc.show_table(tval, tbl_id=\"photometry\", title=\"SED Photometry\")","key":"WYSUzZWq93"},{"type":"outputs","id":"1p6Pc1z5gtfUJYJmS57AM","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"text/plain":{"content":"{'success': True}","content_type":"text/plain"}}},"key":"N3JA1jUJio"}],"key":"ykZX6QYpb1"}],"key":"SMmh2FRpww"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":591,"column":1},"end":{"line":591,"column":1}},"children":[{"type":"text","value":"Specify the columns and markers for the SED plot:","position":{"start":{"line":591,"column":1},"end":{"line":591,"column":1}},"key":"wQ0U7GveJ3"}],"key":"nXLpMaYETb"}],"key":"soZplnqniU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"trace1 = dict(tbl_id=\"photometry\", x=\"tables::wavelength\", y=\"tables::lam_flam\", mode=\"markers\",\n            type=\"scatter\", error_y=dict(array=\"tables::lam_flam_err\"),\n            marker=dict(size=4))\ntrace_data = [trace1]","key":"zaT6Dd2qnc"},{"type":"outputs","id":"uW3EOr8B75cd0wMqxPL08","children":[],"key":"QDYnDUsHSb"}],"key":"QmyQyQ09wB"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"children":[{"type":"text","value":"Specify the title and axes for the SED plot:","position":{"start":{"line":600,"column":1},"end":{"line":600,"column":1}},"key":"W3KsAbw3f0"}],"key":"DgvJlfGsmj"}],"key":"FpWZE5yQE1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"layout_s = dict(title=\"SED\", xaxis=dict(title=\"Wavelength (microns)\", type=\"log\"),\n                yaxis=dict(title=\"Energy density (erg/s/cm2)\", type=\"log\"))","key":"rTJms4SILZ"},{"type":"outputs","id":"hv-8QcLz-d_TZwIZJM0om","children":[],"key":"ycr4TSKyyH"}],"key":"tbOdymwOSx"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":607,"column":1},"end":{"line":607,"column":1}},"children":[{"type":"text","value":"Display the SED plot in Firefly:","position":{"start":{"line":607,"column":1},"end":{"line":607,"column":1}},"key":"T3nk2JFQv1"}],"key":"NYhFkG93NE"}],"key":"XexCiKiyAP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fc.show_chart(layout=layout_s, data=trace_data)","key":"eqvBMen26Y"},{"type":"outputs","id":"NHZ68iG7nt46vxKbbDhBh","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"text/plain":{"content":"{'success': True,\n 'warning': 'group_id unnecessary and ignored in triview mode'}","content_type":"text/plain"}}},"key":"LJf5fBbTYo"}],"key":"dw0iEPZLC8"}],"key":"KAgOA71xiP"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":613,"column":1},"end":{"line":613,"column":1}},"children":[{"type":"text","value":"Retrieve and Display Images","position":{"start":{"line":613,"column":1},"end":{"line":613,"column":1}},"key":"NIWR9st7DF"}],"identifier":"retrieve-and-display-images","label":"Retrieve and Display Images","html_id":"retrieve-and-display-images","implicit":true,"key":"bW6Gg3xMgO"}],"key":"UjcYiH90e3"},{"type":"block","position":{"start":{"line":615,"column":1},"end":{"line":615,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":617,"column":1},"end":{"line":617,"column":1}},"children":[{"type":"text","value":"Use queries directed at Simple Image Access services to retrieve images:","position":{"start":{"line":617,"column":1},"end":{"line":617,"column":1}},"key":"kic9Ak2nzK"}],"key":"TiVziqD7pG"}],"key":"OHqRD7yVew"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"irsa_sia = pyvo.dal.SIAService(\"https://irsa.ipac.caltech.edu/cgi-bin/2MASS/IM/nph-im_sia?type=at\u0026ds=asky\u0026\")","key":"ESUQxEbYSx"},{"type":"outputs","id":"I3R08uhtLwtapBCbZmhv1","children":[],"key":"sSJHHFPdxk"}],"key":"BBuXETC0Iz"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":623,"column":1},"end":{"line":623,"column":1}},"children":[{"type":"text","value":"Get 2MASS Images","position":{"start":{"line":623,"column":1},"end":{"line":623,"column":1}},"key":"lfLnavWX9I"}],"identifier":"get-2mass-images","label":"Get 2MASS Images","html_id":"get-2mass-images","implicit":true,"key":"bf6RZakLDb"}],"key":"UxJVLsWl3Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def get_2mass_images(target, search_size=1*u.arcsec):\n    \"\"\"Retrieve 2MASS images\n\n    Parameters:\n    -----------\n    target: astropy.coordinates.SkyCoord\n        coordinates of the target(s)\n\n    search_size: astropy.units.Quantity\n        matching radius, defaults to 1*u.arcsec\n\n    Returns:\n    --------\n    j_filename: `str`\n         path to J-band image in FITS format\n\n    h_filename: `str`\n         path to H-band image in FITS format\n\n    k_filename: `str`\n         path to K-band image in FITS format\n    \"\"\"\n    im_table = irsa_sia.search(pos=target, size=search_size)\n    url_j = url_h = url_k = None\n    # Get URL for the first instance of each band\n    for i in range(len(im_table)):\n        if url_j is None and im_table[i][\"band\"] == \"J\":\n            url_j = im_table[i].getdataurl()\n        if url_h is None and im_table[i][\"band\"] == \"H\":\n            url_h = im_table[i].getdataurl()\n        if url_k is None and im_table[i][\"band\"] == \"K\":\n            url_k = im_table[i].getdataurl()\n    j_filename = download_file(url_j, cache=True)\n    h_filename = download_file(url_h, cache=True)\n    k_filename = download_file(url_k, cache=True)\n    return (j_filename, h_filename, k_filename)","key":"rQRdkXapmc"},{"type":"outputs","id":"rQ2poLO0k9h6rWv2uXj_J","children":[],"key":"ItCzGgMsd5"}],"key":"vskoBqIGNf"},{"type":"block","children":[],"key":"o0X9WWDiRQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"j_fname, h_fname, k_fname = get_2mass_images(target)","key":"Jh91ArGIu7"},{"type":"outputs","id":"yVeTUsLF8scA7kvXt5TzT","children":[],"key":"YSv1xmcFPM"}],"key":"XpuIWq4jlB"},{"type":"block","children":[],"key":"DrvK94700G"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fc.show_fits(fc.upload_file(j_fname), plot_id=\"2MASS J\", title=\"2MASS J\")\nfc.show_fits(fc.upload_file(h_fname), plot_id=\"2MASS H\", title=\"2MASS H\")\nfc.show_fits(fc.upload_file(k_fname), plot_id=\"2MASS K\", title=\"2MASS K\")","key":"rH8VwsA4us"},{"type":"outputs","id":"-P7ySponNZv2eFpfTDsMZ","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"WARNING: show_fits() is deprecated. Use show_fits_image() instead.\nWARNING: show_fits() is deprecated. Use show_fits_image() instead.\n"},"key":"stO2EPdgAB"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"WARNING: show_fits() is deprecated. Use show_fits_image() instead.\n"},"key":"G0SZJXWKyx"},{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/plain":{"content":"{'success': True}","content_type":"text/plain"}}},"key":"IswpCim4zz"}],"key":"I6vTnJIRcV"}],"key":"azzRDbIDVs"},{"type":"block","children":[],"key":"kQm9CgeU00"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fc.set_zoom(plot_id=\"2MASS J\", factor=4.0)\nfc.set_pan(plot_id=\"2MASS J\", x=target.ra.deg,\n           y=target.dec.deg, coord=\"j2000\")\nfc.set_zoom(plot_id=\"2MASS H\", factor=4.0)\nfc.set_pan(plot_id=\"2MASS H\", x=target.ra.deg,\n           y=target.dec.deg, coord=\"j2000\")\nfc.set_zoom(plot_id=\"2MASS K\", factor=4.0)\nfc.set_pan(plot_id=\"2MASS K\", x=target.ra.deg,\n           y=target.dec.deg, coord=\"j2000\")","key":"AdlP763tTW"},{"type":"outputs","id":"9D36zJ8zlvulxxfjzmm0K","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"text/plain":{"content":"{'success': True}","content_type":"text/plain"}}},"key":"iFUkLTvnql"}],"key":"OAwhyp9Exe"}],"key":"RV8junnGOz"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":686,"column":1},"end":{"line":686,"column":1}},"children":[{"type":"text","value":"For turning on “Align and Lock by WCS” in these images, use:","position":{"start":{"line":686,"column":1},"end":{"line":686,"column":1}},"key":"Xf16jX7Mg8"}],"key":"qZl7y3ju7k"}],"key":"v1kpL1vWuD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fc.align_images(lock_match=True)","key":"hHL2GqWXXJ"},{"type":"outputs","id":"AW91vhxy6jXXbAZJSCG5Z","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"text/plain":{"content":"{'success': True}","content_type":"text/plain"}}},"key":"oExMqYJuS1"}],"key":"cCFCUF76an"}],"key":"gXI4EBWQbe"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"children":[{"type":"text","value":"Note that zooming or panning one image will do the same in the other images as well.","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"key":"BIsFCUDl0I"}],"key":"tXU7zZ6fqX"}],"key":"IySfxWqxML"},{"type":"block","position":{"start":{"line":694,"column":1},"end":{"line":694,"column":1}},"children":[{"type":"thematicBreak","position":{"start":{"line":696,"column":1},"end":{"line":696,"column":1}},"key":"rsvAkqozF6"}],"key":"JNHNXlhgCI"},{"type":"block","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":700,"column":1},"end":{"line":700,"column":1}},"children":[{"type":"text","value":"About This Notebook","position":{"start":{"line":700,"column":1},"end":{"line":700,"column":1}},"key":"IPJEQuOcv4"}],"identifier":"about-this-notebook","label":"About This Notebook","html_id":"about-this-notebook","implicit":true,"key":"iPcy831RVf"}],"key":"WDu9Hhfoma"},{"type":"block","position":{"start":{"line":702,"column":1},"end":{"line":702,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"children":[{"type":"strong","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"children":[{"type":"text","value":"Author:","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"key":"PLiVSAjMvG"}],"key":"w4gevtzP8S"},{"type":"text","value":" David Shupe (IRSA Scientist) and Joyce Kim (IRSA Scientist) in conjunction with the IRSA Science Team","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"key":"XXyoQZpACs"}],"key":"dGndUynwIN"},{"type":"paragraph","position":{"start":{"line":706,"column":1},"end":{"line":706,"column":1}},"children":[{"type":"strong","position":{"start":{"line":706,"column":1},"end":{"line":706,"column":1}},"children":[{"type":"text","value":"Updated:","position":{"start":{"line":706,"column":1},"end":{"line":706,"column":1}},"key":"TY7GKjVnQk"}],"key":"vhjOEovV6V"},{"type":"text","value":" 2024-12-19","position":{"start":{"line":706,"column":1},"end":{"line":706,"column":1}},"key":"wyvk5BPkfQ"}],"key":"dvfrWvrWMb"},{"type":"paragraph","position":{"start":{"line":708,"column":1},"end":{"line":708,"column":1}},"children":[{"type":"strong","position":{"start":{"line":708,"column":1},"end":{"line":708,"column":1}},"children":[{"type":"text","value":"Contact:","position":{"start":{"line":708,"column":1},"end":{"line":708,"column":1}},"key":"lr7NAOqkTv"}],"key":"ORUxIgLQSF"},{"type":"text","value":" ","position":{"start":{"line":708,"column":1},"end":{"line":708,"column":1}},"key":"OkPFCGjcze"},{"type":"link","url":"https://irsa.ipac.caltech.edu/docs/help_desk.html","position":{"start":{"line":708,"column":1},"end":{"line":708,"column":1}},"children":[{"type":"text","value":"the IRSA Helpdesk","position":{"start":{"line":708,"column":1},"end":{"line":708,"column":1}},"key":"BcUzG7B6VO"}],"urlSource":"https://irsa.ipac.caltech.edu/docs/help_desk.html","key":"wmphA3OxyW"},{"type":"text","value":" with questions or reporting problems.","position":{"start":{"line":708,"column":1},"end":{"line":708,"column":1}},"key":"hEVq6uBIoJ"}],"key":"VC7yOTVNc3"}],"key":"sF75612o9W"}],"key":"oRmkdEHg7J"},"references":{"cite":{"order":["Rebull_2023"],"data":{"Rebull_2023":{"label":"Rebull_2023","enumerator":"1","doi":"10.3847/1538-3881/ace32f","html":"Rebull, L. M., Anderson, R. L., Hall, G., Kirkpatrick, J. D., Koenig, X., Odden, C. E., Rodriguez, B., Sanchez, R., Senson, B., Urbanowski, V., Austin, M., Blood, K., Kerman, E., Long, J., \u0026 Roosa, N. (2023). Young Stellar Object Candidates in IC 417. \u003ci\u003eThe Astronomical Journal\u003c/i\u003e, \u003ci\u003e166\u003c/i\u003e(3), 87. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.3847/1538-3881/ace32f\"\u003e10.3847/1538-3881/ace32f\u003c/a\u003e","url":"https://doi.org/10.3847/1538-3881/ace32f"}}}},"footer":{"navigation":{"prev":{"title":"Access HATS Collections Using LSDB: Euclid Q1 and ZTF DR23","url":"/irsa-hats-with-lsdb","group":"Special Topics"},"next":{"title":"Parallelizing image convolution","url":"/parallelize-convolution","group":"Special Topics"}}},"domain":"http://localhost:3000"},"project":{"subject":"IRSA Tutorials","settings":{"output_matplotlib_strings":"remove"},"title":"IRSA Tutorials","description":"IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)","authors":[{"id":"IRSA Scientists and Developers","name":"IRSA Scientists and Developers"}],"github":"https://github.com/Caltech-IPAC/irsa-tutorials/","keywords":["astronomy"],"thebe":{"binder":{"url":"https://mybinder.org","provider":"github","repo":"https://github.com/Caltech-IPAC/irsa-tutorials/","ref":"HEAD"}},"toc":[{"file":"index.md","title":"IRSA Tutorials"},{"children":[{"file":"tutorials/spherex/spherex_intro.md"},{"file":"tutorials/spherex/spherex_cutouts.md"},{"file":"tutorials/spherex/spherex_psf.md"}],"title":"SPHEREx"},{"children":[{"children":[{"file":"tutorials/euclid_access/Euclid_ERO.md"}],"title":"Euclid Early Release Observations"},{"children":[{"file":"tutorials/euclid_access/1_Euclid_intro_MER_images.md"},{"file":"tutorials/euclid_access/2_Euclid_intro_MER_catalog.md"},{"file":"tutorials/euclid_access/3_Euclid_intro_1D_spectra.md"},{"file":"tutorials/euclid_access/4_Euclid_intro_PHZ_catalog.md"},{"file":"tutorials/euclid_access/5_Euclid_intro_SPE_catalog.md"},{"file":"tutorials/cloud_access/euclid-cloud-access.md"}],"title":"Euclid Quick Release 1"}],"title":"Euclid"},{"children":[{"children":[{"file":"tutorials/irsa-sia-examples/sia_allwise_atlas.md"},{"file":"tutorials/parquet-catalog-demos/wise-allwise-catalog-demo.md"}],"title":"AllWISE"},{"children":[{"file":"tutorials/firefly/NEOWISE_light_curve_demo.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-strategies.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-lightcurves.md"}],"title":"NEOWISE"}],"title":"WISE"},{"children":[{"file":"tutorials/irsa-sia-examples/siav2_seip.md"}],"title":"Spitzer"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_2mass_allsky.md"}],"title":"2MASS"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_cosmos.md"}],"title":"COSMOS"},{"children":[{"children":[{"file":"tutorials/roman_simulations/roman_hlss_number_density.md"}],"title":"Roman HLSS Galaxy Mock Catalog"},{"children":[{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_wideareasurvey.md"},{"file":"tutorials/firefly/OpenUniverse2024Preview_Firefly.md"},{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_timedomainsurvey.md"}],"title":"OpenUniverse 2024"},{"children":[{"file":"tutorials/cosmodc2/cosmoDC2_TAP_access.md"}],"title":"CosmoDC2"}],"title":"Simulated Data"},{"children":[{"file":"tutorials/cloud_access/cloud-access-intro.md"},{"file":"tutorials/parquet-catalog-demos/irsa-hats-with-lsdb.md"},{"file":"tutorials/firefly/SEDs_in_Firefly.md"},{"file":"tutorials/parallelize/Parallelize_Convolution.md"}],"title":"Special Topics"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"SPHEREx"},{"slug":"spherex-intro","title":"Introduction to SPHEREx Spectral Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-cutouts","title":"Download a collection of SPHEREx Spectral Image cutouts as a multi-extension FITS file","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-psf","title":"Understanding and Extracting the PSF Extension in a SPHEREx Cutout","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Euclid"},{"level":2,"title":"Euclid Early Release Observations"},{"slug":"euclid-ero","title":"Exploring Star Clusters in the Euclid ERO Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Euclid Quick Release 1"},{"slug":"euclid-intro-mer-images","title":"Euclid Q1: MER mosaics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-mer-catalog","title":"Euclid Q1: MER catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-1d-spectra","title":"Euclid Q1: 1D spectra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-phz-catalog","title":"Euclid Q1: PHZ catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-spe-catalog","title":"Euclid Q1: SPE catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-cloud-access","title":"Euclid Q1: cloud access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"WISE"},{"level":2,"title":"AllWISE"},{"slug":"sia-allwise-atlas","title":"Searching for AllWISE Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"wise-allwise-catalog-demo","title":"Analyzing cloud-hosted AllWISE Source Catalog in Parquet format","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"NEOWISE"},{"slug":"neowise-light-curve-demo","title":"Using Firefly visualization tools to understand the light curves of Solar System objects","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-strategies","title":"Strategies to Efficiently Work with NEOWISE Single-exposure Source Table in Parquet","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-lightcurves","title":"Make Light Curves from NEOWISE Single-exposure Source Table","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Spitzer"},{"slug":"siav2-seip","title":"Searching for Spitzer Enhanced Imaging Products","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"2MASS"},{"slug":"sia-2mass-allsky","title":"Searching for 2MASS All-Sky Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"COSMOS"},{"slug":"sia-cosmos","title":"Searching for contributed COSMOS images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Simulated Data"},{"level":2,"title":"Roman HLSS Galaxy Mock Catalog"},{"slug":"roman-hlss-number-density","title":"Number Density as a Function of Redshift","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"OpenUniverse 2024"},{"slug":"openuniverse2024-roman-simulated-wideareasurvey","title":"Analyzing cloud-hosted simulated Roman coadded images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024preview-firefly","title":"Using Firefly to Explore OpenUniverse2024 Data Preview Simulated Roman and Rubin Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024-roman-simulated-timedomainsurvey","title":"Analyzing cloud-hosted simulated Roman Time Domain Survey images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"CosmoDC2"},{"slug":"cosmodc2-tap-access","title":"Querying the CosmoDC2 Mock v1 Catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Special Topics"},{"slug":"cloud-access-intro","title":"IRSA cloud access introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"irsa-hats-with-lsdb","title":"Access HATS Collections Using LSDB: Euclid Q1 and ZTF DR23","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"seds-in-firefly","title":"Using Firefly visualization tools in Python to vet SEDs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"parallelize-convolution","title":"Parallelizing image convolution","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/irsa-tutorials/build/manifest-86A905A4.js";
import * as route0 from "/irsa-tutorials/build/root-CXYA7X5D.js";
import * as route1 from "/irsa-tutorials/build/routes/$-JRBPULBO.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/irsa-tutorials/build/entry.client-PCJPW7TK.js");</script></body></html>