{"version":2,"kind":"Notebook","sha256":"07c2f19535213c4f3fac5bfd0b663313b0cf0237f60791415db1193acc53f2af","slug":"euclid-intro-1d-spectra","location":"/tutorials/euclid_access/3_Euclid_intro_1D_spectra.md","dependencies":[],"frontmatter":{"title":"Euclid Q1: 1D spectra","kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"jupytext":{"text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.16.7"}},"content_includes_title":false,"authors":[{"id":"IRSA Scientists and Developers","name":"IRSA Scientists and Developers"}],"github":"https://github.com/Caltech-IPAC/irsa-tutorials/","subject":"IRSA Tutorials","keywords":["astronomy"],"settings":{"output_matplotlib_strings":"remove"},"numbering":{"title":{"offset":2}},"source_url":"https://github.com/Caltech-IPAC/irsa-tutorials//blob/main/tutorials/euclid_access/3_Euclid_intro_1D_spectra.md","edit_url":"https://github.com/Caltech-IPAC/irsa-tutorials//edit/main/tutorials/euclid_access/3_Euclid_intro_1D_spectra.md","exports":[{"format":"md","filename":"3_Euclid_intro_1D_spectra.md","url":"/irsa-tutorials/build/3_Euclid_intro_1D_sp-4fad39398ea41d4147908d16a14542e7.md"}]},"mdast":{"type":"root","children":[{"type":"block","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Learning Goals","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"pnwdfjI0jG"}],"identifier":"learning-goals","label":"Learning Goals","html_id":"learning-goals","implicit":true,"key":"HDgSDQ8yM8"}],"key":"LRGnvMknlP"},{"type":"block","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"By the end of this tutorial, you will:","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"LeIkvcIkpy"}],"key":"GpUewkFT2J"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":23,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Understand the basic characteristics of Euclid Q1 SIR 1D spectra.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"S4ZDbQuSiu"}],"key":"b0cVDBuZBt"}],"key":"qk58bXEK8C"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"What columns are available in the MER catalog.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"FL21rTLC1b"}],"key":"XImjQ3VUeN"}],"key":"ID9WpuH1nC"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"How to query with ADQL in the MER catalog.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"FBp79gBwgn"}],"key":"VRXFuMho8M"}],"key":"U3YuvzbQxY"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"How to make a simple color-magnitude diagram with the data.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"YRLA5CK0FS"}],"key":"nyqpMAuJsq"}],"key":"hQKtJx68mk"}],"key":"YeKCnxZFfA"}],"key":"KMH6APKzfT"},{"type":"block","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"y4HfVNLprS"}],"identifier":"introduction","label":"Introduction","html_id":"introduction","implicit":true,"key":"e4zy4XwnAo"},{"type":"paragraph","position":{"start":{"line":32,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"Euclid launched in July 2023 as a European Space Agency (ESA) mission with involvement by NASA.\nThe primary science goals of Euclid are to better understand the composition and evolution of the dark Universe.\nThe Euclid mission is providing space-based imaging and spectroscopy as well as supporting ground-based imaging to achieve these primary goals.\nThese data will be archived by multiple global repositories, including IRSA, where they will support transformational work in many areas of astrophysics.","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"w59DSXhcvv"}],"key":"QIifzRNUK1"},{"type":"paragraph","position":{"start":{"line":37,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Euclid Quick Release 1 (Q1) consists of consists of ~30 TB of imaging, spectroscopy, and catalogs covering four non-contiguous fields:\nEuclid Deep Field North (22.9 sq deg), Euclid Deep Field Fornax (12.1 sq deg), Euclid Deep Field South (28.1 sq deg), and LDN1641.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"WLWwa9wdqr"}],"key":"R7XB0lDPsM"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"Among the data products included in the Q1 release are the 1D spectra created by the SIR Processing Function.\nThis notebook provides an introduction to these SIR 1D spectra.\nIf you have questions about it, please contact the ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"gG6h4EVC49"},{"type":"link","url":"https://irsa.ipac.caltech.edu/docs/help_desk.html","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"IRSA helpdesk","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"lsVbMyLGY4"}],"urlSource":"https://irsa.ipac.caltech.edu/docs/help_desk.html","key":"C5hoQXMwgx"},{"type":"text","value":".","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"CNmQ1U1kft"}],"key":"UiILwNK70w"}],"key":"HkX20cnkqz"},{"type":"block","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"rCKoQ7W1RX"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"pGn6c7RB7F"},{"type":"admonition","kind":"important","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Important","key":"UDvpEMQyu6"}],"key":"wHdHbH2vb5"},{"type":"paragraph","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"We rely on ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"ZpERziWTEq"},{"type":"inlineCode","value":"astroquery","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"OycYoSS5NS"},{"type":"text","value":" features that have been recently added, so please make sure you have version v0.4.10 or newer installed.","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"WKKNp9O8H7"}],"key":"a5bJvzuFjC"}],"key":"VoDQ4iuiFI"}],"key":"yAcMf5Cok8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Uncomment the next line to install dependencies if needed\n# !pip install matplotlib astropy 'astroquery>=0.4.10'","key":"Bxfw2Vlr3G"},{"type":"output","id":"0fyJxtaBAWSd0JkUf5EXy","data":[],"key":"b5ze6KSvVC"}],"key":"O8gJ9ibUQY"},{"type":"block","children":[],"key":"jr1UqfQkCg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\nfrom astropy.io import fits\nfrom astropy.table import QTable\nfrom astropy import units as u\nfrom astropy.visualization import quantity_support\n\nfrom astroquery.ipac.irsa import Irsa","key":"Hrus33Wnhz"},{"type":"output","id":"QY5MZXJU5NPBW1rOpfnJx","data":[],"key":"GJTM3OgxeM"}],"key":"xPE8mBsueb"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"1. Search for the spectrum of a specific galaxy","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"uA0XhZVJsc"}],"identifier":"id-1-search-for-the-spectrum-of-a-specific-galaxy","label":"1. Search for the spectrum of a specific galaxy","html_id":"id-1-search-for-the-spectrum-of-a-specific-galaxy","implicit":true,"key":"lp4PAtTtHx"},{"type":"paragraph","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"text","value":"First, explore what Euclid catalogs are available. Note that we need to use the object ID for our targets to be able to download their spectrum.","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"sZYPINpraa"}],"key":"aisu4ONy2t"},{"type":"paragraph","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"Search for all tables in IRSA labeled as “euclid”.","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"PIRNutAEgD"}],"key":"Wdgbf1200K"}],"key":"NbmJpwGaDx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"Irsa.list_catalogs(filter='euclid')","key":"eK2D3nIR9K"},{"type":"output","id":"rFk42yxZQpliyfztLuR1-","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"{'euclid_q1_mer_catalogue': 'Euclid Q1 MER Catalog'}","content_type":"text/plain"}}}],"key":"GE4j65KfNL"}],"key":"vyfRJEa6o0"},{"type":"block","children":[],"key":"LtDHrUC2u9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"table_1dspectra = 'euclid.objectid_spectrafile_association_q1'","key":"NN2ilYJItw"},{"type":"output","id":"5CDFOBgl1mqSKmIbvmOFO","data":[],"key":"jzjgvjL8BH"}],"key":"Elals9Bo97"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"text","value":"2. Search for the spectrum of a specific galaxy in the 1D spectra table","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"EE8t03N8uC"}],"identifier":"id-2-search-for-the-spectrum-of-a-specific-galaxy-in-the-1d-spectra-table","label":"2. Search for the spectrum of a specific galaxy in the 1D spectra table","html_id":"id-2-search-for-the-spectrum-of-a-specific-galaxy-in-the-1d-spectra-table","implicit":true,"key":"zkr8aVOCGb"}],"key":"SXV8VDhH2Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"obj_id = 2689918641685825137","key":"D0B5qeRVIr"},{"type":"output","id":"aAvlJ5cxw2CVEkLPtqb67","data":[],"key":"i6dv6ao9zz"}],"key":"EC0cYWXaZB"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"We will use TAP and an ASQL query to find the spectral data for our galaxy. (ADQL is the ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"pqATRbhNy2"},{"type":"link","url":"https://www.ivoa.net/documents/latest/ADQL.html","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"IVOA Astronomical Data Query Language","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"h9pyjwNuNi"}],"urlSource":"https://www.ivoa.net/documents/latest/ADQL.html","key":"NLabfPwEfS"},{"type":"text","value":" and is based on SQL.)","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"CCHIQlmTRm"}],"key":"PzOKCONKPo"}],"key":"CGelFt1Rg6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"adql_object = f\"SELECT * FROM {table_1dspectra} WHERE objectid = {obj_id}\"\n\n# Pull the data on this particular galaxy\nresult = Irsa.query_tap(adql_object).to_table()","key":"fJBONZR1lX"},{"type":"output","id":"5Zg3wm0WhSvIkwq6tJ-rM","data":[],"key":"coOpABSCAE"}],"key":"IgZHsiBjT8"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"text","value":"Pull out the file name from the ","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"JhnFoodO7n"},{"type":"inlineCode","value":"result","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"RBDEzdtQvQ"},{"type":"text","value":" table:","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"AuL48eAVV6"}],"key":"RiEhnZ00FO"}],"key":"cGsETA13rE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"spectrum_path = f\"https://irsa.ipac.caltech.edu/{result['path'][0]}\"\nspectrum_path","key":"sH5ZjNWnbs"},{"type":"output","id":"kGocaALzh01hNv16JMsKU","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"'https://irsa.ipac.caltech.edu/api/spectrumdm/convert/euclid/q1/SIR/102160608/EUC_SIR_W-COMBSPEC_102160608_2024-11-05T16:42:00.741819Z.fits?dataset_id=euclid_combspec&hdu=321'","content_type":"text/plain"}}}],"key":"MlYjjhtRQP"}],"key":"RHgmVuTuZV"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"3. Read in the spectrum for only our specific object","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"KuqojL2Yf5"}],"identifier":"id-3-read-in-the-spectrum-for-only-our-specific-object","label":"3. Read in the spectrum for only our specific object","html_id":"id-3-read-in-the-spectrum-for-only-our-specific-object","implicit":true,"key":"HIO6VoCQTg"},{"type":"paragraph","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"children":[{"type":"inlineCode","value":"spectrum_path","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"ickEjtEZOM"},{"type":"text","value":" is a url that will return a VOTable containing the spectrum of our object.","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"OPjIxBlry9"}],"key":"xRCkL2VR8o"}],"key":"fs6caCWqvc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"spectrum = QTable.read(spectrum_path)","key":"W8E30hmyRI"},{"type":"output","id":"AkXS-F3FN6HsBBBdA9iQO","data":[{"output_type":"stream","name":"stderr","text":"WARNING: UnitsWarning: The unit 'Angstrom' has been deprecated in the VOUnit standard. Suggested: 0.1nm. [astropy.units.format.vounit]\nWARNING: UnitsWarning: The unit 'erg' has been deprecated in the VOUnit standard. Suggested: cm**2.g.s**-2. [astropy.units.format.vounit]\nWARNING: UnitsWarning: The unit 'Angstrom' has been deprecated in the VOUnit standard. Suggested: 0.1nm. [astropy.units.format.vounit]\nWARNING: UnitsWarning: The unit 'erg' has been deprecated in the VOUnit standard. Suggested: cm**2.g.s**-2. [astropy.units.format.vounit]\nWARNING: UnitsWarning: The unit 'Angstrom' has been deprecated in the VOUnit standard. Suggested: 0.1nm. [astropy.units.format.vounit]\nWARNING: UnitsWarning: The unit 'erg' has been deprecated in the VOUnit standard. Suggested: cm**2.g.s**-2. [astropy.units.format.vounit]\nWARNING: UnitsWarning: The unit 'Angstrom' has been deprecated in the VOUnit standard. Suggested: 0.1nm. [astropy.units.format.vounit]\n"}],"key":"I7SjA094DB"}],"key":"vKFjNiIxEm"},{"type":"block","children":[],"key":"vBz12OzfTi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"spectrum","key":"Z9DX9WSI0s"},{"type":"output","id":"u_uWSIFDOx_5GBeMcV_2U","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"<QTable length=531>\n   WAVELENGTH               SIGNAL            ...         UNCERTAINTY         \n    Angstrom     1e-16 erg / (Angstrom s cm2) ... 1e-16 erg / (Angstrom s cm2)\n    float32                float32            ...           float32           \n---------------- ---------------------------- ... ----------------------------\n         11900.0                          0.0 ...                          0.0\n 11913.400390625                          0.0 ...                          0.0\n11926.7998046875                          0.0 ...                          0.0\n11940.2001953125         -0.42825955152511597 ...          0.22873060405254364\n 11953.599609375        -0.019433781504631042 ...          0.10246048122644424\n         11967.0          0.02915639616549015 ...         0.058611974120140076\n 11980.400390625          0.08275385200977325 ...          0.04141402989625931\n11993.7998046875         0.018765779212117195 ...          0.03101346082985401\n12007.2001953125         0.009108440019190311 ...         0.024240652099251747\n             ...                          ... ...                          ...\n  18894.80078125         0.004414212889969349 ...         0.016445929184556007\n  18908.19921875        -0.034835416823625565 ...         0.022500716149806976\n 18921.599609375         0.002581549109891057 ...         0.024819431826472282\n         18935.0         -0.03595489263534546 ...         0.030663004145026207\n 18948.400390625          -0.0484054833650589 ...          0.04354298859834671\n  18961.80078125         -0.12392819672822952 ...          0.05629490315914154\n  18975.19921875         -0.08269069343805313 ...          0.07474944740533829\n 18988.599609375         -0.14132308959960938 ...          0.10002429783344269\n         19002.0         -0.33820343017578125 ...          0.12961678206920624","content_type":"text/plain"},"text/html":{"content":"<div><i>QTable length=531</i>\n<table id=\"table140648723296912\" class=\"table-striped table-bordered table-condensed\">\n<thead><tr><th>WAVELENGTH</th><th>SIGNAL</th><th>MASK</th><th>QUALITY</th><th>VAR</th><th>NDITH</th><th>UNCERTAINTY</th></tr></thead>\n<thead><tr><th>Angstrom</th><th>1e-16 erg / (Angstrom s cm2)</th><th></th><th></th><th>1e-32 erg2 / (Angstrom2 s2 cm4)</th><th></th><th>1e-16 erg / (Angstrom s cm2)</th></tr></thead>\n<thead><tr><th>float32</th><th>float32</th><th>int32</th><th>float32</th><th>float32</th><th>int32</th><th>float32</th></tr></thead>\n<tr><td>11900.0</td><td>0.0</td><td>1</td><td>0.0</td><td>0.0</td><td>0</td><td>0.0</td></tr>\n<tr><td>11913.400390625</td><td>0.0</td><td>1</td><td>0.0</td><td>0.0</td><td>0</td><td>0.0</td></tr>\n<tr><td>11926.7998046875</td><td>0.0</td><td>1</td><td>0.0</td><td>0.0</td><td>0</td><td>0.0</td></tr>\n<tr><td>11940.2001953125</td><td>-0.42825955152511597</td><td>64</td><td>0.92492783</td><td>0.05231768637895584</td><td>2</td><td>0.22873060405254364</td></tr>\n<tr><td>11953.599609375</td><td>-0.019433781504631042</td><td>66</td><td>0.85617656</td><td>0.010498150251805782</td><td>2</td><td>0.10246048122644424</td></tr>\n<tr><td>11967.0</td><td>0.02915639616549015</td><td>64</td><td>0.8876306</td><td>0.003435363294556737</td><td>4</td><td>0.058611974120140076</td></tr>\n<tr><td>11980.400390625</td><td>0.08275385200977325</td><td>80</td><td>0.0</td><td>0.0017151220235973597</td><td>4</td><td>0.04141402989625931</td></tr>\n<tr><td>11993.7998046875</td><td>0.018765779212117195</td><td>64</td><td>0.8546597</td><td>0.0009618347976356745</td><td>4</td><td>0.03101346082985401</td></tr>\n<tr><td>12007.2001953125</td><td>0.009108440019190311</td><td>64</td><td>0.88878244</td><td>0.0005876092473044991</td><td>4</td><td>0.024240652099251747</td></tr>\n<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>\n<tr><td>18894.80078125</td><td>0.004414212889969349</td><td>64</td><td>0.91559637</td><td>0.0002704685612116009</td><td>4</td><td>0.016445929184556007</td></tr>\n<tr><td>18908.19921875</td><td>-0.034835416823625565</td><td>64</td><td>0.738968</td><td>0.0005062822601757944</td><td>3</td><td>0.022500716149806976</td></tr>\n<tr><td>18921.599609375</td><td>0.002581549109891057</td><td>66</td><td>0.88685787</td><td>0.0006160042248666286</td><td>4</td><td>0.024819431826472282</td></tr>\n<tr><td>18935.0</td><td>-0.03595489263534546</td><td>66</td><td>0.9000128</td><td>0.0009402198484167457</td><td>4</td><td>0.030663004145026207</td></tr>\n<tr><td>18948.400390625</td><td>-0.0484054833650589</td><td>64</td><td>0.9134283</td><td>0.001895991968922317</td><td>4</td><td>0.04354298859834671</td></tr>\n<tr><td>18961.80078125</td><td>-0.12392819672822952</td><td>64</td><td>0.92242616</td><td>0.0031691163312643766</td><td>3</td><td>0.05629490315914154</td></tr>\n<tr><td>18975.19921875</td><td>-0.08269069343805313</td><td>64</td><td>0.8407321</td><td>0.005587479565292597</td><td>3</td><td>0.07474944740533829</td></tr>\n<tr><td>18988.599609375</td><td>-0.14132308959960938</td><td>66</td><td>0.7666888</td><td>0.0100048603489995</td><td>3</td><td>0.10002429783344269</td></tr>\n<tr><td>19002.0</td><td>-0.33820343017578125</td><td>66</td><td>0.80953264</td><td>0.01680051162838936</td><td>4</td><td>0.12961678206920624</td></tr>\n</table></div>","content_type":"text/html"}}}],"key":"jyc0eRaOqP"}],"key":"nEi4YX7yep"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"4. Plot the image of the extracted spectrum","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"GczE4HmiiJ"}],"identifier":"id-4-plot-the-image-of-the-extracted-spectrum","label":"4. Plot the image of the extracted spectrum","html_id":"id-4-plot-the-image-of-the-extracted-spectrum","implicit":true,"key":"OOy1JodYlG"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"qC3zoSonPV"}],"key":"o0Rx0ttZQc"},{"type":"paragraph","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"text","value":"As we use astropy.visualization’s ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"wqBFiIquKG"},{"type":"inlineCode","value":"quantity_support","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"kavHV1ZYDd"},{"type":"text","value":", matplotlib automatically picks up the axis units from the quantities we plot.","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"TlX7h3Rjdq"}],"key":"pqF1BubGUk"}],"key":"LLJfI3vzW5"}],"key":"YsDpabhXyv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"quantity_support()","key":"wHuf6YnAwK"},{"type":"output","id":"IVjHCkA-nI58OnZuHRivU","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"<astropy.visualization.units.quantity_support.<locals>.MplQuantityConverter at 0x7feb55313ce0>","content_type":"text/plain"}}}],"key":"uZsWG2ZyVN"}],"key":"VbJr5QFu9F"},{"type":"block","children":[{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"jutVzyqRfz"}],"key":"N40BonUUW6"},{"type":"paragraph","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"text","value":"The 1D combined spectra table contains 6 columns, below are a few highlights:","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"ifGnkgTNnI"}],"key":"RaW2WOPker"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":130,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"WAVELENGTH is in Angstroms by default.","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"tYmVsgOa3w"}],"key":"FzTFvAEIxR"}],"key":"TmVLsCoGKm"},{"type":"listItem","spread":true,"position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"SIGNAL is the flux. The values are scaled and the scaling factor is included in the column’s units. This value corresponds to the ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"LW5Uz5uxcE"},{"type":"inlineCode","value":"'FSCALE'","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"B9PTJMlvCA"},{"type":"text","value":" entry in the HDU header of the original FITS file.","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"WYcEgBhsRz"}],"key":"g7aNPgZ6Yq"}],"key":"mGdCbNDcgQ"},{"type":"listItem","spread":true,"position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"MASK values can be used to determine which flux bins to discard. MASK = odd and MASK >=64 means the flux bins not be used.","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"wppOZazr5M"}],"key":"rdJXrbNm7O"}],"key":"RNusZAN5tF"}],"key":"JBqDB4C8bP"}],"key":"ZLhEUb08vl"},{"type":"paragraph","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"text","value":"We investigate the MASK column to see which flux bins are recommended to keep vs “Do Not Use”","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"UIc72jaXlg"}],"key":"c35wcHu4XL"}],"key":"ZzMYQLu1jc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(spectrum['WAVELENGTH'].to(u.micron), spectrum['MASK'])\nplt.ylabel('Mask value')\nplt.title('Values of MASK by flux bin')","key":"WPvXI9OcPI"},{"type":"output","id":"-sEOPVKX6DRUTY1itDcg7","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"adc8fe78c77582116f391c4751408581","path":"/irsa-tutorials/build/adc8fe78c77582116f391c4751408581.png"}}}],"key":"e9Won1q6lS"}],"key":"TDRvIG0Wek"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"text","value":"We use the MASK column to create a boolean mask for values to ignore. We use the inverse of this mask to mark the flux bins to use.","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"wbB64avIgo"}],"key":"mDrRuBkErh"}],"key":"KjtpEnnhtg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"bad_mask = (spectrum['MASK'].value % 2 == 1) | (spectrum['MASK'].value >= 64)\n\nplt.plot(spectrum['WAVELENGTH'].to(u.micron), np.ma.masked_where(bad_mask, spectrum['SIGNAL']), color='black', label='Spectrum')\nplt.plot(spectrum['WAVELENGTH'], np.ma.masked_where(~bad_mask, spectrum['SIGNAL']), color='red', label='Do not use')\nplt.plot(spectrum['WAVELENGTH'], np.sqrt(spectrum['VAR']), color='grey', label='Error')\n\nplt.legend(loc='upper right')\nplt.ylim(-0.15, 0.25)\nplt.title(f'Object ID {obj_id}')","key":"SXdYvFeUdY"},{"type":"output","id":"uvK-BEadRboB-V3han2tI","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"eac2b510ee84c7a899e5d6a31f07ccc6","path":"/irsa-tutorials/build/eac2b510ee84c7a899e5d6a31f07ccc6.png"}}}],"key":"TlENbfPEn1"}],"key":"mXpckqBaY5"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"children":[{"type":"text","value":"About this Notebook","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"key":"wo1anKJygs"}],"identifier":"about-this-notebook","label":"About this Notebook","html_id":"about-this-notebook","implicit":true,"key":"mTTb4hkGoA"},{"type":"paragraph","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"children":[{"type":"strong","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"children":[{"type":"text","value":"Author","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"key":"xgGQVO06Jp"}],"key":"krMjXx2A7v"},{"type":"text","value":": Tiffany Meshkat, Anahita Alavi, Anastasia Laity, Andreas Faisst, Brigitta Sipőcz, Dan Masters, Harry Teplitz, Jaladh Singhal, Shoubaneh Hemmati, Vandana Desai, Troy Raen","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"key":"TS8Ys5tNg6"}],"key":"prGCofNt3d"},{"type":"paragraph","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"children":[{"type":"strong","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"children":[{"type":"text","value":"Updated","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"IJksjgocno"}],"key":"FdiiarAbqK"},{"type":"text","value":": 2025-09-23","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"DN3ThIfN8u"}],"key":"zOBYa6XQWO"},{"type":"paragraph","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"children":[{"type":"strong","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"children":[{"type":"text","value":"Contact:","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"YnQFR4ea4N"}],"key":"QTKCRRIwdI"},{"type":"text","value":" ","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"XNLWw4bILg"},{"type":"link","url":"https://irsa.ipac.caltech.edu/docs/help_desk.html","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"children":[{"type":"text","value":"the IRSA Helpdesk","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"W0MrBYFUzw"}],"urlSource":"https://irsa.ipac.caltech.edu/docs/help_desk.html","key":"CBVLGTdTzR"},{"type":"text","value":" with questions or reporting problems.","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"U5qQxFrrRa"}],"key":"Id5IDVCbyW"}],"key":"q6hRCxu8nJ"}],"key":"y7UV7TERaz"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Euclid Q1: MER catalogs","url":"/euclid-intro-mer-catalog","group":"Euclid Quick Release 1"},"next":{"title":"Euclid Q1: PHZ catalogs","url":"/euclid-intro-phz-catalog","group":"Euclid Quick Release 1"}}},"domain":"http://localhost:3000"}