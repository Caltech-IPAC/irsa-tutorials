<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Access HATS Collections Using LSDB: Euclid Q1 and ZTF DR23 - IRSA Tutorials</title><meta property="og:title" content="Access HATS Collections Using LSDB: Euclid Q1 and ZTF DR23 - IRSA Tutorials"/><meta name="generator" content="mystmd"/><meta name="description" content="IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)"/><meta property="og:description" content="IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)"/><meta name="keywords" content="astronomy"/><link rel="stylesheet" href="/irsa-tutorials/build/_assets/app-5WKS5EPQ.css"/><link rel="stylesheet" href="/irsa-tutorials/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/irsa-tutorials/favicon.ico"/><link rel="stylesheet" href="/irsa-tutorials/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/irsa-tutorials/"><div class="p-1 mr-3 dark:bg-white dark:rounded"><img src="/irsa-tutorials/build/irsa_logo-bd755426d9f69813fa092c6774d3180f.png" class="h-9" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="IRSA Tutorials" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/irsa-tutorials/">IRSA Tutorials</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="SPHEREx" class="block break-words rounded py-2 grow cursor-pointer">SPHEREx</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Euclid" class="block break-words rounded py-2 grow cursor-pointer">Euclid</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rup8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rup8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="WISE" class="block break-words rounded py-2 grow cursor-pointer">WISE</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R16p8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R16p8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Spitzer" class="block break-words rounded py-2 grow cursor-pointer">Spitzer</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1ep8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1ep8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="2MASS" class="block break-words rounded py-2 grow cursor-pointer">2MASS</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1mp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1mp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="COSMOS" class="block break-words rounded py-2 grow cursor-pointer">COSMOS</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1up8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1up8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Simulated Data" class="block break-words rounded py-2 grow cursor-pointer">Simulated Data</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R26p8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R26p8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Special Topics" class="block break-words rounded py-2 grow cursor-pointer">Special Topics</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R2ep8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R2ep8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-none pr-2 smallcaps">IRSA Tutorials</div><div class="flex-grow"></div><a href="https://github.com/Caltech-IPAC/irsa-tutorials/" title="GitHub Repository: Caltech-IPAC/irsa-tutorials/" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><a href="https://github.com/Caltech-IPAC/irsa-tutorials//edit/main/tutorials/parquet-catalog-demos/irsa-hats-with-lsdb.md" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div><button class="inline-flex size-[24px] hover:text-[#E18435] items-center justify-center" aria-label="Launch in external computing interface" title="Launch in external computing interface" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Re8top:" data-state="closed"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.85357 3.85355L7.65355 3.05353C8.2981 2.40901 9.42858 1.96172 10.552 1.80125C11.1056 1.72217 11.6291 1.71725 12.0564 1.78124C12.4987 1.84748 12.7698 1.97696 12.8965 2.10357C13.0231 2.23018 13.1526 2.50125 13.2188 2.94357C13.2828 3.37086 13.2779 3.89439 13.1988 4.44801C13.0383 5.57139 12.591 6.70188 11.9464 7.34645L7.49999 11.7929L6.35354 10.6465C6.15827 10.4512 5.84169 10.4512 5.64643 10.6465C5.45117 10.8417 5.45117 11.1583 5.64643 11.3536L7.14644 12.8536C7.34171 13.0488 7.65829 13.0488 7.85355 12.8536L8.40073 12.3064L9.57124 14.2572C9.65046 14.3893 9.78608 14.4774 9.9389 14.4963C10.0917 14.5151 10.2447 14.4624 10.3535 14.3536L12.3535 12.3536C12.4648 12.2423 12.5172 12.0851 12.495 11.9293L12.0303 8.67679L12.6536 8.05355C13.509 7.19808 14.0117 5.82855 14.1887 4.58943C14.2784 3.9618 14.2891 3.33847 14.2078 2.79546C14.1287 2.26748 13.9519 1.74482 13.6035 1.39645C13.2552 1.04809 12.7325 0.871332 12.2045 0.792264C11.6615 0.710945 11.0382 0.721644 10.4105 0.8113C9.17143 0.988306 7.80189 1.491 6.94644 2.34642L6.32322 2.96968L3.07071 2.50504C2.91492 2.48278 2.75773 2.53517 2.64645 2.64646L0.646451 4.64645C0.537579 4.75533 0.484938 4.90829 0.50375 5.0611C0.522563 5.21391 0.61073 5.34954 0.742757 5.42876L2.69364 6.59928L2.14646 7.14645C2.0527 7.24022 2.00002 7.3674 2.00002 7.50001C2.00002 7.63261 2.0527 7.75979 2.14646 7.85356L3.64647 9.35356C3.84173 9.54883 4.15831 9.54883 4.35357 9.35356C4.54884 9.1583 4.54884 8.84172 4.35357 8.64646L3.20712 7.50001L3.85357 6.85356L6.85357 3.85355ZM10.0993 13.1936L9.12959 11.5775L11.1464 9.56067L11.4697 11.8232L10.0993 13.1936ZM3.42251 5.87041L5.43935 3.85356L3.17678 3.53034L1.80638 4.90074L3.42251 5.87041ZM2.35356 10.3535C2.54882 10.1583 2.54882 9.8417 2.35356 9.64644C2.1583 9.45118 1.84171 9.45118 1.64645 9.64644L0.646451 10.6464C0.451188 10.8417 0.451188 11.1583 0.646451 11.3535C0.841713 11.5488 1.1583 11.5488 1.35356 11.3535L2.35356 10.3535ZM3.85358 11.8536C4.04884 11.6583 4.04885 11.3417 3.85359 11.1465C3.65833 10.9512 3.34175 10.9512 3.14648 11.1465L1.14645 13.1464C0.95119 13.3417 0.951187 13.6583 1.14645 13.8535C1.34171 14.0488 1.65829 14.0488 1.85355 13.8536L3.85358 11.8536ZM5.35356 13.3535C5.54882 13.1583 5.54882 12.8417 5.35356 12.6464C5.1583 12.4512 4.84171 12.4512 4.64645 12.6464L3.64645 13.6464C3.45119 13.8417 3.45119 14.1583 3.64645 14.3535C3.84171 14.5488 4.1583 14.5488 4.35356 14.3535L5.35356 13.3535ZM9.49997 6.74881C10.1897 6.74881 10.7488 6.1897 10.7488 5.5C10.7488 4.8103 10.1897 4.25118 9.49997 4.25118C8.81026 4.25118 8.25115 4.8103 8.25115 5.5C8.25115 6.1897 8.81026 6.74881 9.49997 6.74881Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button></div><h1 class="mb-0">Access HATS Collections Using LSDB: Euclid Q1 and ZTF DR23</h1><header class="mt-4 not-prose"><div><span class="font-semibold text-sm inline-block"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78top:" data-state="closed">IRSA Scientists and Developers</button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div class="sticky top-[60px] pb-[14px] flex justify-end w-full z-20 pointer-events-none"><div class="flex p-1 m-1 space-x-1 border rounded-full shadow pointer-events-auto border-stone-300 bg-white/80 dark:bg-stone-900/80 backdrop-blur"><div class="rounded"><button class="flex text-center rounded-full cursor-pointer text-stone-800 dark:text-white hover:opacity-100 opacity-60" aria-label="start compute environment"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="inline-block w-6 h-6 align-top"><title>Launch kernel</title><path stroke-linecap="round" stroke-linejoin="round" d="M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"></path></svg></button></div></div></div><div id="skip-to-article"></div><h2 id="learning-goals" class="relative group"><span class="heading-text">Learning Goals</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#learning-goals" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>By the end of this tutorial, you will learn how to:</p><ul><li><p>Use the <code>lsdb</code> library to access IRSA HATS Collections from the cloud.</p></li><li><p>Define spatial, column, and row filters to read only a portion of large HATS catalogs.</p></li><li><p>Crossmatch catalogs using <code>lsdb</code> and visualize the results.</p></li><li><p>Perform index searches on HATS catalogs using <code>lsdb</code>.</p></li></ul><h2 id="introduction" class="relative group"><span class="heading-text">Introduction</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#introduction" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>IRSA provides several astronomical catalogs in spatially partitioned <a target="_blank" rel="noreferrer" href="https://parquet.apache.org/" class="">Parquet format</a>, enabling efficient access and scalable analysis of large datasets.
Among these are the <a target="_blank" rel="noreferrer" href="https://irsa.ipac.caltech.edu/docs/parquet_catalogs/#hats" class="">HATS</a> (Hierarchical Adaptive Tiling Scheme) collections, which organize catalog data using adaptive <a target="_blank" rel="noreferrer" href="https://irsa.ipac.caltech.edu/healpix/" class="">HEALPix</a>-based partitioning for parallelizable queries and crossmatching.</p><p>For more details on HATS collections, partitioning, and schema organization, see the IRSA documentation on <a target="_blank" rel="noreferrer" href="https://irsa.ipac.caltech.edu/docs/parquet_catalogs/" class="">Parquet catalogs</a>.</p><p>This notebook demonstrates how to access and analyze HATS collections using the <a target="_blank" rel="noreferrer" href="https://docs.lsdb.io/en/latest/index.html" class="">lsdb</a> Python library, which makes it convenient to work with these large datasets.
We will explore the following IRSA HATS collections in this tutorial:</p><ul><li><p>Euclid Q1 Merged Objects: 14 Euclid Q1 tables, including MER (multi-wavelength mosaics) final catalog, photometric redshift catalogs, and spectroscopic catalogs joined on MER Object ID.</p></li><li><p>ZTF DR23 Objects Table: catalog of PSF-fit photometry detections extracted from ZTF reference images, including “collapsed-lightcurve” metrics.</p></li><li><p>ZTF DR23 Lightcurves: catalog of PSF-fit photometry detections extracted from single-exposure images at the locations of Objects Table detections.</p></li></ul><p>We will use lsdb to leverage HATS partitioning for performing fast spatial queries on a relatively large area of sky and for crossmatching sources between Euclid and ZTF to identify variable galaxy candidates and visualize their light curves.</p><h2 id="imports" class="relative group"><span class="heading-text">Imports</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#imports" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><div id="vn3zQj9TG0" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Uncomment the next line to install dependencies if needed.
# !pip install s3fs &quot;lsdb&gt;=0.6.6&quot; pyarrow pandas numpy astropy dask matplotlib</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="FujSVdgtrXW8MBOXq0LLg" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="oPP7eJ7y45" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import s3fs
import lsdb
import pyarrow.parquet as pq
import numpy as np
import pandas as pd
from astropy import units as u
from astropy.coordinates import SkyCoord
import os
import matplotlib.pyplot as plt
from dask.distributed import Client</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="n_Hxl9RU_HXhv7-RpL3Ny" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="q8ElUJNY8S" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">pd.set_option(&quot;display.max_colwidth&quot;, None) # schema descriptions can be long
pd.set_option(&quot;display.min_rows&quot;, 18) # to show more rows when truncated view</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="y8dotqh5CYI8a2SjWdFUI" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="id-1-locate-hats-collections-in-the-cloud" class="relative group"><span class="heading-text">1. Locate HATS collections in the cloud</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-locate-hats-collections-in-the-cloud" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>From IRSA’s <a target="_blank" rel="noreferrer" href="https://irsa.ipac.caltech.edu/cloud_access/" class="">cloud data access page</a>, let’s identify the bucket and path prefix for the HATS Collections for Euclid Q1 and ZTF DR23:</p><div id="lbPUG5AhdM" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">euclid_q1_bucket = &quot;nasa-irsa-euclid-q1&quot;
euclid_q1_hats_prefix = &quot;contributed/q1/merged_objects/hats&quot;

ztf_bucket = &quot;ipac-irsa-ztf&quot;
ztf_hats_prefix = &quot;contributed/dr23/objects/hats&quot;
ztf_lc_hats_prefix = &quot;contributed/dr23/lc/hats&quot;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5rXlNYehOM2URfC2Djl7f" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p><a target="_blank" rel="noreferrer" href="https://s3fs.readthedocs.io/en/latest/" class="">s3fs</a> provides a filesystem-like Python interface for AWS S3 buckets.
First, we create an S3 client:</p><div id="pvW3e6S7EG" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">s3 = s3fs.S3FileSystem(anon=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="speHXnU78Cw5wJLovU3wn" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Using the S3 client, we can now list the contents of the Euclid Q1 HATS <strong>collection</strong>:</p><div id="Z9Pg7R27HF" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">s3.ls(f&quot;{euclid_q1_bucket}/{euclid_q1_hats_prefix}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="-TczEe9fKfWXjEek9PGuL" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>[&#x27;nasa-irsa-euclid-q1/contributed/q1/merged_objects/hats/collection.properties&#x27;,
 &#x27;nasa-irsa-euclid-q1/contributed/q1/merged_objects/hats/euclid_q1_merged_objects-hats&#x27;,
 &#x27;nasa-irsa-euclid-q1/contributed/q1/merged_objects/hats/euclid_q1_merged_objects-hats_index_object_id&#x27;,
 &#x27;nasa-irsa-euclid-q1/contributed/q1/merged_objects/hats/euclid_q1_merged_objects-hats_margin_10arcsec&#x27;]</span></code></div></div></div><p>In this collection, you can see collection properties, catalog, index table, and margin cache in order.
You can explore more directories to see how this HATS collection follows the directory structure described in IRSA’s documentation on <a target="_blank" rel="noreferrer" href="https://irsa.ipac.caltech.edu/docs/parquet_catalogs/#hats" class="">HATS partitioning and HATS Collections</a>.</p><p>As per the documentation, the Parquet file containing the schema for this <code>euclid_q1_merged_objects-hats</code> catalog is stored in <code>dataset/_common_metadata</code> directory.
You can find the catalog schema through other sources as well but we use the <code>_common_metadata</code> file here because it contains column metadata (units and descriptions) which the other schemas don’t have.
Let’s save its path for later use:</p><div id="FLe23o59Wy" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">euclid_q1_schema_path = &quot;euclid_q1_merged_objects-hats/dataset/_common_metadata&quot; # euclid_q1_merged_objects-hats is the catalog name we identified above</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Up77tLRxgfF9kNLGFOJWk" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Similarly, we can list the contents of the ZTF DR23 Objects HATS collection and save the path to its schema file:</p><div id="YhpaNQEnk8" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">s3.ls(f&quot;{ztf_bucket}/{ztf_hats_prefix}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Qo11awi2jtr3-xZJStBI8" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>[&#x27;ipac-irsa-ztf/contributed/dr23/objects/hats/collection.properties&#x27;,
 &#x27;ipac-irsa-ztf/contributed/dr23/objects/hats/ztf_dr23_objects-hats&#x27;,
 &#x27;ipac-irsa-ztf/contributed/dr23/objects/hats/ztf_dr23_objects-hats_index_oid&#x27;,
 &#x27;ipac-irsa-ztf/contributed/dr23/objects/hats/ztf_dr23_objects-hats_margin_10arcsec&#x27;]</span></code></div></div></div><div id="FPqly41mrs" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">ztf_schema_path = &quot;ztf_dr23_objects-hats/dataset/_common_metadata&quot; # ztf_dr23_objects-hats is the catalog name we identified above</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="IyjOYYyeMXH_TdbqtbSpM" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="id-2-open-the-hats-catalogs" class="relative group"><span class="heading-text">2. Open the HATS catalogs</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-open-the-hats-catalogs" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Now we can use <a target="_blank" rel="noreferrer" href="https://docs.lsdb.io/en/latest/index.html" class="">lsdb</a> to open the HATS catalogs we identified above, starting with the Euclid Q1 catalog.
Note that we can simply pass the HATS collection path and it will automatically identify the catalog inside it and make use of the ancillary data (index table and margin cache) when needed.
Also, we prefix the path with <code>s3://</code> to indicate that it is an S3 path.</p><div id="yTM1bShs5S" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">euclid_catalog = lsdb.open_catalog(f&quot;s3://{euclid_q1_bucket}/{euclid_q1_hats_prefix}&quot;)
euclid_catalog</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="sV4p46-Au6wl8fX0WYRla" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Few things to note here:</p><ul><li><p>This catalog is opened <a target="_blank" rel="noreferrer" href="https://docs.lsdb.io/en/latest/tutorials/lazy_operations.html" class="">lazily</a>, i.e., no data is read from the S3 bucket into memory yet.</p></li><li><p>Since we did not specify any columns to select from this very wide catalog, we get 7 default columns out of 1593 available columns!</p></li><li><p>We see some of the HEALPix orders and pixels at which this catalog is partitioned.</p></li></ul><p>Let’s plot the sky coverage of this catalog:</p><div id="jXI0lKyEln" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">euclid_catalog.plot_pixels()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="o_6jLmdAoVSf4vhVVsSb4" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>(&lt;Figure size 1000x500 with 2 Axes&gt;,
 &lt;WCSAxes: title={&#x27;center&#x27;: &#x27;Catalog pixel map - Euclid_Q1_Merged_Objects&#x27;}&gt;)</span></code></div><img src="/irsa-tutorials/build/ae4ee040ebdf330342bf7dc8c728c362.png" alt="&lt;Figure size 1000x500 with 2 Axes&gt;"/></div></div><p>Since HATS uses adaptive tile-based partitioning, we see higher order HEALPix tiles in regions with higher source density and lower order tiles in regions with lower source density.</p><p>Now let’s open the ZTF DR23 Objects catalog in a similar manner and view its sky coverage:</p><div id="t0qiWxoLLe" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">ztf_catalog = lsdb.open_catalog(f&quot;s3://{ztf_bucket}/{ztf_hats_prefix}&quot;)
ztf_catalog</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="oeOmN1FGI9wky1qC3-Mny" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="aoLcnxwEre" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">ztf_catalog.plot_pixels()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Y4zZHrMAo7pVz4u_cmAnW" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>(&lt;Figure size 1000x500 with 2 Axes&gt;,
 &lt;WCSAxes: title={&#x27;center&#x27;: &#x27;Catalog pixel map - ZTF_DR23_Objects&#x27;}&gt;)</span></code></div><img src="/irsa-tutorials/build/10538ea5a175110a692d6516fb65079c.png" alt="&lt;Figure size 1000x500 with 2 Axes&gt;"/></div></div><h2 id="id-3-define-filters-for-querying-euclid-q1-catalog" class="relative group"><span class="heading-text">3. Define filters for querying Euclid Q1 catalog</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-define-filters-for-querying-euclid-q1-catalog" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="id-3-1-define-a-spatial-filter" class="relative group"><span class="heading-text">3.1 Define a spatial filter</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-1-define-a-spatial-filter" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>From the above two plots, it’s clear that the ZTF DR23 Objects catalog covers a much larger area of the sky compared to the Euclid Q1 catalog.
So for cross-matching, we can safely pick the Euclid Deep Field North (EDF-N) region that is covered by both catalogs.
From the <a target="_blank" rel="noreferrer" href="https://irsa.ipac.caltech.edu/data/Euclid/docs/euclid_archive_at_irsa_user_guide.pdf" class="">Euclid user guide at IRSA</a> Table 1, we identify the following for the EDF-N region:</p><div id="bQZIYLuWVh" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">euclid_DF_N_center = SkyCoord(&#x27;17:58:55.9 +66:01:03.7&#x27;, unit=(&#x27;hourangle&#x27;, &#x27;deg&#x27;))
euclid_DF_N_center</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="7QE3UxZrlNJ00cIsLpEI6" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;SkyCoord (ICRS): (ra, dec) in deg
    (269.73291667, 66.01769444)&gt;</span></code></div></div></div><div id="O6Zd6NRslm" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># euclid_DF_N_radius = 3 * u.deg  # ceil(sqrt(22.9 / pi)) approximate radius to cover almost entire EDF-N
euclid_DF_N_radius = 0.5 * u.deg  # smaller radius to reduce execution time for this tutorial
euclid_DF_N_radius</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="9LWrzeYArydAzuK379s0Z" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Now, using lsdb, we define a cone <a target="_blank" rel="noreferrer" href="https://docs.lsdb.io/en/latest/tutorials/region_selection.html#4.-The-Search-object" class="">search object</a> for this region that can be passed as a spatial filter when querying the catalogs:</p><div id="eG5MxvhE2n" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">spatial_filter = lsdb.ConeSearch(
    ra=euclid_DF_N_center.ra.deg, 
    dec=euclid_DF_N_center.dec.deg, 
    radius_arcsec=euclid_DF_N_radius.to(u.arcsec).value
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="HXedjHxNpx16EKBuUz4Y-" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>We can overplot this spatial filter on the Euclid catalog’s sky coverage to verify (note we limited the field of view so that we can see the cone better):</p><div id="KABX3ANETa" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">euclid_catalog.plot_pixels(fov=(8 * u.deg, 6 * u.deg), center=euclid_DF_N_center)
spatial_filter.plot(fc=&quot;#00000000&quot;, ec=&quot;red&quot;);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="z56iSY5JeuE0nJQZyKA-u" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/irsa-tutorials/build/ad1ac00425c2fec1cb2e6115af70b8d7.png" alt="&lt;Figure size 1000x500 with 2 Axes&gt;"/></div></div><h3 id="id-3-2-identify-columns-of-interest-from-the-schema" class="relative group"><span class="heading-text">3.2 Identify columns of interest from the schema</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-2-identify-columns-of-interest-from-the-schema" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Before we can define column and row filters for querying any HATS catalog, we need to know what columns are available in that catalog.
So let’s inspect the schema of the Euclid Q1 catalog.</p><p>Using pyarrow parquet, we can <a target="_blank" rel="noreferrer" href="https://arrow.apache.org/docs/python/generated/pyarrow.parquet.read_schema.html#pyarrow.parquet.read_schema" class="">read the schema</a> from the <code>_common_metadata</code> parquet file we identified above (note that we again prefixed the path with <code>s3://</code> to indicate that it is an S3 path):</p><div id="lBGcnbqWac" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">euclid_schema = pq.read_schema(
    f&quot;s3://{euclid_q1_bucket}/{euclid_q1_hats_prefix}/{euclid_q1_schema_path}&quot;,
    filesystem=s3
)
type(euclid_schema)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="gFMpLMvst-zpWPqJ6wDQX" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>pyarrow.lib.Schema</span></code></div></div></div><p>Since the schema of this catalog is a pyarrow object, let’s convert it to a pandas DataFrame for easier inspection:</p><div id="QE0fB5PPS2" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def pq_schema_to_df(schema):
    &quot;&quot;&quot;Convert a PyArrow schema to a Pandas DataFrame.&quot;&quot;&quot;
    return pd.DataFrame(
        [
            (
                field.name,
                str(field.type),
                field.metadata.get(b&quot;unit&quot;, b&quot;&quot;).decode(),
                field.metadata.get(b&quot;description&quot;, b&quot;&quot;).decode()
            )
            for field in schema # schema is an iterable of pyarrow fields
        ],
        columns=[&quot;name&quot;, &quot;type&quot;, &quot;unit&quot;, &quot;description&quot;]
    )

euclid_schema_df = pq_schema_to_df(euclid_schema)
len(euclid_schema_df)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="swLLCPDfHEyKjg_RdKyLU" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>1594</span></code></div></div></div><p>As we saw above, the Euclid HATS catalog contains 1594 columns in its schema!</p><p>The columns at the beginning of this schema (such as “tileid”, “objectid”, “ra”, “dec”) define positions and IDs.
These can be useful for our <strong>column filters</strong> — the columns we want to SELECT when querying the catalog.</p><p>We can also filter the schema DataFrame by name, unit, type, etc., to identify columns most relevant for our <strong>row filters</strong> — WHERE rows satisfy conditions on column values for our query.
For example, let’s explore the columns that are part of the PHZ (photometric redshift) catalog to identify photometric redshifts and source types:</p><div id="MZrFO74D0G" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">euclid_schema_df[
    euclid_schema_df[&quot;name&quot;].str.startswith(&quot;phz_&quot;) # phz_ prefix is for PHZ catalog columns in this merged catalog
    &amp; euclid_schema_df[&quot;type&quot;].str.contains(&quot;int&quot;) # to see flag type columns
]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="nWdkHqxgec9zB_HyHfcFx" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>“phz_phz_median” gives us the median photometric redshift of sources, while “phz_phz_classification” can be used to filter the Euclid catalog to only galaxy-type sources.</p><p>You can explore the schema DataFrame further to identify any other columns of interest.
It is also useful to go through the description of Euclid Q1 data products and papers that contain different PHZ, MER, etc. catalog tables that are merged in this HATS catalog, which are linked in the <a target="_blank" rel="noreferrer" href="https://caltech-ipac.github.io/irsa-tutorials/#todo-add-when-available" class="">Euclid Q1 HATS Parquet notebook</a>.</p><h3 id="id-3-3-define-column-filters" class="relative group"><span class="heading-text">3.3 Define column filters</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-3-define-column-filters" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>For this tutorial, the following columns are most relevant to us:</p><div id="Ywl3OJyfK0" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">euclid_columns = euclid_schema_df[&#x27;name&#x27;].iloc[:7].tolist() # the positional and ID columns
euclid_columns.extend([
    &#x27;phz_phz_median&#x27;, # median of the photometric redshift PDF
])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="-QCXZsR7ir9scC1W0RRdJ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>The selected columns with their metadata are:</p><div id="lFlhiEG7h2" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">euclid_schema_df[euclid_schema_df[&quot;name&quot;].isin(euclid_columns)]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="mZ35fzPLO8zKrceM0LNVB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><h3 id="id-3-4-define-row-filters" class="relative group"><span class="heading-text">3.4 Define row filters</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-4-define-row-filters" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>To identify the galaxies with quality redshifts in this catalog, the following filters can be applied to the rows (from <a target="_blank" rel="noreferrer" href="https://arxiv.org/pdf/2503.15306" class="">Tucci et al. 2025</a> section 5.3):</p><p>Note that these filters are defined as lists of lists, where each inner list represents a single condition in the format <code>[column_name, operator, value]</code> and the conditions are combined using logical AND.
More on filters that lsdb supports can be found in its <a target="_blank" rel="noreferrer" href="https://docs.lsdb.io/en/latest/getting-started.html#performing-filters" class="">documentation</a>.</p><div id="vImDraN4J7" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def magnitude_to_flux(magnitude: float) -&gt; float:
    &quot;&quot;&quot;Convert magnitude to flux following the MER Photometry Cookbook.&quot;&quot;&quot;
    zeropoint = 23.9
    flux = 10 ** ((magnitude - zeropoint) / -2.5)
    return flux

galaxy_filters = [
    [&#x27;phz_phz_classification&#x27;, &#x27;==&#x27;, 2], # 2 is for galaxies
    [&#x27;mer_vis_det&#x27;, &#x27;==&#x27;, 1], # No NIR-only objects
    [&#x27;mer_spurious_flag&#x27;, &#x27;==&#x27;, 0], # not spurious
    [&#x27;mer_flux_detection_total&#x27;, &#x27;&gt;&#x27;, magnitude_to_flux(24.5)],  # I &lt; 24.5
    # lsdb doesn&#x27;t support column arithmetic in filters yet, so can rather apply the S/N &gt; 5 filter after loading the data
    # [&#x27;mer_flux_detection_total&#x27;, &#x27;/&#x27;, &#x27;mer_flux_detection_error_total&#x27;, &#x27;&gt;&#x27;, 5], # I band S/N &gt; 5
]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="53YVLUO5Mv474GC7l-TyZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="id-4-define-filters-for-querying-ztf-dr23-objects-catalog" class="relative group"><span class="heading-text">4. Define filters for querying ZTF DR23 Objects catalog</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4-define-filters-for-querying-ztf-dr23-objects-catalog" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Since we are interested in cross-matching ZTF DR23 Objects with the Euclid Q1 catalog, we will use the same spatial filter defined above.</p><p>We can define column and row filters for the ZTF catalog based on its schema, similar to the previous section:</p><div id="HWNcVtCnQo" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">ztf_schema = pq.read_schema(
    f&quot;s3://{ztf_bucket}/{ztf_hats_prefix}/{ztf_schema_path}&quot;,
    filesystem=s3
)
ztf_schema_df = pq_schema_to_df(ztf_schema)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="XwjhlbGajrxp1CJoPegFs" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>You can filter the schema further by units, type, etc. to identify other columns of interest.
It’s also useful to go through the <a target="_blank" rel="noreferrer" href="https://irsa.ipac.caltech.edu/data/ZTF/docs/releases/ztf_release_notes_latest" class="">ZTF DR23 release notes</a> and <a target="_blank" rel="noreferrer" href="https://irsa.ipac.caltech.edu/data/ZTF/docs/ztf_explanatory_supplement.pdf" class="">explanatory supplement</a> at IRSA for more details on column selections and caveats.</p><p>For this tutorial, the following columns are most relevant to us:</p><div id="qvUSkhelBN" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">ztf_columns = ztf_schema_df[&quot;name&quot;].tolist()[:6]
ztf_columns.extend([
    &#x27;fid&#x27;, &#x27;filtercode&#x27;, 
    &#x27;ngoodobsrel&#x27;,  
    &#x27;chisq&#x27;, &#x27;magrms&#x27;, &#x27;meanmag&#x27;, &#x27;medianabsdev&#x27;
])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Z44lmVuDFdkoDhk0scv8d" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>The rationale for selecting these columns is as follows:</p><div id="yY4DJDRHcM" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">ztf_schema_df[ztf_schema_df.name.isin(ztf_columns)]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="8wnrj0s9zEeF6lD59XW8c" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>For a quality cut, we apply the following filter on the number of good epochs (from <cite class="" data-state="closed"><a href="https://doi.org/10.1093/mnras/stab1502" target="_blank" rel="noreferrer" class="hover-link">Coughlin <em>et al.</em> (2021)</a></cite>) section 2):</p><div id="awhCIEjwHg" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">quality_filters = [
    [&quot;ngoodobsrel&quot;, &quot;&gt;&quot;, 50]
]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="D_ReDn3fY3F-O0GxC7Q3O" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="id-5-crossmatch-euclid-q1-x-ztf-dr23-objects" class="relative group"><span class="heading-text">5. Crossmatch: Euclid Q1 x ZTF DR23 Objects</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-5-crossmatch-euclid-q1-x-ztf-dr23-objects" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Now that we have defined the spatial, column, and row filters for both catalogs, we can use lsdb to perform the crossmatch.</p><h3 id="id-5-1-create-crossmatch-query-using-the-filters" class="relative group"><span class="heading-text">5.1 Create crossmatch query using the filters</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-5-1-create-crossmatch-query-using-the-filters" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Following lsdb’s documentation on <a target="_blank" rel="noreferrer" href="https://docs.lsdb.io/en/latest/getting-started.html#performing-filters" class="">performing filters</a>, we open the Euclid Q1 catalog with the defined spatial, column, and row filters:</p><div id="sLveHeipfi" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">euclid_cone = lsdb.open_catalog(
    f&quot;s3://{euclid_q1_bucket}/{euclid_q1_hats_prefix}&quot;,
    columns=euclid_columns,
    search_filter=spatial_filter,
    filters=galaxy_filters
)
euclid_cone</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="t4NPs2z46HKGIcaR5htn2" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Notice how the number of partitions reduced from 114 (in section 2) to only a few partitions that are within the spatial filter.
This allows LSDB to avoid loading unused parts of the catalog.
Also, we see only the columns we selected in the column filters.</p><p>Now, similarly, we open the ZTF DR23 Objects catalog with its defined filters:</p><div id="hqLBIaCk7k" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">ztf_cone = lsdb.open_catalog(
    f&quot;s3://{ztf_bucket}/{ztf_hats_prefix}&quot;,
    columns=ztf_columns,
    search_filter=spatial_filter,
    filters=quality_filters
)
ztf_cone</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4k5Ebpyg70SLXzvSQGF88" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>We see a similar reduction in the number of partitions for this catalog as well, and our column selection is applied.</p><p>Now we can use lsdb’s <a target="_blank" rel="noreferrer" href="https://docs.lsdb.io/en/latest/tutorials/pre_executed/crossmatching.html#2.-Perform-the-crossmatch-on-the-small-catalogs" class="">crossmatch functionality</a> to plan a crossmatch between these two filtered catalogs.
Note that the order of crossmatch matters: lsdb’s algorithm takes each object in the left catalog and finds the closest spatial match from the right catalog.
Since Euclid is denser than ZTF, we put it on the left side of the crossmatch to maximize the number of matches.
For more details on the parameters, refer to the documentation linked.</p><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Note</div></div><div class="myst-admonition-body px-4 py-1"><p>Since ZTF objects are defined per band, setting <code>n_neighbors=1</code> means this is only going to return data in one ZTF band for each Euclid object. This is done for simplicity of analysing the crossmatched results in subsequent sections but you can increase <code>n_neighbors</code> to get data in multiple ZTF bands.</p></div></aside><div id="a76rft0BwU" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">euclid_x_ztf = euclid_cone.crossmatch(
    ztf_cone,
    suffixes=(&quot;_euclid&quot;, &quot;_ztf&quot;), # to distinguish columns from the two catalogs
    n_neighbors=1, # default is 1 too, can be tweaked
    radius_arcsec=1  # default is 1 arcsec too, can be tweaked
)
euclid_x_ztf</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="cK8s67LLyu-o-xopNNRn1" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Note how the resulting crossmatched catalog contains columns from both catalogs with the suffixes we passed.
As we noticed when opening the catalog, this created a crossmatch catalog object lazily but did not execute the crossmatch.</p><h3 id="id-5-2-execute-the-query-and-load-data" class="relative group"><span class="heading-text">5.2 Execute the query and load data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-5-2-execute-the-query-and-load-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Now we can run the crossmatch query we have been planning so far by using the <code>compute()</code> method of the crossmatch catalog object, which will perform all the tasks and return the result as a DataFrame.
lsdb utilizes <a target="_blank" rel="noreferrer" href="https://docs.dask.org/en/stable/" class="">Dask</a> to parallelize the tasks on different partitions, so we need to create a Dask client to manage the resources (and track progress) for the scope of this computation:</p><div id="sHwrXZs6jb" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def get_nworkers(catalog):
    return min(os.cpu_count(), catalog.npartitions + 1)

with Client(n_workers=get_nworkers(euclid_x_ztf), 
            threads_per_worker=2, 
            memory_limit=&#x27;auto&#x27;) as client:
    print(f&quot;This may take more than a few minutes to complete. You can monitor progress in Dask dashboard at {client.dashboard_link}&quot;)
    euclid_x_ztf_df = euclid_x_ztf.compute() # this will load the data into memory finally</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="6xznDzrl2wc1lhQpjxirm" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>This may take more than a few minutes to complete. You can monitor progress in Dask dashboard at http://127.0.0.1:8787/status
</span></code></pre></div></div></div><div id="dbDf7pjgc5" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">euclid_x_ztf_df</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="mhGHRMNmcTpt2ecew9Ouc" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><h3 id="id-5-3-identify-objects-of-interest-from-the-crossmatch" class="relative group"><span class="heading-text">5.3 Identify objects of interest from the crossmatch</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-5-3-identify-objects-of-interest-from-the-crossmatch" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Check the number of unique Euclid and ZTF sources in the crossmatched catalog:</p><div id="HT4tozPuEd" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">euclid_x_ztf_df.shape[0], euclid_x_ztf_df[&#x27;object_id_euclid&#x27;].nunique(), euclid_x_ztf_df[&#x27;oid_ztf&#x27;].nunique()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Qiwq9Tki3YnGeUnhuQ2QN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>(4833, 4833, 4808)</span></code></div></div></div><p>This means there is one unique Euclid source for each row in the crossmatched catalog as expected (since we put Euclid on the left side of the crossmatch).
But for ZTF, this is not true as some ZTF objects have multiple Euclid matches since ZTF has lower resolution than Euclid.</p><p>Now let’s plot some variability metrics from ZTF against Euclid redshift to see if there are any trends.
We will use hexbin plots to visualize the density of sources in each panel:</p><div id="vSvlVL00UA" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">z = euclid_x_ztf_df[&quot;phz_phz_median_euclid&quot;].to_numpy() # x-axis
metrics = [ # y-axes
    (&quot;magrms_ztf&quot;,        &quot;ZTF mag RMS&quot;),
    (&quot;chisq_ztf&quot;,         &quot;ZTF χ²&quot;),
    (&quot;medianabsdev_ztf&quot;,  &quot;ZTF MAD&quot;),
    (&quot;ngoodobsrel_ztf&quot;,   &quot;ZTF # good obs&quot;),
]

fig, axes = plt.subplots(2, 2, figsize=(10, 6), constrained_layout=True, sharex=True)
axes = axes.ravel()

xmin, xmax = 0, 2.5  
gridsize = 48  # resolution: larger =&gt; finer grid

for i, (col, ylabel) in enumerate(metrics):
    ax = axes[i]
    y = euclid_x_ztf_df[col].to_numpy()

    # clip y to robust range (1–99th percentile) for visibility
    y_lo, y_hi = np.nanpercentile(y, [1, 99])

    hb = ax.hexbin(
        z, y,
        gridsize=gridsize,
        extent=(xmin, xmax, y_lo, y_hi),
        mincnt=1,
        bins=&#x27;log&#x27;  # logarithmic color scale of counts
    )

    # ax.set_xlim(xmin, xmax)
    # ax.set_ylim(y_lo, y_hi)
    ax.set_ylabel(ylabel)

    # x-label only on bottom row to reduce clutter
    if i // 2 == 1:
        ax.set_xlabel(&quot;Euclid redshift&quot;)


# Shared colorbar across all panels (uses last hexbin as mappable)
cbar = fig.colorbar(hb, ax=axes[:-1], shrink=0.9, label=&quot;Galaxy sources count (log)&quot;)

fig.suptitle(&quot;Euclid redshift vs ZTF variability metrics&quot;, y=1.04)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="D7GmRwuW97hi86pbJe-x9" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/irsa-tutorials/build/5f8fc2e41bd9c98e75d39a0dba044886.png" alt="&lt;Figure size 1000x600 with 5 Axes&gt;"/></div></div><p>There’s no strong variability trend for higher redshift galaxies (z &gt; 1) as the distributions of mag RMS, MAD, and Chi-squared are fairly stable with redshift.
This is likely because of the limited sensitivity of ZTF, as there are clearly fewer good observations as redshift increases.</p><p>Despite this, we can still select some high-variability galaxy sources from the low redshift (z &lt; 1) range for further analysis.
Let’s focus only on Chi-squared (measure of significance) and RMS magnitude (measure of variability amplitude; similar to MAD) metrics:</p><div id="OakXOszAAD" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">euclid_x_ztf_df[&#x27;chisq_ztf&#x27;].describe()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="P3CyMgkjHsZcP66Ix5nwB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>count       4833.0
mean      1.125982
std       0.677987
min       0.648965
25%       0.964728
50%       1.050994
75%       1.161509
max      27.873291
Name: chisq_ztf, dtype: double[pyarrow]</span></code></div></div></div><div id="V0y66X80Mz" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">chisq_threshold = euclid_x_ztf_df[&#x27;chisq_ztf&#x27;].quantile(0.95)
chisq_threshold</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="KDMlj-aCIV3S4ao0V9tiF" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>1.4483341455459593</span></code></div></div></div><div id="FMDG7XdApV" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">euclid_x_ztf_df[&#x27;magrms_ztf&#x27;].describe()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="6FcBRkdbuE0a-iPgz9XuJ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>count      4833.0
mean     0.219656
std      0.089749
min      0.010117
25%      0.175114
50%      0.234153
75%      0.277245
max      0.923869
Name: magrms_ztf, dtype: double[pyarrow]</span></code></div></div></div><div id="bXHLdpPvM8" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">magrms_threshold = euclid_x_ztf_df[&#x27;magrms_ztf&#x27;].quantile(0.95)
magrms_threshold</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="U_GQYHI5_cNFdCTVi-F9a" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>0.33570506572723385</span></code></div></div></div><div id="t0REX70A1y" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">variable_galaxies = euclid_x_ztf_df.query(
    f&quot;chisq_ztf &gt;= {chisq_threshold} &amp; magrms_ztf &gt;= {magrms_threshold}&quot;
    ).sort_values(&quot;chisq_ztf&quot;, ascending=False) # sort by significant variability</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="QJg2oH1SQ0Vx9RgQeajvJ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Let’s inspect the top variable galaxies that we can use for plotting their light curves:</p><div id="jynRJNfk3d" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">cols_of_interest = [&quot;oid_ztf&quot;, &quot;fid_ztf&quot;, &quot;filtercode_ztf&quot;, &quot;phz_phz_median_euclid&quot;, &quot;magrms_ztf&quot;, &quot;chisq_ztf&quot;]
top_variable_galaxies = variable_galaxies.head(3)
top_variable_galaxies[cols_of_interest]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="jaeDUAP-DaNKcvLTs21ls" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><h2 id="id-6-load-ztf-lightcurves-by-object-ids" class="relative group"><span class="heading-text">6. Load ZTF lightcurves by object IDs</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-6-load-ztf-lightcurves-by-object-ids" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Let’s open the ZTF light curves HATS catalog.
Note that we are using the same spatial filter as before.
We do not specify any column filters, because the default columns already contain the light curve data we need.
We also do not apply any row filters, since we will directly filter rows by object IDs.</p><div id="lqwplVvoS1" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">ztf_lc_catalog = lsdb.open_catalog(f&quot;s3://{ztf_bucket}/{ztf_lc_hats_prefix}&quot;,
                                   search_filter=spatial_filter
                                   )
ztf_lc_catalog</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="234XCRvbnEXeyws3NXLsv" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>We can inspect the catalog’s collection properties and find which columns have ancillary index tables (as explained in lsdb’s documentation on <a target="_blank" rel="noreferrer" href="https://docs.lsdb.io/en/latest/tutorials/pre_executed/index_table.html" class="">using index tables</a>).</p><div id="uWlHwXbNvN" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">ztf_lc_idx_column = list(ztf_lc_catalog.hc_collection.all_indexes.keys())[0]
ztf_lc_idx_column</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="9pLmYb4LEwiQWLog5Yj67" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&#x27;objectid&#x27;</span></code></div></div></div><p>Let’s just extract the object IDs of the top variable galaxies we identified above:</p><div id="DEV2FySOAi" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">ztf_oids = top_variable_galaxies[&#x27;oid_ztf&#x27;].tolist()
ztf_oids</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="2TTwKIQGhU9hheZsJzb0U" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>[848201300014047, 848102400023608, 848202400038072]</span></code></div></div></div><p>Now we can use these IDs to filter the ZTF light curves catalog by the <code>id_search</code> method:</p><div id="UOveHkjIwk" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">ztf_lcs = ztf_lc_catalog.id_search(values={ztf_lc_idx_column: ztf_oids})
ztf_lcs</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="fAgct18o3dAV_6ODywbiX" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>As earlier, this creates a lazy catalog object with the partition(s) that contains our IDs.
We can load the light curves data into a DataFrame by using the <code>compute()</code> method:</p><div id="HqeCKv4oFA" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">ztf_lcs_df = ztf_lcs.compute() # ID search runs out of memory if we try to parallelize it with Dask client
ztf_lcs_df</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="N_bxqVYWBYrUogf9OBqCk" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Let’s merge this light curves DataFrame with the crossmatched catalog (with variability filters and sorting) so that we can use collapsed light curves metrics for annotating the plots:</p><div id="HWsdFP7Uep" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">merged_ztf_lcs_df = ztf_lcs_df.merge(
    top_variable_galaxies[cols_of_interest].set_index(&#x27;oid_ztf&#x27;),
    left_on=&#x27;objectid&#x27;, right_index=True
).set_index(&#x27;objectid&#x27;, drop=False)

# Sort by the order of top_variable_galaxies
merged_ztf_lcs_df = merged_ztf_lcs_df.loc[ztf_oids]
merged_ztf_lcs_df</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="n0byOf8ql8qMD5ngWGaVi" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Now we can finally plot the light curves of these variable galaxy candidates.
We need to filter out bad epochs using the <code>catflags</code> column as explained in the <a target="_blank" rel="noreferrer" href="https://irsa.ipac.caltech.edu/data/ZTF/docs/ztf_explanatory_supplement.pdf" class="">ZTF DR23 explanatory supplement</a> section 13.6.
Then, we will plot the light curves in separate panels for each object:</p><div id="xzPxqHKzIS" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig, axs = plt.subplots(len(merged_ztf_lcs_df), 1, figsize=(10, 4 * len(merged_ztf_lcs_df)), constrained_layout=True)

if len(merged_ztf_lcs_df) == 1:
    axs = [axs]

for ax, (_, row) in zip(axs, merged_ztf_lcs_df.iterrows()):
    lc = row[&#x27;lightcurve&#x27;].query(&quot;catflags == 0&quot;)  # remove bad epochs
    lc_label = (f&#x27;ZTF DR23 Object {row[&quot;objectid&quot;]} in band {row[&quot;filtercode_ztf&quot;][1]}\n&#x27;
                f&#x27;(z={row[&quot;phz_phz_median_euclid&quot;]:.2f}, RMS mag={row[&quot;magrms_ztf&quot;]:.3f}, Chi-sq={row[&quot;chisq_ztf&quot;]:.3f})&#x27;)
    pts = ax.plot(lc[&#x27;hmjd&#x27;], lc[&#x27;mag&#x27;], &#x27;.&#x27;, markersize=4, label=lc_label, zorder=3)
    ax.errorbar(
        lc[&#x27;hmjd&#x27;], lc[&#x27;mag&#x27;], yerr=lc[&#x27;magerr&#x27;],
        fmt=&#x27;none&#x27;, ecolor=pts[0].get_color(), elinewidth=0.8, capsize=0, alpha=0.3, zorder=2
    )
    ax.set_ylabel(&#x27;Magnitude&#x27;)
    ax.set_xlabel(&#x27;HMJD&#x27;)
    ax.invert_yaxis()
    ax.set_title(lc_label, fontsize=10)

fig.suptitle(&quot;Lightcurves of Variable Galaxy Candidates&quot;, fontsize=14, y=1.02)
fig.set_constrained_layout_pads(h_pad=0.15)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="D92YMftxRNQVwA117Na7T" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/irsa-tutorials/build/0632036dbe05fc30d2ba9354579e6278.png" alt="&lt;Figure size 1000x1200 with 3 Axes&gt;"/></div></div><h2 id="about-this-notebook" class="relative group"><span class="heading-text">About this notebook</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#about-this-notebook" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Author: Jaladh Singhal, Troy Raen, Jessica Krick, Brigitta Sipőcz, Vandana Desai, and the IRSA Data Science Team</p><p>Updated: 2025-10-02</p><p>Contact: the <a target="_blank" rel="noreferrer" href="https://irsa.ipac.caltech.edu/docs/help_desk.html" class="">IRSA Helpdesk</a> with questions or to report problems.</p><div></div><section id="references" class="article-grid subgrid-gap col-screen"><div><header class="text-lg font-semibold text-stone-900 dark:text-white group">References<a class="no-underline text-inherit hover:text-inherit ml-2 select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#references" title="Link to References" aria-label="Link to References">¶</a></header></div><div class="pl-3 mb-8 text-xs text-stone-500 dark:text-stone-300"><ol><li class="break-words" id="cite-Coughlin_2021">Coughlin, M. W., Burdge, K., Duev, D. A., Katz, M. L., van Roestel, J., Drake, A., Graham, M. J., Hillenbrand, L., Mahabal, A. A., Masci, F. J., Mróz, P., Prince, T. A., Yao, Y., Bellm, E. C., Burruss, R., Dekany, R., Jaodand, A., Kaplan, D. L., Kupfer, T., … Zolkower, J. (2021). The ZTF Source Classification Project – II. Periodicity and variability processing metrics. <i>Monthly Notices of the Royal Astronomical Society</i>, <i>505</i>(2), 2954–2965. <a target="_blank" rel="noreferrer" href="https://doi.org/10.1093/mnras/stab1502">10.1093/mnras/stab1502</a></li></ol></div></section><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/irsa-tutorials/cloud-access-intro"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Special Topics</div>IRSA cloud access introduction</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/irsa-tutorials/seds-in-firefly"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">Special Topics</div>Using Firefly visualization tools in Python to vet SEDs</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></article></main><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/irsa-tutorials/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-XWET6RJ7.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-C7FW3E47.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-ND43KHSX.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/irsa-tutorials/build/root-ZJOPFBMV.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-NFM2H3KQ.js"/><link rel="modulepreload" href="/irsa-tutorials/build/routes/$-CQPS5IOR.js"/><script>window.__remixContext = {"url":"/irsa-hats-with-lsdb","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.4","options":{"outline_maxdepth":1,"favicon":"/irsa-tutorials/build/irsa-favicon-7816ba4985c4c07a3aec6d0bc169a8af.ico","logo":"/irsa-tutorials/build/irsa_logo-bd755426d9f69813fa092c6774d3180f.png"},"nav":[],"actions":[],"projects":[{"subject":"IRSA Tutorials","settings":{"output_matplotlib_strings":"remove"},"title":"IRSA Tutorials","description":"IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)","authors":[{"id":"IRSA Scientists and Developers","name":"IRSA Scientists and Developers"}],"github":"https://github.com/Caltech-IPAC/irsa-tutorials/","keywords":["astronomy"],"thebe":{"binder":{"url":"https://mybinder.org","provider":"github","repo":"https://github.com/Caltech-IPAC/irsa-tutorials/","ref":"HEAD"}},"toc":[{"file":"index.md","title":"IRSA Tutorials"},{"children":[{"file":"tutorials/spherex/spherex_intro.md"},{"file":"tutorials/spherex/spherex_cutouts.md"},{"file":"tutorials/spherex/spherex_psf.md"}],"title":"SPHEREx"},{"children":[{"children":[{"file":"tutorials/euclid_access/Euclid_ERO.md"}],"title":"Euclid Early Release Observations"},{"children":[{"file":"tutorials/euclid_access/1_Euclid_intro_MER_images.md"},{"file":"tutorials/euclid_access/2_Euclid_intro_MER_catalog.md"},{"file":"tutorials/euclid_access/3_Euclid_intro_1D_spectra.md"},{"file":"tutorials/euclid_access/4_Euclid_intro_PHZ_catalog.md"},{"file":"tutorials/euclid_access/5_Euclid_intro_SPE_catalog.md"},{"file":"tutorials/cloud_access/euclid-cloud-access.md"}],"title":"Euclid Quick Release 1"}],"title":"Euclid"},{"children":[{"children":[{"file":"tutorials/irsa-sia-examples/sia_allwise_atlas.md"},{"file":"tutorials/parquet-catalog-demos/wise-allwise-catalog-demo.md"}],"title":"AllWISE"},{"children":[{"file":"tutorials/firefly/NEOWISE_light_curve_demo.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-strategies.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-lightcurves.md"}],"title":"NEOWISE"}],"title":"WISE"},{"children":[{"file":"tutorials/irsa-sia-examples/siav2_seip.md"}],"title":"Spitzer"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_2mass_allsky.md"}],"title":"2MASS"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_cosmos.md"}],"title":"COSMOS"},{"children":[{"children":[{"file":"tutorials/roman_simulations/roman_hlss_number_density.md"}],"title":"Roman HLSS Galaxy Mock Catalog"},{"children":[{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_wideareasurvey.md"},{"file":"tutorials/firefly/OpenUniverse2024Preview_Firefly.md"},{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_timedomainsurvey.md"}],"title":"OpenUniverse 2024"},{"children":[{"file":"tutorials/cosmodc2/cosmoDC2_TAP_access.md"}],"title":"CosmoDC2"}],"title":"Simulated Data"},{"children":[{"file":"tutorials/cloud_access/cloud-access-intro.md"},{"file":"tutorials/parquet-catalog-demos/irsa-hats-with-lsdb.md"},{"file":"tutorials/firefly/SEDs_in_Firefly.md"},{"file":"tutorials/parallelize/Parallelize_Convolution.md"}],"title":"Special Topics"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"SPHEREx"},{"slug":"spherex-intro","title":"Introduction to SPHEREx Spectral Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-cutouts","title":"Download a collection of SPHEREx Spectral Image cutouts as a multi-extension FITS file","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-psf","title":"Understanding and Extracting the PSF Extension in a SPHEREx Cutout","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Euclid"},{"level":2,"title":"Euclid Early Release Observations"},{"slug":"euclid-ero","title":"Exploring Star Clusters in the Euclid ERO Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Euclid Quick Release 1"},{"slug":"euclid-intro-mer-images","title":"Euclid Q1: MER mosaics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-mer-catalog","title":"Euclid Q1: MER catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-1d-spectra","title":"Euclid Q1: 1D spectra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-phz-catalog","title":"Euclid Q1: PHZ catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-spe-catalog","title":"Euclid Q1: SPE catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-cloud-access","title":"Euclid Q1: cloud access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"WISE"},{"level":2,"title":"AllWISE"},{"slug":"sia-allwise-atlas","title":"Searching for AllWISE Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"wise-allwise-catalog-demo","title":"Analyzing cloud-hosted AllWISE Source Catalog in Parquet format","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"NEOWISE"},{"slug":"neowise-light-curve-demo","title":"Using Firefly visualization tools to understand the light curves of Solar System objects","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-strategies","title":"Strategies to Efficiently Work with NEOWISE Single-exposure Source Table in Parquet","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-lightcurves","title":"Make Light Curves from NEOWISE Single-exposure Source Table","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Spitzer"},{"slug":"siav2-seip","title":"Searching for Spitzer Enhanced Imaging Products","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"2MASS"},{"slug":"sia-2mass-allsky","title":"Searching for 2MASS All-Sky Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"COSMOS"},{"slug":"sia-cosmos","title":"Searching for contributed COSMOS images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Simulated Data"},{"level":2,"title":"Roman HLSS Galaxy Mock Catalog"},{"slug":"roman-hlss-number-density","title":"Number Density as a Function of Redshift","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"OpenUniverse 2024"},{"slug":"openuniverse2024-roman-simulated-wideareasurvey","title":"Analyzing cloud-hosted simulated Roman coadded images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024preview-firefly","title":"Using Firefly to Explore OpenUniverse2024 Data Preview Simulated Roman and Rubin Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024-roman-simulated-timedomainsurvey","title":"Analyzing cloud-hosted simulated Roman Time Domain Survey images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"CosmoDC2"},{"slug":"cosmodc2-tap-access","title":"Querying CosmoDC2 Mock v1 catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Special Topics"},{"slug":"cloud-access-intro","title":"IRSA cloud access introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"irsa-hats-with-lsdb","title":"Access HATS Collections Using LSDB: Euclid Q1 and ZTF DR23","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"seds-in-firefly","title":"Using Firefly visualization tools in Python to vet SEDs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"parallelize-convolution","title":"Parallelizing image convolution","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/irsa-tutorials"},"routes/$":{"config":{"version":2,"myst":"1.6.4","options":{"outline_maxdepth":1,"favicon":"/irsa-tutorials/build/irsa-favicon-7816ba4985c4c07a3aec6d0bc169a8af.ico","logo":"/irsa-tutorials/build/irsa_logo-bd755426d9f69813fa092c6774d3180f.png"},"nav":[],"actions":[],"projects":[{"subject":"IRSA Tutorials","settings":{"output_matplotlib_strings":"remove"},"title":"IRSA Tutorials","description":"IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)","authors":[{"id":"IRSA Scientists and Developers","name":"IRSA Scientists and Developers"}],"github":"https://github.com/Caltech-IPAC/irsa-tutorials/","keywords":["astronomy"],"thebe":{"binder":{"url":"https://mybinder.org","provider":"github","repo":"https://github.com/Caltech-IPAC/irsa-tutorials/","ref":"HEAD"}},"toc":[{"file":"index.md","title":"IRSA Tutorials"},{"children":[{"file":"tutorials/spherex/spherex_intro.md"},{"file":"tutorials/spherex/spherex_cutouts.md"},{"file":"tutorials/spherex/spherex_psf.md"}],"title":"SPHEREx"},{"children":[{"children":[{"file":"tutorials/euclid_access/Euclid_ERO.md"}],"title":"Euclid Early Release Observations"},{"children":[{"file":"tutorials/euclid_access/1_Euclid_intro_MER_images.md"},{"file":"tutorials/euclid_access/2_Euclid_intro_MER_catalog.md"},{"file":"tutorials/euclid_access/3_Euclid_intro_1D_spectra.md"},{"file":"tutorials/euclid_access/4_Euclid_intro_PHZ_catalog.md"},{"file":"tutorials/euclid_access/5_Euclid_intro_SPE_catalog.md"},{"file":"tutorials/cloud_access/euclid-cloud-access.md"}],"title":"Euclid Quick Release 1"}],"title":"Euclid"},{"children":[{"children":[{"file":"tutorials/irsa-sia-examples/sia_allwise_atlas.md"},{"file":"tutorials/parquet-catalog-demos/wise-allwise-catalog-demo.md"}],"title":"AllWISE"},{"children":[{"file":"tutorials/firefly/NEOWISE_light_curve_demo.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-strategies.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-lightcurves.md"}],"title":"NEOWISE"}],"title":"WISE"},{"children":[{"file":"tutorials/irsa-sia-examples/siav2_seip.md"}],"title":"Spitzer"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_2mass_allsky.md"}],"title":"2MASS"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_cosmos.md"}],"title":"COSMOS"},{"children":[{"children":[{"file":"tutorials/roman_simulations/roman_hlss_number_density.md"}],"title":"Roman HLSS Galaxy Mock Catalog"},{"children":[{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_wideareasurvey.md"},{"file":"tutorials/firefly/OpenUniverse2024Preview_Firefly.md"},{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_timedomainsurvey.md"}],"title":"OpenUniverse 2024"},{"children":[{"file":"tutorials/cosmodc2/cosmoDC2_TAP_access.md"}],"title":"CosmoDC2"}],"title":"Simulated Data"},{"children":[{"file":"tutorials/cloud_access/cloud-access-intro.md"},{"file":"tutorials/parquet-catalog-demos/irsa-hats-with-lsdb.md"},{"file":"tutorials/firefly/SEDs_in_Firefly.md"},{"file":"tutorials/parallelize/Parallelize_Convolution.md"}],"title":"Special Topics"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"SPHEREx"},{"slug":"spherex-intro","title":"Introduction to SPHEREx Spectral Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-cutouts","title":"Download a collection of SPHEREx Spectral Image cutouts as a multi-extension FITS file","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-psf","title":"Understanding and Extracting the PSF Extension in a SPHEREx Cutout","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Euclid"},{"level":2,"title":"Euclid Early Release Observations"},{"slug":"euclid-ero","title":"Exploring Star Clusters in the Euclid ERO Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Euclid Quick Release 1"},{"slug":"euclid-intro-mer-images","title":"Euclid Q1: MER mosaics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-mer-catalog","title":"Euclid Q1: MER catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-1d-spectra","title":"Euclid Q1: 1D spectra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-phz-catalog","title":"Euclid Q1: PHZ catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-spe-catalog","title":"Euclid Q1: SPE catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-cloud-access","title":"Euclid Q1: cloud access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"WISE"},{"level":2,"title":"AllWISE"},{"slug":"sia-allwise-atlas","title":"Searching for AllWISE Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"wise-allwise-catalog-demo","title":"Analyzing cloud-hosted AllWISE Source Catalog in Parquet format","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"NEOWISE"},{"slug":"neowise-light-curve-demo","title":"Using Firefly visualization tools to understand the light curves of Solar System objects","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-strategies","title":"Strategies to Efficiently Work with NEOWISE Single-exposure Source Table in Parquet","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-lightcurves","title":"Make Light Curves from NEOWISE Single-exposure Source Table","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Spitzer"},{"slug":"siav2-seip","title":"Searching for Spitzer Enhanced Imaging Products","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"2MASS"},{"slug":"sia-2mass-allsky","title":"Searching for 2MASS All-Sky Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"COSMOS"},{"slug":"sia-cosmos","title":"Searching for contributed COSMOS images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Simulated Data"},{"level":2,"title":"Roman HLSS Galaxy Mock Catalog"},{"slug":"roman-hlss-number-density","title":"Number Density as a Function of Redshift","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"OpenUniverse 2024"},{"slug":"openuniverse2024-roman-simulated-wideareasurvey","title":"Analyzing cloud-hosted simulated Roman coadded images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024preview-firefly","title":"Using Firefly to Explore OpenUniverse2024 Data Preview Simulated Roman and Rubin Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024-roman-simulated-timedomainsurvey","title":"Analyzing cloud-hosted simulated Roman Time Domain Survey images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"CosmoDC2"},{"slug":"cosmodc2-tap-access","title":"Querying CosmoDC2 Mock v1 catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Special Topics"},{"slug":"cloud-access-intro","title":"IRSA cloud access introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"irsa-hats-with-lsdb","title":"Access HATS Collections Using LSDB: Euclid Q1 and ZTF DR23","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"seds-in-firefly","title":"Using Firefly visualization tools in Python to vet SEDs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"parallelize-convolution","title":"Parallelizing image convolution","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":2,"kind":"Notebook","sha256":"d7b9dace24caeb97a4cafd79cacb69b0cf8be0b3e15964e83c209623ad49041c","slug":"irsa-hats-with-lsdb","location":"/tutorials/parquet-catalog-demos/irsa-hats-with-lsdb.md","dependencies":[],"frontmatter":{"title":"Access HATS Collections Using LSDB: Euclid Q1 and ZTF DR23","kernelspec":{"name":"python3","display_name":"irsa-tutorials","language":"python"},"jupytext":{"text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.17.2"}},"content_includes_title":false,"authors":[{"id":"IRSA Scientists and Developers","name":"IRSA Scientists and Developers"}],"github":"https://github.com/Caltech-IPAC/irsa-tutorials/","subject":"IRSA Tutorials","keywords":["astronomy"],"settings":{"output_matplotlib_strings":"remove"},"numbering":{"title":{"offset":1}},"source_url":"https://github.com/Caltech-IPAC/irsa-tutorials//blob/main/tutorials/parquet-catalog-demos/irsa-hats-with-lsdb.md","edit_url":"https://github.com/Caltech-IPAC/irsa-tutorials//edit/main/tutorials/parquet-catalog-demos/irsa-hats-with-lsdb.md","exports":[{"format":"md","filename":"irsa-hats-with-lsdb.md","url":"/irsa-tutorials/build/irsa-hats-with-lsdb-502a62e1f3e2809bb8053eafcc5a0d3c.md"}]},"mdast":{"type":"root","children":[{"type":"block","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Learning Goals","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"JIKRx9I893"}],"identifier":"learning-goals","label":"Learning Goals","html_id":"learning-goals","implicit":true,"key":"z7WEaPq5uk"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"By the end of this tutorial, you will learn how to:","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"lJInZBAlEb"}],"key":"j61QarsDOy"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":22,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Use the ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"r1A0oP5efE"},{"type":"inlineCode","value":"lsdb","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"ezI8cwCc6R"},{"type":"text","value":" library to access IRSA HATS Collections from the cloud.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"ZjIcR6CSCC"}],"key":"g6GcFgopZE"}],"key":"K6mej8h2E6"},{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Define spatial, column, and row filters to read only a portion of large HATS catalogs.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"kNXyWFggdY"}],"key":"PKqyo3pX3d"}],"key":"JrLVNraJTB"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Crossmatch catalogs using ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"eHagJNn3kr"},{"type":"inlineCode","value":"lsdb","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"sRQ6Y871JT"},{"type":"text","value":" and visualize the results.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"UORqnpv5zC"}],"key":"AGd6xkxoGL"}],"key":"bMf1Lt3jzP"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Perform index searches on HATS catalogs using ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"SBGJAoCGVW"},{"type":"inlineCode","value":"lsdb","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"KvtlytldPU"},{"type":"text","value":".","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"TJCuzfnhoK"}],"key":"Kb3zDQGXjU"}],"key":"veoTAIB9Fm"}],"key":"N5g9nofG9e"}],"key":"kXBh3dqiM5"},{"type":"block","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"M0rVU6y41b"}],"identifier":"introduction","label":"Introduction","html_id":"introduction","implicit":true,"key":"YiVVUdO3Zb"},{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"IRSA provides several astronomical catalogs in spatially partitioned ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"raHsEYYgKq"},{"type":"link","url":"https://parquet.apache.org/","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"Parquet format","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"NQOY6EvNrt"}],"urlSource":"https://parquet.apache.org/","key":"L7Eqzu0kNc"},{"type":"text","value":", enabling efficient access and scalable analysis of large datasets.\nAmong these are the ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"NRY5VMoSkV"},{"type":"link","url":"https://irsa.ipac.caltech.edu/docs/parquet_catalogs/#hats","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"HATS","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"O5Dfr3orhe"}],"urlSource":"https://irsa.ipac.caltech.edu/docs/parquet_catalogs/#hats","key":"mWTfc9hLo2"},{"type":"text","value":" (Hierarchical Adaptive Tiling Scheme) collections, which organize catalog data using adaptive ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"eNti9vSAO0"},{"type":"link","url":"https://irsa.ipac.caltech.edu/healpix/","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"HEALPix","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"qa8Bipiysv"}],"urlSource":"https://irsa.ipac.caltech.edu/healpix/","key":"LWTBp5Y9B8"},{"type":"text","value":"-based partitioning for parallelizable queries and crossmatching.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"jSK9PbwVih"}],"key":"E14fet47rl"},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"For more details on HATS collections, partitioning, and schema organization, see the IRSA documentation on ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"JG8oFtqEtc"},{"type":"link","url":"https://irsa.ipac.caltech.edu/docs/parquet_catalogs/","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Parquet catalogs","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"ihjsDXuT0V"}],"urlSource":"https://irsa.ipac.caltech.edu/docs/parquet_catalogs/","key":"IiAEDnj4up"},{"type":"text","value":".","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"gdTnQWk2w7"}],"key":"Tv35lyaXzI"},{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"This notebook demonstrates how to access and analyze HATS collections using the ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"wSOhOTUuj8"},{"type":"link","url":"https://docs.lsdb.io/en/latest/index.html","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"lsdb","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"C4NrsSloBq"}],"urlSource":"https://docs.lsdb.io/en/latest/index.html","key":"oMOztLLC9o"},{"type":"text","value":" Python library, which makes it convenient to work with these large datasets.\nWe will explore the following IRSA HATS collections in this tutorial:","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"Csh6CO7lTp"}],"key":"pjq3QOvxIa"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":39,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Euclid Q1 Merged Objects: 14 Euclid Q1 tables, including MER (multi-wavelength mosaics) final catalog, photometric redshift catalogs, and spectroscopic catalogs joined on MER Object ID.","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"PjPAY9rcGE"}],"key":"KIJ84gBVj8"}],"key":"WCa8yPZX3Y"},{"type":"listItem","spread":true,"position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"ZTF DR23 Objects Table: catalog of PSF-fit photometry detections extracted from ZTF reference images, including “collapsed-lightcurve” metrics.","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"CTCE06i6zF"}],"key":"GykgcpdibM"}],"key":"fZxynumQOo"},{"type":"listItem","spread":true,"position":{"start":{"line":41,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"ZTF DR23 Lightcurves: catalog of PSF-fit photometry detections extracted from single-exposure images at the locations of Objects Table detections.","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"bukODLXumL"}],"key":"Fi8yPAkGyo"}],"key":"lNsO5rYKM0"}],"key":"ocWh3pXBEH"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"We will use lsdb to leverage HATS partitioning for performing fast spatial queries on a relatively large area of sky and for crossmatching sources between Euclid and ZTF to identify variable galaxy candidates and visualize their light curves.","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"p3exrdBPa3"}],"key":"EkoFv2xpnc"}],"key":"jnUHq8JOvG"},{"type":"block","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"gXPDvj5HpH"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"dqEX7s52W3"}],"key":"P1MuIoNggl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Uncomment the next line to install dependencies if needed.\n# !pip install s3fs \"lsdb\u003e=0.6.6\" pyarrow pandas numpy astropy dask matplotlib","key":"mjPiZifzmY"},{"type":"output","id":"FujSVdgtrXW8MBOXq0LLg","data":[],"key":"raS87PW906"}],"key":"vn3zQj9TG0"},{"type":"block","children":[],"key":"DL8b7S38K3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import s3fs\nimport lsdb\nimport pyarrow.parquet as pq\nimport numpy as np\nimport pandas as pd\nfrom astropy import units as u\nfrom astropy.coordinates import SkyCoord\nimport os\nimport matplotlib.pyplot as plt\nfrom dask.distributed import Client","key":"IMchvf6O5t"},{"type":"output","id":"n_Hxl9RU_HXhv7-RpL3Ny","data":[],"key":"Lk3pteC7EU"}],"key":"oPP7eJ7y45"},{"type":"block","children":[],"key":"dRgGfKx8rm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pd.set_option(\"display.max_colwidth\", None) # schema descriptions can be long\npd.set_option(\"display.min_rows\", 18) # to show more rows when truncated view","key":"ir7ZNiIsw3"},{"type":"output","id":"y8dotqh5CYI8a2SjWdFUI","data":[],"key":"ZGFj0giLr5"}],"key":"q8ElUJNY8S"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"text","value":"1. Locate HATS collections in the cloud","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"UaqKydW5kS"}],"identifier":"id-1-locate-hats-collections-in-the-cloud","label":"1. Locate HATS collections in the cloud","html_id":"id-1-locate-hats-collections-in-the-cloud","implicit":true,"key":"urZX1lB14H"},{"type":"paragraph","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"text","value":"From IRSA’s ","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"z6XyrM5AID"},{"type":"link","url":"https://irsa.ipac.caltech.edu/cloud_access/","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"text","value":"cloud data access page","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"lHZLAILkLc"}],"urlSource":"https://irsa.ipac.caltech.edu/cloud_access/","key":"uU99DXA4tP"},{"type":"text","value":", let’s identify the bucket and path prefix for the HATS Collections for Euclid Q1 and ZTF DR23:","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"aGmWOcOkxA"}],"key":"VLcjXQKMCd"}],"key":"tvRmdE1oBZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"euclid_q1_bucket = \"nasa-irsa-euclid-q1\"\neuclid_q1_hats_prefix = \"contributed/q1/merged_objects/hats\"\n\nztf_bucket = \"ipac-irsa-ztf\"\nztf_hats_prefix = \"contributed/dr23/objects/hats\"\nztf_lc_hats_prefix = \"contributed/dr23/lc/hats\"","key":"xE5qAEy2fr"},{"type":"output","id":"5rXlNYehOM2URfC2Djl7f","data":[],"key":"pUbVnU6xFb"}],"key":"lbPUG5AhdM"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":85,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"link","url":"https://s3fs.readthedocs.io/en/latest/","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"s3fs","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"TXS8tXsVBB"}],"urlSource":"https://s3fs.readthedocs.io/en/latest/","key":"hjFrywUtlo"},{"type":"text","value":" provides a filesystem-like Python interface for AWS S3 buckets.\nFirst, we create an S3 client:","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"CJxUDaUdR1"}],"key":"Xu0Bhug0Fr"}],"key":"AfV2EJGLSq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"s3 = s3fs.S3FileSystem(anon=True)","key":"TXV9oYHQHH"},{"type":"output","id":"speHXnU78Cw5wJLovU3wn","data":[],"key":"AE6E4QZGM2"}],"key":"pvW3e6S7EG"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"text","value":"Using the S3 client, we can now list the contents of the Euclid Q1 HATS ","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"F7N1i8RGDu"},{"type":"strong","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"text","value":"collection","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"NKm2Po0P5D"}],"key":"BP23nAke5M"},{"type":"text","value":":","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"kMXxvk2kcN"}],"key":"s8AdKEx6Qc"}],"key":"kX84Ctj12K"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"s3.ls(f\"{euclid_q1_bucket}/{euclid_q1_hats_prefix}\")","key":"AFsGhxYDhQ"},{"type":"output","id":"-TczEe9fKfWXjEek9PGuL","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"['nasa-irsa-euclid-q1/contributed/q1/merged_objects/hats/collection.properties',\n 'nasa-irsa-euclid-q1/contributed/q1/merged_objects/hats/euclid_q1_merged_objects-hats',\n 'nasa-irsa-euclid-q1/contributed/q1/merged_objects/hats/euclid_q1_merged_objects-hats_index_object_id',\n 'nasa-irsa-euclid-q1/contributed/q1/merged_objects/hats/euclid_q1_merged_objects-hats_margin_10arcsec']","content_type":"text/plain"}}}],"key":"UKNyg8KP1J"}],"key":"Z9Pg7R27HF"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":98,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"In this collection, you can see collection properties, catalog, index table, and margin cache in order.\nYou can explore more directories to see how this HATS collection follows the directory structure described in IRSA’s documentation on ","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"fnSKpVVUWm"},{"type":"link","url":"https://irsa.ipac.caltech.edu/docs/parquet_catalogs/#hats","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"text","value":"HATS partitioning and HATS Collections","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"tZW8yeKS3Z"}],"urlSource":"https://irsa.ipac.caltech.edu/docs/parquet_catalogs/#hats","key":"trVRUIfdQ7"},{"type":"text","value":".","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"X93BUpJ6Tr"}],"key":"JYnIl2Wpc7"},{"type":"paragraph","position":{"start":{"line":101,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"As per the documentation, the Parquet file containing the schema for this ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"yhLHKAnJlV"},{"type":"inlineCode","value":"euclid_q1_merged_objects-hats","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"Xe3WZhuwrC"},{"type":"text","value":" catalog is stored in ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"gw8WCjYDzr"},{"type":"inlineCode","value":"dataset/_common_metadata","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"D8Re7maaF6"},{"type":"text","value":" directory.\nYou can find the catalog schema through other sources as well but we use the ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"p0akH7aIEF"},{"type":"inlineCode","value":"_common_metadata","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"GbzMYcmUMr"},{"type":"text","value":" file here because it contains column metadata (units and descriptions) which the other schemas don’t have.\nLet’s save its path for later use:","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"L3lmfyv0WL"}],"key":"PieaS0lQRk"}],"key":"XZpc8nVrCL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"euclid_q1_schema_path = \"euclid_q1_merged_objects-hats/dataset/_common_metadata\" # euclid_q1_merged_objects-hats is the catalog name we identified above","key":"QAuTIKcDmE"},{"type":"output","id":"Up77tLRxgfF9kNLGFOJWk","data":[],"key":"wAavX9HsoZ"}],"key":"FLe23o59Wy"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"Similarly, we can list the contents of the ZTF DR23 Objects HATS collection and save the path to its schema file:","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"fG07AwywCs"}],"key":"hI5SMfE1TK"}],"key":"iRYINeh4nU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"s3.ls(f\"{ztf_bucket}/{ztf_hats_prefix}\")","key":"BFON95CCTD"},{"type":"output","id":"Qo11awi2jtr3-xZJStBI8","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"['ipac-irsa-ztf/contributed/dr23/objects/hats/collection.properties',\n 'ipac-irsa-ztf/contributed/dr23/objects/hats/ztf_dr23_objects-hats',\n 'ipac-irsa-ztf/contributed/dr23/objects/hats/ztf_dr23_objects-hats_index_oid',\n 'ipac-irsa-ztf/contributed/dr23/objects/hats/ztf_dr23_objects-hats_margin_10arcsec']","content_type":"text/plain"}}}],"key":"e5DjTsodUa"}],"key":"YhpaNQEnk8"},{"type":"block","children":[],"key":"bGIoZCdHBL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ztf_schema_path = \"ztf_dr23_objects-hats/dataset/_common_metadata\" # ztf_dr23_objects-hats is the catalog name we identified above","key":"ZdF5895P3q"},{"type":"output","id":"IyjOYYyeMXH_TdbqtbSpM","data":[],"key":"M6yT9N9W5L"}],"key":"FPqly41mrs"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"2. Open the HATS catalogs","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"D3udJuH9hI"}],"identifier":"id-2-open-the-hats-catalogs","label":"2. Open the HATS catalogs","html_id":"id-2-open-the-hats-catalogs","implicit":true,"key":"jDMkagnzAR"},{"type":"paragraph","position":{"start":{"line":121,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"text","value":"Now we can use ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"Ka38IO7fJP"},{"type":"link","url":"https://docs.lsdb.io/en/latest/index.html","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"text","value":"lsdb","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"JdhYixqD5J"}],"urlSource":"https://docs.lsdb.io/en/latest/index.html","key":"nmUPnbfPDe"},{"type":"text","value":" to open the HATS catalogs we identified above, starting with the Euclid Q1 catalog.\nNote that we can simply pass the HATS collection path and it will automatically identify the catalog inside it and make use of the ancillary data (index table and margin cache) when needed.\nAlso, we prefix the path with ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"e8vAJBxSCb"},{"type":"inlineCode","value":"s3://","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"X4WTlq4PRu"},{"type":"text","value":" to indicate that it is an S3 path.","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"empvE0ZVig"}],"key":"WxxrHOmoKd"}],"key":"aROqx7ukbG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"euclid_catalog = lsdb.open_catalog(f\"s3://{euclid_q1_bucket}/{euclid_q1_hats_prefix}\")\neuclid_catalog","key":"ZaAFXi7N2C"},{"type":"output","id":"sV4p46-Au6wl8fX0WYRla","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"Dask NestedFrame Structure:\n                          object_id               ra              dec mer_flux_h_templfit mer_fluxerr_h_templfit  phz_phz_median class_phz_classification\nnpartitions=114                                                                                                                                          \n718306548379549696   int64[pyarrow]  double[pyarrow]  double[pyarrow]      float[pyarrow]         float[pyarrow]  float[pyarrow]           int32[pyarrow]\n719784292007280640              ...              ...              ...                 ...                    ...             ...                      ...\n...                             ...              ...              ...                 ...                    ...             ...                      ...\n2542493095883177984             ...              ...              ...                 ...                    ...             ...                      ...\n2542510688069222400             ...              ...              ...                 ...                    ...             ...                      ...\nDask Name: nestedframe, 3 expressions\nExpr=MapPartitions(NestedFrame)","content_type":"text/plain"},"text/html":{"content":"\u003cdiv\u003e\u003cstrong\u003elsdb Catalog Euclid_Q1_Merged_Objects:\u003c/strong\u003e\u003c/div\u003e\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003eobject_id\u003c/th\u003e\n      \u003cth\u003era\u003c/th\u003e\n      \u003cth\u003edec\u003c/th\u003e\n      \u003cth\u003emer_flux_h_templfit\u003c/th\u003e\n      \u003cth\u003emer_fluxerr_h_templfit\u003c/th\u003e\n      \u003cth\u003ephz_phz_median\u003c/th\u003e\n      \u003cth\u003eclass_phz_classification\u003c/th\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003enpartitions=114\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 7, Pixel: 40831\u003c/th\u003e\n      \u003ctd\u003eint64[pyarrow]\u003c/td\u003e\n      \u003ctd\u003edouble[pyarrow]\u003c/td\u003e\n      \u003ctd\u003edouble[pyarrow]\u003c/td\u003e\n      \u003ctd\u003efloat[pyarrow]\u003c/td\u003e\n      \u003ctd\u003efloat[pyarrow]\u003c/td\u003e\n      \u003ctd\u003efloat[pyarrow]\u003c/td\u003e\n      \u003ctd\u003eint32[pyarrow]\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 7, Pixel: 40915\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e...\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 6, Pixel: 36130\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 7, Pixel: 144524\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e\u003cdiv\u003e7 out of 1593 available columns in the catalog have been loaded \u003cstrong\u003elazily\u003c/strong\u003e, meaning no data has been read, only the catalog schema\u003c/div\u003e","content_type":"text/html"}}}],"key":"ZI8phREyA5"}],"key":"yTM1bShs5S"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Few things to note here:","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"lCR0LvK4kn"}],"key":"fhOLumA2ki"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":132,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"This catalog is opened ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"hYGMyB9lAs"},{"type":"link","url":"https://docs.lsdb.io/en/latest/tutorials/lazy_operations.html","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"lazily","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"tLSECDMt51"}],"urlSource":"https://docs.lsdb.io/en/latest/tutorials/lazy_operations.html","key":"M9ZevPDDaT"},{"type":"text","value":", i.e., no data is read from the S3 bucket into memory yet.","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"CYPtbwYUGn"}],"key":"ocYa5hu2OM"}],"key":"gb8ldOoL2V"},{"type":"listItem","spread":true,"position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Since we did not specify any columns to select from this very wide catalog, we get 7 default columns out of 1593 available columns!","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"mqkxugnB22"}],"key":"eL6OR350xK"}],"key":"HXdqtqPet3"},{"type":"listItem","spread":true,"position":{"start":{"line":134,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We see some of the HEALPix orders and pixels at which this catalog is partitioned.","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"RCWxMzOpeZ"}],"key":"sU4QMb1OKR"}],"key":"O5RII7ewjw"}],"key":"MhZClUJ0l5"},{"type":"paragraph","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"children":[{"type":"text","value":"Let’s plot the sky coverage of this catalog:","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"MfNCUFH2QR"}],"key":"cWA0z2b28v"}],"key":"KWaOmyT5MG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"euclid_catalog.plot_pixels()","key":"QoALzsKOBA"},{"type":"output","id":"o_6jLmdAoVSf4vhVVsSb4","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"(\u003cFigure size 1000x500 with 2 Axes\u003e,\n \u003cWCSAxes: title={'center': 'Catalog pixel map - Euclid_Q1_Merged_Objects'}\u003e)","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 1000x500 with 2 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"ae4ee040ebdf330342bf7dc8c728c362","path":"/irsa-tutorials/build/ae4ee040ebdf330342bf7dc8c728c362.png"}}}],"key":"EnjmeE7jVc"}],"key":"jXI0lKyEln"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"children":[{"type":"text","value":"Since HATS uses adaptive tile-based partitioning, we see higher order HEALPix tiles in regions with higher source density and lower order tiles in regions with lower source density.","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"q3g7sFc5nJ"}],"key":"BX1X1PmTGg"},{"type":"paragraph","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"children":[{"type":"text","value":"Now let’s open the ZTF DR23 Objects catalog in a similar manner and view its sky coverage:","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"key":"Q1NO5Y5hHn"}],"key":"ueyUVohr2K"}],"key":"gt12CBstYL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ztf_catalog = lsdb.open_catalog(f\"s3://{ztf_bucket}/{ztf_hats_prefix}\")\nztf_catalog","key":"KT61HH4VjE"},{"type":"output","id":"oeOmN1FGI9wky1qC3-Mny","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"Dask NestedFrame Structure:\n                                oid               ra              dec       filtercode       medianmag       medmagerr\nnpartitions=1791                                                                                                      \n0                    int64[pyarrow]  double[pyarrow]  double[pyarrow]  string[pyarrow]  float[pyarrow]  float[pyarrow]\n4503599627370496                ...              ...              ...              ...             ...             ...\n...                             ...              ...              ...              ...             ...             ...\n3457638613913698304             ...              ...              ...              ...             ...             ...\n3458764513820540928             ...              ...              ...              ...             ...             ...\nDask Name: nestedframe, 3 expressions\nExpr=MapPartitions(NestedFrame)","content_type":"text/plain"},"text/html":{"content":"\u003cdiv\u003e\u003cstrong\u003elsdb Catalog ZTF_DR23_Objects:\u003c/strong\u003e\u003c/div\u003e\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003eoid\u003c/th\u003e\n      \u003cth\u003era\u003c/th\u003e\n      \u003cth\u003edec\u003c/th\u003e\n      \u003cth\u003efiltercode\u003c/th\u003e\n      \u003cth\u003emedianmag\u003c/th\u003e\n      \u003cth\u003emedmagerr\u003c/th\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003enpartitions=1791\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 3, Pixel: 0\u003c/th\u003e\n      \u003ctd\u003eint64[pyarrow]\u003c/td\u003e\n      \u003ctd\u003edouble[pyarrow]\u003c/td\u003e\n      \u003ctd\u003edouble[pyarrow]\u003c/td\u003e\n      \u003ctd\u003estring[pyarrow]\u003c/td\u003e\n      \u003ctd\u003efloat[pyarrow]\u003c/td\u003e\n      \u003ctd\u003efloat[pyarrow]\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 3, Pixel: 1\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e...\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 4, Pixel: 3070\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 4, Pixel: 3071\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e\u003cdiv\u003e6 out of 76 available columns in the catalog have been loaded \u003cstrong\u003elazily\u003c/strong\u003e, meaning no data has been read, only the catalog schema\u003c/div\u003e","content_type":"text/html"}}}],"key":"cpBC6JKF67"}],"key":"t0qiWxoLLe"},{"type":"block","children":[],"key":"di9ElCWYfv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ztf_catalog.plot_pixels()","key":"ObHPR6JWD3"},{"type":"output","id":"Y4zZHrMAo7pVz4u_cmAnW","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/plain":{"content":"(\u003cFigure size 1000x500 with 2 Axes\u003e,\n \u003cWCSAxes: title={'center': 'Catalog pixel map - ZTF_DR23_Objects'}\u003e)","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 1000x500 with 2 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"10538ea5a175110a692d6516fb65079c","path":"/irsa-tutorials/build/10538ea5a175110a692d6516fb65079c.png"}}}],"key":"iX5TLKKriZ"}],"key":"aoLcnxwEre"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"3. Define filters for querying Euclid Q1 catalog","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"C7JcQlKiQZ"}],"identifier":"id-3-define-filters-for-querying-euclid-q1-catalog","label":"3. Define filters for querying Euclid Q1 catalog","html_id":"id-3-define-filters-for-querying-euclid-q1-catalog","implicit":true,"key":"LamFFujcB8"},{"type":"heading","depth":3,"position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"children":[{"type":"text","value":"3.1 Define a spatial filter","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"key":"j6MaJai0wt"}],"identifier":"id-3-1-define-a-spatial-filter","label":"3.1 Define a spatial filter","html_id":"id-3-1-define-a-spatial-filter","implicit":true,"key":"Y6JlTxGQbI"},{"type":"paragraph","position":{"start":{"line":159,"column":1},"end":{"line":161,"column":1}},"children":[{"type":"text","value":"From the above two plots, it’s clear that the ZTF DR23 Objects catalog covers a much larger area of the sky compared to the Euclid Q1 catalog.\nSo for cross-matching, we can safely pick the Euclid Deep Field North (EDF-N) region that is covered by both catalogs.\nFrom the ","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"key":"CCXvI0i8sQ"},{"type":"link","url":"https://irsa.ipac.caltech.edu/data/Euclid/docs/euclid_archive_at_irsa_user_guide.pdf","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"children":[{"type":"text","value":"Euclid user guide at IRSA","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"key":"sH4sGSVKAZ"}],"urlSource":"https://irsa.ipac.caltech.edu/data/Euclid/docs/euclid_archive_at_irsa_user_guide.pdf","key":"Y1Emoxp3DA"},{"type":"text","value":" Table 1, we identify the following for the EDF-N region:","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"key":"oqF0FN5B0t"}],"key":"X5txsKpGEJ"}],"key":"BI2Ibxcxnx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"euclid_DF_N_center = SkyCoord('17:58:55.9 +66:01:03.7', unit=('hourangle', 'deg'))\neuclid_DF_N_center","key":"J7AdShgKMi"},{"type":"output","id":"7QE3UxZrlNJ00cIsLpEI6","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"\u003cSkyCoord (ICRS): (ra, dec) in deg\n    (269.73291667, 66.01769444)\u003e","content_type":"text/plain"}}}],"key":"FErlcxKzfY"}],"key":"bQZIYLuWVh"},{"type":"block","children":[],"key":"Vbdla1WUZp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# euclid_DF_N_radius = 3 * u.deg  # ceil(sqrt(22.9 / pi)) approximate radius to cover almost entire EDF-N\neuclid_DF_N_radius = 0.5 * u.deg  # smaller radius to reduce execution time for this tutorial\neuclid_DF_N_radius","key":"HKXKdGIpEG"},{"type":"output","id":"9LWrzeYArydAzuK379s0Z","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/plain":{"content":"\u003cQuantity 0.5 deg\u003e","content_type":"text/plain"},"text/latex":{"content":"$0.5\\mathrm{{}^{\\circ}}$","content_type":"text/latex"}}}],"key":"os0uyBIvxC"}],"key":"O6Zd6NRslm"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"children":[{"type":"text","value":"Now, using lsdb, we define a cone ","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"kOkV6FdPxm"},{"type":"link","url":"https://docs.lsdb.io/en/latest/tutorials/region_selection.html#4.-The-Search-object","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"children":[{"type":"text","value":"search object","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"ajSKbFwvui"}],"urlSource":"https://docs.lsdb.io/en/latest/tutorials/region_selection.html#4.-The-Search-object","key":"fpHtdHTARF"},{"type":"text","value":" for this region that can be passed as a spatial filter when querying the catalogs:","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"H2wCFBrxH5"}],"key":"HW32qKSybL"}],"key":"oH4i4Q4Epi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"spatial_filter = lsdb.ConeSearch(\n    ra=euclid_DF_N_center.ra.deg, \n    dec=euclid_DF_N_center.dec.deg, \n    radius_arcsec=euclid_DF_N_radius.to(u.arcsec).value\n)","key":"pd6RhOFaG1"},{"type":"output","id":"HXedjHxNpx16EKBuUz4Y-","data":[],"key":"BAjHYqnjdK"}],"key":"eG5MxvhE2n"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"children":[{"type":"text","value":"We can overplot this spatial filter on the Euclid catalog’s sky coverage to verify (note we limited the field of view so that we can see the cone better):","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"yJ7DZYRazz"}],"key":"Sx3nEy0Qv2"}],"key":"KEyHcmDgHz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"euclid_catalog.plot_pixels(fov=(8 * u.deg, 6 * u.deg), center=euclid_DF_N_center)\nspatial_filter.plot(fc=\"#00000000\", ec=\"red\");","key":"yAiGwmICDz"},{"type":"output","id":"z56iSY5JeuE0nJQZyKA-u","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 1000x500 with 2 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"ad1ac00425c2fec1cb2e6115af70b8d7","path":"/irsa-tutorials/build/ad1ac00425c2fec1cb2e6115af70b8d7.png"}}}],"key":"jjULbsmvnI"}],"key":"KABX3ANETa"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"children":[{"type":"text","value":"3.2 Identify columns of interest from the schema","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"VD4iiranL8"}],"identifier":"id-3-2-identify-columns-of-interest-from-the-schema","label":"3.2 Identify columns of interest from the schema","html_id":"id-3-2-identify-columns-of-interest-from-the-schema","implicit":true,"key":"V0LhSOQd2N"},{"type":"paragraph","position":{"start":{"line":193,"column":1},"end":{"line":194,"column":1}},"children":[{"type":"text","value":"Before we can define column and row filters for querying any HATS catalog, we need to know what columns are available in that catalog.\nSo let’s inspect the schema of the Euclid Q1 catalog.","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"s0zNkD0CZl"}],"key":"zkvubTYfo7"},{"type":"paragraph","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"text","value":"Using pyarrow parquet, we can ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"gp23LzDyAA"},{"type":"link","url":"https://arrow.apache.org/docs/python/generated/pyarrow.parquet.read_schema.html#pyarrow.parquet.read_schema","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"text","value":"read the schema","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"ABLTVTH2gb"}],"urlSource":"https://arrow.apache.org/docs/python/generated/pyarrow.parquet.read_schema.html#pyarrow.parquet.read_schema","key":"MTlJyBCklZ"},{"type":"text","value":" from the ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"PiMsOzd8wj"},{"type":"inlineCode","value":"_common_metadata","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"daVKu2Hidd"},{"type":"text","value":" parquet file we identified above (note that we again prefixed the path with ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"sjEyA95H7R"},{"type":"inlineCode","value":"s3://","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"rV4LGzxM9T"},{"type":"text","value":" to indicate that it is an S3 path):","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"JXoQ4sdqwt"}],"key":"zeNUwifzjE"}],"key":"HJ5SETWN1H"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"euclid_schema = pq.read_schema(\n    f\"s3://{euclid_q1_bucket}/{euclid_q1_hats_prefix}/{euclid_q1_schema_path}\",\n    filesystem=s3\n)\ntype(euclid_schema)","key":"JvQnNWVLyp"},{"type":"output","id":"gFMpLMvst-zpWPqJ6wDQX","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/plain":{"content":"pyarrow.lib.Schema","content_type":"text/plain"}}}],"key":"KEepntSu8c"}],"key":"lBGcnbqWac"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"children":[{"type":"text","value":"Since the schema of this catalog is a pyarrow object, let’s convert it to a pandas DataFrame for easier inspection:","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"PzCDmRiqay"}],"key":"etvLdjM2Gm"}],"key":"TyT7vDyxWK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def pq_schema_to_df(schema):\n    \"\"\"Convert a PyArrow schema to a Pandas DataFrame.\"\"\"\n    return pd.DataFrame(\n        [\n            (\n                field.name,\n                str(field.type),\n                field.metadata.get(b\"unit\", b\"\").decode(),\n                field.metadata.get(b\"description\", b\"\").decode()\n            )\n            for field in schema # schema is an iterable of pyarrow fields\n        ],\n        columns=[\"name\", \"type\", \"unit\", \"description\"]\n    )\n\neuclid_schema_df = pq_schema_to_df(euclid_schema)\nlen(euclid_schema_df)","key":"iHbfkhnwPZ"},{"type":"output","id":"swLLCPDfHEyKjg_RdKyLU","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"1594","content_type":"text/plain"}}}],"key":"XxwNVY0SN5"}],"key":"QE0fB5PPS2"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"children":[{"type":"text","value":"As we saw above, the Euclid HATS catalog contains 1594 columns in its schema!","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"QNlOivLT8N"}],"key":"zjMXjhJiyK"},{"type":"paragraph","position":{"start":{"line":230,"column":1},"end":{"line":231,"column":1}},"children":[{"type":"text","value":"The columns at the beginning of this schema (such as “tileid”, “objectid”, “ra”, “dec”) define positions and IDs.\nThese can be useful for our ","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"hsW3x3T52t"},{"type":"strong","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"children":[{"type":"text","value":"column filters","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"pz8fzZu525"}],"key":"VmoUsuAtZg"},{"type":"text","value":" — the columns we want to SELECT when querying the catalog.","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"tG3ArHo5PF"}],"key":"jxcYGSx8jd"},{"type":"paragraph","position":{"start":{"line":233,"column":1},"end":{"line":234,"column":1}},"children":[{"type":"text","value":"We can also filter the schema DataFrame by name, unit, type, etc., to identify columns most relevant for our ","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"dN81CZ4kjC"},{"type":"strong","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"children":[{"type":"text","value":"row filters","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"eTFKOuhGHv"}],"key":"iRFHnz1vEJ"},{"type":"text","value":" — WHERE rows satisfy conditions on column values for our query.\nFor example, let’s explore the columns that are part of the PHZ (photometric redshift) catalog to identify photometric redshifts and source types:","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"TiBnyatScY"}],"key":"Vlc8vOiNjz"}],"key":"kiE3Y2SO3a"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"euclid_schema_df[\n    euclid_schema_df[\"name\"].str.startswith(\"phz_\") # phz_ prefix is for PHZ catalog columns in this merged catalog\n    \u0026 euclid_schema_df[\"type\"].str.contains(\"int\") # to see flag type columns\n]","key":"qHinzrh8mu"},{"type":"output","id":"nWdkHqxgec9zB_HyHfcFx","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/plain":{"content":"                       name   type unit  \\\n728             phz_bias_id  int32        \n729          phz_tom_bin_id  int32        \n730      phz_alt_tom_bin_id  int32        \n731      phz_pos_tom_bin_id  int32        \n773  phz_photometric_system  int32        \n774  phz_phz_classification  int32        \n775           phz_phz_flags  int32        \n\n                                                                                                                                                                      description  \n728                                                                               The identifier to be used for retrieving the bias correction shift from the bias correction map  \n729                                                                                              The identifier of the tomographic bin the source belongs to (Equipopulated-bins)  \n730                                                                                      The identifier of the alternate tomographic bin the source belongs to (Equidistant-bins)  \n731                                                                       The identifier of the photometric clustering tomographic bin the source belongs to (Equipopulated-bins)  \n773                                                                                     Encode the Photometric band configuration (indicating also the number of missing columns)  \n774  Classification flag: |1 if the source is accepted as star, |2 if it is accepted as a galaxy |4 if it is accepted as a QSO |8 if the source is accepted as a globular Cluster  \n775                An integer containing the flags of the PHZ processing. Meaning: 0 =\u003e OK, 1 =\u003e NNPZ flag: no close neighbor, 10 not VIS detected, 11 missing band, 12 too faint  ","content_type":"text/plain"},"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003ename\u003c/th\u003e\n      \u003cth\u003etype\u003c/th\u003e\n      \u003cth\u003eunit\u003c/th\u003e\n      \u003cth\u003edescription\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e728\u003c/th\u003e\n      \u003ctd\u003ephz_bias_id\u003c/td\u003e\n      \u003ctd\u003eint32\u003c/td\u003e\n      \u003ctd\u003e\u003c/td\u003e\n      \u003ctd\u003eThe identifier to be used for retrieving the bias correction shift from the bias correction map\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e729\u003c/th\u003e\n      \u003ctd\u003ephz_tom_bin_id\u003c/td\u003e\n      \u003ctd\u003eint32\u003c/td\u003e\n      \u003ctd\u003e\u003c/td\u003e\n      \u003ctd\u003eThe identifier of the tomographic bin the source belongs to (Equipopulated-bins)\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e730\u003c/th\u003e\n      \u003ctd\u003ephz_alt_tom_bin_id\u003c/td\u003e\n      \u003ctd\u003eint32\u003c/td\u003e\n      \u003ctd\u003e\u003c/td\u003e\n      \u003ctd\u003eThe identifier of the alternate tomographic bin the source belongs to (Equidistant-bins)\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e731\u003c/th\u003e\n      \u003ctd\u003ephz_pos_tom_bin_id\u003c/td\u003e\n      \u003ctd\u003eint32\u003c/td\u003e\n      \u003ctd\u003e\u003c/td\u003e\n      \u003ctd\u003eThe identifier of the photometric clustering tomographic bin the source belongs to (Equipopulated-bins)\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e773\u003c/th\u003e\n      \u003ctd\u003ephz_photometric_system\u003c/td\u003e\n      \u003ctd\u003eint32\u003c/td\u003e\n      \u003ctd\u003e\u003c/td\u003e\n      \u003ctd\u003eEncode the Photometric band configuration (indicating also the number of missing columns)\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e774\u003c/th\u003e\n      \u003ctd\u003ephz_phz_classification\u003c/td\u003e\n      \u003ctd\u003eint32\u003c/td\u003e\n      \u003ctd\u003e\u003c/td\u003e\n      \u003ctd\u003eClassification flag: |1 if the source is accepted as star, |2 if it is accepted as a galaxy |4 if it is accepted as a QSO |8 if the source is accepted as a globular Cluster\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e775\u003c/th\u003e\n      \u003ctd\u003ephz_phz_flags\u003c/td\u003e\n      \u003ctd\u003eint32\u003c/td\u003e\n      \u003ctd\u003e\u003c/td\u003e\n      \u003ctd\u003eAn integer containing the flags of the PHZ processing. Meaning: 0 =\u0026gt; OK, 1 =\u0026gt; NNPZ flag: no close neighbor, 10 not VIS detected, 11 missing band, 12 too faint\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e","content_type":"text/html"}}}],"key":"PyYqoBKvNW"}],"key":"MZrFO74D0G"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"children":[{"type":"text","value":"“phz_phz_median” gives us the median photometric redshift of sources, while “phz_phz_classification” can be used to filter the Euclid catalog to only galaxy-type sources.","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"Rb4k7MCMLI"}],"key":"ufLbvW2V8O"},{"type":"paragraph","position":{"start":{"line":245,"column":1},"end":{"line":246,"column":1}},"children":[{"type":"text","value":"You can explore the schema DataFrame further to identify any other columns of interest.\nIt is also useful to go through the description of Euclid Q1 data products and papers that contain different PHZ, MER, etc. catalog tables that are merged in this HATS catalog, which are linked in the ","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"A0BRTdxaxg"},{"type":"link","url":"https://caltech-ipac.github.io/irsa-tutorials/#todo-add-when-available","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"children":[{"type":"text","value":"Euclid Q1 HATS Parquet notebook","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"y4qSx5jA6Y"}],"urlSource":"https://caltech-ipac.github.io/irsa-tutorials/#todo-add-when-available","key":"GL0qY4LfmZ"},{"type":"text","value":".","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"zVpEQk2rYD"}],"key":"kbwgujQtDc"}],"key":"D95YQZPcYo"},{"type":"block","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"children":[{"type":"text","value":"3.3 Define column filters","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"key":"lCKcNFEvpd"}],"identifier":"id-3-3-define-column-filters","label":"3.3 Define column filters","html_id":"id-3-3-define-column-filters","implicit":true,"key":"mHDDovjV9q"}],"key":"Ec8k9bInzR"},{"type":"block","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"children":[{"type":"text","value":"For this tutorial, the following columns are most relevant to us:","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"key":"Zy7xEH164l"}],"key":"opt1sS0mOA"}],"key":"mp2IDuiX9q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"euclid_columns = euclid_schema_df['name'].iloc[:7].tolist() # the positional and ID columns\neuclid_columns.extend([\n    'phz_phz_median', # median of the photometric redshift PDF\n])","key":"YvVafIKti3"},{"type":"output","id":"-QCXZsR7ir9scC1W0RRdJ","data":[],"key":"jYLa9LRAu5"}],"key":"Ywl3OJyfK0"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"children":[{"type":"text","value":"The selected columns with their metadata are:","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"key":"XNhjhv9xk7"}],"key":"hHoBZAvohR"}],"key":"qN7Y8XMzbp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"euclid_schema_df[euclid_schema_df[\"name\"].isin(euclid_columns)]","key":"UXheogsdzB"},{"type":"output","id":"mZ35fzPLO8zKrceM0LNVB","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"               name    type unit  \\\n0       _healpix_29   int64        \n1       _healpix_19   int64        \n2        _healpix_9   int32        \n3            tileid   int64        \n4         object_id   int64  nan   \n5                ra  double  deg   \n6               dec  double  deg   \n720  phz_phz_median   float        \n\n                                                                   description  \n0                                                HEALPix order 29 pixel index.  \n1                                                HEALPix order 19 pixel index.  \n2                                                 HEALPix order 9 pixel index.  \n3                                                       Euclid MER tile index.  \n4                         Unique ID of the object in the survey, as set by MER  \n5     Source barycenter RA coordinate (SExtractor ALPHA_J2000) decimal degrees  \n6    Source barycenter DEC coordinate (SExtractor DELTA_J2000) decimal degrees  \n720                                                  The median of the PHZ PDF  ","content_type":"text/plain"},"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003ename\u003c/th\u003e\n      \u003cth\u003etype\u003c/th\u003e\n      \u003cth\u003eunit\u003c/th\u003e\n      \u003cth\u003edescription\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e0\u003c/th\u003e\n      \u003ctd\u003e_healpix_29\u003c/td\u003e\n      \u003ctd\u003eint64\u003c/td\u003e\n      \u003ctd\u003e\u003c/td\u003e\n      \u003ctd\u003eHEALPix order 29 pixel index.\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1\u003c/th\u003e\n      \u003ctd\u003e_healpix_19\u003c/td\u003e\n      \u003ctd\u003eint64\u003c/td\u003e\n      \u003ctd\u003e\u003c/td\u003e\n      \u003ctd\u003eHEALPix order 19 pixel index.\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e2\u003c/th\u003e\n      \u003ctd\u003e_healpix_9\u003c/td\u003e\n      \u003ctd\u003eint32\u003c/td\u003e\n      \u003ctd\u003e\u003c/td\u003e\n      \u003ctd\u003eHEALPix order 9 pixel index.\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e3\u003c/th\u003e\n      \u003ctd\u003etileid\u003c/td\u003e\n      \u003ctd\u003eint64\u003c/td\u003e\n      \u003ctd\u003e\u003c/td\u003e\n      \u003ctd\u003eEuclid MER tile index.\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e4\u003c/th\u003e\n      \u003ctd\u003eobject_id\u003c/td\u003e\n      \u003ctd\u003eint64\u003c/td\u003e\n      \u003ctd\u003enan\u003c/td\u003e\n      \u003ctd\u003eUnique ID of the object in the survey, as set by MER\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e5\u003c/th\u003e\n      \u003ctd\u003era\u003c/td\u003e\n      \u003ctd\u003edouble\u003c/td\u003e\n      \u003ctd\u003edeg\u003c/td\u003e\n      \u003ctd\u003eSource barycenter RA coordinate (SExtractor ALPHA_J2000) decimal degrees\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e6\u003c/th\u003e\n      \u003ctd\u003edec\u003c/td\u003e\n      \u003ctd\u003edouble\u003c/td\u003e\n      \u003ctd\u003edeg\u003c/td\u003e\n      \u003ctd\u003eSource barycenter DEC coordinate (SExtractor DELTA_J2000) decimal degrees\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e720\u003c/th\u003e\n      \u003ctd\u003ephz_phz_median\u003c/td\u003e\n      \u003ctd\u003efloat\u003c/td\u003e\n      \u003ctd\u003e\u003c/td\u003e\n      \u003ctd\u003eThe median of the PHZ PDF\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e","content_type":"text/html"}}}],"key":"qdWLcVht53"}],"key":"lFlhiEG7h2"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"children":[{"type":"text","value":"3.4 Define row filters","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"i9Td5sRNpF"}],"identifier":"id-3-4-define-row-filters","label":"3.4 Define row filters","html_id":"id-3-4-define-row-filters","implicit":true,"key":"KjyA6anLbM"}],"key":"GCZWAChUtj"},{"type":"block","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"text","value":"To identify the galaxies with quality redshifts in this catalog, the following filters can be applied to the rows (from ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"teUNYHr9Jq"},{"type":"link","url":"https://arxiv.org/pdf/2503.15306","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"text","value":"Tucci et al. 2025","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"H5TO4C5dGz"}],"urlSource":"https://arxiv.org/pdf/2503.15306","key":"ZH7z5sPZoo"},{"type":"text","value":" section 5.3):","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"mLOI7rv6O1"}],"key":"EDsjXdDi7b"},{"type":"paragraph","position":{"start":{"line":275,"column":1},"end":{"line":276,"column":1}},"children":[{"type":"text","value":"Note that these filters are defined as lists of lists, where each inner list represents a single condition in the format ","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"eBuEnNsX17"},{"type":"inlineCode","value":"[column_name, operator, value]","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"Wit6ZuT2xw"},{"type":"text","value":" and the conditions are combined using logical AND.\nMore on filters that lsdb supports can be found in its ","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"QnCbQPYRmz"},{"type":"link","url":"https://docs.lsdb.io/en/latest/getting-started.html#performing-filters","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"text","value":"documentation","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"bwcEYYUNMM"}],"urlSource":"https://docs.lsdb.io/en/latest/getting-started.html#performing-filters","key":"HLn0XL4gOe"},{"type":"text","value":".","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"TQFHbwIVTy"}],"key":"WiSqnLSQ57"}],"key":"os8wrCdFCp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def magnitude_to_flux(magnitude: float) -\u003e float:\n    \"\"\"Convert magnitude to flux following the MER Photometry Cookbook.\"\"\"\n    zeropoint = 23.9\n    flux = 10 ** ((magnitude - zeropoint) / -2.5)\n    return flux\n\ngalaxy_filters = [\n    ['phz_phz_classification', '==', 2], # 2 is for galaxies\n    ['mer_vis_det', '==', 1], # No NIR-only objects\n    ['mer_spurious_flag', '==', 0], # not spurious\n    ['mer_flux_detection_total', '\u003e', magnitude_to_flux(24.5)],  # I \u003c 24.5\n    # lsdb doesn't support column arithmetic in filters yet, so can rather apply the S/N \u003e 5 filter after loading the data\n    # ['mer_flux_detection_total', '/', 'mer_flux_detection_error_total', '\u003e', 5], # I band S/N \u003e 5\n]","key":"GIYx5qjvir"},{"type":"output","id":"53YVLUO5Mv474GC7l-TyZ","data":[],"key":"jv3M3akGub"}],"key":"vImDraN4J7"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"children":[{"type":"text","value":"4. Define filters for querying ZTF DR23 Objects catalog","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"kVe9a3TWE5"}],"identifier":"id-4-define-filters-for-querying-ztf-dr23-objects-catalog","label":"4. Define filters for querying ZTF DR23 Objects catalog","html_id":"id-4-define-filters-for-querying-ztf-dr23-objects-catalog","implicit":true,"key":"D3eFPsbOwK"},{"type":"paragraph","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"children":[{"type":"text","value":"Since we are interested in cross-matching ZTF DR23 Objects with the Euclid Q1 catalog, we will use the same spatial filter defined above.","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"U86OrczAKN"}],"key":"JPvOiuDreD"},{"type":"paragraph","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"children":[{"type":"text","value":"We can define column and row filters for the ZTF catalog based on its schema, similar to the previous section:","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"key":"cWrF27BSzB"}],"key":"c3ZAyVDUwe"}],"key":"mDthmXqyEY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ztf_schema = pq.read_schema(\n    f\"s3://{ztf_bucket}/{ztf_hats_prefix}/{ztf_schema_path}\",\n    filesystem=s3\n)\nztf_schema_df = pq_schema_to_df(ztf_schema)","key":"yPCVvzVe5T"},{"type":"output","id":"XwjhlbGajrxp1CJoPegFs","data":[],"key":"Owm61iJmfx"}],"key":"HWNcVtCnQo"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":309,"column":1},"end":{"line":310,"column":1}},"children":[{"type":"text","value":"You can filter the schema further by units, type, etc. to identify other columns of interest.\nIt’s also useful to go through the ","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"JLiMcwFMwe"},{"type":"link","url":"https://irsa.ipac.caltech.edu/data/ZTF/docs/releases/ztf_release_notes_latest","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"children":[{"type":"text","value":"ZTF DR23 release notes","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"GMT77zP53C"}],"urlSource":"https://irsa.ipac.caltech.edu/data/ZTF/docs/releases/ztf_release_notes_latest","key":"JM6lTm0UOR"},{"type":"text","value":" and ","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"Br40oyze6b"},{"type":"link","url":"https://irsa.ipac.caltech.edu/data/ZTF/docs/ztf_explanatory_supplement.pdf","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"children":[{"type":"text","value":"explanatory supplement","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"ffoahgfIrY"}],"urlSource":"https://irsa.ipac.caltech.edu/data/ZTF/docs/ztf_explanatory_supplement.pdf","key":"XwIIDFJu9j"},{"type":"text","value":" at IRSA for more details on column selections and caveats.","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"KbGv6Dz0OK"}],"key":"ismz7svE3O"},{"type":"paragraph","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"children":[{"type":"text","value":"For this tutorial, the following columns are most relevant to us:","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"DoTKmQJIPW"}],"key":"i5b0Q3WyFs"}],"key":"HQnE15QleB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ztf_columns = ztf_schema_df[\"name\"].tolist()[:6]\nztf_columns.extend([\n    'fid', 'filtercode', \n    'ngoodobsrel',  \n    'chisq', 'magrms', 'meanmag', 'medianabsdev'\n])","key":"mAVJuI7PG7"},{"type":"output","id":"Z44lmVuDFdkoDhk0scv8d","data":[],"key":"faRnMJJH0L"}],"key":"qvUSkhelBN"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":323,"column":1},"end":{"line":323,"column":1}},"children":[{"type":"text","value":"The rationale for selecting these columns is as follows:","position":{"start":{"line":323,"column":1},"end":{"line":323,"column":1}},"key":"SNPtuwcs9H"}],"key":"HkqvmQRftt"}],"key":"hhUXBtSg77"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ztf_schema_df[ztf_schema_df.name.isin(ztf_columns)]","key":"I7jDtZcgaf"},{"type":"output","id":"8wnrj0s9zEeF6lD59XW8c","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/plain":{"content":"            name    type unit  \\\n0    _healpix_29   int64        \n1    _healpix_19   int64        \n2     _healpix_9   int32        \n3            oid   int64        \n4             ra  double  deg   \n5            dec  double  deg   \n10           fid    int8        \n11    filtercode  string        \n17         chisq   float        \n20        magrms   float  mag   \n23       meanmag   float  mag   \n24  medianabsdev   float  mag   \n44   ngoodobsrel   int32        \n\n                                                                    description  \n0                                                 HEALPix order 29 pixel index.  \n1                                                 HEALPix order 19 pixel index.  \n2                                                  HEALPix order 9 pixel index.  \n3                                                      Unique object identifier  \n4                                                        Object Right Ascension  \n5                                                            Object Declination  \n10                                   Filter identifier (1 = zg; 2 = zr; 3 = zi)  \n11                                                     Filter code (zg, zr, zi)  \n17                                      Chi-square metric using nobs detections  \n20                             Root Mean Squared deviation over nobs magnitudes  \n23                                          Mean magnitude over nobs detections  \n24                 Median absolute deviation in magnitudes over nobs detections  \n44  Number of epochal detections in this release not associated with bad pixels  ","content_type":"text/plain"},"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003ename\u003c/th\u003e\n      \u003cth\u003etype\u003c/th\u003e\n      \u003cth\u003eunit\u003c/th\u003e\n      \u003cth\u003edescription\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e0\u003c/th\u003e\n      \u003ctd\u003e_healpix_29\u003c/td\u003e\n      \u003ctd\u003eint64\u003c/td\u003e\n      \u003ctd\u003e\u003c/td\u003e\n      \u003ctd\u003eHEALPix order 29 pixel index.\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1\u003c/th\u003e\n      \u003ctd\u003e_healpix_19\u003c/td\u003e\n      \u003ctd\u003eint64\u003c/td\u003e\n      \u003ctd\u003e\u003c/td\u003e\n      \u003ctd\u003eHEALPix order 19 pixel index.\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e2\u003c/th\u003e\n      \u003ctd\u003e_healpix_9\u003c/td\u003e\n      \u003ctd\u003eint32\u003c/td\u003e\n      \u003ctd\u003e\u003c/td\u003e\n      \u003ctd\u003eHEALPix order 9 pixel index.\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e3\u003c/th\u003e\n      \u003ctd\u003eoid\u003c/td\u003e\n      \u003ctd\u003eint64\u003c/td\u003e\n      \u003ctd\u003e\u003c/td\u003e\n      \u003ctd\u003eUnique object identifier\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e4\u003c/th\u003e\n      \u003ctd\u003era\u003c/td\u003e\n      \u003ctd\u003edouble\u003c/td\u003e\n      \u003ctd\u003edeg\u003c/td\u003e\n      \u003ctd\u003eObject Right Ascension\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e5\u003c/th\u003e\n      \u003ctd\u003edec\u003c/td\u003e\n      \u003ctd\u003edouble\u003c/td\u003e\n      \u003ctd\u003edeg\u003c/td\u003e\n      \u003ctd\u003eObject Declination\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e10\u003c/th\u003e\n      \u003ctd\u003efid\u003c/td\u003e\n      \u003ctd\u003eint8\u003c/td\u003e\n      \u003ctd\u003e\u003c/td\u003e\n      \u003ctd\u003eFilter identifier (1 = zg; 2 = zr; 3 = zi)\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e11\u003c/th\u003e\n      \u003ctd\u003efiltercode\u003c/td\u003e\n      \u003ctd\u003estring\u003c/td\u003e\n      \u003ctd\u003e\u003c/td\u003e\n      \u003ctd\u003eFilter code (zg, zr, zi)\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e17\u003c/th\u003e\n      \u003ctd\u003echisq\u003c/td\u003e\n      \u003ctd\u003efloat\u003c/td\u003e\n      \u003ctd\u003e\u003c/td\u003e\n      \u003ctd\u003eChi-square metric using nobs detections\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e20\u003c/th\u003e\n      \u003ctd\u003emagrms\u003c/td\u003e\n      \u003ctd\u003efloat\u003c/td\u003e\n      \u003ctd\u003emag\u003c/td\u003e\n      \u003ctd\u003eRoot Mean Squared deviation over nobs magnitudes\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e23\u003c/th\u003e\n      \u003ctd\u003emeanmag\u003c/td\u003e\n      \u003ctd\u003efloat\u003c/td\u003e\n      \u003ctd\u003emag\u003c/td\u003e\n      \u003ctd\u003eMean magnitude over nobs detections\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e24\u003c/th\u003e\n      \u003ctd\u003emedianabsdev\u003c/td\u003e\n      \u003ctd\u003efloat\u003c/td\u003e\n      \u003ctd\u003emag\u003c/td\u003e\n      \u003ctd\u003eMedian absolute deviation in magnitudes over nobs detections\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e44\u003c/th\u003e\n      \u003ctd\u003engoodobsrel\u003c/td\u003e\n      \u003ctd\u003eint32\u003c/td\u003e\n      \u003ctd\u003e\u003c/td\u003e\n      \u003ctd\u003eNumber of epochal detections in this release not associated with bad pixels\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e","content_type":"text/html"}}}],"key":"dp5m4RoAov"}],"key":"yY4DJDRHcM"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"children":[{"type":"text","value":"For a quality cut, we apply the following filter on the number of good epochs (from ","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"pFlgU6DDy3"},{"type":"cite","kind":"narrative","label":"Coughlin_2021","identifier":"doi.org/10.1093/mnras/stab1502","children":[{"type":"text","value":"Coughlin ","key":"bapAdPywRR"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"cG5UZecyU0"}],"key":"a2fOCd2X16"},{"type":"text","value":" (2021)","key":"VyLz0QgvfT"}],"enumerator":"1","key":"LvBdoTsjvD"},{"type":"text","value":") section 2):","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"s0iHPn1Ijd"}],"key":"rDmPXdDHgx"}],"key":"b733Xzmq2a"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"quality_filters = [\n    [\"ngoodobsrel\", \"\u003e\", 50]\n]","key":"T2SdNWAFZZ"},{"type":"output","id":"D_ReDn3fY3F-O0GxC7Q3O","data":[],"key":"I5mw9yQVUE"}],"key":"awhCIEjwHg"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":337,"column":1},"end":{"line":337,"column":1}},"children":[{"type":"text","value":"5. Crossmatch: Euclid Q1 x ZTF DR23 Objects","position":{"start":{"line":337,"column":1},"end":{"line":337,"column":1}},"key":"XWDzoQOeKX"}],"identifier":"id-5-crossmatch-euclid-q1-x-ztf-dr23-objects","label":"5. Crossmatch: Euclid Q1 x ZTF DR23 Objects","html_id":"id-5-crossmatch-euclid-q1-x-ztf-dr23-objects","implicit":true,"key":"KTLsUjREx7"},{"type":"paragraph","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"children":[{"type":"text","value":"Now that we have defined the spatial, column, and row filters for both catalogs, we can use lsdb to perform the crossmatch.","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"key":"URxFCRhUfR"}],"key":"CIWaH98JoA"}],"key":"Pq1Cgt90RO"},{"type":"block","position":{"start":{"line":341,"column":1},"end":{"line":341,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"children":[{"type":"text","value":"5.1 Create crossmatch query using the filters","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"key":"kv0Q3A2cTq"}],"identifier":"id-5-1-create-crossmatch-query-using-the-filters","label":"5.1 Create crossmatch query using the filters","html_id":"id-5-1-create-crossmatch-query-using-the-filters","implicit":true,"key":"i6DX96R7H0"},{"type":"paragraph","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"children":[{"type":"text","value":"Following lsdb’s documentation on ","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"key":"IkuVgEzQrX"},{"type":"link","url":"https://docs.lsdb.io/en/latest/getting-started.html#performing-filters","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"children":[{"type":"text","value":"performing filters","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"key":"ovjIel5yww"}],"urlSource":"https://docs.lsdb.io/en/latest/getting-started.html#performing-filters","key":"MZROegpn4O"},{"type":"text","value":", we open the Euclid Q1 catalog with the defined spatial, column, and row filters:","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"key":"NfmroFLH5R"}],"key":"u0CrJpnbRq"}],"key":"MOwWTAzVdJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"euclid_cone = lsdb.open_catalog(\n    f\"s3://{euclid_q1_bucket}/{euclid_q1_hats_prefix}\",\n    columns=euclid_columns,\n    search_filter=spatial_filter,\n    filters=galaxy_filters\n)\neuclid_cone","key":"w5TjSW6Tl5"},{"type":"output","id":"t4NPs2z46HKGIcaR5htn2","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/plain":{"content":"Dask NestedFrame Structure:\n                        _healpix_19      _healpix_9          tileid       object_id               ra              dec  phz_phz_median\nnpartitions=6                                                                                                                        \n720364834146746368   int64[pyarrow]  int32[pyarrow]  int64[pyarrow]  int64[pyarrow]  double[pyarrow]  double[pyarrow]  float[pyarrow]\n720505571635101696              ...             ...             ...             ...              ...              ...             ...\n...                             ...             ...             ...             ...              ...              ...             ...\n1128855394098085888             ...             ...             ...             ...              ...              ...             ...\n1128925762842263552             ...             ...             ...             ...              ...              ...             ...\nDask Name: search_points, 5 expressions\nExpr=MapPartitions(search_points)","content_type":"text/plain"},"text/html":{"content":"\u003cdiv\u003e\u003cstrong\u003elsdb Catalog Euclid_Q1_Merged_Objects:\u003c/strong\u003e\u003c/div\u003e\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e_healpix_19\u003c/th\u003e\n      \u003cth\u003e_healpix_9\u003c/th\u003e\n      \u003cth\u003etileid\u003c/th\u003e\n      \u003cth\u003eobject_id\u003c/th\u003e\n      \u003cth\u003era\u003c/th\u003e\n      \u003cth\u003edec\u003c/th\u003e\n      \u003cth\u003ephz_phz_median\u003c/th\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003enpartitions=6\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 6, Pixel: 10237\u003c/th\u003e\n      \u003ctd\u003eint64[pyarrow]\u003c/td\u003e\n      \u003ctd\u003eint32[pyarrow]\u003c/td\u003e\n      \u003ctd\u003eint64[pyarrow]\u003c/td\u003e\n      \u003ctd\u003eint64[pyarrow]\u003c/td\u003e\n      \u003ctd\u003edouble[pyarrow]\u003c/td\u003e\n      \u003ctd\u003edouble[pyarrow]\u003c/td\u003e\n      \u003ctd\u003efloat[pyarrow]\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 6, Pixel: 10239\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e...\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 6, Pixel: 15359\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 6, Pixel: 16042\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e\u003cdiv\u003e7 out of 1593 available columns in the catalog have been loaded \u003cstrong\u003elazily\u003c/strong\u003e, meaning no data has been read, only the catalog schema\u003c/div\u003e","content_type":"text/html"}}}],"key":"ZSQT7p8O7P"}],"key":"sLveHeipfi"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":357,"column":1},"end":{"line":359,"column":1}},"children":[{"type":"text","value":"Notice how the number of partitions reduced from 114 (in section 2) to only a few partitions that are within the spatial filter.\nThis allows LSDB to avoid loading unused parts of the catalog.\nAlso, we see only the columns we selected in the column filters.","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"key":"jEMmFRtxu8"}],"key":"kmAT65ZU5f"},{"type":"paragraph","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"children":[{"type":"text","value":"Now, similarly, we open the ZTF DR23 Objects catalog with its defined filters:","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"agImCfQVe4"}],"key":"tivEbYANpI"}],"key":"uh28fERASs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ztf_cone = lsdb.open_catalog(\n    f\"s3://{ztf_bucket}/{ztf_hats_prefix}\",\n    columns=ztf_columns,\n    search_filter=spatial_filter,\n    filters=quality_filters\n)\nztf_cone","key":"b4yCmeqzAK"},{"type":"output","id":"4k5Ebpyg70SLXzvSQGF88","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/plain":{"content":"Dask NestedFrame Structure:\n                        _healpix_19      _healpix_9             oid               ra              dec            fid       filtercode     ngoodobsrel           chisq          magrms         meanmag    medianabsdev\nnpartitions=4                                                                                                                                                                                                        \n719450040472436736   int64[pyarrow]  int32[pyarrow]  int64[pyarrow]  double[pyarrow]  double[pyarrow]  int8[pyarrow]  string[pyarrow]  int32[pyarrow]  float[pyarrow]  float[pyarrow]  float[pyarrow]  float[pyarrow]\n816277432460902400              ...             ...             ...              ...              ...            ...              ...             ...             ...             ...             ...             ...\n1079738010662076416             ...             ...             ...              ...              ...            ...              ...             ...             ...             ...             ...             ...\n1128151706656309248             ...             ...             ...              ...              ...            ...              ...             ...             ...             ...             ...             ...\n1129277606563151872             ...             ...             ...              ...              ...            ...              ...             ...             ...             ...             ...             ...\nDask Name: search_points, 5 expressions\nExpr=MapPartitions(search_points)","content_type":"text/plain"},"text/html":{"content":"\u003cdiv\u003e\u003cstrong\u003elsdb Catalog ZTF_DR23_Objects:\u003c/strong\u003e\u003c/div\u003e\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e_healpix_19\u003c/th\u003e\n      \u003cth\u003e_healpix_9\u003c/th\u003e\n      \u003cth\u003eoid\u003c/th\u003e\n      \u003cth\u003era\u003c/th\u003e\n      \u003cth\u003edec\u003c/th\u003e\n      \u003cth\u003efid\u003c/th\u003e\n      \u003cth\u003efiltercode\u003c/th\u003e\n      \u003cth\u003engoodobsrel\u003c/th\u003e\n      \u003cth\u003echisq\u003c/th\u003e\n      \u003cth\u003emagrms\u003c/th\u003e\n      \u003cth\u003emeanmag\u003c/th\u003e\n      \u003cth\u003emedianabsdev\u003c/th\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003enpartitions=4\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 4, Pixel: 639\u003c/th\u003e\n      \u003ctd\u003eint64[pyarrow]\u003c/td\u003e\n      \u003ctd\u003eint32[pyarrow]\u003c/td\u003e\n      \u003ctd\u003eint64[pyarrow]\u003c/td\u003e\n      \u003ctd\u003edouble[pyarrow]\u003c/td\u003e\n      \u003ctd\u003edouble[pyarrow]\u003c/td\u003e\n      \u003ctd\u003eint8[pyarrow]\u003c/td\u003e\n      \u003ctd\u003estring[pyarrow]\u003c/td\u003e\n      \u003ctd\u003eint32[pyarrow]\u003c/td\u003e\n      \u003ctd\u003efloat[pyarrow]\u003c/td\u003e\n      \u003ctd\u003efloat[pyarrow]\u003c/td\u003e\n      \u003ctd\u003efloat[pyarrow]\u003c/td\u003e\n      \u003ctd\u003efloat[pyarrow]\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 4, Pixel: 725\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 4, Pixel: 959\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 4, Pixel: 1002\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e\u003cdiv\u003e12 out of 76 available columns in the catalog have been loaded \u003cstrong\u003elazily\u003c/strong\u003e, meaning no data has been read, only the catalog schema\u003c/div\u003e","content_type":"text/html"}}}],"key":"rFS6Bz43Lq"}],"key":"hqLBIaCk7k"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":373,"column":1},"end":{"line":373,"column":1}},"children":[{"type":"text","value":"We see a similar reduction in the number of partitions for this catalog as well, and our column selection is applied.","position":{"start":{"line":373,"column":1},"end":{"line":373,"column":1}},"key":"swGf9rkJCT"}],"key":"PYur1k2JpR"},{"type":"paragraph","position":{"start":{"line":375,"column":1},"end":{"line":378,"column":1}},"children":[{"type":"text","value":"Now we can use lsdb’s ","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"key":"Brzn88xeXz"},{"type":"link","url":"https://docs.lsdb.io/en/latest/tutorials/pre_executed/crossmatching.html#2.-Perform-the-crossmatch-on-the-small-catalogs","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"children":[{"type":"text","value":"crossmatch functionality","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"key":"Szvk7AhThp"}],"urlSource":"https://docs.lsdb.io/en/latest/tutorials/pre_executed/crossmatching.html#2.-Perform-the-crossmatch-on-the-small-catalogs","key":"UTYKSrdYaW"},{"type":"text","value":" to plan a crossmatch between these two filtered catalogs.\nNote that the order of crossmatch matters: lsdb’s algorithm takes each object in the left catalog and finds the closest spatial match from the right catalog.\nSince Euclid is denser than ZTF, we put it on the left side of the crossmatch to maximize the number of matches.\nFor more details on the parameters, refer to the documentation linked.","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"key":"k6hvCnHji9"}],"key":"cgiOOVxakX"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"W5V37xSvBi"}],"key":"rj6wQUvdOZ"},{"type":"paragraph","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"children":[{"type":"text","value":"Since ZTF objects are defined per band, setting ","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"GLilUrKRFE"},{"type":"inlineCode","value":"n_neighbors=1","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"urrs3Le1DN"},{"type":"text","value":" means this is only going to return data in one ZTF band for each Euclid object. This is done for simplicity of analysing the crossmatched results in subsequent sections but you can increase ","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"PcSchrHkwa"},{"type":"inlineCode","value":"n_neighbors","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"E3o9xRfiNe"},{"type":"text","value":" to get data in multiple ZTF bands.","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"WGWkgfn0yM"}],"key":"XqugcB8rtJ"}],"key":"vJUwfXMpor"}],"key":"MWZlIfAkfS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"euclid_x_ztf = euclid_cone.crossmatch(\n    ztf_cone,\n    suffixes=(\"_euclid\", \"_ztf\"), # to distinguish columns from the two catalogs\n    n_neighbors=1, # default is 1 too, can be tweaked\n    radius_arcsec=1  # default is 1 arcsec too, can be tweaked\n)\neuclid_x_ztf","key":"OqANxExnt5"},{"type":"output","id":"cK8s67LLyu-o-xopNNRn1","data":[{"output_type":"stream","name":"stderr","text":"/home/runner/work/irsa-tutorials/irsa-tutorials/.tox/py312-buildhtml/lib/python3.12/site-packages/lsdb/catalog/catalog.py:289: FutureWarning: The default suffix behavior will change from applying suffixes to all columns to only applying suffixes to overlapping columns in a future release.To maintain the current behavior, explicitly set `suffix_method='all_columns'`. To change to the new behavior, set `suffix_method='overlapping_columns'`.\n  warnings.warn(\n"},{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/plain":{"content":"Dask NestedFrame Structure:\n                    _healpix_19_euclid _healpix_9_euclid   tileid_euclid object_id_euclid        ra_euclid       dec_euclid phz_phz_median_euclid _healpix_19_ztf  _healpix_9_ztf         oid_ztf           ra_ztf          dec_ztf        fid_ztf   filtercode_ztf ngoodobsrel_ztf       chisq_ztf      magrms_ztf     meanmag_ztf medianabsdev_ztf     _dist_arcsec\nnpartitions=6                                                                                                                                                                                                                                                                                                                                                        \n720364834146746368      int64[pyarrow]    int32[pyarrow]  int64[pyarrow]   int64[pyarrow]  double[pyarrow]  double[pyarrow]        float[pyarrow]  int64[pyarrow]  int32[pyarrow]  int64[pyarrow]  double[pyarrow]  double[pyarrow]  int8[pyarrow]  string[pyarrow]  int32[pyarrow]  float[pyarrow]  float[pyarrow]  float[pyarrow]   float[pyarrow]  double[pyarrow]\n720505571635101696                 ...               ...             ...              ...              ...              ...                   ...             ...             ...             ...              ...              ...            ...              ...             ...             ...             ...             ...              ...              ...\n...                                ...               ...             ...              ...              ...              ...                   ...             ...             ...             ...              ...              ...            ...              ...             ...             ...             ...             ...              ...              ...\n1128855394098085888                ...               ...             ...              ...              ...              ...                   ...             ...             ...             ...              ...              ...            ...              ...             ...             ...             ...             ...              ...              ...\n1128925762842263552                ...               ...             ...              ...              ...              ...                   ...             ...             ...             ...              ...              ...            ...              ...             ...             ...             ...             ...              ...              ...\nDask Name: nestedframe, 3 expressions\nExpr=MapPartitions(NestedFrame)","content_type":"text/plain"},"text/html":{"content":"\u003cdiv\u003e\u003cstrong\u003elsdb Catalog Euclid_Q1_Merged_Objects_x_ZTF_DR23_Objects:\u003c/strong\u003e\u003c/div\u003e\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e_healpix_19_euclid\u003c/th\u003e\n      \u003cth\u003e_healpix_9_euclid\u003c/th\u003e\n      \u003cth\u003etileid_euclid\u003c/th\u003e\n      \u003cth\u003eobject_id_euclid\u003c/th\u003e\n      \u003cth\u003era_euclid\u003c/th\u003e\n      \u003cth\u003edec_euclid\u003c/th\u003e\n      \u003cth\u003ephz_phz_median_euclid\u003c/th\u003e\n      \u003cth\u003e_healpix_19_ztf\u003c/th\u003e\n      \u003cth\u003e_healpix_9_ztf\u003c/th\u003e\n      \u003cth\u003eoid_ztf\u003c/th\u003e\n      \u003cth\u003era_ztf\u003c/th\u003e\n      \u003cth\u003edec_ztf\u003c/th\u003e\n      \u003cth\u003efid_ztf\u003c/th\u003e\n      \u003cth\u003efiltercode_ztf\u003c/th\u003e\n      \u003cth\u003engoodobsrel_ztf\u003c/th\u003e\n      \u003cth\u003echisq_ztf\u003c/th\u003e\n      \u003cth\u003emagrms_ztf\u003c/th\u003e\n      \u003cth\u003emeanmag_ztf\u003c/th\u003e\n      \u003cth\u003emedianabsdev_ztf\u003c/th\u003e\n      \u003cth\u003e_dist_arcsec\u003c/th\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003enpartitions=6\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 6, Pixel: 10237\u003c/th\u003e\n      \u003ctd\u003eint64[pyarrow]\u003c/td\u003e\n      \u003ctd\u003eint32[pyarrow]\u003c/td\u003e\n      \u003ctd\u003eint64[pyarrow]\u003c/td\u003e\n      \u003ctd\u003eint64[pyarrow]\u003c/td\u003e\n      \u003ctd\u003edouble[pyarrow]\u003c/td\u003e\n      \u003ctd\u003edouble[pyarrow]\u003c/td\u003e\n      \u003ctd\u003efloat[pyarrow]\u003c/td\u003e\n      \u003ctd\u003eint64[pyarrow]\u003c/td\u003e\n      \u003ctd\u003eint32[pyarrow]\u003c/td\u003e\n      \u003ctd\u003eint64[pyarrow]\u003c/td\u003e\n      \u003ctd\u003edouble[pyarrow]\u003c/td\u003e\n      \u003ctd\u003edouble[pyarrow]\u003c/td\u003e\n      \u003ctd\u003eint8[pyarrow]\u003c/td\u003e\n      \u003ctd\u003estring[pyarrow]\u003c/td\u003e\n      \u003ctd\u003eint32[pyarrow]\u003c/td\u003e\n      \u003ctd\u003efloat[pyarrow]\u003c/td\u003e\n      \u003ctd\u003efloat[pyarrow]\u003c/td\u003e\n      \u003ctd\u003efloat[pyarrow]\u003c/td\u003e\n      \u003ctd\u003efloat[pyarrow]\u003c/td\u003e\n      \u003ctd\u003edouble[pyarrow]\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 6, Pixel: 10239\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e...\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 6, Pixel: 15359\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 6, Pixel: 16042\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e\u003cdiv\u003e20 out of 20 available columns in the catalog have been loaded \u003cstrong\u003elazily\u003c/strong\u003e, meaning no data has been read, only the catalog schema\u003c/div\u003e","content_type":"text/html"}}}],"key":"QQZid78Olj"}],"key":"a76rft0BwU"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":394,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"text","value":"Note how the resulting crossmatched catalog contains columns from both catalogs with the suffixes we passed.\nAs we noticed when opening the catalog, this created a crossmatch catalog object lazily but did not execute the crossmatch.","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"key":"b6O6SLXJ1a"}],"key":"Lx5cdC4VSX"}],"key":"FvUTDCjFPG"},{"type":"block","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"children":[{"type":"text","value":"5.2 Execute the query and load data","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"key":"Ik8uzZEC2u"}],"identifier":"id-5-2-execute-the-query-and-load-data","label":"5.2 Execute the query and load data","html_id":"id-5-2-execute-the-query-and-load-data","implicit":true,"key":"BKdzgttcoR"},{"type":"paragraph","position":{"start":{"line":401,"column":1},"end":{"line":402,"column":1}},"children":[{"type":"text","value":"Now we can run the crossmatch query we have been planning so far by using the ","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"qZvLBp9Kgw"},{"type":"inlineCode","value":"compute()","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"c03WkoDXSE"},{"type":"text","value":" method of the crossmatch catalog object, which will perform all the tasks and return the result as a DataFrame.\nlsdb utilizes ","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"M4K1K3pne0"},{"type":"link","url":"https://docs.dask.org/en/stable/","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"children":[{"type":"text","value":"Dask","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"W4XH0ewCBv"}],"urlSource":"https://docs.dask.org/en/stable/","key":"lAD9evnyr6"},{"type":"text","value":" to parallelize the tasks on different partitions, so we need to create a Dask client to manage the resources (and track progress) for the scope of this computation:","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"XLvwVtkMGE"}],"key":"RyLd8IvkhX"}],"key":"XUzrzesPFo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def get_nworkers(catalog):\n    return min(os.cpu_count(), catalog.npartitions + 1)\n\nwith Client(n_workers=get_nworkers(euclid_x_ztf), \n            threads_per_worker=2, \n            memory_limit='auto') as client:\n    print(f\"This may take more than a few minutes to complete. You can monitor progress in Dask dashboard at {client.dashboard_link}\")\n    euclid_x_ztf_df = euclid_x_ztf.compute() # this will load the data into memory finally","key":"drtNgo9fTD"},{"type":"output","id":"6xznDzrl2wc1lhQpjxirm","data":[{"output_type":"stream","name":"stdout","text":"This may take more than a few minutes to complete. You can monitor progress in Dask dashboard at http://127.0.0.1:8787/status\n"}],"key":"gIU58IS6J8"}],"key":"sHwrXZs6jb"},{"type":"block","children":[],"key":"IVuKEkRpvz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"euclid_x_ztf_df","key":"zlvvyPmfF5"},{"type":"output","id":"mhGHRMNmcTpt2ecew9Ouc","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"text/plain":{"content":"                     _healpix_19_euclid  _healpix_9_euclid  tileid_euclid  \\\n_healpix_29                                                                 \n720434593244322473         687059968227             655231      102158891   \n720432428583862814         687057903846             655229      102158891   \n720434481587813232         687059861743             655231      102158891   \n720432832290153985         687058288850             655229      102158891   \n720432970313122903         687058420479             655229      102158891   \n720434484456996712         687059864480             655231      102158891   \n720432835157060433         687058291585             655229      102158891   \n720432420190003514         687057895841             655229      102158891   \n720435031368747437         687060386055             655231      102158891   \n...                                 ...                ...            ...   \n1128893524233377784       1076596760018            1026722      102159487   \n1128893589791736967       1076596822540            1026722      102159487   \n1128893569383796065       1076596803077            1026722      102159487   \n1128893542038473039       1076596776998            1026722      102159487   \n1128893540953147706       1076596775963            1026722      102159487   \n1128893538206451784       1076596773344            1026722      102159487   \n1128893376581602470       1076596619207            1026722      102159193   \n1128893337709122935       1076596582135            1026722      102159193   \n1128893340254188261       1076596584562            1026722      102159193   \n\n                        object_id_euclid   ra_euclid  dec_euclid  \\\n_healpix_29                                                        \n720434593244322473   2699181571656108156  269.918157   65.610816   \n720432428583862814   2699187793655290965  269.918779   65.529097   \n720434481587813232   2699189269655936829  269.918927   65.593683   \n720432832290153985   2699194755655464972  269.919476   65.546497   \n720432970313122903   2699203905655721348  269.920391   65.572135   \n720434484456996712   2699204552655981362  269.920455   65.598136   \n720432835157060433   2699209485655511218  269.920949   65.551122   \n720432420190003514   2699210741655237953  269.921074   65.523795   \n720435031368747437   2699214091656398506  269.921409   65.639851   \n...                                  ...         ...         ...   \n1128893524233377784  2707275041662719928  270.727504   66.271993   \n1128893589791736967  2707360491662878475  270.736049   66.287848   \n1128893569383796065  2707361465662732069  270.736147   66.273207   \n1128893542038473039  2707612776662634595  270.761278    66.26346   \n1128893540953147706  2707730517662693744  270.773052   66.269374   \n1128893538206451784  2707809557662660563  270.780956   66.266056   \n1128893376581602470  2707976353662411561  270.797635   66.241156   \n1128893337709122935  2708392307662229925  270.839231   66.222993   \n1128893340254188261  2708472558662234858  270.847256   66.223486   \n\n                     phz_phz_median_euclid  _healpix_19_ztf  _healpix_9_ztf  \\\n_healpix_29                                                                   \n720434593244322473                     0.2     687059968227          655231   \n720432428583862814                    0.27     687057903846          655229   \n720434481587813232                    0.73     687059862089          655231   \n720432832290153985                    0.15     687058288850          655229   \n720432970313122903                    0.25     687058420479          655229   \n720434484456996712                     0.2     687059864480          655231   \n720432835157060433                    0.36     687058291588          655229   \n720432420190003514                    0.36     687057895842          655229   \n720435031368747437                     0.1     687060386055          655231   \n...                                    ...              ...             ...   \n1128893524233377784                   0.32    1076596760019         1026722   \n1128893589791736967                   0.43    1076596822537         1026722   \n1128893569383796065                   0.32    1076596803077         1026722   \n1128893542038473039                   0.29    1076596776999         1026722   \n1128893540953147706                   0.01    1076596775963         1026722   \n1128893538206451784                   0.47    1076596773323         1026722   \n1128893376581602470                    0.4    1076596619206         1026722   \n1128893337709122935                   0.59    1076596582134         1026722   \n1128893340254188261                   0.03    1076596584563         1026722   \n\n                              oid_ztf      ra_ztf    dec_ztf  fid_ztf  \\\n_healpix_29                                                             \n720434593244322473    826215200002321  269.918125   65.61082        2   \n720432428583862814    826215200031991  269.918892  65.529095        2   \n720434481587813232    848302400011626  269.918333  65.593788        3   \n720432832290153985    826215200011172  269.919267   65.54643        2   \n720432970313122903    848202400009734  269.920497  65.572115        2   \n720434484456996712    848202400022812  269.920449   65.59814        2   \n720432835157060433    826215200017597  269.921348   65.55124        2   \n720432420190003514    826215200022643  269.920704  65.523755        2   \n720435031368747437    848302400025079  269.921389   65.63984        3   \n...                               ...         ...        ...      ...   \n1128893524233377784   848201300011194  270.727673  66.272057        2   \n1128893589791736967   848201300001262  270.736013  66.287832        2   \n1128893569383796065   848201300001438   270.73629  66.273238        2   \n1128893542038473039   848201300001540  270.761399  66.263474        2   \n1128893540953147706  1857212300002383  270.773034  66.269382        2   \n1128893538206451784   848201300001497  270.781189  66.266031        2   \n1128893376581602470   848201300001788  270.797594  66.241162        2   \n1128893337709122935   848201300001975  270.839017  66.222907        2   \n1128893340254188261   848201300001966  270.847261  66.223523        2   \n\n                    filtercode_ztf  ngoodobsrel_ztf  chisq_ztf  magrms_ztf  \\\n_healpix_29                                                                  \n720434593244322473              zr              957   0.963843    0.142436   \n720432428583862814              zr               90   1.132518    0.316141   \n720434481587813232              zi              223   1.083044    0.085483   \n720432832290153985              zr               92   0.833866    0.237722   \n720432970313122903              zr              223   1.029616    0.264355   \n720434484456996712              zr             1041   0.971803    0.141235   \n720432835157060433              zr               66   1.291853    0.350705   \n720432420190003514              zr               82    1.10932    0.283498   \n720435031368747437              zi              235   1.307203    0.099071   \n...                            ...              ...        ...         ...   \n1128893524233377784             zr              172   0.957406    0.234242   \n1128893589791736967             zr              536   0.968066    0.219642   \n1128893569383796065             zr              347   0.939984    0.236459   \n1128893542038473039             zr              400    0.92098    0.217024   \n1128893540953147706             zr               53   1.208119    0.017946   \n1128893538206451784             zr              196   1.018292    0.256665   \n1128893376581602470             zr              599   0.958596    0.210892   \n1128893337709122935             zr               61   1.336956    0.333995   \n1128893340254188261             zr               83    1.09015      0.3153   \n\n                     meanmag_ztf  medianabsdev_ztf  _dist_arcsec  \n_healpix_29                                                       \n720434593244322473     20.150564          0.087977      0.050941  \n720432428583862814     21.188622          0.187522      0.168698  \n720434481587813232     19.007387          0.054602      0.961264  \n720432832290153985     21.323473           0.14329      0.393347  \n720432970313122903     21.137856           0.15752      0.173815  \n720434484456996712     20.038595          0.082394      0.017943  \n720432835157060433      21.23908          0.217272      0.732231  \n720432420190003514     21.253254          0.190222      0.570194  \n720435031368747437     18.976027          0.064419      0.047905  \n...                          ...               ...           ...  \n1128893524233377784    21.202761          0.160785      0.334972  \n1128893589791736967    20.804783           0.13789      0.075775  \n1128893569383796065    21.124443          0.153017      0.236522  \n1128893542038473039      21.0543          0.145107      0.183349  \n1128893540953147706    16.642914          0.011663      0.037508  \n1128893538206451784     21.14094          0.167229      0.350357  \n1128893376581602470    20.752556          0.132805      0.064059  \n1128893337709122935    21.316973          0.234939      0.436674  \n1128893340254188261    21.287346          0.189821      0.132318  \n\n[4833 rows x 20 columns]","content_type":"text/plain"},"text/html":{"content":"\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e_healpix_19_euclid\u003c/th\u003e\n      \u003cth\u003e_healpix_9_euclid\u003c/th\u003e\n      \u003cth\u003etileid_euclid\u003c/th\u003e\n      \u003cth\u003eobject_id_euclid\u003c/th\u003e\n      \u003cth\u003era_euclid\u003c/th\u003e\n      \u003cth\u003edec_euclid\u003c/th\u003e\n      \u003cth\u003ephz_phz_median_euclid\u003c/th\u003e\n      \u003cth\u003e_healpix_19_ztf\u003c/th\u003e\n      \u003cth\u003e_healpix_9_ztf\u003c/th\u003e\n      \u003cth\u003eoid_ztf\u003c/th\u003e\n      \u003cth\u003era_ztf\u003c/th\u003e\n      \u003cth\u003edec_ztf\u003c/th\u003e\n      \u003cth\u003efid_ztf\u003c/th\u003e\n      \u003cth\u003efiltercode_ztf\u003c/th\u003e\n      \u003cth\u003engoodobsrel_ztf\u003c/th\u003e\n      \u003cth\u003echisq_ztf\u003c/th\u003e\n      \u003cth\u003emagrms_ztf\u003c/th\u003e\n      \u003cth\u003emeanmag_ztf\u003c/th\u003e\n      \u003cth\u003emedianabsdev_ztf\u003c/th\u003e\n      \u003cth\u003e_dist_arcsec\u003c/th\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e_healpix_29\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e720434593244322473\u003c/th\u003e\n      \u003ctd\u003e687059968227\u003c/td\u003e\n      \u003ctd\u003e655231\u003c/td\u003e\n      \u003ctd\u003e102158891\u003c/td\u003e\n      \u003ctd\u003e2699181571656108156\u003c/td\u003e\n      \u003ctd\u003e269.918157\u003c/td\u003e\n      \u003ctd\u003e65.610816\u003c/td\u003e\n      \u003ctd\u003e0.2\u003c/td\u003e\n      \u003ctd\u003e687059968227\u003c/td\u003e\n      \u003ctd\u003e655231\u003c/td\u003e\n      \u003ctd\u003e826215200002321\u003c/td\u003e\n      \u003ctd\u003e269.918125\u003c/td\u003e\n      \u003ctd\u003e65.61082\u003c/td\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003ezr\u003c/td\u003e\n      \u003ctd\u003e957\u003c/td\u003e\n      \u003ctd\u003e0.963843\u003c/td\u003e\n      \u003ctd\u003e0.142436\u003c/td\u003e\n      \u003ctd\u003e20.150564\u003c/td\u003e\n      \u003ctd\u003e0.087977\u003c/td\u003e\n      \u003ctd\u003e0.050941\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e720432428583862814\u003c/th\u003e\n      \u003ctd\u003e687057903846\u003c/td\u003e\n      \u003ctd\u003e655229\u003c/td\u003e\n      \u003ctd\u003e102158891\u003c/td\u003e\n      \u003ctd\u003e2699187793655290965\u003c/td\u003e\n      \u003ctd\u003e269.918779\u003c/td\u003e\n      \u003ctd\u003e65.529097\u003c/td\u003e\n      \u003ctd\u003e0.27\u003c/td\u003e\n      \u003ctd\u003e687057903846\u003c/td\u003e\n      \u003ctd\u003e655229\u003c/td\u003e\n      \u003ctd\u003e826215200031991\u003c/td\u003e\n      \u003ctd\u003e269.918892\u003c/td\u003e\n      \u003ctd\u003e65.529095\u003c/td\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003ezr\u003c/td\u003e\n      \u003ctd\u003e90\u003c/td\u003e\n      \u003ctd\u003e1.132518\u003c/td\u003e\n      \u003ctd\u003e0.316141\u003c/td\u003e\n      \u003ctd\u003e21.188622\u003c/td\u003e\n      \u003ctd\u003e0.187522\u003c/td\u003e\n      \u003ctd\u003e0.168698\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e720434481587813232\u003c/th\u003e\n      \u003ctd\u003e687059861743\u003c/td\u003e\n      \u003ctd\u003e655231\u003c/td\u003e\n      \u003ctd\u003e102158891\u003c/td\u003e\n      \u003ctd\u003e2699189269655936829\u003c/td\u003e\n      \u003ctd\u003e269.918927\u003c/td\u003e\n      \u003ctd\u003e65.593683\u003c/td\u003e\n      \u003ctd\u003e0.73\u003c/td\u003e\n      \u003ctd\u003e687059862089\u003c/td\u003e\n      \u003ctd\u003e655231\u003c/td\u003e\n      \u003ctd\u003e848302400011626\u003c/td\u003e\n      \u003ctd\u003e269.918333\u003c/td\u003e\n      \u003ctd\u003e65.593788\u003c/td\u003e\n      \u003ctd\u003e3\u003c/td\u003e\n      \u003ctd\u003ezi\u003c/td\u003e\n      \u003ctd\u003e223\u003c/td\u003e\n      \u003ctd\u003e1.083044\u003c/td\u003e\n      \u003ctd\u003e0.085483\u003c/td\u003e\n      \u003ctd\u003e19.007387\u003c/td\u003e\n      \u003ctd\u003e0.054602\u003c/td\u003e\n      \u003ctd\u003e0.961264\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e720432832290153985\u003c/th\u003e\n      \u003ctd\u003e687058288850\u003c/td\u003e\n      \u003ctd\u003e655229\u003c/td\u003e\n      \u003ctd\u003e102158891\u003c/td\u003e\n      \u003ctd\u003e2699194755655464972\u003c/td\u003e\n      \u003ctd\u003e269.919476\u003c/td\u003e\n      \u003ctd\u003e65.546497\u003c/td\u003e\n      \u003ctd\u003e0.15\u003c/td\u003e\n      \u003ctd\u003e687058288850\u003c/td\u003e\n      \u003ctd\u003e655229\u003c/td\u003e\n      \u003ctd\u003e826215200011172\u003c/td\u003e\n      \u003ctd\u003e269.919267\u003c/td\u003e\n      \u003ctd\u003e65.54643\u003c/td\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003ezr\u003c/td\u003e\n      \u003ctd\u003e92\u003c/td\u003e\n      \u003ctd\u003e0.833866\u003c/td\u003e\n      \u003ctd\u003e0.237722\u003c/td\u003e\n      \u003ctd\u003e21.323473\u003c/td\u003e\n      \u003ctd\u003e0.14329\u003c/td\u003e\n      \u003ctd\u003e0.393347\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e720432970313122903\u003c/th\u003e\n      \u003ctd\u003e687058420479\u003c/td\u003e\n      \u003ctd\u003e655229\u003c/td\u003e\n      \u003ctd\u003e102158891\u003c/td\u003e\n      \u003ctd\u003e2699203905655721348\u003c/td\u003e\n      \u003ctd\u003e269.920391\u003c/td\u003e\n      \u003ctd\u003e65.572135\u003c/td\u003e\n      \u003ctd\u003e0.25\u003c/td\u003e\n      \u003ctd\u003e687058420479\u003c/td\u003e\n      \u003ctd\u003e655229\u003c/td\u003e\n      \u003ctd\u003e848202400009734\u003c/td\u003e\n      \u003ctd\u003e269.920497\u003c/td\u003e\n      \u003ctd\u003e65.572115\u003c/td\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003ezr\u003c/td\u003e\n      \u003ctd\u003e223\u003c/td\u003e\n      \u003ctd\u003e1.029616\u003c/td\u003e\n      \u003ctd\u003e0.264355\u003c/td\u003e\n      \u003ctd\u003e21.137856\u003c/td\u003e\n      \u003ctd\u003e0.15752\u003c/td\u003e\n      \u003ctd\u003e0.173815\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e720434484456996712\u003c/th\u003e\n      \u003ctd\u003e687059864480\u003c/td\u003e\n      \u003ctd\u003e655231\u003c/td\u003e\n      \u003ctd\u003e102158891\u003c/td\u003e\n      \u003ctd\u003e2699204552655981362\u003c/td\u003e\n      \u003ctd\u003e269.920455\u003c/td\u003e\n      \u003ctd\u003e65.598136\u003c/td\u003e\n      \u003ctd\u003e0.2\u003c/td\u003e\n      \u003ctd\u003e687059864480\u003c/td\u003e\n      \u003ctd\u003e655231\u003c/td\u003e\n      \u003ctd\u003e848202400022812\u003c/td\u003e\n      \u003ctd\u003e269.920449\u003c/td\u003e\n      \u003ctd\u003e65.59814\u003c/td\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003ezr\u003c/td\u003e\n      \u003ctd\u003e1041\u003c/td\u003e\n      \u003ctd\u003e0.971803\u003c/td\u003e\n      \u003ctd\u003e0.141235\u003c/td\u003e\n      \u003ctd\u003e20.038595\u003c/td\u003e\n      \u003ctd\u003e0.082394\u003c/td\u003e\n      \u003ctd\u003e0.017943\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e720432835157060433\u003c/th\u003e\n      \u003ctd\u003e687058291585\u003c/td\u003e\n      \u003ctd\u003e655229\u003c/td\u003e\n      \u003ctd\u003e102158891\u003c/td\u003e\n      \u003ctd\u003e2699209485655511218\u003c/td\u003e\n      \u003ctd\u003e269.920949\u003c/td\u003e\n      \u003ctd\u003e65.551122\u003c/td\u003e\n      \u003ctd\u003e0.36\u003c/td\u003e\n      \u003ctd\u003e687058291588\u003c/td\u003e\n      \u003ctd\u003e655229\u003c/td\u003e\n      \u003ctd\u003e826215200017597\u003c/td\u003e\n      \u003ctd\u003e269.921348\u003c/td\u003e\n      \u003ctd\u003e65.55124\u003c/td\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003ezr\u003c/td\u003e\n      \u003ctd\u003e66\u003c/td\u003e\n      \u003ctd\u003e1.291853\u003c/td\u003e\n      \u003ctd\u003e0.350705\u003c/td\u003e\n      \u003ctd\u003e21.23908\u003c/td\u003e\n      \u003ctd\u003e0.217272\u003c/td\u003e\n      \u003ctd\u003e0.732231\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e720432420190003514\u003c/th\u003e\n      \u003ctd\u003e687057895841\u003c/td\u003e\n      \u003ctd\u003e655229\u003c/td\u003e\n      \u003ctd\u003e102158891\u003c/td\u003e\n      \u003ctd\u003e2699210741655237953\u003c/td\u003e\n      \u003ctd\u003e269.921074\u003c/td\u003e\n      \u003ctd\u003e65.523795\u003c/td\u003e\n      \u003ctd\u003e0.36\u003c/td\u003e\n      \u003ctd\u003e687057895842\u003c/td\u003e\n      \u003ctd\u003e655229\u003c/td\u003e\n      \u003ctd\u003e826215200022643\u003c/td\u003e\n      \u003ctd\u003e269.920704\u003c/td\u003e\n      \u003ctd\u003e65.523755\u003c/td\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003ezr\u003c/td\u003e\n      \u003ctd\u003e82\u003c/td\u003e\n      \u003ctd\u003e1.10932\u003c/td\u003e\n      \u003ctd\u003e0.283498\u003c/td\u003e\n      \u003ctd\u003e21.253254\u003c/td\u003e\n      \u003ctd\u003e0.190222\u003c/td\u003e\n      \u003ctd\u003e0.570194\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e720435031368747437\u003c/th\u003e\n      \u003ctd\u003e687060386055\u003c/td\u003e\n      \u003ctd\u003e655231\u003c/td\u003e\n      \u003ctd\u003e102158891\u003c/td\u003e\n      \u003ctd\u003e2699214091656398506\u003c/td\u003e\n      \u003ctd\u003e269.921409\u003c/td\u003e\n      \u003ctd\u003e65.639851\u003c/td\u003e\n      \u003ctd\u003e0.1\u003c/td\u003e\n      \u003ctd\u003e687060386055\u003c/td\u003e\n      \u003ctd\u003e655231\u003c/td\u003e\n      \u003ctd\u003e848302400025079\u003c/td\u003e\n      \u003ctd\u003e269.921389\u003c/td\u003e\n      \u003ctd\u003e65.63984\u003c/td\u003e\n      \u003ctd\u003e3\u003c/td\u003e\n      \u003ctd\u003ezi\u003c/td\u003e\n      \u003ctd\u003e235\u003c/td\u003e\n      \u003ctd\u003e1.307203\u003c/td\u003e\n      \u003ctd\u003e0.099071\u003c/td\u003e\n      \u003ctd\u003e18.976027\u003c/td\u003e\n      \u003ctd\u003e0.064419\u003c/td\u003e\n      \u003ctd\u003e0.047905\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e...\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1128893524233377784\u003c/th\u003e\n      \u003ctd\u003e1076596760018\u003c/td\u003e\n      \u003ctd\u003e1026722\u003c/td\u003e\n      \u003ctd\u003e102159487\u003c/td\u003e\n      \u003ctd\u003e2707275041662719928\u003c/td\u003e\n      \u003ctd\u003e270.727504\u003c/td\u003e\n      \u003ctd\u003e66.271993\u003c/td\u003e\n      \u003ctd\u003e0.32\u003c/td\u003e\n      \u003ctd\u003e1076596760019\u003c/td\u003e\n      \u003ctd\u003e1026722\u003c/td\u003e\n      \u003ctd\u003e848201300011194\u003c/td\u003e\n      \u003ctd\u003e270.727673\u003c/td\u003e\n      \u003ctd\u003e66.272057\u003c/td\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003ezr\u003c/td\u003e\n      \u003ctd\u003e172\u003c/td\u003e\n      \u003ctd\u003e0.957406\u003c/td\u003e\n      \u003ctd\u003e0.234242\u003c/td\u003e\n      \u003ctd\u003e21.202761\u003c/td\u003e\n      \u003ctd\u003e0.160785\u003c/td\u003e\n      \u003ctd\u003e0.334972\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1128893589791736967\u003c/th\u003e\n      \u003ctd\u003e1076596822540\u003c/td\u003e\n      \u003ctd\u003e1026722\u003c/td\u003e\n      \u003ctd\u003e102159487\u003c/td\u003e\n      \u003ctd\u003e2707360491662878475\u003c/td\u003e\n      \u003ctd\u003e270.736049\u003c/td\u003e\n      \u003ctd\u003e66.287848\u003c/td\u003e\n      \u003ctd\u003e0.43\u003c/td\u003e\n      \u003ctd\u003e1076596822537\u003c/td\u003e\n      \u003ctd\u003e1026722\u003c/td\u003e\n      \u003ctd\u003e848201300001262\u003c/td\u003e\n      \u003ctd\u003e270.736013\u003c/td\u003e\n      \u003ctd\u003e66.287832\u003c/td\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003ezr\u003c/td\u003e\n      \u003ctd\u003e536\u003c/td\u003e\n      \u003ctd\u003e0.968066\u003c/td\u003e\n      \u003ctd\u003e0.219642\u003c/td\u003e\n      \u003ctd\u003e20.804783\u003c/td\u003e\n      \u003ctd\u003e0.13789\u003c/td\u003e\n      \u003ctd\u003e0.075775\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1128893569383796065\u003c/th\u003e\n      \u003ctd\u003e1076596803077\u003c/td\u003e\n      \u003ctd\u003e1026722\u003c/td\u003e\n      \u003ctd\u003e102159487\u003c/td\u003e\n      \u003ctd\u003e2707361465662732069\u003c/td\u003e\n      \u003ctd\u003e270.736147\u003c/td\u003e\n      \u003ctd\u003e66.273207\u003c/td\u003e\n      \u003ctd\u003e0.32\u003c/td\u003e\n      \u003ctd\u003e1076596803077\u003c/td\u003e\n      \u003ctd\u003e1026722\u003c/td\u003e\n      \u003ctd\u003e848201300001438\u003c/td\u003e\n      \u003ctd\u003e270.73629\u003c/td\u003e\n      \u003ctd\u003e66.273238\u003c/td\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003ezr\u003c/td\u003e\n      \u003ctd\u003e347\u003c/td\u003e\n      \u003ctd\u003e0.939984\u003c/td\u003e\n      \u003ctd\u003e0.236459\u003c/td\u003e\n      \u003ctd\u003e21.124443\u003c/td\u003e\n      \u003ctd\u003e0.153017\u003c/td\u003e\n      \u003ctd\u003e0.236522\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1128893542038473039\u003c/th\u003e\n      \u003ctd\u003e1076596776998\u003c/td\u003e\n      \u003ctd\u003e1026722\u003c/td\u003e\n      \u003ctd\u003e102159487\u003c/td\u003e\n      \u003ctd\u003e2707612776662634595\u003c/td\u003e\n      \u003ctd\u003e270.761278\u003c/td\u003e\n      \u003ctd\u003e66.26346\u003c/td\u003e\n      \u003ctd\u003e0.29\u003c/td\u003e\n      \u003ctd\u003e1076596776999\u003c/td\u003e\n      \u003ctd\u003e1026722\u003c/td\u003e\n      \u003ctd\u003e848201300001540\u003c/td\u003e\n      \u003ctd\u003e270.761399\u003c/td\u003e\n      \u003ctd\u003e66.263474\u003c/td\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003ezr\u003c/td\u003e\n      \u003ctd\u003e400\u003c/td\u003e\n      \u003ctd\u003e0.92098\u003c/td\u003e\n      \u003ctd\u003e0.217024\u003c/td\u003e\n      \u003ctd\u003e21.0543\u003c/td\u003e\n      \u003ctd\u003e0.145107\u003c/td\u003e\n      \u003ctd\u003e0.183349\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1128893540953147706\u003c/th\u003e\n      \u003ctd\u003e1076596775963\u003c/td\u003e\n      \u003ctd\u003e1026722\u003c/td\u003e\n      \u003ctd\u003e102159487\u003c/td\u003e\n      \u003ctd\u003e2707730517662693744\u003c/td\u003e\n      \u003ctd\u003e270.773052\u003c/td\u003e\n      \u003ctd\u003e66.269374\u003c/td\u003e\n      \u003ctd\u003e0.01\u003c/td\u003e\n      \u003ctd\u003e1076596775963\u003c/td\u003e\n      \u003ctd\u003e1026722\u003c/td\u003e\n      \u003ctd\u003e1857212300002383\u003c/td\u003e\n      \u003ctd\u003e270.773034\u003c/td\u003e\n      \u003ctd\u003e66.269382\u003c/td\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003ezr\u003c/td\u003e\n      \u003ctd\u003e53\u003c/td\u003e\n      \u003ctd\u003e1.208119\u003c/td\u003e\n      \u003ctd\u003e0.017946\u003c/td\u003e\n      \u003ctd\u003e16.642914\u003c/td\u003e\n      \u003ctd\u003e0.011663\u003c/td\u003e\n      \u003ctd\u003e0.037508\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1128893538206451784\u003c/th\u003e\n      \u003ctd\u003e1076596773344\u003c/td\u003e\n      \u003ctd\u003e1026722\u003c/td\u003e\n      \u003ctd\u003e102159487\u003c/td\u003e\n      \u003ctd\u003e2707809557662660563\u003c/td\u003e\n      \u003ctd\u003e270.780956\u003c/td\u003e\n      \u003ctd\u003e66.266056\u003c/td\u003e\n      \u003ctd\u003e0.47\u003c/td\u003e\n      \u003ctd\u003e1076596773323\u003c/td\u003e\n      \u003ctd\u003e1026722\u003c/td\u003e\n      \u003ctd\u003e848201300001497\u003c/td\u003e\n      \u003ctd\u003e270.781189\u003c/td\u003e\n      \u003ctd\u003e66.266031\u003c/td\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003ezr\u003c/td\u003e\n      \u003ctd\u003e196\u003c/td\u003e\n      \u003ctd\u003e1.018292\u003c/td\u003e\n      \u003ctd\u003e0.256665\u003c/td\u003e\n      \u003ctd\u003e21.14094\u003c/td\u003e\n      \u003ctd\u003e0.167229\u003c/td\u003e\n      \u003ctd\u003e0.350357\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1128893376581602470\u003c/th\u003e\n      \u003ctd\u003e1076596619207\u003c/td\u003e\n      \u003ctd\u003e1026722\u003c/td\u003e\n      \u003ctd\u003e102159193\u003c/td\u003e\n      \u003ctd\u003e2707976353662411561\u003c/td\u003e\n      \u003ctd\u003e270.797635\u003c/td\u003e\n      \u003ctd\u003e66.241156\u003c/td\u003e\n      \u003ctd\u003e0.4\u003c/td\u003e\n      \u003ctd\u003e1076596619206\u003c/td\u003e\n      \u003ctd\u003e1026722\u003c/td\u003e\n      \u003ctd\u003e848201300001788\u003c/td\u003e\n      \u003ctd\u003e270.797594\u003c/td\u003e\n      \u003ctd\u003e66.241162\u003c/td\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003ezr\u003c/td\u003e\n      \u003ctd\u003e599\u003c/td\u003e\n      \u003ctd\u003e0.958596\u003c/td\u003e\n      \u003ctd\u003e0.210892\u003c/td\u003e\n      \u003ctd\u003e20.752556\u003c/td\u003e\n      \u003ctd\u003e0.132805\u003c/td\u003e\n      \u003ctd\u003e0.064059\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1128893337709122935\u003c/th\u003e\n      \u003ctd\u003e1076596582135\u003c/td\u003e\n      \u003ctd\u003e1026722\u003c/td\u003e\n      \u003ctd\u003e102159193\u003c/td\u003e\n      \u003ctd\u003e2708392307662229925\u003c/td\u003e\n      \u003ctd\u003e270.839231\u003c/td\u003e\n      \u003ctd\u003e66.222993\u003c/td\u003e\n      \u003ctd\u003e0.59\u003c/td\u003e\n      \u003ctd\u003e1076596582134\u003c/td\u003e\n      \u003ctd\u003e1026722\u003c/td\u003e\n      \u003ctd\u003e848201300001975\u003c/td\u003e\n      \u003ctd\u003e270.839017\u003c/td\u003e\n      \u003ctd\u003e66.222907\u003c/td\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003ezr\u003c/td\u003e\n      \u003ctd\u003e61\u003c/td\u003e\n      \u003ctd\u003e1.336956\u003c/td\u003e\n      \u003ctd\u003e0.333995\u003c/td\u003e\n      \u003ctd\u003e21.316973\u003c/td\u003e\n      \u003ctd\u003e0.234939\u003c/td\u003e\n      \u003ctd\u003e0.436674\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1128893340254188261\u003c/th\u003e\n      \u003ctd\u003e1076596584562\u003c/td\u003e\n      \u003ctd\u003e1026722\u003c/td\u003e\n      \u003ctd\u003e102159193\u003c/td\u003e\n      \u003ctd\u003e2708472558662234858\u003c/td\u003e\n      \u003ctd\u003e270.847256\u003c/td\u003e\n      \u003ctd\u003e66.223486\u003c/td\u003e\n      \u003ctd\u003e0.03\u003c/td\u003e\n      \u003ctd\u003e1076596584563\u003c/td\u003e\n      \u003ctd\u003e1026722\u003c/td\u003e\n      \u003ctd\u003e848201300001966\u003c/td\u003e\n      \u003ctd\u003e270.847261\u003c/td\u003e\n      \u003ctd\u003e66.223523\u003c/td\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003ezr\u003c/td\u003e\n      \u003ctd\u003e83\u003c/td\u003e\n      \u003ctd\u003e1.09015\u003c/td\u003e\n      \u003ctd\u003e0.3153\u003c/td\u003e\n      \u003ctd\u003e21.287346\u003c/td\u003e\n      \u003ctd\u003e0.189821\u003c/td\u003e\n      \u003ctd\u003e0.132318\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e4833 rows × 20 columns\u003c/p\u003e","content_type":"text/html"}}}],"key":"iilnedHbig"}],"key":"dbDf7pjgc5"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":419,"column":1},"end":{"line":419,"column":1}},"children":[{"type":"text","value":"5.3 Identify objects of interest from the crossmatch","position":{"start":{"line":419,"column":1},"end":{"line":419,"column":1}},"key":"zgBtUclEoJ"}],"identifier":"id-5-3-identify-objects-of-interest-from-the-crossmatch","label":"5.3 Identify objects of interest from the crossmatch","html_id":"id-5-3-identify-objects-of-interest-from-the-crossmatch","implicit":true,"key":"jrccu6Rijh"}],"key":"ECoqcD9ngv"},{"type":"block","position":{"start":{"line":421,"column":1},"end":{"line":421,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"children":[{"type":"text","value":"Check the number of unique Euclid and ZTF sources in the crossmatched catalog:","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"FCJWFf8ccJ"}],"key":"o4cLtCPvWH"}],"key":"CJrme3hL9z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"euclid_x_ztf_df.shape[0], euclid_x_ztf_df['object_id_euclid'].nunique(), euclid_x_ztf_df['oid_ztf'].nunique()","key":"lDTrrhUocl"},{"type":"output","id":"Qiwq9Tki3YnGeUnhuQ2QN","data":[{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"text/plain":{"content":"(4833, 4833, 4808)","content_type":"text/plain"}}}],"key":"jCNSoU54rA"}],"key":"HT4tozPuEd"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":429,"column":1},"end":{"line":430,"column":1}},"children":[{"type":"text","value":"This means there is one unique Euclid source for each row in the crossmatched catalog as expected (since we put Euclid on the left side of the crossmatch).\nBut for ZTF, this is not true as some ZTF objects have multiple Euclid matches since ZTF has lower resolution than Euclid.","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"key":"pgHaHignll"}],"key":"HGV3LC7d1Y"},{"type":"paragraph","position":{"start":{"line":432,"column":1},"end":{"line":433,"column":1}},"children":[{"type":"text","value":"Now let’s plot some variability metrics from ZTF against Euclid redshift to see if there are any trends.\nWe will use hexbin plots to visualize the density of sources in each panel:","position":{"start":{"line":432,"column":1},"end":{"line":432,"column":1}},"key":"fxter9OpFa"}],"key":"BCCSOiZaY3"}],"key":"myqcwkgqNs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"z = euclid_x_ztf_df[\"phz_phz_median_euclid\"].to_numpy() # x-axis\nmetrics = [ # y-axes\n    (\"magrms_ztf\",        \"ZTF mag RMS\"),\n    (\"chisq_ztf\",         \"ZTF χ²\"),\n    (\"medianabsdev_ztf\",  \"ZTF MAD\"),\n    (\"ngoodobsrel_ztf\",   \"ZTF # good obs\"),\n]\n\nfig, axes = plt.subplots(2, 2, figsize=(10, 6), constrained_layout=True, sharex=True)\naxes = axes.ravel()\n\nxmin, xmax = 0, 2.5  \ngridsize = 48  # resolution: larger =\u003e finer grid\n\nfor i, (col, ylabel) in enumerate(metrics):\n    ax = axes[i]\n    y = euclid_x_ztf_df[col].to_numpy()\n\n    # clip y to robust range (1–99th percentile) for visibility\n    y_lo, y_hi = np.nanpercentile(y, [1, 99])\n\n    hb = ax.hexbin(\n        z, y,\n        gridsize=gridsize,\n        extent=(xmin, xmax, y_lo, y_hi),\n        mincnt=1,\n        bins='log'  # logarithmic color scale of counts\n    )\n\n    # ax.set_xlim(xmin, xmax)\n    # ax.set_ylim(y_lo, y_hi)\n    ax.set_ylabel(ylabel)\n\n    # x-label only on bottom row to reduce clutter\n    if i // 2 == 1:\n        ax.set_xlabel(\"Euclid redshift\")\n\n\n# Shared colorbar across all panels (uses last hexbin as mappable)\ncbar = fig.colorbar(hb, ax=axes[:-1], shrink=0.9, label=\"Galaxy sources count (log)\")\n\nfig.suptitle(\"Euclid redshift vs ZTF variability metrics\", y=1.04)\nplt.show()","key":"NAPkzHZXfE"},{"type":"output","id":"D7GmRwuW97hi86pbJe-x9","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 1000x600 with 5 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"5f8fc2e41bd9c98e75d39a0dba044886","path":"/irsa-tutorials/build/5f8fc2e41bd9c98e75d39a0dba044886.png"}}}],"key":"CXj1RLMJSu"}],"key":"vSvlVL00UA"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":481,"column":1},"end":{"line":482,"column":1}},"children":[{"type":"text","value":"There’s no strong variability trend for higher redshift galaxies (z \u003e 1) as the distributions of mag RMS, MAD, and Chi-squared are fairly stable with redshift.\nThis is likely because of the limited sensitivity of ZTF, as there are clearly fewer good observations as redshift increases.","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"key":"GMRBD1qngF"}],"key":"nirjjUBj4Z"},{"type":"paragraph","position":{"start":{"line":484,"column":1},"end":{"line":485,"column":1}},"children":[{"type":"text","value":"Despite this, we can still select some high-variability galaxy sources from the low redshift (z \u003c 1) range for further analysis.\nLet’s focus only on Chi-squared (measure of significance) and RMS magnitude (measure of variability amplitude; similar to MAD) metrics:","position":{"start":{"line":484,"column":1},"end":{"line":484,"column":1}},"key":"ZLFFIq5QTI"}],"key":"k6NDBnqyc0"}],"key":"WPzeoRJcnK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"euclid_x_ztf_df['chisq_ztf'].describe()","key":"pX0oGR2Ift"},{"type":"output","id":"P3CyMgkjHsZcP66Ix5nwB","data":[{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"text/plain":{"content":"count       4833.0\nmean      1.125982\nstd       0.677987\nmin       0.648965\n25%       0.964728\n50%       1.050994\n75%       1.161509\nmax      27.873291\nName: chisq_ztf, dtype: double[pyarrow]","content_type":"text/plain"}}}],"key":"XXKDjn0F6h"}],"key":"OakXOszAAD"},{"type":"block","children":[],"key":"Old3viJisV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"chisq_threshold = euclid_x_ztf_df['chisq_ztf'].quantile(0.95)\nchisq_threshold","key":"ofxtEDrVmp"},{"type":"output","id":"KDMlj-aCIV3S4ao0V9tiF","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"text/plain":{"content":"1.4483341455459593","content_type":"text/plain"}}}],"key":"XRutzCJ38z"}],"key":"V0y66X80Mz"},{"type":"block","children":[],"key":"hfqfTtCL1Y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"euclid_x_ztf_df['magrms_ztf'].describe()","key":"reycAkadBH"},{"type":"output","id":"6FcBRkdbuE0a-iPgz9XuJ","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/plain":{"content":"count      4833.0\nmean     0.219656\nstd      0.089749\nmin      0.010117\n25%      0.175114\n50%      0.234153\n75%      0.277245\nmax      0.923869\nName: magrms_ztf, dtype: double[pyarrow]","content_type":"text/plain"}}}],"key":"nr6LL0CikC"}],"key":"FMDG7XdApV"},{"type":"block","children":[],"key":"BWkfBf8EwJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"magrms_threshold = euclid_x_ztf_df['magrms_ztf'].quantile(0.95)\nmagrms_threshold","key":"tkz1uFmxHh"},{"type":"output","id":"U_GQYHI5_cNFdCTVi-F9a","data":[{"output_type":"execute_result","execution_count":38,"metadata":{},"data":{"text/plain":{"content":"0.33570506572723385","content_type":"text/plain"}}}],"key":"N45RaERYud"}],"key":"bXHLdpPvM8"},{"type":"block","children":[],"key":"mqF5rhnTfi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"variable_galaxies = euclid_x_ztf_df.query(\n    f\"chisq_ztf \u003e= {chisq_threshold} \u0026 magrms_ztf \u003e= {magrms_threshold}\"\n    ).sort_values(\"chisq_ztf\", ascending=False) # sort by significant variability","key":"lpWmmoHqea"},{"type":"output","id":"QJg2oH1SQ0Vx9RgQeajvJ","data":[],"key":"tCY1XJ1sqs"}],"key":"t0REX70A1y"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":511,"column":1},"end":{"line":511,"column":1}},"children":[{"type":"text","value":"Let’s inspect the top variable galaxies that we can use for plotting their light curves:","position":{"start":{"line":511,"column":1},"end":{"line":511,"column":1}},"key":"xpbwKO5mFg"}],"key":"gxrR3NKOGj"}],"key":"QZF4AsuHrS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cols_of_interest = [\"oid_ztf\", \"fid_ztf\", \"filtercode_ztf\", \"phz_phz_median_euclid\", \"magrms_ztf\", \"chisq_ztf\"]\ntop_variable_galaxies = variable_galaxies.head(3)\ntop_variable_galaxies[cols_of_interest]","key":"NFWcRdrmst"},{"type":"output","id":"jaeDUAP-DaNKcvLTs21ls","data":[{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"text/plain":{"content":"                             oid_ztf  fid_ztf filtercode_ztf  \\\n_healpix_29                                                    \n1080844064773760661  848201300014047        2             zr   \n816655967593598710   848102400023608        1             zg   \n816655965602458265   848202400038072        2             zr   \n\n                     phz_phz_median_euclid  magrms_ztf  chisq_ztf  \n_healpix_29                                                        \n1080844064773760661                   0.11    0.923869  27.873291  \n816655967593598710                     1.0    0.844652  19.543127  \n816655965602458265                    0.96    0.765504  17.694681  ","content_type":"text/plain"},"text/html":{"content":"\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003eoid_ztf\u003c/th\u003e\n      \u003cth\u003efid_ztf\u003c/th\u003e\n      \u003cth\u003efiltercode_ztf\u003c/th\u003e\n      \u003cth\u003ephz_phz_median_euclid\u003c/th\u003e\n      \u003cth\u003emagrms_ztf\u003c/th\u003e\n      \u003cth\u003echisq_ztf\u003c/th\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e_healpix_29\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1080844064773760661\u003c/th\u003e\n      \u003ctd\u003e848201300014047\u003c/td\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003ezr\u003c/td\u003e\n      \u003ctd\u003e0.11\u003c/td\u003e\n      \u003ctd\u003e0.923869\u003c/td\u003e\n      \u003ctd\u003e27.873291\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e816655967593598710\u003c/th\u003e\n      \u003ctd\u003e848102400023608\u003c/td\u003e\n      \u003ctd\u003e1\u003c/td\u003e\n      \u003ctd\u003ezg\u003c/td\u003e\n      \u003ctd\u003e1.0\u003c/td\u003e\n      \u003ctd\u003e0.844652\u003c/td\u003e\n      \u003ctd\u003e19.543127\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e816655965602458265\u003c/th\u003e\n      \u003ctd\u003e848202400038072\u003c/td\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003ezr\u003c/td\u003e\n      \u003ctd\u003e0.96\u003c/td\u003e\n      \u003ctd\u003e0.765504\u003c/td\u003e\n      \u003ctd\u003e17.694681\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e3 rows × 6 columns\u003c/p\u003e","content_type":"text/html"}}}],"key":"sBnCXI1x0v"}],"key":"jynRJNfk3d"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"children":[{"type":"text","value":"6. Load ZTF lightcurves by object IDs","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"key":"Sur4S9IQYN"}],"identifier":"id-6-load-ztf-lightcurves-by-object-ids","label":"6. Load ZTF lightcurves by object IDs","html_id":"id-6-load-ztf-lightcurves-by-object-ids","implicit":true,"key":"ydcn0PMDh8"}],"key":"rWjWQvVQDx"},{"type":"block","position":{"start":{"line":521,"column":1},"end":{"line":521,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":523,"column":1},"end":{"line":526,"column":1}},"children":[{"type":"text","value":"Let’s open the ZTF light curves HATS catalog.\nNote that we are using the same spatial filter as before.\nWe do not specify any column filters, because the default columns already contain the light curve data we need.\nWe also do not apply any row filters, since we will directly filter rows by object IDs.","position":{"start":{"line":523,"column":1},"end":{"line":523,"column":1}},"key":"t3HRpuzZlE"}],"key":"Jp5PNv7AyN"}],"key":"oZ5gSxkaP8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ztf_lc_catalog = lsdb.open_catalog(f\"s3://{ztf_bucket}/{ztf_lc_hats_prefix}\",\n                                   search_filter=spatial_filter\n                                   )\nztf_lc_catalog","key":"BguObk7FXf"},{"type":"output","id":"234XCRvbnEXeyws3NXLsv","data":[{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"text/plain":{"content":"Dask NestedFrame Structure:\n                           objectid       filterid           objra          objdec                                                                                   lightcurve\nnpartitions=4                                                                                                                                                                  \n720294465402568704   int64[pyarrow]  int8[pyarrow]  float[pyarrow]  float[pyarrow]  nested\u003chmjd: [double], mag: [float], magerr: [float], clrcoeff: [float], catflags: [int32]\u003e\n816558907437613056              ...            ...             ...             ...                                                                                          ...\n1080582435592208384             ...            ...             ...             ...                                                                                          ...\n1128714656609730560             ...            ...             ...             ...                                                                                          ...\n1128996131586441216             ...            ...             ...             ...                                                                                          ...\nDask Name: search_points, 5 expressions\nExpr=MapPartitions(search_points)","content_type":"text/plain"},"text/html":{"content":"\u003cdiv\u003e\u003cstrong\u003elsdb Catalog ZTF_DR23_Lightcurves:\u003c/strong\u003e\u003c/div\u003e\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003eobjectid\u003c/th\u003e\n      \u003cth\u003efilterid\u003c/th\u003e\n      \u003cth\u003eobjra\u003c/th\u003e\n      \u003cth\u003eobjdec\u003c/th\u003e\n      \u003cth\u003elightcurve\u003c/th\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003enpartitions=4\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 5, Pixel: 2559\u003c/th\u003e\n      \u003ctd\u003eint64[pyarrow]\u003c/td\u003e\n      \u003ctd\u003eint8[pyarrow]\u003c/td\u003e\n      \u003ctd\u003efloat[pyarrow]\u003c/td\u003e\n      \u003ctd\u003efloat[pyarrow]\u003c/td\u003e\n      \u003ctd\u003enested\u0026lt;hmjd: [double], mag: [float], magerr: [float], clrcoeff: [float], catflags: [int32]\u0026gt;\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 5, Pixel: 2901\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 5, Pixel: 3839\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 5, Pixel: 4010\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e\u003cdiv\u003e5 out of 13 available columns in the catalog have been loaded \u003cstrong\u003elazily\u003c/strong\u003e, meaning no data has been read, only the catalog schema\u003c/div\u003e","content_type":"text/html"}}}],"key":"GynMubYLkV"}],"key":"lqwplVvoS1"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":535,"column":1},"end":{"line":535,"column":1}},"children":[{"type":"text","value":"We can inspect the catalog’s collection properties and find which columns have ancillary index tables (as explained in lsdb’s documentation on ","position":{"start":{"line":535,"column":1},"end":{"line":535,"column":1}},"key":"ip9GSJgGGS"},{"type":"link","url":"https://docs.lsdb.io/en/latest/tutorials/pre_executed/index_table.html","position":{"start":{"line":535,"column":1},"end":{"line":535,"column":1}},"children":[{"type":"text","value":"using index tables","position":{"start":{"line":535,"column":1},"end":{"line":535,"column":1}},"key":"oKBDdljJBg"}],"urlSource":"https://docs.lsdb.io/en/latest/tutorials/pre_executed/index_table.html","key":"OqR9GXYPb3"},{"type":"text","value":").","position":{"start":{"line":535,"column":1},"end":{"line":535,"column":1}},"key":"HLJLSILLTz"}],"key":"PHsna7R9Gg"}],"key":"OBo5ZErdFZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ztf_lc_idx_column = list(ztf_lc_catalog.hc_collection.all_indexes.keys())[0]\nztf_lc_idx_column","key":"xDN0xmwdQC"},{"type":"output","id":"9pLmYb4LEwiQWLog5Yj67","data":[{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"text/plain":{"content":"'objectid'","content_type":"text/plain"}}}],"key":"gmkxUREeTY"}],"key":"uWlHwXbNvN"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":542,"column":1},"end":{"line":542,"column":1}},"children":[{"type":"text","value":"Let’s just extract the object IDs of the top variable galaxies we identified above:","position":{"start":{"line":542,"column":1},"end":{"line":542,"column":1}},"key":"Ts21v1X6pP"}],"key":"UNLBDZNCeR"}],"key":"S5KXVkQTXZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ztf_oids = top_variable_galaxies['oid_ztf'].tolist()\nztf_oids","key":"QJYkIiQOoZ"},{"type":"output","id":"2TTwKIQGhU9hheZsJzb0U","data":[{"output_type":"execute_result","execution_count":43,"metadata":{},"data":{"text/plain":{"content":"[848201300014047, 848102400023608, 848202400038072]","content_type":"text/plain"}}}],"key":"Mc1YTukYZ4"}],"key":"DEV2FySOAi"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"children":[{"type":"text","value":"Now we can use these IDs to filter the ZTF light curves catalog by the ","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"key":"WsSvJxG1q7"},{"type":"inlineCode","value":"id_search","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"key":"xHo2uLjloJ"},{"type":"text","value":" method:","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"key":"jGW9mqpFjy"}],"key":"u7ObiL8Xip"}],"key":"VKyDwqVQfj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ztf_lcs = ztf_lc_catalog.id_search(values={ztf_lc_idx_column: ztf_oids})\nztf_lcs","key":"sQ41IoV2G2"},{"type":"output","id":"fAgct18o3dAV_6ODywbiX","data":[{"output_type":"stream","name":"stdout","text":"Searching for objectid=[848201300014047, 848102400023608, 848202400038072]\n"},{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/plain":{"content":"Dask NestedFrame Structure:\n                           objectid       filterid           objra          objdec                                                                                   lightcurve\nnpartitions=2                                                                                                                                                                  \n816558907437613056   int64[pyarrow]  int8[pyarrow]  float[pyarrow]  float[pyarrow]  nested\u003chmjd: [double], mag: [float], magerr: [float], clrcoeff: [float], catflags: [int32]\u003e\n1080582435592208384             ...            ...             ...             ...                                                                                          ...\n1128714656609730560             ...            ...             ...             ...                                                                                          ...\nDask Name: search_points, 7 expressions\nExpr=MapPartitions(search_points)","content_type":"text/plain"},"text/html":{"content":"\u003cdiv\u003e\u003cstrong\u003elsdb Catalog ZTF_DR23_Lightcurves:\u003c/strong\u003e\u003c/div\u003e\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003eobjectid\u003c/th\u003e\n      \u003cth\u003efilterid\u003c/th\u003e\n      \u003cth\u003eobjra\u003c/th\u003e\n      \u003cth\u003eobjdec\u003c/th\u003e\n      \u003cth\u003elightcurve\u003c/th\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003enpartitions=2\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 5, Pixel: 2901\u003c/th\u003e\n      \u003ctd\u003eint64[pyarrow]\u003c/td\u003e\n      \u003ctd\u003eint8[pyarrow]\u003c/td\u003e\n      \u003ctd\u003efloat[pyarrow]\u003c/td\u003e\n      \u003ctd\u003efloat[pyarrow]\u003c/td\u003e\n      \u003ctd\u003enested\u0026lt;hmjd: [double], mag: [float], magerr: [float], clrcoeff: [float], catflags: [int32]\u0026gt;\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eOrder: 5, Pixel: 3839\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e\u003cdiv\u003e5 out of 13 available columns in the catalog have been loaded \u003cstrong\u003elazily\u003c/strong\u003e, meaning no data has been read, only the catalog schema\u003c/div\u003e","content_type":"text/html"}}}],"key":"h10G7BPncC"}],"key":"UOveHkjIwk"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":556,"column":1},"end":{"line":557,"column":1}},"children":[{"type":"text","value":"As earlier, this creates a lazy catalog object with the partition(s) that contains our IDs.\nWe can load the light curves data into a DataFrame by using the ","position":{"start":{"line":556,"column":1},"end":{"line":556,"column":1}},"key":"EmObIcMGFS"},{"type":"inlineCode","value":"compute()","position":{"start":{"line":556,"column":1},"end":{"line":556,"column":1}},"key":"n9LArdAu5i"},{"type":"text","value":" method:","position":{"start":{"line":556,"column":1},"end":{"line":556,"column":1}},"key":"kZHwCtJxFN"}],"key":"WhHwCoYMe2"}],"key":"rD2Jl4Me2k"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ztf_lcs_df = ztf_lcs.compute() # ID search runs out of memory if we try to parallelize it with Dask client\nztf_lcs_df","key":"yCz8x9xb3i"},{"type":"output","id":"N_bxqVYWBYrUogf9OBqCk","data":[{"output_type":"execute_result","execution_count":45,"metadata":{},"data":{"text/plain":{"content":"                            objectid  filterid       objra     objdec  \\\n_healpix_29                                                             \n816655965609758114   848202400038072         2    268.8302  66.324913   \n816655967601097877   848102400023608         1  268.827881  66.326439   \n1080844064784050785  848201300014047         2  270.404602  65.946106   \n\n                                                                                                                 lightcurve  \n_healpix_29                                                                                                                  \n816655965609758114   [{hmjd: 58198.36545, mag: 17.170887, magerr: 0.016645, clrcoeff: 0.067037, catflags: 0}; …] (130 rows)  \n816655967601097877   [{hmjd: 58207.39283, mag: 18.013729, magerr: 0.028822, clrcoeff: -0.077841, catflags: 0}; …] (54 rows)  \n1080844064784050785  [{hmjd: 58226.44889, mag: 21.158422, magerr: 0.242976, clrcoeff: 0.094843, catflags: 0}; …] (148 rows)  ","content_type":"text/plain"},"text/html":{"content":"\u003cstyle type=\"text/css\"\u003e\n\u003c/style\u003e\n\u003ctable id=\"T_46b4f\"\u003e\n  \u003cthead\u003e\n    \u003ctr\u003e\n      \u003cth class=\"blank level0\" \u003e\u0026nbsp;\u003c/th\u003e\n      \u003cth id=\"T_46b4f_level0_col0\" class=\"col_heading level0 col0\" \u003eobjectid\u003c/th\u003e\n      \u003cth id=\"T_46b4f_level0_col1\" class=\"col_heading level0 col1\" \u003efilterid\u003c/th\u003e\n      \u003cth id=\"T_46b4f_level0_col2\" class=\"col_heading level0 col2\" \u003eobjra\u003c/th\u003e\n      \u003cth id=\"T_46b4f_level0_col3\" class=\"col_heading level0 col3\" \u003eobjdec\u003c/th\u003e\n      \u003cth id=\"T_46b4f_level0_col4\" class=\"col_heading level0 col4\" \u003elightcurve\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth id=\"T_46b4f_level0_row0\" class=\"row_heading level0 row0\" \u003e816655965609758114\u003c/th\u003e\n      \u003ctd id=\"T_46b4f_row0_col0\" class=\"data row0 col0\" \u003e848202400038072\u003c/td\u003e\n      \u003ctd id=\"T_46b4f_row0_col1\" class=\"data row0 col1\" \u003e2\u003c/td\u003e\n      \u003ctd id=\"T_46b4f_row0_col2\" class=\"data row0 col2\" \u003e268.830200\u003c/td\u003e\n      \u003ctd id=\"T_46b4f_row0_col3\" class=\"data row0 col3\" \u003e66.324913\u003c/td\u003e\n      \u003ctd id=\"T_46b4f_row0_col4\" class=\"data row0 col4\" \u003e\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003ehmjd\u003c/th\u003e\n      \u003cth\u003emag\u003c/th\u003e\n      \u003cth\u003emagerr\u003c/th\u003e\n      \u003cth\u003eclrcoeff\u003c/th\u003e\n      \u003cth\u003ecatflags\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e58198.36545\u003c/td\u003e\n      \u003ctd\u003e17.170887\u003c/td\u003e\n      \u003ctd\u003e0.016645\u003c/td\u003e\n      \u003ctd\u003e0.067037\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ci\u003e+129 rows\u003c/i\u003e\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth id=\"T_46b4f_level0_row1\" class=\"row_heading level0 row1\" \u003e816655967601097877\u003c/th\u003e\n      \u003ctd id=\"T_46b4f_row1_col0\" class=\"data row1 col0\" \u003e848102400023608\u003c/td\u003e\n      \u003ctd id=\"T_46b4f_row1_col1\" class=\"data row1 col1\" \u003e1\u003c/td\u003e\n      \u003ctd id=\"T_46b4f_row1_col2\" class=\"data row1 col2\" \u003e268.827881\u003c/td\u003e\n      \u003ctd id=\"T_46b4f_row1_col3\" class=\"data row1 col3\" \u003e66.326439\u003c/td\u003e\n      \u003ctd id=\"T_46b4f_row1_col4\" class=\"data row1 col4\" \u003e\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003ehmjd\u003c/th\u003e\n      \u003cth\u003emag\u003c/th\u003e\n      \u003cth\u003emagerr\u003c/th\u003e\n      \u003cth\u003eclrcoeff\u003c/th\u003e\n      \u003cth\u003ecatflags\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e58207.39283\u003c/td\u003e\n      \u003ctd\u003e18.013729\u003c/td\u003e\n      \u003ctd\u003e0.028822\u003c/td\u003e\n      \u003ctd\u003e-0.077841\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ci\u003e+53 rows\u003c/i\u003e\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth id=\"T_46b4f_level0_row2\" class=\"row_heading level0 row2\" \u003e1080844064784050785\u003c/th\u003e\n      \u003ctd id=\"T_46b4f_row2_col0\" class=\"data row2 col0\" \u003e848201300014047\u003c/td\u003e\n      \u003ctd id=\"T_46b4f_row2_col1\" class=\"data row2 col1\" \u003e2\u003c/td\u003e\n      \u003ctd id=\"T_46b4f_row2_col2\" class=\"data row2 col2\" \u003e270.404602\u003c/td\u003e\n      \u003ctd id=\"T_46b4f_row2_col3\" class=\"data row2 col3\" \u003e65.946106\u003c/td\u003e\n      \u003ctd id=\"T_46b4f_row2_col4\" class=\"data row2 col4\" \u003e\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003ehmjd\u003c/th\u003e\n      \u003cth\u003emag\u003c/th\u003e\n      \u003cth\u003emagerr\u003c/th\u003e\n      \u003cth\u003eclrcoeff\u003c/th\u003e\n      \u003cth\u003ecatflags\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e58226.44889\u003c/td\u003e\n      \u003ctd\u003e21.158422\u003c/td\u003e\n      \u003ctd\u003e0.242976\u003c/td\u003e\n      \u003ctd\u003e0.094843\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ci\u003e+147 rows\u003c/i\u003e\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n3 rows x 5 columns","content_type":"text/html"}}}],"key":"NQsUdnysde"}],"key":"HqeCKv4oFA"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"children":[{"type":"text","value":"Let’s merge this light curves DataFrame with the crossmatched catalog (with variability filters and sorting) so that we can use collapsed light curves metrics for annotating the plots:","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"PFrX7wEywZ"}],"key":"qzGbcYrD2X"}],"key":"v2jy5RZCYx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"merged_ztf_lcs_df = ztf_lcs_df.merge(\n    top_variable_galaxies[cols_of_interest].set_index('oid_ztf'),\n    left_on='objectid', right_index=True\n).set_index('objectid', drop=False)\n\n# Sort by the order of top_variable_galaxies\nmerged_ztf_lcs_df = merged_ztf_lcs_df.loc[ztf_oids]\nmerged_ztf_lcs_df","key":"eaCl7S6uM1"},{"type":"output","id":"n0byOf8ql8qMD5ngWGaVi","data":[{"output_type":"execute_result","execution_count":46,"metadata":{},"data":{"text/plain":{"content":"                        objectid  filterid       objra     objdec  \\\nobjectid                                                            \n848201300014047  848201300014047         2  270.404602  65.946106   \n848102400023608  848102400023608         1  268.827881  66.326439   \n848202400038072  848202400038072         2    268.8302  66.324913   \n\n                                                                                                             lightcurve  \\\nobjectid                                                                                                                  \n848201300014047  [{hmjd: 58226.44889, mag: 21.158422, magerr: 0.242976, clrcoeff: 0.094843, catflags: 0}; …] (148 rows)   \n848102400023608  [{hmjd: 58207.39283, mag: 18.013729, magerr: 0.028822, clrcoeff: -0.077841, catflags: 0}; …] (54 rows)   \n848202400038072  [{hmjd: 58198.36545, mag: 17.170887, magerr: 0.016645, clrcoeff: 0.067037, catflags: 0}; …] (130 rows)   \n\n                 fid_ztf filtercode_ztf  phz_phz_median_euclid  magrms_ztf  \\\nobjectid                                                                     \n848201300014047        2             zr                   0.11    0.923869   \n848102400023608        1             zg                    1.0    0.844652   \n848202400038072        2             zr                   0.96    0.765504   \n\n                 chisq_ztf  \nobjectid                    \n848201300014047  27.873291  \n848102400023608  19.543127  \n848202400038072  17.694681  ","content_type":"text/plain"},"text/html":{"content":"\u003cstyle type=\"text/css\"\u003e\n\u003c/style\u003e\n\u003ctable id=\"T_22866\"\u003e\n  \u003cthead\u003e\n    \u003ctr\u003e\n      \u003cth class=\"blank level0\" \u003e\u0026nbsp;\u003c/th\u003e\n      \u003cth id=\"T_22866_level0_col0\" class=\"col_heading level0 col0\" \u003eobjectid\u003c/th\u003e\n      \u003cth id=\"T_22866_level0_col1\" class=\"col_heading level0 col1\" \u003efilterid\u003c/th\u003e\n      \u003cth id=\"T_22866_level0_col2\" class=\"col_heading level0 col2\" \u003eobjra\u003c/th\u003e\n      \u003cth id=\"T_22866_level0_col3\" class=\"col_heading level0 col3\" \u003eobjdec\u003c/th\u003e\n      \u003cth id=\"T_22866_level0_col4\" class=\"col_heading level0 col4\" \u003elightcurve\u003c/th\u003e\n      \u003cth id=\"T_22866_level0_col5\" class=\"col_heading level0 col5\" \u003efid_ztf\u003c/th\u003e\n      \u003cth id=\"T_22866_level0_col6\" class=\"col_heading level0 col6\" \u003efiltercode_ztf\u003c/th\u003e\n      \u003cth id=\"T_22866_level0_col7\" class=\"col_heading level0 col7\" \u003ephz_phz_median_euclid\u003c/th\u003e\n      \u003cth id=\"T_22866_level0_col8\" class=\"col_heading level0 col8\" \u003emagrms_ztf\u003c/th\u003e\n      \u003cth id=\"T_22866_level0_col9\" class=\"col_heading level0 col9\" \u003echisq_ztf\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth id=\"T_22866_level0_row0\" class=\"row_heading level0 row0\" \u003e848201300014047\u003c/th\u003e\n      \u003ctd id=\"T_22866_row0_col0\" class=\"data row0 col0\" \u003e848201300014047\u003c/td\u003e\n      \u003ctd id=\"T_22866_row0_col1\" class=\"data row0 col1\" \u003e2\u003c/td\u003e\n      \u003ctd id=\"T_22866_row0_col2\" class=\"data row0 col2\" \u003e270.404602\u003c/td\u003e\n      \u003ctd id=\"T_22866_row0_col3\" class=\"data row0 col3\" \u003e65.946106\u003c/td\u003e\n      \u003ctd id=\"T_22866_row0_col4\" class=\"data row0 col4\" \u003e\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003ehmjd\u003c/th\u003e\n      \u003cth\u003emag\u003c/th\u003e\n      \u003cth\u003emagerr\u003c/th\u003e\n      \u003cth\u003eclrcoeff\u003c/th\u003e\n      \u003cth\u003ecatflags\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e58226.44889\u003c/td\u003e\n      \u003ctd\u003e21.158422\u003c/td\u003e\n      \u003ctd\u003e0.242976\u003c/td\u003e\n      \u003ctd\u003e0.094843\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ci\u003e+147 rows\u003c/i\u003e\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\u003c/td\u003e\n      \u003ctd id=\"T_22866_row0_col5\" class=\"data row0 col5\" \u003e2\u003c/td\u003e\n      \u003ctd id=\"T_22866_row0_col6\" class=\"data row0 col6\" \u003ezr\u003c/td\u003e\n      \u003ctd id=\"T_22866_row0_col7\" class=\"data row0 col7\" \u003e0.110000\u003c/td\u003e\n      \u003ctd id=\"T_22866_row0_col8\" class=\"data row0 col8\" \u003e0.923869\u003c/td\u003e\n      \u003ctd id=\"T_22866_row0_col9\" class=\"data row0 col9\" \u003e27.873291\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth id=\"T_22866_level0_row1\" class=\"row_heading level0 row1\" \u003e848102400023608\u003c/th\u003e\n      \u003ctd id=\"T_22866_row1_col0\" class=\"data row1 col0\" \u003e848102400023608\u003c/td\u003e\n      \u003ctd id=\"T_22866_row1_col1\" class=\"data row1 col1\" \u003e1\u003c/td\u003e\n      \u003ctd id=\"T_22866_row1_col2\" class=\"data row1 col2\" \u003e268.827881\u003c/td\u003e\n      \u003ctd id=\"T_22866_row1_col3\" class=\"data row1 col3\" \u003e66.326439\u003c/td\u003e\n      \u003ctd id=\"T_22866_row1_col4\" class=\"data row1 col4\" \u003e\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003ehmjd\u003c/th\u003e\n      \u003cth\u003emag\u003c/th\u003e\n      \u003cth\u003emagerr\u003c/th\u003e\n      \u003cth\u003eclrcoeff\u003c/th\u003e\n      \u003cth\u003ecatflags\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e58207.39283\u003c/td\u003e\n      \u003ctd\u003e18.013729\u003c/td\u003e\n      \u003ctd\u003e0.028822\u003c/td\u003e\n      \u003ctd\u003e-0.077841\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ci\u003e+53 rows\u003c/i\u003e\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\u003c/td\u003e\n      \u003ctd id=\"T_22866_row1_col5\" class=\"data row1 col5\" \u003e1\u003c/td\u003e\n      \u003ctd id=\"T_22866_row1_col6\" class=\"data row1 col6\" \u003ezg\u003c/td\u003e\n      \u003ctd id=\"T_22866_row1_col7\" class=\"data row1 col7\" \u003e1.000000\u003c/td\u003e\n      \u003ctd id=\"T_22866_row1_col8\" class=\"data row1 col8\" \u003e0.844652\u003c/td\u003e\n      \u003ctd id=\"T_22866_row1_col9\" class=\"data row1 col9\" \u003e19.543127\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth id=\"T_22866_level0_row2\" class=\"row_heading level0 row2\" \u003e848202400038072\u003c/th\u003e\n      \u003ctd id=\"T_22866_row2_col0\" class=\"data row2 col0\" \u003e848202400038072\u003c/td\u003e\n      \u003ctd id=\"T_22866_row2_col1\" class=\"data row2 col1\" \u003e2\u003c/td\u003e\n      \u003ctd id=\"T_22866_row2_col2\" class=\"data row2 col2\" \u003e268.830200\u003c/td\u003e\n      \u003ctd id=\"T_22866_row2_col3\" class=\"data row2 col3\" \u003e66.324913\u003c/td\u003e\n      \u003ctd id=\"T_22866_row2_col4\" class=\"data row2 col4\" \u003e\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003ehmjd\u003c/th\u003e\n      \u003cth\u003emag\u003c/th\u003e\n      \u003cth\u003emagerr\u003c/th\u003e\n      \u003cth\u003eclrcoeff\u003c/th\u003e\n      \u003cth\u003ecatflags\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e58198.36545\u003c/td\u003e\n      \u003ctd\u003e17.170887\u003c/td\u003e\n      \u003ctd\u003e0.016645\u003c/td\u003e\n      \u003ctd\u003e0.067037\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ci\u003e+129 rows\u003c/i\u003e\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\u003c/td\u003e\n      \u003ctd id=\"T_22866_row2_col5\" class=\"data row2 col5\" \u003e2\u003c/td\u003e\n      \u003ctd id=\"T_22866_row2_col6\" class=\"data row2 col6\" \u003ezr\u003c/td\u003e\n      \u003ctd id=\"T_22866_row2_col7\" class=\"data row2 col7\" \u003e0.960000\u003c/td\u003e\n      \u003ctd id=\"T_22866_row2_col8\" class=\"data row2 col8\" \u003e0.765504\u003c/td\u003e\n      \u003ctd id=\"T_22866_row2_col9\" class=\"data row2 col9\" \u003e17.694681\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n3 rows x 10 columns","content_type":"text/html"}}}],"key":"wgcGPhqqvn"}],"key":"HWsdFP7Uep"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":577,"column":1},"end":{"line":579,"column":1}},"children":[{"type":"text","value":"Now we can finally plot the light curves of these variable galaxy candidates.\nWe need to filter out bad epochs using the ","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"key":"LAG0z2GzDx"},{"type":"inlineCode","value":"catflags","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"key":"niSMTnfQgE"},{"type":"text","value":" column as explained in the ","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"key":"q9kq11zIG5"},{"type":"link","url":"https://irsa.ipac.caltech.edu/data/ZTF/docs/ztf_explanatory_supplement.pdf","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"children":[{"type":"text","value":"ZTF DR23 explanatory supplement","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"key":"S1G2NyddF6"}],"urlSource":"https://irsa.ipac.caltech.edu/data/ZTF/docs/ztf_explanatory_supplement.pdf","key":"vcV9QycyMU"},{"type":"text","value":" section 13.6.\nThen, we will plot the light curves in separate panels for each object:","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"key":"QNtPt8EEQ2"}],"key":"JCblcQ8gby"}],"key":"l0x3fdDWaU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, axs = plt.subplots(len(merged_ztf_lcs_df), 1, figsize=(10, 4 * len(merged_ztf_lcs_df)), constrained_layout=True)\n\nif len(merged_ztf_lcs_df) == 1:\n    axs = [axs]\n\nfor ax, (_, row) in zip(axs, merged_ztf_lcs_df.iterrows()):\n    lc = row['lightcurve'].query(\"catflags == 0\")  # remove bad epochs\n    lc_label = (f'ZTF DR23 Object {row[\"objectid\"]} in band {row[\"filtercode_ztf\"][1]}\\n'\n                f'(z={row[\"phz_phz_median_euclid\"]:.2f}, RMS mag={row[\"magrms_ztf\"]:.3f}, Chi-sq={row[\"chisq_ztf\"]:.3f})')\n    pts = ax.plot(lc['hmjd'], lc['mag'], '.', markersize=4, label=lc_label, zorder=3)\n    ax.errorbar(\n        lc['hmjd'], lc['mag'], yerr=lc['magerr'],\n        fmt='none', ecolor=pts[0].get_color(), elinewidth=0.8, capsize=0, alpha=0.3, zorder=2\n    )\n    ax.set_ylabel('Magnitude')\n    ax.set_xlabel('HMJD')\n    ax.invert_yaxis()\n    ax.set_title(lc_label, fontsize=10)\n\nfig.suptitle(\"Lightcurves of Variable Galaxy Candidates\", fontsize=14, y=1.02)\nfig.set_constrained_layout_pads(h_pad=0.15)\nplt.show()","key":"rwMAFIAV9N"},{"type":"output","id":"D92YMftxRNQVwA117Na7T","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 1000x1200 with 3 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"0632036dbe05fc30d2ba9354579e6278","path":"/irsa-tutorials/build/0632036dbe05fc30d2ba9354579e6278.png"}}}],"key":"K26PwnWfQU"}],"key":"xzPxqHKzIS"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":606,"column":1},"end":{"line":606,"column":1}},"children":[{"type":"text","value":"About this notebook","position":{"start":{"line":606,"column":1},"end":{"line":606,"column":1}},"key":"jTZfGgk3iY"}],"identifier":"about-this-notebook","label":"About this notebook","html_id":"about-this-notebook","implicit":true,"key":"lzKzmLKmuh"},{"type":"paragraph","position":{"start":{"line":608,"column":1},"end":{"line":608,"column":1}},"children":[{"type":"text","value":"Author: Jaladh Singhal, Troy Raen, Jessica Krick, Brigitta Sipőcz, Vandana Desai, and the IRSA Data Science Team","position":{"start":{"line":608,"column":1},"end":{"line":608,"column":1}},"key":"HeBly7NYlP"}],"key":"k5DvVB67qx"},{"type":"paragraph","position":{"start":{"line":610,"column":1},"end":{"line":610,"column":1}},"children":[{"type":"text","value":"Updated: 2025-10-02","position":{"start":{"line":610,"column":1},"end":{"line":610,"column":1}},"key":"TSekE6F5wP"}],"key":"XXWgz3HjHX"},{"type":"paragraph","position":{"start":{"line":612,"column":1},"end":{"line":612,"column":1}},"children":[{"type":"text","value":"Contact: the ","position":{"start":{"line":612,"column":1},"end":{"line":612,"column":1}},"key":"VKlEl1HSAA"},{"type":"link","url":"https://irsa.ipac.caltech.edu/docs/help_desk.html","position":{"start":{"line":612,"column":1},"end":{"line":612,"column":1}},"children":[{"type":"text","value":"IRSA Helpdesk","position":{"start":{"line":612,"column":1},"end":{"line":612,"column":1}},"key":"LK7bZPeqQy"}],"urlSource":"https://irsa.ipac.caltech.edu/docs/help_desk.html","key":"A3ZY7GgOM6"},{"type":"text","value":" with questions or to report problems.","position":{"start":{"line":612,"column":1},"end":{"line":612,"column":1}},"key":"NAreIkiYFo"}],"key":"U5gtjzhfDy"}],"key":"DRC2bj9aF3"}],"key":"Zd1TYPbbnq"},"references":{"cite":{"order":["Coughlin_2021"],"data":{"Coughlin_2021":{"label":"Coughlin_2021","enumerator":"1","doi":"10.1093/mnras/stab1502","html":"Coughlin, M. W., Burdge, K., Duev, D. A., Katz, M. L., van Roestel, J., Drake, A., Graham, M. J., Hillenbrand, L., Mahabal, A. A., Masci, F. J., Mróz, P., Prince, T. A., Yao, Y., Bellm, E. C., Burruss, R., Dekany, R., Jaodand, A., Kaplan, D. L., Kupfer, T., … Zolkower, J. (2021). The ZTF Source Classification Project – II. Periodicity and variability processing metrics. \u003ci\u003eMonthly Notices of the Royal Astronomical Society\u003c/i\u003e, \u003ci\u003e505\u003c/i\u003e(2), 2954–2965. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1093/mnras/stab1502\"\u003e10.1093/mnras/stab1502\u003c/a\u003e","url":"https://doi.org/10.1093/mnras/stab1502"}}}},"footer":{"navigation":{"prev":{"title":"IRSA cloud access introduction","url":"/cloud-access-intro","group":"Special Topics"},"next":{"title":"Using Firefly visualization tools in Python to vet SEDs","url":"/seds-in-firefly","group":"Special Topics"}}},"domain":"http://localhost:3000"},"project":{"subject":"IRSA Tutorials","settings":{"output_matplotlib_strings":"remove"},"title":"IRSA Tutorials","description":"IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)","authors":[{"id":"IRSA Scientists and Developers","name":"IRSA Scientists and Developers"}],"github":"https://github.com/Caltech-IPAC/irsa-tutorials/","keywords":["astronomy"],"thebe":{"binder":{"url":"https://mybinder.org","provider":"github","repo":"https://github.com/Caltech-IPAC/irsa-tutorials/","ref":"HEAD"}},"toc":[{"file":"index.md","title":"IRSA Tutorials"},{"children":[{"file":"tutorials/spherex/spherex_intro.md"},{"file":"tutorials/spherex/spherex_cutouts.md"},{"file":"tutorials/spherex/spherex_psf.md"}],"title":"SPHEREx"},{"children":[{"children":[{"file":"tutorials/euclid_access/Euclid_ERO.md"}],"title":"Euclid Early Release Observations"},{"children":[{"file":"tutorials/euclid_access/1_Euclid_intro_MER_images.md"},{"file":"tutorials/euclid_access/2_Euclid_intro_MER_catalog.md"},{"file":"tutorials/euclid_access/3_Euclid_intro_1D_spectra.md"},{"file":"tutorials/euclid_access/4_Euclid_intro_PHZ_catalog.md"},{"file":"tutorials/euclid_access/5_Euclid_intro_SPE_catalog.md"},{"file":"tutorials/cloud_access/euclid-cloud-access.md"}],"title":"Euclid Quick Release 1"}],"title":"Euclid"},{"children":[{"children":[{"file":"tutorials/irsa-sia-examples/sia_allwise_atlas.md"},{"file":"tutorials/parquet-catalog-demos/wise-allwise-catalog-demo.md"}],"title":"AllWISE"},{"children":[{"file":"tutorials/firefly/NEOWISE_light_curve_demo.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-strategies.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-lightcurves.md"}],"title":"NEOWISE"}],"title":"WISE"},{"children":[{"file":"tutorials/irsa-sia-examples/siav2_seip.md"}],"title":"Spitzer"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_2mass_allsky.md"}],"title":"2MASS"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_cosmos.md"}],"title":"COSMOS"},{"children":[{"children":[{"file":"tutorials/roman_simulations/roman_hlss_number_density.md"}],"title":"Roman HLSS Galaxy Mock Catalog"},{"children":[{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_wideareasurvey.md"},{"file":"tutorials/firefly/OpenUniverse2024Preview_Firefly.md"},{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_timedomainsurvey.md"}],"title":"OpenUniverse 2024"},{"children":[{"file":"tutorials/cosmodc2/cosmoDC2_TAP_access.md"}],"title":"CosmoDC2"}],"title":"Simulated Data"},{"children":[{"file":"tutorials/cloud_access/cloud-access-intro.md"},{"file":"tutorials/parquet-catalog-demos/irsa-hats-with-lsdb.md"},{"file":"tutorials/firefly/SEDs_in_Firefly.md"},{"file":"tutorials/parallelize/Parallelize_Convolution.md"}],"title":"Special Topics"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"SPHEREx"},{"slug":"spherex-intro","title":"Introduction to SPHEREx Spectral Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-cutouts","title":"Download a collection of SPHEREx Spectral Image cutouts as a multi-extension FITS file","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-psf","title":"Understanding and Extracting the PSF Extension in a SPHEREx Cutout","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Euclid"},{"level":2,"title":"Euclid Early Release Observations"},{"slug":"euclid-ero","title":"Exploring Star Clusters in the Euclid ERO Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Euclid Quick Release 1"},{"slug":"euclid-intro-mer-images","title":"Euclid Q1: MER mosaics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-mer-catalog","title":"Euclid Q1: MER catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-1d-spectra","title":"Euclid Q1: 1D spectra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-phz-catalog","title":"Euclid Q1: PHZ catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-spe-catalog","title":"Euclid Q1: SPE catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-cloud-access","title":"Euclid Q1: cloud access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"WISE"},{"level":2,"title":"AllWISE"},{"slug":"sia-allwise-atlas","title":"Searching for AllWISE Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"wise-allwise-catalog-demo","title":"Analyzing cloud-hosted AllWISE Source Catalog in Parquet format","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"NEOWISE"},{"slug":"neowise-light-curve-demo","title":"Using Firefly visualization tools to understand the light curves of Solar System objects","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-strategies","title":"Strategies to Efficiently Work with NEOWISE Single-exposure Source Table in Parquet","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-lightcurves","title":"Make Light Curves from NEOWISE Single-exposure Source Table","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Spitzer"},{"slug":"siav2-seip","title":"Searching for Spitzer Enhanced Imaging Products","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"2MASS"},{"slug":"sia-2mass-allsky","title":"Searching for 2MASS All-Sky Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"COSMOS"},{"slug":"sia-cosmos","title":"Searching for contributed COSMOS images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Simulated Data"},{"level":2,"title":"Roman HLSS Galaxy Mock Catalog"},{"slug":"roman-hlss-number-density","title":"Number Density as a Function of Redshift","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"OpenUniverse 2024"},{"slug":"openuniverse2024-roman-simulated-wideareasurvey","title":"Analyzing cloud-hosted simulated Roman coadded images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024preview-firefly","title":"Using Firefly to Explore OpenUniverse2024 Data Preview Simulated Roman and Rubin Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024-roman-simulated-timedomainsurvey","title":"Analyzing cloud-hosted simulated Roman Time Domain Survey images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"CosmoDC2"},{"slug":"cosmodc2-tap-access","title":"Querying CosmoDC2 Mock v1 catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Special Topics"},{"slug":"cloud-access-intro","title":"IRSA cloud access introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"irsa-hats-with-lsdb","title":"Access HATS Collections Using LSDB: Euclid Q1 and ZTF DR23","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"seds-in-firefly","title":"Using Firefly visualization tools in Python to vet SEDs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"parallelize-convolution","title":"Parallelizing image convolution","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/irsa-tutorials/build/manifest-ED236704.js";
import * as route0 from "/irsa-tutorials/build/root-ZJOPFBMV.js";
import * as route1 from "/irsa-tutorials/build/routes/$-CQPS5IOR.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/irsa-tutorials/build/entry.client-UNPC4GT3.js");</script></body></html>