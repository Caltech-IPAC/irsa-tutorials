<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Exploring Star Clusters in the Euclid ERO Data - IRSA Tutorials</title><meta property="og:title" content="Exploring Star Clusters in the Euclid ERO Data - IRSA Tutorials"/><meta name="generator" content="mystmd"/><meta name="description" content="IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)"/><meta property="og:description" content="IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)"/><meta name="keywords" content="astronomy"/><link rel="stylesheet" href="/irsa-tutorials/build/_assets/app-5WKS5EPQ.css"/><link rel="stylesheet" href="/irsa-tutorials/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/irsa-tutorials/favicon.ico"/><link rel="stylesheet" href="/irsa-tutorials/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/irsa-tutorials/"><div class="p-1 mr-3 dark:bg-white dark:rounded"><img src="/irsa-tutorials/build/irsa_logo-bd755426d9f69813fa092c6774d3180f.png" class="h-9" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="IRSA Tutorials" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/irsa-tutorials/">IRSA Tutorials</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="SPHEREx" class="block break-words rounded py-2 grow cursor-pointer">SPHEREx</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Euclid" class="block break-words rounded py-2 grow cursor-pointer">Euclid</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rup8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rup8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="WISE" class="block break-words rounded py-2 grow cursor-pointer">WISE</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R16p8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R16p8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Spitzer" class="block break-words rounded py-2 grow cursor-pointer">Spitzer</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1ep8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1ep8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="2MASS" class="block break-words rounded py-2 grow cursor-pointer">2MASS</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1mp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1mp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="COSMOS" class="block break-words rounded py-2 grow cursor-pointer">COSMOS</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1up8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1up8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Simulated Data" class="block break-words rounded py-2 grow cursor-pointer">Simulated Data</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R26p8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R26p8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Special Topics" class="block break-words rounded py-2 grow cursor-pointer">Special Topics</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R2ep8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R2ep8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-none pr-2 smallcaps">IRSA Tutorials</div><div class="flex-grow"></div><a href="https://github.com/Caltech-IPAC/irsa-tutorials/" title="GitHub Repository: Caltech-IPAC/irsa-tutorials/" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><a href="https://github.com/Caltech-IPAC/irsa-tutorials//edit/main/tutorials/euclid_access/Euclid_ERO.md" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div><button class="inline-flex size-[24px] hover:text-[#E18435] items-center justify-center" aria-label="Launch in external computing interface" title="Launch in external computing interface" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Re8top:" data-state="closed"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.85357 3.85355L7.65355 3.05353C8.2981 2.40901 9.42858 1.96172 10.552 1.80125C11.1056 1.72217 11.6291 1.71725 12.0564 1.78124C12.4987 1.84748 12.7698 1.97696 12.8965 2.10357C13.0231 2.23018 13.1526 2.50125 13.2188 2.94357C13.2828 3.37086 13.2779 3.89439 13.1988 4.44801C13.0383 5.57139 12.591 6.70188 11.9464 7.34645L7.49999 11.7929L6.35354 10.6465C6.15827 10.4512 5.84169 10.4512 5.64643 10.6465C5.45117 10.8417 5.45117 11.1583 5.64643 11.3536L7.14644 12.8536C7.34171 13.0488 7.65829 13.0488 7.85355 12.8536L8.40073 12.3064L9.57124 14.2572C9.65046 14.3893 9.78608 14.4774 9.9389 14.4963C10.0917 14.5151 10.2447 14.4624 10.3535 14.3536L12.3535 12.3536C12.4648 12.2423 12.5172 12.0851 12.495 11.9293L12.0303 8.67679L12.6536 8.05355C13.509 7.19808 14.0117 5.82855 14.1887 4.58943C14.2784 3.9618 14.2891 3.33847 14.2078 2.79546C14.1287 2.26748 13.9519 1.74482 13.6035 1.39645C13.2552 1.04809 12.7325 0.871332 12.2045 0.792264C11.6615 0.710945 11.0382 0.721644 10.4105 0.8113C9.17143 0.988306 7.80189 1.491 6.94644 2.34642L6.32322 2.96968L3.07071 2.50504C2.91492 2.48278 2.75773 2.53517 2.64645 2.64646L0.646451 4.64645C0.537579 4.75533 0.484938 4.90829 0.50375 5.0611C0.522563 5.21391 0.61073 5.34954 0.742757 5.42876L2.69364 6.59928L2.14646 7.14645C2.0527 7.24022 2.00002 7.3674 2.00002 7.50001C2.00002 7.63261 2.0527 7.75979 2.14646 7.85356L3.64647 9.35356C3.84173 9.54883 4.15831 9.54883 4.35357 9.35356C4.54884 9.1583 4.54884 8.84172 4.35357 8.64646L3.20712 7.50001L3.85357 6.85356L6.85357 3.85355ZM10.0993 13.1936L9.12959 11.5775L11.1464 9.56067L11.4697 11.8232L10.0993 13.1936ZM3.42251 5.87041L5.43935 3.85356L3.17678 3.53034L1.80638 4.90074L3.42251 5.87041ZM2.35356 10.3535C2.54882 10.1583 2.54882 9.8417 2.35356 9.64644C2.1583 9.45118 1.84171 9.45118 1.64645 9.64644L0.646451 10.6464C0.451188 10.8417 0.451188 11.1583 0.646451 11.3535C0.841713 11.5488 1.1583 11.5488 1.35356 11.3535L2.35356 10.3535ZM3.85358 11.8536C4.04884 11.6583 4.04885 11.3417 3.85359 11.1465C3.65833 10.9512 3.34175 10.9512 3.14648 11.1465L1.14645 13.1464C0.95119 13.3417 0.951187 13.6583 1.14645 13.8535C1.34171 14.0488 1.65829 14.0488 1.85355 13.8536L3.85358 11.8536ZM5.35356 13.3535C5.54882 13.1583 5.54882 12.8417 5.35356 12.6464C5.1583 12.4512 4.84171 12.4512 4.64645 12.6464L3.64645 13.6464C3.45119 13.8417 3.45119 14.1583 3.64645 14.3535C3.84171 14.5488 4.1583 14.5488 4.35356 14.3535L5.35356 13.3535ZM9.49997 6.74881C10.1897 6.74881 10.7488 6.1897 10.7488 5.5C10.7488 4.8103 10.1897 4.25118 9.49997 4.25118C8.81026 4.25118 8.25115 4.8103 8.25115 5.5C8.25115 6.1897 8.81026 6.74881 9.49997 6.74881Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button></div><h1 class="mb-0">Exploring Star Clusters in the Euclid ERO Data</h1><header class="mt-4 not-prose"><div><span class="font-semibold text-sm inline-block"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78top:" data-state="closed">IRSA Scientists and Developers</button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div class="sticky top-[60px] pb-[14px] flex justify-end w-full z-20 pointer-events-none"><div class="flex p-1 m-1 space-x-1 border rounded-full shadow pointer-events-auto border-stone-300 bg-white/80 dark:bg-stone-900/80 backdrop-blur"><div class="rounded"><button class="flex text-center rounded-full cursor-pointer text-stone-800 dark:text-white hover:opacity-100 opacity-60" aria-label="start compute environment"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="inline-block w-6 h-6 align-top"><title>Launch kernel</title><path stroke-linecap="round" stroke-linejoin="round" d="M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"></path></svg></button></div></div></div><div id="skip-to-article"></div><h2 id="learning-goals" class="relative group"><span class="heading-text">Learning Goals</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#learning-goals" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>By the end of this tutorial, you will be able to:</p><p>• Access the Euclid ERO images using <code>astroquery</code></p><p>• Create cutouts on the large Euclid ERO images directly</p><p>• Extract sources on the Euclid image and run photometry tools</p><p>• Compare photometry to the Gaia catalog</p><p>• Visualize the Euclid ERO image and the Gaia catalog in <code>Firefly</code></p><h2 id="introduction" class="relative group"><span class="heading-text">Introduction</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#introduction" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Euclid is a European Space Agency (ESA) space mission with NASA participation, to study the geometry and nature of the dark Universe. As part of its first observations, Euclid publicly released so-called <em>Early Release Observations</em> (ERO) targeting some press-worthy targets on the sky such as star clusters or local galaxies.</p><p>In this notebook, we will focus on the ERO data of <strong>NGC 6397</strong>, a globular cluster 78,000 light years away. (Note that there is another globular cluster, <strong>NGC 6254</strong> that can also be used for this analysis - in fact the user can choose which one to use) The goal of this analysis is to extract the Euclid photometry of the stars belonging to the cluster and compare them to the photometry of Gaia. Due to the different pixel scales of the visible (VIS, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.</mn><msup><mn>1</mn><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup></mrow><annotation encoding="application/x-tex">0.1^{\prime\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord">0.</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span></span></span></span></span>) and near-IR (NISP, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.</mn><msup><mn>3</mn><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup></mrow><annotation encoding="application/x-tex">0.3^{\prime\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord">0.</span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span></span></span></span></span>) wavelengths, we will first detect and extract the stars in the VIS filter and use their position to subsequently extract the photometry in the NISP (Y, J, H) filters (a method also referred to as <em>forced photometry</em>).</p><p>One challenge with Euclid data is their size due to the large sky coverage and small pixel size.
This notebook demonstrates how to download only a cutout of the large Euclid ERO observation image (namely focussing only on the position of the globular cluster. Furthermore, this notebook demonstrates how to extract sources on a large astronomical image and how to measure their photometry across different pixel scales using a very simple implementation of the forced photometry method with positional priors.
Finally, we also demonstrate how to visualize the Euclid images and catalog in <code>Firefly</code>, an open-source web-based UI library for astronomical data archive access and visualization developed at Caltech (<a target="_blank" rel="noreferrer" href="https://github.com/Caltech-IPAC/firefly" class="">https://<wbr/>github<wbr/>.com<wbr/>/Caltech<wbr/>-IPAC<wbr/>/firefly</a>). <code>Firefly</code> is a convenient tool to visualize images similar to DS9 on your local computer, but it can run on a cloud-based science platform.</p><p>This notebook is written to be used in Fornax which is a cloud based computing platform using AWS. The advantage of this is that the user does not need to download actuall data, hence the analysis of large datasets is not limited by local computing resources. It also allows to access data across all archives fast and easy.</p><h2 id="data-volume" class="relative group"><span class="heading-text">Data Volume</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#data-volume" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The total data volume required for running this notebook is less than 20 MB.</p><h2 id="imports" class="relative group"><span class="heading-text">Imports</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#imports" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><aside class="myst-admonition myst-admonition-important my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path fill-rule="evenodd" d="M14.615 1.595a.75.75 0 0 1 .359.852L12.982 9.75h7.268a.75.75 0 0 1 .548 1.262l-10.5 11.25a.75.75 0 0 1-1.272-.71l1.992-7.302H3.75a.75.75 0 0 1-.548-1.262l10.5-11.25a.75.75 0 0 1 .913-.143Z" clip-rule="evenodd"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Important</div></div><div class="myst-admonition-body px-4 py-1"><p>We rely on <code>astroquery</code>, <code>firefly_client</code>, <code>photutils</code>, and <code>sep</code> features that have been recently added, so please make sure you have the respective versions v0.4.10, v3.2, v2.0, and v1.4 or newer installed.</p></div></aside><div id="h7jbUFk8ba" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Uncomment the next line to install dependencies if needed.
# !pip install tqdm numpy matplotlib astropy &#x27;photutils&gt;=2.0&#x27; &#x27;astroquery&gt;=0.4.10&#x27; &#x27;sep&gt;=1.4&#x27; &#x27;firefly_client&gt;=3.2&#x27;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="81e0g2_w5qbJRbv7BsQ3C" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>First, we import all necessary packages.</p><div id="uJ9HdJtmAi" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># General imports
import os
import numpy as np
from tqdm import tqdm

# Astroquery
from astroquery.ipac.irsa import Irsa
from astroquery.gaia import Gaia

# Astropy
from astropy.coordinates import SkyCoord
from astropy import units as u
from astropy.io import fits
from astropy.nddata import Cutout2D
from astropy.wcs import WCS
from astropy.table import Table
from astropy.stats import sigma_clipped_stats

# Photometry tools
import sep
from photutils.detection import DAOStarFinder
from photutils.psf import PSFPhotometry, IterativePSFPhotometry, CircularGaussianSigmaPRF, make_psf_model_image
from photutils.background import LocalBackground, MMMBackground

# Firefly
from firefly_client import FireflyClient

# Matplotlib
import matplotlib.pyplot as plt
import matplotlib as mpl</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="GsFTXZ0ObROcrc4Y0J_D7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>/home/runner/work/irsa-tutorials/irsa-tutorials/.tox/py312-buildhtml/lib/python3.12/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html
  from .autonotebook import tqdm as notebook_tqdm
</span></code></pre></div></div></div><p>Next, we define some parameters for <code>Matplotlib</code> plotting.</p><div id="miNiAtLNQr" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">## Plotting stuff
mpl.rcParams[&#x27;font.size&#x27;] = 14
mpl.rcParams[&#x27;axes.labelpad&#x27;] = 7
mpl.rcParams[&#x27;xtick.major.pad&#x27;] = 7
mpl.rcParams[&#x27;ytick.major.pad&#x27;] = 7
mpl.rcParams[&#x27;xtick.minor.visible&#x27;] = True
mpl.rcParams[&#x27;ytick.minor.visible&#x27;] = True
mpl.rcParams[&#x27;xtick.minor.top&#x27;] = True
mpl.rcParams[&#x27;xtick.minor.bottom&#x27;] = True
mpl.rcParams[&#x27;ytick.minor.left&#x27;] = True
mpl.rcParams[&#x27;ytick.minor.right&#x27;] = True
mpl.rcParams[&#x27;xtick.major.size&#x27;] = 5
mpl.rcParams[&#x27;ytick.major.size&#x27;] = 5
mpl.rcParams[&#x27;xtick.minor.size&#x27;] = 3
mpl.rcParams[&#x27;ytick.minor.size&#x27;] = 3
mpl.rcParams[&#x27;xtick.direction&#x27;] = &#x27;in&#x27;
mpl.rcParams[&#x27;ytick.direction&#x27;] = &#x27;in&#x27;
#mpl.rc(&#x27;text&#x27;, usetex=True)
mpl.rc(&#x27;font&#x27;, family=&#x27;serif&#x27;)
mpl.rcParams[&#x27;xtick.top&#x27;] = True
mpl.rcParams[&#x27;ytick.right&#x27;] = True
mpl.rcParams[&#x27;hatch.linewidth&#x27;] = 1

def_cols = plt.rcParams[&#x27;axes.prop_cycle&#x27;].by_key()[&#x27;color&#x27;]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="bTR-jUXiX8kPhAodbsCms" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="setting-up-the-environment" class="relative group"><span class="heading-text">Setting up the Environment</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#setting-up-the-environment" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Next, we set up the environment. This includes</p><ul><li><p>setting up an output data directory (will be created if it does not exist)</p></li><li><p>define the search radius around the target of interest to pull data from the Gaia catalog</p></li><li><p>define the cutout size that will be used to download a certain part of the Euclid ERO images</p></li></ul><p>Finally, we also define the target of interest here. We can choose between two globular clusters, <strong>NGC 6254</strong> and <strong>NGC6397</strong>, both covered by the Euclid ERO data.</p><p>Note that <code>astropy</code> units can be attached to the <code>search_radius</code> and <code>cutout_size</code>.</p><div id="TT1hWM4Ieu" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># create output directory
if os.path.exists(&quot;./data/&quot;):
    print(&quot;Output directory already created.&quot;)
else:
    print(&quot;Creating data directory.&quot;)
    os.mkdir(&quot;./data/&quot;)

search_radius = 1.5 * u.arcmin # search radius
cutout_size = 1.5 * u.arcmin # cutout size

coord = SkyCoord.from_name(&#x27;NGC 6397&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="-KF-3Wp9B7o1VnmuA00Kb" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Creating data directory.
</span></code></pre></div></div></div><h2 id="search-euclid-ero-images" class="relative group"><span class="heading-text">Search Euclid ERO Images</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#search-euclid-ero-images" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Now, we search for the Euclid ERO images using the <code>astroquery</code> package.
Note that the Euclid ERO images are no in the cloud currently, but we access them directly from IRSA using IRSA’s <em>Simple Image Access</em> (SIA) methods.</p><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Note</div></div><div class="myst-admonition-body px-4 py-1"><p>The following only works for combined images (either extended or point source stacks). This would not work if there are multiple, let’s say, H-band images of Euclid at a given position. Therefore, no time domain studies here (which is anyway not one of the main goals of Euclid).</p></div></aside><p>Here we use the collection <em>euclid_ero</em>, containing the Euclid ERO images. We first create a <code>SkyCoord</code> object and then query the SIA.</p><div id="zJpXeIhK1Z" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">image_tab = Irsa.query_sia(pos=(coord, search_radius), collection=&#x27;euclid_ero&#x27;)
print(&quot;Number of images available: {}&quot;.format(len(image_tab)))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="0XP8r4F37lj1ITIwLcJxX" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Number of images available: 25
</span></code></pre></div></div></div><p>Sort the queried table by wavelength (column <code>em_min</code>). This allows us later when we plot the images to keep them sorted by wavelength (VIS, Y, J, H).</p><div id="soI1p7BdA7" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">image_tab.sort(&#x27;em_min&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Zp8Jb46GSh0aLw-E9chJu" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Let’s inspec the table that was downloaded.</p><div id="h4mxrkG7mx" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">image_tab[0:3]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="hCi70RXvS7rGTeCcUE6BM" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Next, we add additional restrictions to narrow down the images.</p><p>The Euclid ERO images come in two different flavors:</p><ul><li><p><em>Flattened</em> images: idealized for compact sources (for example stars)</p></li><li><p><em>LSB</em> images: idealized for low surface brightness objects (for example galaxies)</p></li></ul><p>Maybe counter-intuitively, we select the <em>LSB</em> images here by checking if the file name given in the URL (<code>access_url</code> column) contains that key word. We found that the <em>Flattened</em> images contain many masked pixels.</p><div id="ibmlMxPyZJ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#sel_basic = np.where( [&quot;Flattened&quot; in tt[&quot;access_url&quot;] for tt in image_tab] )[0]
sel_basic = np.where( [&quot;LSB&quot; in tt[&quot;access_url&quot;] for tt in image_tab] )[0]
image_tab = image_tab[sel_basic]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="OvYaMegG8t5FVqQIf0D1N" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Next, we want to check what filteres are available. This can be done by <code>np.unique()</code>, however, in that case it would sort the filters alphabetically. We want to keep the sorting based on the wavelength, therefore we opt for a more complicated way.</p><div id="inUFkn5HpL" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">idxs = np.unique(image_tab[&quot;energy_bandpassname&quot;], return_index=True)[1]
filters = [image_tab[&quot;energy_bandpassname&quot;][idx] for idx in sorted(idxs)]
print(&quot;Filters: {}&quot;.format(filters))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="OL9QTJNa1eFJERMDBpUQa" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Filters: [&#x27;VIS&#x27;, &#x27;Y&#x27;, &#x27;J&#x27;, &#x27;H&#x27;]
</span></code></pre></div></div></div><p>We can now loop throught the filters and collect the images to create a handy summary table with all the data we have. This way we will have an easier time to later access the data.</p><div id="Dh07421LVw" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create a dictionary with all the necessary information (science, weight, noise, mask)
summary_table = Table(names=[&quot;filter&quot;,&quot;products&quot;,&quot;facility_name&quot;,&quot;instrument_name&quot;] , dtype=[str,str,str,str])
for filt in filters:
    sel = np.where(image_tab[&#x27;energy_bandpassname&#x27;] == filt)[0]
    products = list( np.unique(image_tab[&quot;dataproduct_subtype&quot;][sel].value) )
    if &quot;science&quot; in products: # sort so that science is the first in the list. This is the order we create the hdu extensions
        products.remove(&quot;science&quot;)
        products.insert(0,&quot;science&quot;)
    else:
        print(&quot;WARNING: no science image found!&quot;)
    print(products)

    summary_table.add_row( [filt , &quot;;&quot;.join(products), str(np.unique(image_tab[&quot;facility_name&quot;][sel].value)[0]), str(np.unique(image_tab[&quot;instrument_name&quot;][sel].value)[0])] )</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="XH06FABQ2gOanVJ4GbK7V" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>[&#x27;science&#x27;, &#x27;auxiliary&#x27;]
[&#x27;science&#x27;, &#x27;auxiliary&#x27;]
[&#x27;science&#x27;, &#x27;auxiliary&#x27;]
[&#x27;science&#x27;, &#x27;auxiliary&#x27;]
</span></code></pre></div></div></div><p>Let’s check out the summary table that we have created. We see that we have all the 4 Euclid bands and what data products are available for each of them.</p><div id="nOECUknzIh" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">summary_table</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="IKiW_HVJ4otaqMmqMXMW9" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><h2 id="create-cutout-images" class="relative group"><span class="heading-text">Create Cutout Images</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#create-cutout-images" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Now that we have a list of data products, we can create the cutouts. This is important as the full Euclid ERO images would be too large to run extraction and photometry software on them (they would simply fail due to memory issues).</p><p>For each image, we create a cutout around the target of interest, using the <code>cutout_size</code> defined above. The cutouts are then collected into HDUs. That way we can easily access the different data products. Note that we only use the <em>science</em> products as the <em>ancillary</em> products are not needed.</p><p>We save the HDU to disk as it will be later used when we visualize the Euclid ERO FITS images in <code>Firefly</code>.</p><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Note</div></div><div class="myst-admonition-body px-4 py-1"><p>You will notice that <code>Cutout2D</code> can be applied to an URL. That way, it we do not need to download the full image to create a cutout. This is a useful trick to keep in mind when analyzing large images. This makes creating cutout images very fast.</p></div></aside><div id="LEQt1q5Xoe" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%%time
for ii,filt in tqdm(enumerate(filters)):
    products = summary_table[summary_table[&quot;filter&quot;] == filt][&quot;products&quot;][0].split(&quot;;&quot;)

    for product in products:
        sel = np.where( (image_tab[&quot;energy_bandpassname&quot;] == filt) &amp; (image_tab[&quot;dataproduct_subtype&quot;] == product) )[0]

        with fits.open(image_tab[&#x27;access_url&#x27;][sel[0]], use_fsspec=True) as hdul:
            tmp = Cutout2D(hdul[0].section, position=coord, size=cutout_size, wcs=WCS(hdul[0].header)) # create cutout


            if (product == &quot;science&quot;) &amp; (ii == 0): # if science image, then create a new hdu.
                hdu0 = fits.PrimaryHDU(data = tmp.data, header=hdul[0].header)
                hdu0.header.update(tmp.wcs.to_header()) # update header with WCS info
                hdu0.header[&quot;EXTNAME&quot;] = &quot;{}_{}&quot;.format(filt,product.upper())
                hdu0.header[&quot;PRODUCT&quot;] = product.upper()
                hdu0.header[&quot;FILTER&quot;] = filt.upper()
                hdulcutout = fits.HDUList([hdu0])
            elif (product == &quot;science&quot;) &amp; (ii &gt; 0):
                hdu = fits.ImageHDU(data = tmp.data, header=hdul[0].header)
                hdu.header.update(tmp.wcs.to_header()) # update header with WCS info
                hdu.header[&quot;EXTNAME&quot;] = &quot;{}_{}&quot;.format(filt,product.upper())
                hdu.header[&quot;PRODUCT&quot;] = product.upper()
                hdu.header[&quot;FILTER&quot;] = filt.upper()
                hdulcutout.append(hdu)

## Save the HDUL cube:
hdulcutout.writeto(&quot;./data/euclid_images_test.fits&quot;, overwrite=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="oQDCX5GsZHkgB7_G5hqI_" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>0it [00:00, ?it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>1it [00:17, 17.56s/it]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>2it [00:19,  8.38s/it]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>3it [00:22,  5.85s/it]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>4it [00:24,  4.25s/it]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>4it [00:24,  6.04s/it]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>CPU times: user 1.68 s, sys: 454 ms, total: 2.14 s
Wall time: 24.3 s
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>
</span></code></pre></div></div></div><p>Let’s look at the HDU that we created to check what information we have. You see that all filters are collected in different extensions. Also note the different dimensions of the FITS layers as the pixel scale of VIS and NISP are different.</p><div id="PbuH4X40on" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">hdulcutout.info()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="WPKKKx0Cj98hu2oVfNa0B" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Filename: (No file associated with this HDUList)
No.    Name      Ver    Type      Cards   Dimensions   Format
  0  VIS_SCIENCE    1 PrimaryHDU     190   (900, 900)   float32   
  1  Y_SCIENCE     1 ImageHDU       191   (300, 300)   float32   
  2  J_SCIENCE     1 ImageHDU       191   (300, 300)   float32   
  3  H_SCIENCE     1 ImageHDU       191   (300, 300)   float32   
</span></code></pre></div></div></div><p>We can now plot the image cutouts that we generated. The globular cluster is clearly visible.</p><div id="Cc2wmCizMZ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">nimages = len(filters) # number of images
ncols = int(4) # number of columns
nrows = int( nimages // ncols ) # number of rows

fig = plt.figure(figsize = (5*ncols,5*nrows) )
axs = [fig.add_subplot(nrows,ncols,ii+1) for ii in range(nimages)]

for ii,filt in enumerate(filters):
    img = hdulcutout[&quot;{}_SCIENCE&quot;.format(filt)].data
    axs[ii].imshow(img , origin=&quot;lower&quot;)
    axs[ii].text(0.05,0.05 , &quot;{} ({}/{})&quot;.format(summary_table[&quot;facility_name&quot;][ii],summary_table[&quot;instrument_name&quot;][ii],filt) , fontsize=14 , color=&quot;white&quot;,
                 va=&quot;bottom&quot;, ha=&quot;left&quot; , transform=axs[ii].transAxes)

plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="pRsSYaZdG6N91zVRzGI0l" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/irsa-tutorials/build/8a9efd35bd69fb89255c3f362485d5f6.png" alt="&lt;Figure size 2000x500 with 4 Axes&gt;"/></div></div><h2 id="extract-sources-and-measure-their-photometry-on-the-vis-image" class="relative group"><span class="heading-text">Extract Sources and Measure their Photometry on the VIS Image</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#extract-sources-and-measure-their-photometry-on-the-vis-image" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Now that we have the images in memory (and on disk - but we do not need them, yet), we can measure the fluxes of the individual stars.
Our simple photometry pipeline has different parts:</p><ul><li><p>First, we are using the Python package <code>sep</code> (similar to SExtractor) to extract the position of the sources. We do that on the VIS image, which provides the highest resolution.</p></li><li><p>Second, we use <code>sep</code> to perform aperture measurements of the photometry. We will use that to compare the obtained fluxes to our forced photometry method</p></li><li><p>Third, we apply a PSF fitting technique (using the <code>photutils</code> Python package) to improve the photometry measurement</p></li></ul><p>We start by extracting the sources using <code>sep</code>. We first isolate the data that we want to look at (the VIS image only).</p><div id="goSommZPbn" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">## Get Data (this will be replaced later)
img = hdulcutout[&quot;VIS_SCIENCE&quot;].data
hdr = hdulcutout[&quot;VIS_SCIENCE&quot;].header
img[img == 0] = np.nan</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="K1_qsrcuIrHmCNP7kYLX5" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>There are some NaN value on the image that we need to mask out. For this we create a mask image that we later feed to <code>sep</code>.</p><div id="UAZYMbOALD" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">mask = np.isnan(img)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="dbyTElOggkBPJqJOAQB9s" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Next, we compute the background statistics what will be used by <code>sep</code> to extract the sources above a certain threshold.</p><div id="B4KCVpOLhf" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">mean, median, std = sigma_clipped_stats(img, sigma=3.0)
print(np.array((mean, median, std)))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5vp9NLiCeR0nvoFkqAg90" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>[135.95871  99.62191 100.63356]
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>WARNING: Input data contains invalid values (NaNs or infs), which were automatically clipped. [astropy.stats.sigma_clipping]
</span></code></pre></div></div></div><p>Finally, we perform object detection with <code>sep</code>. There are also modules in <code>photutils</code> to do that, however, we found that <code>sep</code> works best here. We output the number of objects found on the image.</p><div id="RbVg1uRyqG" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">objects = sep.extract(img-median, thresh=1.2, err=std, minarea=3, mask=mask, deblend_cont=0.0002, deblend_nthresh=64 )
print(&quot;Number of sources extracted: &quot;, len(objects))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Z59FHTzh8OJsQbdbd4FRl" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Number of sources extracted:  2759
</span></code></pre></div></div></div><p>Next, we perform simple aperture photometry on the detected sources. Again, we use the <code>sep</code> package for this. We will use these aperture photometry later to compare to the PSF photometry.</p><div id="JJjE8gzVbY" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">flux, fluxerr, flag = sep.sum_circle(img-median, objects[&#x27;x&#x27;], objects[&#x27;y&#x27;],r=3.0, err=std, gain=1.0)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="RjXaldFRtXapvjvxLWtoQ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Now, we use the <code>photutils</code> Python package to perform PSF fitting. Here we assume a simple Gaussian with a FWHM given by <code>psf_fwhm</code> as PSF.</p><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Note</div></div><div class="myst-admonition-body px-4 py-1"><p>We use a Gaussian PSF here for simplicity. The photometry can be improved by using a pixelated PSF measured directly from the Euclid images (for example by stacking stars).</p></div></aside><div id="HEO74QcDMe" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">psf_fwhm = 0.16 # PSF FWHM in arcsec
pixscale = 0.1 # VIS pixel scale in arcsec/px

init_params = Table([objects[&quot;x&quot;],objects[&quot;y&quot;]] , names=[&quot;x&quot;,&quot;y&quot;]) # initial positions
psf_model = CircularGaussianSigmaPRF(flux=1, sigma=psf_fwhm/pixscale / 2.35)
psf_model.x_0.fixed = True
psf_model.y_0.fixed = True
psf_model.sigma.fixed = False
fit_shape = (5, 5)
psfphot = PSFPhotometry(psf_model,
                        fit_shape,
                        finder = DAOStarFinder(fwhm=0.1, threshold=3.*std, exclude_border=True), # not needed because we are using fixed initial positions.
                        aperture_radius = 4,
                        progress_bar = True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="xPAsZhF6z9N5xgpghIrbU" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>After initiating the <code>PSFPhotometry</code> object, we can run the PSF photometry measurement. This can take a while (typically between 1 and 2 minutes).</p><div id="TZIAXELnOK" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">phot = psfphot(img-median, error=None, mask=mask, init_params=init_params)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="BsevhKRdVaRLy54cJFTTb" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   0%|          | 0/2759 [00:00&lt;?, ?it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   0%|          | 11/2759 [00:00&lt;00:25, 106.36it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   1%|          | 26/2759 [00:00&lt;00:21, 126.46it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   1%|▏         | 39/2759 [00:00&lt;00:21, 125.93it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   2%|▏         | 54/2759 [00:00&lt;00:20, 131.59it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   3%|▎         | 70/2759 [00:00&lt;00:19, 140.92it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   3%|▎         | 85/2759 [00:00&lt;00:20, 128.03it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   4%|▎         | 101/2759 [00:00&lt;00:19, 136.06it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   4%|▍         | 117/2759 [00:00&lt;00:18, 141.60it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   5%|▍         | 132/2759 [00:00&lt;00:18, 142.94it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   5%|▌         | 147/2759 [00:01&lt;00:18, 142.86it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   6%|▌         | 162/2759 [00:01&lt;00:18, 140.01it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   6%|▋         | 177/2759 [00:01&lt;00:18, 139.05it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   7%|▋         | 192/2759 [00:01&lt;00:18, 139.94it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   8%|▊         | 207/2759 [00:01&lt;00:18, 141.44it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   8%|▊         | 222/2759 [00:01&lt;00:17, 141.94it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   9%|▊         | 237/2759 [00:01&lt;00:17, 143.26it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   9%|▉         | 253/2759 [00:01&lt;00:17, 145.35it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  10%|▉         | 268/2759 [00:01&lt;00:17, 142.24it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  10%|█         | 283/2759 [00:02&lt;00:17, 141.30it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  11%|█         | 298/2759 [00:02&lt;00:17, 140.54it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  11%|█▏        | 314/2759 [00:02&lt;00:16, 144.40it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  12%|█▏        | 329/2759 [00:02&lt;00:16, 144.19it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  13%|█▎        | 346/2759 [00:02&lt;00:16, 148.43it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  13%|█▎        | 363/2759 [00:02&lt;00:15, 153.29it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  14%|█▎        | 379/2759 [00:02&lt;00:17, 133.13it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  14%|█▍        | 394/2759 [00:02&lt;00:17, 134.66it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  15%|█▍        | 411/2759 [00:02&lt;00:16, 142.87it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  16%|█▌        | 428/2759 [00:03&lt;00:15, 148.79it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  16%|█▌        | 445/2759 [00:03&lt;00:15, 153.73it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  17%|█▋        | 462/2759 [00:03&lt;00:14, 156.64it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  17%|█▋        | 479/2759 [00:03&lt;00:14, 158.20it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  18%|█▊        | 495/2759 [00:03&lt;00:14, 157.62it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  19%|█▊        | 513/2759 [00:03&lt;00:13, 161.95it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  19%|█▉        | 530/2759 [00:03&lt;00:14, 158.29it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  20%|█▉        | 546/2759 [00:03&lt;00:14, 156.64it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  20%|██        | 562/2759 [00:03&lt;00:13, 156.95it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  21%|██        | 578/2759 [00:03&lt;00:13, 157.71it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  22%|██▏       | 596/2759 [00:04&lt;00:13, 162.87it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  22%|██▏       | 613/2759 [00:04&lt;00:14, 153.15it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  23%|██▎       | 629/2759 [00:04&lt;00:14, 148.92it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  23%|██▎       | 645/2759 [00:04&lt;00:14, 150.79it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  24%|██▍       | 663/2759 [00:04&lt;00:13, 157.53it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  25%|██▍       | 679/2759 [00:04&lt;00:14, 143.19it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  25%|██▌       | 695/2759 [00:04&lt;00:14, 145.93it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  26%|██▌       | 711/2759 [00:04&lt;00:13, 148.58it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  26%|██▋       | 727/2759 [00:04&lt;00:13, 148.31it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  27%|██▋       | 742/2759 [00:05&lt;00:13, 148.12it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  27%|██▋       | 757/2759 [00:05&lt;00:13, 146.87it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  28%|██▊       | 772/2759 [00:05&lt;00:14, 141.90it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  29%|██▊       | 789/2759 [00:05&lt;00:13, 149.73it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  29%|██▉       | 806/2759 [00:05&lt;00:12, 154.62it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  30%|██▉       | 822/2759 [00:05&lt;00:12, 153.10it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  30%|███       | 838/2759 [00:05&lt;00:12, 153.79it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  31%|███       | 855/2759 [00:05&lt;00:12, 156.72it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  32%|███▏      | 873/2759 [00:05&lt;00:11, 161.33it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  32%|███▏      | 891/2759 [00:06&lt;00:11, 164.30it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  33%|███▎      | 908/2759 [00:06&lt;00:11, 161.41it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  34%|███▎      | 925/2759 [00:06&lt;00:11, 163.05it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  34%|███▍      | 942/2759 [00:06&lt;00:11, 158.65it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  35%|███▍      | 958/2759 [00:06&lt;00:13, 138.30it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  35%|███▌      | 976/2759 [00:06&lt;00:12, 148.28it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  36%|███▌      | 992/2759 [00:06&lt;00:11, 148.34it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  37%|███▋      | 1008/2759 [00:06&lt;00:11, 146.27it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  37%|███▋      | 1025/2759 [00:06&lt;00:11, 149.17it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  38%|███▊      | 1042/2759 [00:07&lt;00:11, 154.79it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  38%|███▊      | 1058/2759 [00:07&lt;00:10, 154.76it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  39%|███▉      | 1076/2759 [00:07&lt;00:10, 161.29it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  40%|███▉      | 1094/2759 [00:07&lt;00:10, 166.33it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  40%|████      | 1112/2759 [00:07&lt;00:09, 169.86it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  41%|████      | 1130/2759 [00:07&lt;00:09, 172.10it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  42%|████▏     | 1148/2759 [00:07&lt;00:09, 171.68it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  42%|████▏     | 1166/2759 [00:07&lt;00:09, 173.62it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  43%|████▎     | 1184/2759 [00:07&lt;00:09, 173.78it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  44%|████▎     | 1202/2759 [00:07&lt;00:09, 167.14it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  44%|████▍     | 1219/2759 [00:08&lt;00:09, 164.65it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  45%|████▍     | 1236/2759 [00:08&lt;00:09, 162.56it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  45%|████▌     | 1254/2759 [00:08&lt;00:09, 166.28it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  46%|████▌     | 1272/2759 [00:08&lt;00:08, 167.98it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  47%|████▋     | 1289/2759 [00:08&lt;00:08, 165.65it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  47%|████▋     | 1306/2759 [00:08&lt;00:08, 165.36it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  48%|████▊     | 1323/2759 [00:08&lt;00:08, 160.15it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  49%|████▊     | 1340/2759 [00:08&lt;00:08, 158.44it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  49%|████▉     | 1356/2759 [00:08&lt;00:09, 154.30it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  50%|████▉     | 1372/2759 [00:09&lt;00:09, 152.32it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  50%|█████     | 1388/2759 [00:09&lt;00:09, 142.58it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  51%|█████     | 1403/2759 [00:09&lt;00:09, 137.88it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  51%|█████▏    | 1417/2759 [00:09&lt;00:10, 132.36it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  52%|█████▏    | 1435/2759 [00:09&lt;00:09, 143.24it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  53%|█████▎    | 1455/2759 [00:09&lt;00:08, 156.97it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  53%|█████▎    | 1474/2759 [00:09&lt;00:07, 163.43it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  54%|█████▍    | 1491/2759 [00:09&lt;00:07, 162.79it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  55%|█████▍    | 1508/2759 [00:09&lt;00:07, 162.69it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  55%|█████▌    | 1525/2759 [00:10&lt;00:08, 143.58it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  56%|█████▌    | 1544/2759 [00:10&lt;00:07, 154.42it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  57%|█████▋    | 1563/2759 [00:10&lt;00:07, 161.81it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  57%|█████▋    | 1580/2759 [00:10&lt;00:07, 162.43it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  58%|█████▊    | 1598/2759 [00:10&lt;00:06, 165.94it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  59%|█████▊    | 1615/2759 [00:10&lt;00:07, 156.38it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  59%|█████▉    | 1631/2759 [00:10&lt;00:07, 156.08it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  60%|█████▉    | 1647/2759 [00:10&lt;00:07, 153.01it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  60%|██████    | 1665/2759 [00:10&lt;00:06, 157.23it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  61%|██████    | 1682/2759 [00:11&lt;00:06, 157.60it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  62%|██████▏   | 1698/2759 [00:11&lt;00:06, 153.94it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  62%|██████▏   | 1715/2759 [00:11&lt;00:06, 157.13it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  63%|██████▎   | 1731/2759 [00:11&lt;00:06, 154.14it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  63%|██████▎   | 1747/2759 [00:11&lt;00:07, 142.30it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  64%|██████▍   | 1762/2759 [00:11&lt;00:06, 142.83it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  64%|██████▍   | 1777/2759 [00:11&lt;00:07, 137.16it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  65%|██████▌   | 1795/2759 [00:11&lt;00:06, 148.03it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  66%|██████▌   | 1811/2759 [00:11&lt;00:06, 150.09it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  66%|██████▌   | 1827/2759 [00:12&lt;00:06, 148.86it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  67%|██████▋   | 1846/2759 [00:12&lt;00:05, 158.22it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  67%|██████▋   | 1862/2759 [00:12&lt;00:05, 158.50it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  68%|██████▊   | 1878/2759 [00:12&lt;00:05, 156.97it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  69%|██████▊   | 1894/2759 [00:12&lt;00:05, 157.70it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  69%|██████▉   | 1911/2759 [00:12&lt;00:05, 159.09it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  70%|██████▉   | 1929/2759 [00:12&lt;00:05, 163.17it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  71%|███████   | 1946/2759 [00:12&lt;00:05, 161.30it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  71%|███████   | 1963/2759 [00:12&lt;00:04, 160.58it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  72%|███████▏  | 1980/2759 [00:13&lt;00:06, 125.38it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  72%|███████▏  | 1994/2759 [00:13&lt;00:06, 123.82it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  73%|███████▎  | 2012/2759 [00:13&lt;00:05, 133.36it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  74%|███████▎  | 2032/2759 [00:13&lt;00:04, 149.12it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  74%|███████▍  | 2049/2759 [00:13&lt;00:04, 152.76it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  75%|███████▍  | 2067/2759 [00:13&lt;00:04, 159.35it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  76%|███████▌  | 2084/2759 [00:13&lt;00:04, 139.55it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  76%|███████▌  | 2100/2759 [00:13&lt;00:04, 143.99it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  77%|███████▋  | 2116/2759 [00:13&lt;00:04, 148.19it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  77%|███████▋  | 2134/2759 [00:14&lt;00:03, 156.58it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  78%|███████▊  | 2152/2759 [00:14&lt;00:03, 161.03it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  79%|███████▊  | 2172/2759 [00:14&lt;00:03, 169.45it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  79%|███████▉  | 2191/2759 [00:14&lt;00:03, 173.65it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  80%|████████  | 2210/2759 [00:14&lt;00:03, 178.35it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  81%|████████  | 2230/2759 [00:14&lt;00:02, 183.74it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  82%|████████▏ | 2249/2759 [00:14&lt;00:02, 182.56it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  82%|████████▏ | 2270/2759 [00:14&lt;00:02, 189.72it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  83%|████████▎ | 2290/2759 [00:14&lt;00:02, 184.69it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  84%|████████▎ | 2309/2759 [00:15&lt;00:02, 184.63it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  84%|████████▍ | 2328/2759 [00:15&lt;00:02, 179.53it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  85%|████████▌ | 2347/2759 [00:15&lt;00:02, 177.07it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  86%|████████▌ | 2367/2759 [00:15&lt;00:02, 182.71it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  86%|████████▋ | 2386/2759 [00:15&lt;00:02, 181.08it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  87%|████████▋ | 2406/2759 [00:15&lt;00:01, 183.12it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  88%|████████▊ | 2425/2759 [00:15&lt;00:01, 184.87it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  89%|████████▊ | 2444/2759 [00:15&lt;00:02, 155.15it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  89%|████████▉ | 2462/2759 [00:15&lt;00:01, 160.76it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  90%|████████▉ | 2481/2759 [00:16&lt;00:01, 166.99it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  91%|█████████ | 2499/2759 [00:16&lt;00:02, 127.00it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  91%|█████████ | 2516/2759 [00:16&lt;00:01, 135.46it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  92%|█████████▏| 2532/2759 [00:16&lt;00:01, 113.50it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  92%|█████████▏| 2550/2759 [00:16&lt;00:01, 127.24it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  93%|█████████▎| 2565/2759 [00:16&lt;00:01, 121.85it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  93%|█████████▎| 2579/2759 [00:17&lt;00:01, 103.91it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  94%|█████████▍| 2591/2759 [00:17&lt;00:01, 92.45it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  94%|█████████▍| 2606/2759 [00:17&lt;00:01, 94.83it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  95%|█████████▍| 2617/2759 [00:17&lt;00:01, 86.10it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  95%|█████████▌| 2628/2759 [00:17&lt;00:01, 85.88it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  96%|█████████▌| 2637/2759 [00:17&lt;00:01, 85.68it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  96%|█████████▌| 2646/2759 [00:17&lt;00:01, 85.02it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  96%|█████████▌| 2655/2759 [00:17&lt;00:01, 84.69it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  97%|█████████▋| 2668/2759 [00:18&lt;00:01, 88.33it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  97%|█████████▋| 2682/2759 [00:18&lt;00:00, 100.46it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  98%|█████████▊| 2693/2759 [00:18&lt;00:01, 65.18it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  98%|█████████▊| 2702/2759 [00:18&lt;00:00, 69.09it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  98%|█████████▊| 2711/2759 [00:18&lt;00:00, 72.96it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  99%|█████████▊| 2723/2759 [00:18&lt;00:00, 73.19it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  99%|█████████▉| 2735/2759 [00:18&lt;00:00, 82.94it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group: 100%|█████████▉| 2748/2759 [00:19&lt;00:00, 92.64it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group: 100%|██████████| 2759/2759 [00:19&lt;00:00, 143.91it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>WARNING: One or more fit(s) may not have converged. Please check the &quot;flags&quot; column in the output table. [photutils.psf._components]
</span></code></pre></div></div></div><p>Once this is done, we can create a residual image.</p><div id="jiF6CHjqyE" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">resimage = psfphot.make_residual_image(data = img-median, psf_shape = (9, 9))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="CEy38QnR66YPzaBiOSF1Y" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Add model sources:   0%|          | 0/2759 [00:00&lt;?, ?it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Add model sources:  11%|█         | 294/2759 [00:00&lt;00:00, 2932.57it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Add model sources:  21%|██▏       | 592/2759 [00:00&lt;00:00, 2959.23it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Add model sources:  32%|███▏      | 888/2759 [00:00&lt;00:00, 2949.16it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Add model sources:  43%|████▎     | 1187/2759 [00:00&lt;00:00, 2963.45it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Add model sources:  54%|█████▍    | 1491/2759 [00:00&lt;00:00, 2989.83it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Add model sources:  65%|██████▌   | 1794/2759 [00:00&lt;00:00, 3000.38it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Add model sources:  76%|███████▌  | 2095/2759 [00:00&lt;00:00, 2990.07it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Add model sources:  87%|████████▋ | 2399/2759 [00:00&lt;00:00, 3003.46it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Add model sources:  98%|█████████▊| 2705/2759 [00:00&lt;00:00, 3018.41it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Add model sources: 100%|██████████| 2759/2759 [00:00&lt;00:00, 2989.09it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>
</span></code></pre></div></div></div><p>We now want to add the best-fit coordinates (R.A. and Decl.) to the VIS photometry catalog. For this, we have to convert the image coordinates into sky coordinates using the WCS information. We will need these coordinates because we want to use them as positional priors for the photometry measurement on the NISP images.</p><div id="cogVCYVmWp" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">## Add coordinates to catalog
wcs1 = WCS(hdr) # VIS
radec = wcs1.all_pix2world(phot[&quot;x_fit&quot;],phot[&quot;y_fit&quot;],0)
phot[&quot;ra_fit&quot;] = radec[0]
phot[&quot;dec_fit&quot;] = radec[1]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="2owQGl39T_C_Y2J2bPP5c" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Finally, we plot the VIS image and the residual with the extracted sources overlaid.</p><div id="Q0Od9huzcq" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig = plt.figure(figsize=(20,10))
ax1 = fig.add_subplot(1,2,1)
ax2 = fig.add_subplot(1,2,2)
ax1.imshow(np.log10(img), cmap=&quot;Greys&quot;, origin=&quot;lower&quot;)
ax1.plot(phot[&quot;x_fit&quot;], phot[&quot;y_fit&quot;] , &quot;o&quot;, markersize=8 , markeredgecolor=&quot;red&quot;, fillstyle=&quot;none&quot;)

ax2.imshow(resimage,vmin=-5*std, vmax=5*std, cmap=&quot;RdBu&quot;, origin=&quot;lower&quot;)
ax2.plot(phot[&quot;x_fit&quot;], phot[&quot;y_fit&quot;] , &quot;o&quot;, markersize=8 , markeredgecolor=&quot;red&quot;, fillstyle=&quot;none&quot;)

plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5ZYLZw8BNkheiTbLkQ6be" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/irsa-tutorials/build/259d0a3dd736cf4fec47882dffdd7017.png" alt="&lt;Figure size 2000x1000 with 2 Axes&gt;"/></div></div><p>As an additional check, we can compare the aperture photometry and the PSF photometry. We should find a good agreement between those two measurement methods. However, note that the PSF photometry should do a better job in deblending the fluxes of sources that are close by.</p><div id="ZNRuGQp6Rs" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">x = objects[&quot;flux&quot;]
y = phot[&quot;flux_fit&quot;]

fig = plt.figure(figsize=(6,5))
ax1 = fig.add_subplot(1,1,1)

ax1.plot(x , y , &quot;o&quot;, markersize=2, alpha=0.5)
minlim = np.nanmin(np.concatenate((x,y)))
maxlim = np.nanmax(np.concatenate((x,y)))

ax1.fill_between(np.asarray([minlim,maxlim]),np.asarray([minlim,maxlim])/1.5,np.asarray([minlim,maxlim])*1.5, color=&quot;gray&quot;, alpha=0.2, linewidth=0)
ax1.fill_between(np.asarray([minlim,maxlim]),np.asarray([minlim,maxlim])/1.2,np.asarray([minlim,maxlim])*1.2, color=&quot;gray&quot;, alpha=0.4, linewidth=0)
ax1.plot(np.asarray([minlim,maxlim]),np.asarray([minlim,maxlim]), &quot;:&quot;, color=&quot;gray&quot;)

ax1.set_xlabel(&quot;Aperture Photometry [flux]&quot;)
ax1.set_ylabel(&quot;PSF forced-photometry [flux]&quot;)
ax1.set_xscale(&#x27;log&#x27;)
ax1.set_yscale(&#x27;log&#x27;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5TEk_nttLabaRrENb4sz-" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/irsa-tutorials/build/16fa53b792afdac5bc54cac1d8671dfe.png" alt="&lt;Figure size 600x500 with 1 Axes&gt;"/></div></div><h2 id="measure-the-photometry-on-the-nisp-images" class="relative group"><span class="heading-text">Measure the Photometry on the NISP Images</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#measure-the-photometry-on-the-nisp-images" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>We now have the photometry and the position of sources on the VIS image. We can now proceed with similar steps on the NISP images. Because the NISP PSF and pixel scale are larger that those of the VIS images, we utilize the advantage of position prior-based forced photometry.
For this, we use the positions of the VIS measurements and perform PSF fitting on the NISP image using these priors.</p><p>The steps below are almost identical to the ones applied to the VIS images.</p><p>We first isolate the data, which is in this case the NISP <em>H</em>-band filter. Note that this is an arbitrary choice and you should be encouraged to try other filters as well!</p><div id="EJgIBk6wPP" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">img2 = hdulcutout[&quot;H_SCIENCE&quot;].data
hdr2 = hdulcutout[&quot;H_SCIENCE&quot;].header
img2[img2 == 0] = np.nan</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="xfR1BRAyAiE50A1g-agGr" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>We again need to create a mask that will be fed to the PSF fitting module.</p><div id="R5umhUEyXx" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">mask2 = np.isnan(img2)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="wuW2dly0h4tz91lSvg_sV" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>... and we also get some statistics on the sky background.</p><div id="HIZJ8mBFUV" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">mean2, median2, std2 = sigma_clipped_stats(img2, sigma=3.0)
print(np.array((mean2, median2, std2)))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="QF-uOZUgEhIo9BcMtMncO" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>[2626.3018 1889.8518 2043.9841]
</span></code></pre></div></div></div><p>Now, we need to obtain the (x,y) image coordinates on the NISP image that correspond to the extracted sources on the VIS image. We use the WCS information from the NISP image for this case and apply it to the sky coordinates obtained on the VIS image.</p><div id="B8Vd2BqGb4" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">wcs = WCS(hdr) # VIS
wcs2 = WCS(hdr2) # NISP
radec = wcs.all_pix2world(objects[&quot;x&quot;],objects[&quot;y&quot;], 0)
xy = wcs2.all_world2pix(radec[0],radec[1],0)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="rOtx6OPFMPdU-qsd84Yln" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Having all this set up, we can now again perform the PSF photometry using <code>PSFPhotometry()</code> from the <code>photutils</code> package. This again can take a while, typically 1 minute.</p><div id="VqG0RXIVhB" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">psf_fwhm = 0.3 # arcsec
pixscale = 0.3 # arcsec/px

init_params = Table([xy[0],xy[1]] , names=[&quot;x&quot;,&quot;y&quot;]) # initial positions
psf_model = CircularGaussianSigmaPRF(flux=1, sigma=psf_fwhm/pixscale / 2.35)
psf_model.x_0.fixed = True
psf_model.y_0.fixed = True
psf_model.sigma.fixed = False
fit_shape = (3, 3)
psfphot2 = PSFPhotometry(psf_model,
                        fit_shape,
                        finder = DAOStarFinder(fwhm=0.1, threshold=3.*std2, exclude_border=True), # not needed because we are using fixed initial positions.
                        aperture_radius = 4,
                        progress_bar = True)
phot2 = psfphot2(img2-median2, error=None, mask=mask2, init_params=init_params)
resimage2 = psfphot2.make_residual_image(data = img2-median2, psf_shape = (3, 3))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="T2OECC8AOOCeNwsYXb0PU" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   0%|          | 0/2759 [00:00&lt;?, ?it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   0%|          | 5/2759 [00:00&lt;00:58, 47.37it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   0%|          | 12/2759 [00:00&lt;00:46, 58.93it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   1%|          | 28/2759 [00:00&lt;00:26, 102.08it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   1%|▏         | 41/2759 [00:00&lt;00:26, 100.80it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   2%|▏         | 53/2759 [00:00&lt;00:26, 101.90it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   2%|▏         | 64/2759 [00:00&lt;00:27, 99.36it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   3%|▎         | 75/2759 [00:00&lt;00:27, 95.94it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   3%|▎         | 85/2759 [00:00&lt;00:32, 81.98it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   3%|▎         | 94/2759 [00:01&lt;00:32, 82.90it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   4%|▎         | 103/2759 [00:01&lt;00:31, 83.30it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   4%|▍         | 112/2759 [00:01&lt;00:32, 82.45it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   4%|▍         | 121/2759 [00:01&lt;00:31, 83.86it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   5%|▍         | 130/2759 [00:01&lt;00:31, 84.11it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   5%|▌         | 140/2759 [00:01&lt;00:33, 77.22it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   5%|▌         | 148/2759 [00:01&lt;00:34, 76.55it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   6%|▌         | 157/2759 [00:01&lt;00:32, 79.59it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   6%|▌         | 166/2759 [00:02&lt;00:38, 67.89it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   6%|▋         | 175/2759 [00:02&lt;00:35, 72.23it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   7%|▋         | 191/2759 [00:02&lt;00:27, 93.56it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   7%|▋         | 201/2759 [00:02&lt;00:27, 94.27it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   8%|▊         | 211/2759 [00:02&lt;00:27, 92.86it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   8%|▊         | 227/2759 [00:02&lt;00:22, 110.50it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   9%|▊         | 239/2759 [00:02&lt;00:27, 92.45it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:   9%|▉         | 255/2759 [00:02&lt;00:23, 106.90it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  10%|▉         | 267/2759 [00:03&lt;00:25, 96.28it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  10%|█         | 278/2759 [00:03&lt;00:25, 96.44it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  10%|█         | 289/2759 [00:03&lt;00:25, 95.11it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  11%|█         | 301/2759 [00:03&lt;00:25, 95.28it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  11%|█▏        | 311/2759 [00:03&lt;00:37, 64.54it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  12%|█▏        | 319/2759 [00:03&lt;00:41, 58.57it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  12%|█▏        | 332/2759 [00:03&lt;00:33, 71.88it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  12%|█▏        | 344/2759 [00:04&lt;00:29, 81.75it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  13%|█▎        | 358/2759 [00:04&lt;00:25, 94.56it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  13%|█▎        | 369/2759 [00:04&lt;00:31, 76.66it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  14%|█▍        | 386/2759 [00:04&lt;00:24, 96.74it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  14%|█▍        | 398/2759 [00:04&lt;00:26, 88.88it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  15%|█▌        | 415/2759 [00:04&lt;00:22, 106.45it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  16%|█▌        | 433/2759 [00:04&lt;00:18, 123.21it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  16%|█▌        | 447/2759 [00:04&lt;00:19, 118.84it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  17%|█▋        | 460/2759 [00:05&lt;00:22, 103.76it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  17%|█▋        | 472/2759 [00:05&lt;00:24, 93.54it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  18%|█▊        | 488/2759 [00:05&lt;00:20, 108.45it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  18%|█▊        | 502/2759 [00:05&lt;00:21, 106.15it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  19%|█▊        | 514/2759 [00:05&lt;00:21, 104.28it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  19%|█▉        | 528/2759 [00:05&lt;00:21, 105.31it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  20%|█▉        | 539/2759 [00:05&lt;00:24, 92.11it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  20%|█▉        | 549/2759 [00:06&lt;00:26, 82.76it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  20%|██        | 560/2759 [00:06&lt;00:25, 86.07it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  21%|██        | 570/2759 [00:06&lt;00:25, 86.82it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  21%|██        | 579/2759 [00:06&lt;00:24, 87.30it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  21%|██▏       | 588/2759 [00:06&lt;00:25, 86.62it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  22%|██▏       | 597/2759 [00:06&lt;00:25, 85.07it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  22%|██▏       | 606/2759 [00:06&lt;00:28, 74.63it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  22%|██▏       | 614/2759 [00:07&lt;00:34, 61.48it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  23%|██▎       | 629/2759 [00:07&lt;00:26, 80.93it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  23%|██▎       | 639/2759 [00:07&lt;00:25, 84.73it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  24%|██▍       | 657/2759 [00:07&lt;00:19, 107.68it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  24%|██▍       | 669/2759 [00:07&lt;00:22, 93.59it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  25%|██▍       | 680/2759 [00:07&lt;00:21, 94.52it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  25%|██▌       | 691/2759 [00:07&lt;00:21, 95.86it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  25%|██▌       | 702/2759 [00:07&lt;00:25, 79.26it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  26%|██▌       | 711/2759 [00:08&lt;00:27, 74.31it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  26%|██▌       | 720/2759 [00:08&lt;00:28, 71.58it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  26%|██▋       | 730/2759 [00:08&lt;00:26, 77.77it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  27%|██▋       | 746/2759 [00:08&lt;00:22, 90.69it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  27%|██▋       | 756/2759 [00:08&lt;00:27, 73.69it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  28%|██▊       | 773/2759 [00:08&lt;00:21, 94.42it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  28%|██▊       | 784/2759 [00:08&lt;00:21, 93.41it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  29%|██▉       | 796/2759 [00:08&lt;00:20, 96.90it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  29%|██▉       | 813/2759 [00:09&lt;00:16, 114.72it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  30%|██▉       | 826/2759 [00:09&lt;00:19, 100.11it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  30%|███       | 837/2759 [00:09&lt;00:19, 99.25it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  31%|███       | 848/2759 [00:09&lt;00:19, 98.09it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  31%|███       | 859/2759 [00:09&lt;00:19, 97.71it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  32%|███▏      | 870/2759 [00:09&lt;00:21, 88.09it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  32%|███▏      | 881/2759 [00:09&lt;00:20, 92.37it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  32%|███▏      | 891/2759 [00:09&lt;00:20, 90.25it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  33%|███▎      | 904/2759 [00:10&lt;00:20, 92.61it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  33%|███▎      | 914/2759 [00:10&lt;00:19, 92.67it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  34%|███▎      | 926/2759 [00:10&lt;00:19, 94.90it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  34%|███▍      | 942/2759 [00:10&lt;00:16, 111.88it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  35%|███▍      | 954/2759 [00:10&lt;00:21, 85.94it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  35%|███▌      | 968/2759 [00:10&lt;00:19, 90.07it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  35%|███▌      | 978/2759 [00:10&lt;00:22, 80.06it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  36%|███▌      | 987/2759 [00:11&lt;00:24, 72.66it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  36%|███▌      | 995/2759 [00:11&lt;00:27, 63.15it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  37%|███▋      | 1011/2759 [00:11&lt;00:21, 82.44it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  37%|███▋      | 1025/2759 [00:11&lt;00:19, 89.09it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  38%|███▊      | 1042/2759 [00:11&lt;00:16, 105.23it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  38%|███▊      | 1054/2759 [00:11&lt;00:19, 86.46it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  39%|███▊      | 1069/2759 [00:11&lt;00:16, 100.15it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  39%|███▉      | 1081/2759 [00:12&lt;00:18, 92.32it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  40%|███▉      | 1092/2759 [00:12&lt;00:17, 94.04it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  40%|████      | 1108/2759 [00:12&lt;00:15, 109.31it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  41%|████      | 1120/2759 [00:12&lt;00:17, 94.15it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  41%|████      | 1131/2759 [00:12&lt;00:20, 78.44it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  41%|████▏     | 1140/2759 [00:12&lt;00:22, 72.75it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  42%|████▏     | 1149/2759 [00:12&lt;00:21, 75.96it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  42%|████▏     | 1164/2759 [00:13&lt;00:18, 85.97it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  43%|████▎     | 1181/2759 [00:13&lt;00:15, 105.04it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  43%|████▎     | 1193/2759 [00:13&lt;00:15, 99.92it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  44%|████▎     | 1204/2759 [00:13&lt;00:19, 78.97it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  44%|████▍     | 1214/2759 [00:13&lt;00:18, 82.98it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  44%|████▍     | 1224/2759 [00:13&lt;00:19, 77.76it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  45%|████▍     | 1233/2759 [00:13&lt;00:20, 74.30it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  45%|████▌     | 1242/2759 [00:14&lt;00:19, 76.63it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  45%|████▌     | 1252/2759 [00:14&lt;00:18, 82.00it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  46%|████▌     | 1267/2759 [00:14&lt;00:15, 98.78it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  47%|████▋     | 1285/2759 [00:14&lt;00:13, 106.61it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  47%|████▋     | 1296/2759 [00:14&lt;00:14, 102.23it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  47%|████▋     | 1307/2759 [00:14&lt;00:14, 99.96it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  48%|████▊     | 1318/2759 [00:14&lt;00:15, 90.50it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  48%|████▊     | 1328/2759 [00:14&lt;00:17, 81.79it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  48%|████▊     | 1337/2759 [00:15&lt;00:19, 74.29it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  49%|████▉     | 1349/2759 [00:15&lt;00:17, 81.19it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  49%|████▉     | 1358/2759 [00:15&lt;00:19, 72.72it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  50%|████▉     | 1366/2759 [00:15&lt;00:19, 70.88it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  50%|████▉     | 1374/2759 [00:15&lt;00:19, 72.76it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  50%|█████     | 1382/2759 [00:15&lt;00:22, 60.75it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  50%|█████     | 1393/2759 [00:15&lt;00:20, 65.06it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  51%|█████     | 1407/2759 [00:16&lt;00:18, 74.38it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  51%|█████▏    | 1415/2759 [00:16&lt;00:21, 63.91it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  52%|█████▏    | 1433/2759 [00:16&lt;00:15, 88.30it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  53%|█████▎    | 1449/2759 [00:16&lt;00:12, 104.64it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  53%|█████▎    | 1461/2759 [00:16&lt;00:12, 104.72it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  54%|█████▎    | 1479/2759 [00:16&lt;00:10, 122.83it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  54%|█████▍    | 1493/2759 [00:16&lt;00:10, 116.57it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  55%|█████▍    | 1506/2759 [00:16&lt;00:10, 114.61it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  55%|█████▌    | 1518/2759 [00:17&lt;00:12, 97.41it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  55%|█████▌    | 1529/2759 [00:17&lt;00:14, 84.38it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  56%|█████▌    | 1539/2759 [00:17&lt;00:14, 87.10it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  56%|█████▌    | 1549/2759 [00:17&lt;00:15, 80.37it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  57%|█████▋    | 1565/2759 [00:17&lt;00:13, 91.00it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  57%|█████▋    | 1575/2759 [00:17&lt;00:13, 89.83it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  58%|█████▊    | 1587/2759 [00:17&lt;00:12, 96.37it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  58%|█████▊    | 1598/2759 [00:18&lt;00:11, 99.14it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  58%|█████▊    | 1609/2759 [00:18&lt;00:14, 79.53it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  59%|█████▊    | 1618/2759 [00:18&lt;00:15, 73.79it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  59%|█████▉    | 1626/2759 [00:18&lt;00:15, 75.14it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  59%|█████▉    | 1635/2759 [00:18&lt;00:14, 77.88it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  60%|█████▉    | 1644/2759 [00:18&lt;00:15, 70.00it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  60%|█████▉    | 1652/2759 [00:18&lt;00:15, 72.00it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  60%|██████    | 1661/2759 [00:18&lt;00:14, 75.66it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  61%|██████    | 1671/2759 [00:19&lt;00:13, 81.16it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  61%|██████    | 1680/2759 [00:19&lt;00:12, 83.10it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  61%|██████▏   | 1690/2759 [00:19&lt;00:12, 86.33it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  62%|██████▏   | 1706/2759 [00:19&lt;00:09, 106.72it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  62%|██████▏   | 1717/2759 [00:19&lt;00:11, 94.66it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  63%|██████▎   | 1728/2759 [00:19&lt;00:10, 97.60it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  63%|██████▎   | 1739/2759 [00:19&lt;00:11, 86.29it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  63%|██████▎   | 1751/2759 [00:19&lt;00:10, 92.26it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  64%|██████▍   | 1761/2759 [00:20&lt;00:11, 83.82it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  64%|██████▍   | 1771/2759 [00:20&lt;00:12, 79.89it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  65%|██████▍   | 1780/2759 [00:20&lt;00:14, 69.19it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  65%|██████▍   | 1790/2759 [00:20&lt;00:12, 75.27it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  65%|██████▌   | 1801/2759 [00:20&lt;00:11, 82.65it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  66%|██████▌   | 1812/2759 [00:20&lt;00:10, 89.32it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  66%|██████▋   | 1829/2759 [00:20&lt;00:09, 101.46it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  67%|██████▋   | 1840/2759 [00:20&lt;00:09, 92.06it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  67%|██████▋   | 1852/2759 [00:21&lt;00:09, 96.23it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  67%|██████▋   | 1862/2759 [00:21&lt;00:09, 97.18it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  68%|██████▊   | 1872/2759 [00:21&lt;00:11, 79.17it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  69%|██████▊   | 1891/2759 [00:21&lt;00:08, 104.87it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  69%|██████▉   | 1903/2759 [00:21&lt;00:08, 102.36it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  69%|██████▉   | 1914/2759 [00:21&lt;00:09, 84.72it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  70%|██████▉   | 1924/2759 [00:21&lt;00:10, 81.54it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  70%|███████   | 1936/2759 [00:22&lt;00:09, 87.49it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  71%|███████   | 1946/2759 [00:22&lt;00:09, 83.14it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  71%|███████   | 1955/2759 [00:22&lt;00:10, 78.38it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  71%|███████▏  | 1972/2759 [00:22&lt;00:07, 99.94it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  72%|███████▏  | 1983/2759 [00:22&lt;00:09, 83.14it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  72%|███████▏  | 1993/2759 [00:22&lt;00:09, 78.34it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  73%|███████▎  | 2003/2759 [00:22&lt;00:09, 83.12it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  73%|███████▎  | 2012/2759 [00:22&lt;00:09, 82.12it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  73%|███████▎  | 2021/2759 [00:23&lt;00:09, 76.10it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  74%|███████▎  | 2031/2759 [00:23&lt;00:09, 78.83it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  74%|███████▍  | 2046/2759 [00:23&lt;00:08, 89.04it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  75%|███████▍  | 2056/2759 [00:23&lt;00:07, 90.83it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  75%|███████▌  | 2071/2759 [00:23&lt;00:06, 103.63it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  75%|███████▌  | 2082/2759 [00:23&lt;00:08, 83.55it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  76%|███████▌  | 2097/2759 [00:23&lt;00:07, 93.91it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  76%|███████▋  | 2108/2759 [00:23&lt;00:06, 96.89it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  77%|███████▋  | 2119/2759 [00:24&lt;00:06, 99.81it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  77%|███████▋  | 2132/2759 [00:24&lt;00:06, 103.54it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  78%|███████▊  | 2143/2759 [00:24&lt;00:06, 102.51it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  78%|███████▊  | 2154/2759 [00:24&lt;00:06, 92.34it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  78%|███████▊  | 2164/2759 [00:24&lt;00:06, 85.19it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  79%|███████▉  | 2175/2759 [00:24&lt;00:06, 89.14it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  79%|███████▉  | 2186/2759 [00:24&lt;00:06, 93.28it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  80%|███████▉  | 2197/2759 [00:24&lt;00:05, 96.57it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  80%|████████  | 2210/2759 [00:25&lt;00:05, 99.50it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  81%|████████  | 2221/2759 [00:25&lt;00:06, 80.56it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  81%|████████  | 2233/2759 [00:25&lt;00:06, 87.23it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  81%|████████▏ | 2243/2759 [00:25&lt;00:06, 81.94it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  82%|████████▏ | 2253/2759 [00:25&lt;00:05, 85.49it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  82%|████████▏ | 2264/2759 [00:25&lt;00:05, 91.56it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  82%|████████▏ | 2274/2759 [00:25&lt;00:05, 89.90it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  83%|████████▎ | 2285/2759 [00:25&lt;00:04, 94.83it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  83%|████████▎ | 2296/2759 [00:26&lt;00:04, 97.89it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  84%|████████▎ | 2310/2759 [00:26&lt;00:04, 108.43it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  84%|████████▍ | 2322/2759 [00:26&lt;00:04, 103.51it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  85%|████████▍ | 2338/2759 [00:26&lt;00:03, 117.31it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  85%|████████▌ | 2350/2759 [00:26&lt;00:04, 87.50it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  86%|████████▌ | 2360/2759 [00:26&lt;00:05, 79.16it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  86%|████████▌ | 2369/2759 [00:26&lt;00:05, 73.23it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  86%|████████▌ | 2377/2759 [00:27&lt;00:05, 64.54it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  86%|████████▋ | 2385/2759 [00:27&lt;00:05, 62.68it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  87%|████████▋ | 2396/2759 [00:27&lt;00:05, 72.04it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  87%|████████▋ | 2405/2759 [00:27&lt;00:04, 76.16it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  88%|████████▊ | 2416/2759 [00:27&lt;00:04, 83.92it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  88%|████████▊ | 2426/2759 [00:27&lt;00:03, 87.30it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  88%|████████▊ | 2436/2759 [00:27&lt;00:04, 72.96it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  89%|████████▊ | 2445/2759 [00:27&lt;00:04, 76.20it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  89%|████████▉ | 2454/2759 [00:28&lt;00:03, 79.63it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  89%|████████▉ | 2463/2759 [00:28&lt;00:03, 75.38it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  90%|████████▉ | 2473/2759 [00:28&lt;00:03, 76.81it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  90%|█████████ | 2485/2759 [00:28&lt;00:03, 83.64it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  90%|█████████ | 2494/2759 [00:28&lt;00:04, 65.17it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  91%|█████████ | 2512/2759 [00:28&lt;00:02, 90.13it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  91%|█████████▏| 2523/2759 [00:28&lt;00:02, 93.16it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  92%|█████████▏| 2534/2759 [00:29&lt;00:03, 68.61it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  92%|█████████▏| 2544/2759 [00:29&lt;00:02, 73.84it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  93%|█████████▎| 2555/2759 [00:29&lt;00:02, 80.99it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  93%|█████████▎| 2565/2759 [00:29&lt;00:02, 82.81it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  93%|█████████▎| 2575/2759 [00:29&lt;00:02, 86.73it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  94%|█████████▍| 2590/2759 [00:29&lt;00:01, 96.36it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  94%|█████████▍| 2607/2759 [00:29&lt;00:01, 114.43it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  95%|█████████▍| 2619/2759 [00:29&lt;00:01, 109.73it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  96%|█████████▌| 2635/2759 [00:29&lt;00:01, 122.99it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  96%|█████████▌| 2648/2759 [00:30&lt;00:00, 114.19it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  97%|█████████▋| 2665/2759 [00:30&lt;00:00, 128.58it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  97%|█████████▋| 2679/2759 [00:30&lt;00:00, 124.38it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  98%|█████████▊| 2692/2759 [00:30&lt;00:00, 120.56it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  98%|█████████▊| 2708/2759 [00:30&lt;00:00, 119.40it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  99%|█████████▊| 2721/2759 [00:30&lt;00:00, 80.68it/s] </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  99%|█████████▉| 2734/2759 [00:30&lt;00:00, 90.30it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group:  99%|█████████▉| 2745/2759 [00:31&lt;00:00, 91.81it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Fit source/group: 100%|██████████| 2759/2759 [00:31&lt;00:00, 88.54it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>WARNING: One or more fit(s) may not have converged. Please check the &quot;flags&quot; column in the output table. [photutils.psf._components]
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Add model sources:   0%|          | 0/2759 [00:00&lt;?, ?it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Add model sources:  17%|█▋        | 462/2759 [00:00&lt;00:00, 4611.35it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Add model sources:  35%|███▍      | 957/2759 [00:00&lt;00:00, 4808.23it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Add model sources:  53%|█████▎    | 1457/2759 [00:00&lt;00:00, 4894.62it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Add model sources:  71%|███████   | 1947/2759 [00:00&lt;00:00, 4741.99it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Add model sources:  88%|████████▊ | 2428/2759 [00:00&lt;00:00, 4764.59it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Add model sources: 100%|██████████| 2759/2759 [00:00&lt;00:00, 4760.30it/s]</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>
</span></code></pre></div></div></div><p>Again, we convert the pixel coordinates to sky coordinates and add them to the catalog.</p><div id="wPV1TMSDSQ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">wcs2 = WCS(hdr2) # NISP
radec = wcs2.all_pix2world(phot2[&quot;x_fit&quot;],phot2[&quot;y_fit&quot;],0)
phot2[&quot;ra_fit&quot;] = radec[0]
phot2[&quot;dec_fit&quot;] = radec[1]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ldxyGwXSwiYz2VbYdyVGN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Finally, we create the same figure as above, showing the NISP image and the residual with the (VIS-extracted) sources overlaid.</p><div id="ITifOqsBTV" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig = plt.figure(figsize=(20,10))
ax1 = fig.add_subplot(1,2,1)
ax2 = fig.add_subplot(1,2,2)
ax1.imshow(np.log10(img2), cmap=&quot;Greys&quot;, origin=&quot;lower&quot;)
ax1.plot(phot2[&quot;x_fit&quot;], phot2[&quot;y_fit&quot;] , &quot;o&quot;, markersize=8 , markeredgecolor=&quot;red&quot;, fillstyle=&quot;none&quot;)

ax2.imshow(resimage2,vmin=-20*std2, vmax=20*std2, cmap=&quot;RdBu&quot;, origin=&quot;lower&quot;)
ax2.plot(phot2[&quot;x_fit&quot;], phot2[&quot;y_fit&quot;] , &quot;o&quot;, markersize=8 , markeredgecolor=&quot;red&quot;, fillstyle=&quot;none&quot;)

plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="C5PwrWpaYAAeHd1z3gN6h" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/irsa-tutorials/build/17938692777de4260dc806d857fa1fae.png" alt="&lt;Figure size 2000x1000 with 2 Axes&gt;"/></div></div><h2 id="load-gaia-catalog" class="relative group"><span class="heading-text">Load Gaia Catalog</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#load-gaia-catalog" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>We now load the Gaia sources at the location of the globular clusters. The goal is to compare the photometry of Gaia to the one derived above for the Euclid VIS and NISP images. This is scientifically useful, for example we can compute the colors of the stars in the Gaia optical bands and the Euclid near-IR bands.
To search for Gaia sources, we use <code>astroquery</code> again.</p><p>We first have to elimiate the row limit for the Gaia query by setting</p><div id="vegik5gVH6" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">Gaia.ROW_LIMIT = -1</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="BROMhCs4PSdoG5khPLHcc" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Next, we request the Gaia catalog around the position of the globular cluster. We use the same size as the cutout size.</p><div id="IU1PqAnseb" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">gaia_objects = Gaia.query_object_async(coordinate=coord, radius = cutout_size/2)
print(&quot;Number of Gaia stars found: {}&quot;.format(len(gaia_objects)))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="pciUEx4_snaRW2flBdpxp" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>INFO: Query finished. [astroquery.utils.tap.core]
Number of Gaia stars found: 1202
</span></code></pre></div></div></div><p>We then convert the sky coordinates of the Gaia stars to (x,y) image coordinates for VIS and NISP images using the corresponding WCS. This makes it more easy to plot the Gaia sources later on the images.</p><div id="zkTkXqW4B8" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">wcs = WCS(hdr) # VIS
wcs2 = WCS(hdr2) # NISP
xy = wcs.all_world2pix(gaia_objects[&quot;ra&quot;],gaia_objects[&quot;dec&quot;],0)
xy2 = wcs2.all_world2pix(gaia_objects[&quot;ra&quot;],gaia_objects[&quot;dec&quot;],0)

gaia_objects[&quot;x_vis&quot;] = xy[0]
gaia_objects[&quot;y_vis&quot;] = xy[1]
gaia_objects[&quot;x_nisp&quot;] = xy2[0]
gaia_objects[&quot;y_nisp&quot;] = xy2[1]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="jPgMDhBdTZeQODs7rYhjc" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>We save the Gaia table to disk as we will later use it for the visualization in <code>Firefly</code>.</p><div id="cFI3GbaAT0" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">gaia_objects.write(&quot;./data/gaiatable.csv&quot;, format=&quot;csv&quot;, overwrite=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="SsN0zQsFs73JdESYAGTqU" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Now we can overlay the Gaia sources on the VIS and NISP images (here the x/y coordinates become handy).</p><div id="hyvUTfSutx" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig = plt.figure(figsize=(20,10))
ax1 = fig.add_subplot(1,2,1)
ax2 = fig.add_subplot(1,2,2)
ax1.imshow(np.log10(img), cmap=&quot;Greys&quot;, origin=&quot;lower&quot;)
ax1.plot(gaia_objects[&quot;x_vis&quot;], gaia_objects[&quot;y_vis&quot;] , &quot;o&quot;, markersize=8 , markeredgecolor=&quot;red&quot;, fillstyle=&quot;none&quot;)
ax1.set_title(&quot;VIS&quot;)

ax2.imshow(np.log10(img2), cmap=&quot;Greys&quot;, origin=&quot;lower&quot;)
ax2.plot(gaia_objects[&quot;x_nisp&quot;], gaia_objects[&quot;y_nisp&quot;] , &quot;o&quot;, markersize=8 , markeredgecolor=&quot;red&quot;, fillstyle=&quot;none&quot;)
ax2.set_title(&quot;NISP&quot;)

plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="BJd8ygS6mfkCNMXdsjW0d" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/irsa-tutorials/build/3c8d9b314fb39e4efbb608f925a0d98c.png" alt="&lt;Figure size 2000x1000 with 2 Axes&gt;"/></div></div><h2 id="match-the-gaia-catalog-to-the-vis-and-nisp-catalogs" class="relative group"><span class="heading-text">Match the Gaia Catalog to the VIS and NISP Catalogs</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#match-the-gaia-catalog-to-the-vis-and-nisp-catalogs" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Now, we match the Gaia source positions to the extracted sources in the VIS and NISP images.</p><p>We first define which Gaia columns to copy to the matched catalog as well as the matching distance.</p><div id="nIxl2NuRqE" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">gaia_keys = [&quot;source_id&quot;, &quot;phot_g_mean_mag&quot;, &quot;phot_bp_mean_mag&quot;, &quot;phot_rp_mean_mag&quot;,&quot;ra&quot;,&quot;dec&quot;,&quot;pmra&quot;,&quot;pmdec&quot;]
matching_distance = 0.6*u.arcsecond</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Di_SznH-jfmilv0XLtKZM" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>First match to the VIS image. We use the <code>astropy</code> <em>SkyCoord()</em> function for matching in sky coordinates.</p><div id="mBH0KKx4tr" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">c = SkyCoord(ra=phot[&quot;ra_fit&quot;]*u.degree, dec=phot[&quot;dec_fit&quot;]*u.degree )
catalog = SkyCoord(ra=gaia_objects[&quot;ra&quot;].data*u.degree, dec=gaia_objects[&quot;dec&quot;].data*u.degree)
idx, d2d, d3d = c.match_to_catalog_sky(catalog)

sel_matched = np.where(d2d.to(u.arcsecond) &lt; (matching_distance))[0]
print(&quot;Gaia Sources matched to VIS: {}&quot;.format( len(sel_matched) ) )
phot[&quot;gaia_distance&quot;] = d2d.to(u.arcsecond)

for gaia_key in gaia_keys:
    phot[&quot;gaia_{}&quot;.format(gaia_key)] = 0.0
    phot[&quot;gaia_{}&quot;.format(gaia_key)][sel_matched] = gaia_objects[gaia_key][idx[sel_matched]]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="PpJhPe4SYONohNATNrdop" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Gaia Sources matched to VIS: 1223
</span></code></pre></div></div></div><p>And then we add the NISP sources. Note that we do not have to perform matching here because by design the VIS and NISP sources are matched (spatial prior forced photometry).</p><div id="HXppH74xiC" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">phot2[&quot;gaia_distance&quot;] = d2d.to(u.arcsecond)

for gaia_key in gaia_keys:
    phot2[&quot;gaia_{}&quot;.format(gaia_key)] = 0.0
    phot2[&quot;gaia_{}&quot;.format(gaia_key)][sel_matched] = gaia_objects[gaia_key][idx[sel_matched]]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="0tAl1uGqCHA7UUD04z9hZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Once matched, we can now compare the Gaia and Euclid/NISP magnitudes of the stars.</p><div id="RKqYluZU93" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Data
x = phot[&quot;gaia_phot_rp_mean_mag&quot;]
y = -2.5*np.log10(phot[&quot;flux_fit&quot;]) + hdr[&quot;ZP_STACK&quot;]

# selection
sel_good = np.where(phot[&quot;gaia_source_id&quot;] &gt; 0)[0]
x = x[sel_good]
y = y[sel_good]

fig = plt.figure(figsize=(6,5))
ax1 = fig.add_subplot(1,1,1)

ax1.plot(x , y , &quot;o&quot;, markersize=2)
minlim = np.nanmin(np.concatenate((x,y)))
maxlim = np.nanmax(np.concatenate((x,y)))

ax1.fill_between(np.asarray([minlim,maxlim]),np.asarray([minlim,maxlim])/1.5,np.asarray([minlim,maxlim])*1.5, color=&quot;gray&quot;, alpha=0.2, linewidth=0)
ax1.fill_between(np.asarray([minlim,maxlim]),np.asarray([minlim,maxlim])/1.2,np.asarray([minlim,maxlim])*1.2, color=&quot;gray&quot;, alpha=0.4, linewidth=0)
ax1.plot(np.asarray([minlim,maxlim]),np.asarray([minlim,maxlim]), &quot;:&quot;, color=&quot;gray&quot;)

ax1.set_xlabel(&quot;Gaia Rp [mag]&quot;)
ax1.set_ylabel(&quot;I$_E$ [mag]&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="DtLIk9QPqj6e85zkeTWF3" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/irsa-tutorials/build/dfaa3975ed0b422fbd63c8aff8ad5c89.png" alt="&lt;Figure size 600x500 with 1 Axes&gt;"/></div></div><h2 id="visualization-with-firefly" class="relative group"><span class="heading-text">Visualization with Firefly</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#visualization-with-firefly" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>At the end of this Notebook, we demonstrate how we can visualize the images and catalogs created above in <code>Firefly</code>.</p><p>We start by initializing the Firefly client.
The following line will open a new <code>Firefly</code> GUI in a separate tab <strong>inside</strong> the Jupyter Notebook environment. The user can drag the tab onto the currently open tab to create a “split tab”. This the user to see the code and images side-by-side.</p><div id="LmsGY3Soz5" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Uncomment when using within Jupyter Lab with jupyter_firefly_extensions installed
# fc = FireflyClient.make_lab_client()

# Uncomment for contexts other than the above
fc = FireflyClient.make_client(url=&quot;https://irsa.ipac.caltech.edu/irsaviewer&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="tk5CgZ12cdkcTKv0gqWsU" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>In order to display in image or catalog in <code>Firefly</code>, it needs to be uploaded to the <code>Firefly</code> server. We do this here using the <code>upload_file()</code> function.
We first upload the FITS image that we created above.</p><div id="GSnRerNJ8K" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fval = fc.upload_file(&#x27;./data/euclid_images_test.fits&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="rwu5GfLA99152QJ_gAYdU" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Once the image is uploaded we can use the <code>show_fits()</code> function to display it.
Note that our FITS image has multiple extensions (VIS, and NISP bands). We can open them separately in new <code>Firefly</code> tabs by looping over the HDUs and specifying the plot ID by the extension’s name.</p><div id="ruF7SgB9v5" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">for hh,hdu in enumerate(hdulcutout):
    fc.show_fits(fval, MultiImageIdx=hh, plot_id=hdu.header[&quot;EXTNAME&quot;] )</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="dBfw5UhLGm0Bl_ugzcT0n" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>WARNING: show_fits() is deprecated. Use show_fits_image() instead.
WARNING: show_fits() is deprecated. Use show_fits_image() instead.
WARNING: show_fits() is deprecated. Use show_fits_image() instead.
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>WARNING: show_fits() is deprecated. Use show_fits_image() instead.
</span></code></pre></div></div></div><p>We can lock the WCS between the images (allowing the user to pan and zoom the images simultaneously) by running:</p><div id="IWUKlk2o9c" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fc.align_images(lock_match=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="hnJvke2iAyalBApgFyd7e" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>{&#x27;success&#x27;: True}</span></code></div></div></div><p>In the same way, we can upload a table, in this case our Gaia table. We again use <code>upload_file()</code> but in this case we use <code>show_table()</code> to show it in <code>Firefly</code>.</p><div id="FM0rf1P1lX" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">tval = fc.upload_file(&#x27;./data/gaiatable.csv&#x27;)
fc.show_table(tval, tbl_id = &quot;gaiatable&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="dzKZ15B_v2283hv3PDJzQ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>{&#x27;success&#x27;: True}</span></code></div></div></div><p>Now, check out the <code>Firefly</code> GUI. You can zoom the images, click on sources, filter the table, display different selection, and much more!</p><hr class="py-2 my-5 translate-y-2"/><h2 id="about-this-notebook" class="relative group"><span class="heading-text">About this Notebook</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#about-this-notebook" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p><strong>Author</strong>: Andreas Faisst (IPAC Scientist)</p><p><strong>Updated</strong>: 2025-03-17</p><p><strong>Contact</strong>: the <a target="_blank" rel="noreferrer" href="https://irsa.ipac.caltech.edu/docs/help_desk.html" class="">IRSA Helpdesk</a> with questions or reporting problems.</p><div></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/irsa-tutorials/spherex-psf"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">SPHEREx</div>Understanding and Extracting the PSF Extension in a SPHEREx Cutout</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/irsa-tutorials/euclid-intro-mer-images"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">Euclid Quick Release 1</div>Euclid Q1: MER mosaics</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></article></main><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/irsa-tutorials/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-XWET6RJ7.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-C7FW3E47.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-ND43KHSX.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/irsa-tutorials/build/root-ZJOPFBMV.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-NFM2H3KQ.js"/><link rel="modulepreload" href="/irsa-tutorials/build/routes/$-CQPS5IOR.js"/><script>window.__remixContext = {"url":"/euclid-ero","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.4","options":{"outline_maxdepth":1,"favicon":"/irsa-tutorials/build/irsa-favicon-7816ba4985c4c07a3aec6d0bc169a8af.ico","logo":"/irsa-tutorials/build/irsa_logo-bd755426d9f69813fa092c6774d3180f.png"},"nav":[],"actions":[],"projects":[{"subject":"IRSA Tutorials","settings":{"output_matplotlib_strings":"remove"},"title":"IRSA Tutorials","description":"IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)","authors":[{"id":"IRSA Scientists and Developers","name":"IRSA Scientists and Developers"}],"github":"https://github.com/Caltech-IPAC/irsa-tutorials/","keywords":["astronomy"],"thebe":{"binder":{"url":"https://mybinder.org","provider":"github","repo":"https://github.com/Caltech-IPAC/irsa-tutorials/","ref":"HEAD"}},"toc":[{"file":"index.md","title":"IRSA Tutorials"},{"children":[{"file":"tutorials/spherex/spherex_intro.md"},{"file":"tutorials/spherex/spherex_cutouts.md"},{"file":"tutorials/spherex/spherex_psf.md"}],"title":"SPHEREx"},{"children":[{"children":[{"file":"tutorials/euclid_access/Euclid_ERO.md"}],"title":"Euclid Early Release Observations"},{"children":[{"file":"tutorials/euclid_access/1_Euclid_intro_MER_images.md"},{"file":"tutorials/euclid_access/2_Euclid_intro_MER_catalog.md"},{"file":"tutorials/euclid_access/3_Euclid_intro_1D_spectra.md"},{"file":"tutorials/euclid_access/4_Euclid_intro_PHZ_catalog.md"},{"file":"tutorials/euclid_access/5_Euclid_intro_SPE_catalog.md"},{"file":"tutorials/cloud_access/euclid-cloud-access.md"}],"title":"Euclid Quick Release 1"}],"title":"Euclid"},{"children":[{"children":[{"file":"tutorials/irsa-sia-examples/sia_allwise_atlas.md"},{"file":"tutorials/parquet-catalog-demos/wise-allwise-catalog-demo.md"}],"title":"AllWISE"},{"children":[{"file":"tutorials/firefly/NEOWISE_light_curve_demo.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-strategies.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-lightcurves.md"}],"title":"NEOWISE"}],"title":"WISE"},{"children":[{"file":"tutorials/irsa-sia-examples/siav2_seip.md"}],"title":"Spitzer"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_2mass_allsky.md"}],"title":"2MASS"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_cosmos.md"}],"title":"COSMOS"},{"children":[{"children":[{"file":"tutorials/roman_simulations/roman_hlss_number_density.md"}],"title":"Roman HLSS Galaxy Mock Catalog"},{"children":[{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_wideareasurvey.md"},{"file":"tutorials/firefly/OpenUniverse2024Preview_Firefly.md"},{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_timedomainsurvey.md"}],"title":"OpenUniverse 2024"},{"children":[{"file":"tutorials/cosmodc2/cosmoDC2_TAP_access.md"}],"title":"CosmoDC2"}],"title":"Simulated Data"},{"children":[{"file":"tutorials/cloud_access/cloud-access-intro.md"},{"file":"tutorials/parquet-catalog-demos/irsa-hats-with-lsdb.md"},{"file":"tutorials/firefly/SEDs_in_Firefly.md"},{"file":"tutorials/parallelize/Parallelize_Convolution.md"}],"title":"Special Topics"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"SPHEREx"},{"slug":"spherex-intro","title":"Introduction to SPHEREx Spectral Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-cutouts","title":"Download a collection of SPHEREx Spectral Image cutouts as a multi-extension FITS file","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-psf","title":"Understanding and Extracting the PSF Extension in a SPHEREx Cutout","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Euclid"},{"level":2,"title":"Euclid Early Release Observations"},{"slug":"euclid-ero","title":"Exploring Star Clusters in the Euclid ERO Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Euclid Quick Release 1"},{"slug":"euclid-intro-mer-images","title":"Euclid Q1: MER mosaics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-mer-catalog","title":"Euclid Q1: MER catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-1d-spectra","title":"Euclid Q1: 1D spectra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-phz-catalog","title":"Euclid Q1: PHZ catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-spe-catalog","title":"Euclid Q1: SPE catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-cloud-access","title":"Euclid Q1: cloud access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"WISE"},{"level":2,"title":"AllWISE"},{"slug":"sia-allwise-atlas","title":"Searching for AllWISE Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"wise-allwise-catalog-demo","title":"Analyzing cloud-hosted AllWISE Source Catalog in Parquet format","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"NEOWISE"},{"slug":"neowise-light-curve-demo","title":"Using Firefly visualization tools to understand the light curves of Solar System objects","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-strategies","title":"Strategies to Efficiently Work with NEOWISE Single-exposure Source Table in Parquet","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-lightcurves","title":"Make Light Curves from NEOWISE Single-exposure Source Table","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Spitzer"},{"slug":"siav2-seip","title":"Searching for Spitzer Enhanced Imaging Products","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"2MASS"},{"slug":"sia-2mass-allsky","title":"Searching for 2MASS All-Sky Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"COSMOS"},{"slug":"sia-cosmos","title":"Searching for contributed COSMOS images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Simulated Data"},{"level":2,"title":"Roman HLSS Galaxy Mock Catalog"},{"slug":"roman-hlss-number-density","title":"Number Density as a Function of Redshift","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"OpenUniverse 2024"},{"slug":"openuniverse2024-roman-simulated-wideareasurvey","title":"Analyzing cloud-hosted simulated Roman coadded images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024preview-firefly","title":"Using Firefly to Explore OpenUniverse2024 Data Preview Simulated Roman and Rubin Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024-roman-simulated-timedomainsurvey","title":"Analyzing cloud-hosted simulated Roman Time Domain Survey images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"CosmoDC2"},{"slug":"cosmodc2-tap-access","title":"Querying CosmoDC2 Mock v1 catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Special Topics"},{"slug":"cloud-access-intro","title":"IRSA cloud access introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"irsa-hats-with-lsdb","title":"Access HATS Collections Using LSDB: Euclid Q1 and ZTF DR23","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"seds-in-firefly","title":"Using Firefly visualization tools in Python to vet SEDs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"parallelize-convolution","title":"Parallelizing image convolution","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/irsa-tutorials"},"routes/$":{"config":{"version":2,"myst":"1.6.4","options":{"outline_maxdepth":1,"favicon":"/irsa-tutorials/build/irsa-favicon-7816ba4985c4c07a3aec6d0bc169a8af.ico","logo":"/irsa-tutorials/build/irsa_logo-bd755426d9f69813fa092c6774d3180f.png"},"nav":[],"actions":[],"projects":[{"subject":"IRSA Tutorials","settings":{"output_matplotlib_strings":"remove"},"title":"IRSA Tutorials","description":"IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)","authors":[{"id":"IRSA Scientists and Developers","name":"IRSA Scientists and Developers"}],"github":"https://github.com/Caltech-IPAC/irsa-tutorials/","keywords":["astronomy"],"thebe":{"binder":{"url":"https://mybinder.org","provider":"github","repo":"https://github.com/Caltech-IPAC/irsa-tutorials/","ref":"HEAD"}},"toc":[{"file":"index.md","title":"IRSA Tutorials"},{"children":[{"file":"tutorials/spherex/spherex_intro.md"},{"file":"tutorials/spherex/spherex_cutouts.md"},{"file":"tutorials/spherex/spherex_psf.md"}],"title":"SPHEREx"},{"children":[{"children":[{"file":"tutorials/euclid_access/Euclid_ERO.md"}],"title":"Euclid Early Release Observations"},{"children":[{"file":"tutorials/euclid_access/1_Euclid_intro_MER_images.md"},{"file":"tutorials/euclid_access/2_Euclid_intro_MER_catalog.md"},{"file":"tutorials/euclid_access/3_Euclid_intro_1D_spectra.md"},{"file":"tutorials/euclid_access/4_Euclid_intro_PHZ_catalog.md"},{"file":"tutorials/euclid_access/5_Euclid_intro_SPE_catalog.md"},{"file":"tutorials/cloud_access/euclid-cloud-access.md"}],"title":"Euclid Quick Release 1"}],"title":"Euclid"},{"children":[{"children":[{"file":"tutorials/irsa-sia-examples/sia_allwise_atlas.md"},{"file":"tutorials/parquet-catalog-demos/wise-allwise-catalog-demo.md"}],"title":"AllWISE"},{"children":[{"file":"tutorials/firefly/NEOWISE_light_curve_demo.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-strategies.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-lightcurves.md"}],"title":"NEOWISE"}],"title":"WISE"},{"children":[{"file":"tutorials/irsa-sia-examples/siav2_seip.md"}],"title":"Spitzer"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_2mass_allsky.md"}],"title":"2MASS"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_cosmos.md"}],"title":"COSMOS"},{"children":[{"children":[{"file":"tutorials/roman_simulations/roman_hlss_number_density.md"}],"title":"Roman HLSS Galaxy Mock Catalog"},{"children":[{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_wideareasurvey.md"},{"file":"tutorials/firefly/OpenUniverse2024Preview_Firefly.md"},{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_timedomainsurvey.md"}],"title":"OpenUniverse 2024"},{"children":[{"file":"tutorials/cosmodc2/cosmoDC2_TAP_access.md"}],"title":"CosmoDC2"}],"title":"Simulated Data"},{"children":[{"file":"tutorials/cloud_access/cloud-access-intro.md"},{"file":"tutorials/parquet-catalog-demos/irsa-hats-with-lsdb.md"},{"file":"tutorials/firefly/SEDs_in_Firefly.md"},{"file":"tutorials/parallelize/Parallelize_Convolution.md"}],"title":"Special Topics"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"SPHEREx"},{"slug":"spherex-intro","title":"Introduction to SPHEREx Spectral Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-cutouts","title":"Download a collection of SPHEREx Spectral Image cutouts as a multi-extension FITS file","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-psf","title":"Understanding and Extracting the PSF Extension in a SPHEREx Cutout","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Euclid"},{"level":2,"title":"Euclid Early Release Observations"},{"slug":"euclid-ero","title":"Exploring Star Clusters in the Euclid ERO Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Euclid Quick Release 1"},{"slug":"euclid-intro-mer-images","title":"Euclid Q1: MER mosaics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-mer-catalog","title":"Euclid Q1: MER catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-1d-spectra","title":"Euclid Q1: 1D spectra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-phz-catalog","title":"Euclid Q1: PHZ catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-spe-catalog","title":"Euclid Q1: SPE catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-cloud-access","title":"Euclid Q1: cloud access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"WISE"},{"level":2,"title":"AllWISE"},{"slug":"sia-allwise-atlas","title":"Searching for AllWISE Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"wise-allwise-catalog-demo","title":"Analyzing cloud-hosted AllWISE Source Catalog in Parquet format","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"NEOWISE"},{"slug":"neowise-light-curve-demo","title":"Using Firefly visualization tools to understand the light curves of Solar System objects","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-strategies","title":"Strategies to Efficiently Work with NEOWISE Single-exposure Source Table in Parquet","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-lightcurves","title":"Make Light Curves from NEOWISE Single-exposure Source Table","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Spitzer"},{"slug":"siav2-seip","title":"Searching for Spitzer Enhanced Imaging Products","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"2MASS"},{"slug":"sia-2mass-allsky","title":"Searching for 2MASS All-Sky Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"COSMOS"},{"slug":"sia-cosmos","title":"Searching for contributed COSMOS images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Simulated Data"},{"level":2,"title":"Roman HLSS Galaxy Mock Catalog"},{"slug":"roman-hlss-number-density","title":"Number Density as a Function of Redshift","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"OpenUniverse 2024"},{"slug":"openuniverse2024-roman-simulated-wideareasurvey","title":"Analyzing cloud-hosted simulated Roman coadded images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024preview-firefly","title":"Using Firefly to Explore OpenUniverse2024 Data Preview Simulated Roman and Rubin Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024-roman-simulated-timedomainsurvey","title":"Analyzing cloud-hosted simulated Roman Time Domain Survey images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"CosmoDC2"},{"slug":"cosmodc2-tap-access","title":"Querying CosmoDC2 Mock v1 catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Special Topics"},{"slug":"cloud-access-intro","title":"IRSA cloud access introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"irsa-hats-with-lsdb","title":"Access HATS Collections Using LSDB: Euclid Q1 and ZTF DR23","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"seds-in-firefly","title":"Using Firefly visualization tools in Python to vet SEDs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"parallelize-convolution","title":"Parallelizing image convolution","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":2,"kind":"Notebook","sha256":"8e10f122cfc32baed49bff8eed029aa816f5eb5f7d06352a3b987e463b6a3289","slug":"euclid-ero","location":"/tutorials/euclid_access/Euclid_ERO.md","dependencies":[],"frontmatter":{"title":"Exploring Star Clusters in the Euclid ERO Data","kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"jupytext":{"formats":"md:myst","text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.16.7"}},"content_includes_title":false,"authors":[{"id":"IRSA Scientists and Developers","name":"IRSA Scientists and Developers"}],"github":"https://github.com/Caltech-IPAC/irsa-tutorials/","subject":"IRSA Tutorials","keywords":["astronomy"],"settings":{"output_matplotlib_strings":"remove"},"numbering":{"title":{"offset":2}},"source_url":"https://github.com/Caltech-IPAC/irsa-tutorials//blob/main/tutorials/euclid_access/Euclid_ERO.md","edit_url":"https://github.com/Caltech-IPAC/irsa-tutorials//edit/main/tutorials/euclid_access/Euclid_ERO.md","exports":[{"format":"md","filename":"Euclid_ERO.md","url":"/irsa-tutorials/build/Euclid_ERO-08212a738341e14f332d0240d8260aba.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Learning Goals","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"AI4P39uTkl"}],"identifier":"learning-goals","label":"Learning Goals","html_id":"learning-goals","implicit":true,"key":"xatIiGfdlA"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"By the end of this tutorial, you will be able to:","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Ts5MteyCdw"}],"key":"vMZTzrhKjP"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"• Access the Euclid ERO images using ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"wJBDtCIZSW"},{"type":"inlineCode","value":"astroquery","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"yOc4qsxRNQ"}],"key":"xZNJQsm3Kh"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"• Create cutouts on the large Euclid ERO images directly","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"vDwtYGdMIm"}],"key":"nCoeyraBsh"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"• Extract sources on the Euclid image and run photometry tools","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"L48nuYjB9d"}],"key":"jICRH07ZZU"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"• Compare photometry to the Gaia catalog","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"B5D23QJpty"}],"key":"Ch4aHS0rex"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"• Visualize the Euclid ERO image and the Gaia catalog in ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"ghXCiTc8fc"},{"type":"inlineCode","value":"Firefly","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"hScmrOKzr1"}],"key":"Q7YW7rBf4i"},{"type":"heading","depth":2,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"qqTFFCVCXH"}],"identifier":"introduction","label":"Introduction","html_id":"introduction","implicit":true,"key":"jPBT7QnUtN"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"Euclid is a European Space Agency (ESA) space mission with NASA participation, to study the geometry and nature of the dark Universe. As part of its first observations, Euclid publicly released so-called ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"PjJTHrtpqr"},{"type":"emphasis","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"Early Release Observations","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"HZQf14V7pF"}],"key":"H9IvbvW8GE"},{"type":"text","value":" (ERO) targeting some press-worthy targets on the sky such as star clusters or local galaxies.","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"C0GDLQpexc"}],"key":"Pyh8o4OMAe"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"In this notebook, we will focus on the ERO data of ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"OAVTQBXBpG"},{"type":"strong","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"NGC 6397","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"UEmWtWmZmV"}],"key":"JLhQheAOeD"},{"type":"text","value":", a globular cluster 78,000 light years away. (Note that there is another globular cluster, ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"pZWz1kPFAk"},{"type":"strong","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"NGC 6254","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"XJIOPQLTdA"}],"key":"xWUiYWyiAH"},{"type":"text","value":" that can also be used for this analysis - in fact the user can choose which one to use) The goal of this analysis is to extract the Euclid photometry of the stars belonging to the cluster and compare them to the photometry of Gaia. Due to the different pixel scales of the visible (VIS, ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"chReUpb7pc"},{"type":"inlineMath","value":"0.1^{\\prime\\prime}","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e0.\u003c/mn\u003e\u003cmsup\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmrow\u003e\u003cmo mathvariant=\"normal\"\u003e′\u003c/mo\u003e\u003cmo mathvariant=\"normal\"\u003e′\u003c/mo\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e0.1^{\\prime\\prime}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7519em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0.\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7519em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e′′\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"oMrDUy2z8Y"},{"type":"text","value":") and near-IR (NISP, ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"hPYBbUemA7"},{"type":"inlineMath","value":"0.3^{\\prime\\prime}","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e0.\u003c/mn\u003e\u003cmsup\u003e\u003cmn\u003e3\u003c/mn\u003e\u003cmrow\u003e\u003cmo mathvariant=\"normal\"\u003e′\u003c/mo\u003e\u003cmo mathvariant=\"normal\"\u003e′\u003c/mo\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e0.3^{\\prime\\prime}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7519em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0.\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e3\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7519em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e′′\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"A3qRLODWdW"},{"type":"text","value":") wavelengths, we will first detect and extract the stars in the VIS filter and use their position to subsequently extract the photometry in the NISP (Y, J, H) filters (a method also referred to as ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"W15PyTog6f"},{"type":"emphasis","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"forced photometry","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"ldoiCpeD4x"}],"key":"Exdn5IUOD4"},{"type":"text","value":").","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"FB9P9gjeqD"}],"key":"JeAjACJPO0"},{"type":"paragraph","position":{"start":{"line":37,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"One challenge with Euclid data is their size due to the large sky coverage and small pixel size.\nThis notebook demonstrates how to download only a cutout of the large Euclid ERO observation image (namely focussing only on the position of the globular cluster. Furthermore, this notebook demonstrates how to extract sources on a large astronomical image and how to measure their photometry across different pixel scales using a very simple implementation of the forced photometry method with positional priors.\nFinally, we also demonstrate how to visualize the Euclid images and catalog in ","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"OtS4ymlMSf"},{"type":"inlineCode","value":"Firefly","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"cTNAaflPpT"},{"type":"text","value":", an open-source web-based UI library for astronomical data archive access and visualization developed at Caltech (","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"v5RCqBtJEJ"},{"type":"link","url":"https://github.com/Caltech-IPAC/firefly","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"https://​github​.com​/Caltech​-IPAC​/firefly","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"yhaRFLJlxh"}],"urlSource":"https://github.com/Caltech-IPAC/firefly","error":true,"key":"BaKXz9LvkI"},{"type":"text","value":"). ","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"wMhmuOuI59"},{"type":"inlineCode","value":"Firefly","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"Pj6d5AWl56"},{"type":"text","value":" is a convenient tool to visualize images similar to DS9 on your local computer, but it can run on a cloud-based science platform.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"yMwyRIe4fS"}],"key":"lst6L7Phxl"},{"type":"paragraph","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"This notebook is written to be used in Fornax which is a cloud based computing platform using AWS. The advantage of this is that the user does not need to download actuall data, hence the analysis of large datasets is not limited by local computing resources. It also allows to access data across all archives fast and easy.","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"Ca7W9Iet5F"}],"key":"vsVuD7bnsG"},{"type":"heading","depth":2,"position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"Data Volume","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"FUlbf2TbzX"}],"identifier":"data-volume","label":"Data Volume","html_id":"data-volume","implicit":true,"key":"layy7W68r7"},{"type":"paragraph","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"The total data volume required for running this notebook is less than 20 MB.","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"i7m67qJIFE"}],"key":"Lami84cc1P"}],"key":"PKMdZNTuPK"},{"type":"block","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"FegV24SFpq"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"P3bSqKneZG"},{"type":"admonition","kind":"important","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Important","key":"PQTIUZwKQ7"}],"key":"TqLxaR8ZSb"},{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"We rely on ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"VrB5xOa60C"},{"type":"inlineCode","value":"astroquery","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"Rr5aItANJf"},{"type":"text","value":", ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"V16ikaxh25"},{"type":"inlineCode","value":"firefly_client","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"PNHukDbbV1"},{"type":"text","value":", ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"QBg0MXXVPW"},{"type":"inlineCode","value":"photutils","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"QghaCIfqYI"},{"type":"text","value":", and ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"uSS0kJB5eE"},{"type":"inlineCode","value":"sep","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"XvZ1vg7cPF"},{"type":"text","value":" features that have been recently added, so please make sure you have the respective versions v0.4.10, v3.2, v2.0, and v1.4 or newer installed.","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"SOCBl1FFEO"}],"key":"i3vmOPJUC4"}],"key":"bQRz6iTz9J"}],"key":"SAjdYEk7qw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Uncomment the next line to install dependencies if needed.\n# !pip install tqdm numpy matplotlib astropy 'photutils\u003e=2.0' 'astroquery\u003e=0.4.10' 'sep\u003e=1.4' 'firefly_client\u003e=3.2'","key":"S5RxAbyYwo"},{"type":"output","id":"81e0g2_w5qbJRbv7BsQ3C","data":[],"key":"wRgP7iScbj"}],"key":"h7jbUFk8ba"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"First, we import all necessary packages.","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"U38fYjwiVm"}],"key":"xHyCtz9g8H"}],"key":"zPu2unTZgO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# General imports\nimport os\nimport numpy as np\nfrom tqdm import tqdm\n\n# Astroquery\nfrom astroquery.ipac.irsa import Irsa\nfrom astroquery.gaia import Gaia\n\n# Astropy\nfrom astropy.coordinates import SkyCoord\nfrom astropy import units as u\nfrom astropy.io import fits\nfrom astropy.nddata import Cutout2D\nfrom astropy.wcs import WCS\nfrom astropy.table import Table\nfrom astropy.stats import sigma_clipped_stats\n\n# Photometry tools\nimport sep\nfrom photutils.detection import DAOStarFinder\nfrom photutils.psf import PSFPhotometry, IterativePSFPhotometry, CircularGaussianSigmaPRF, make_psf_model_image\nfrom photutils.background import LocalBackground, MMMBackground\n\n# Firefly\nfrom firefly_client import FireflyClient\n\n# Matplotlib\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl","key":"aXOaHm2smL"},{"type":"output","id":"GsFTXZ0ObROcrc4Y0J_D7","data":[{"output_type":"stream","name":"stderr","text":"/home/runner/work/irsa-tutorials/irsa-tutorials/.tox/py312-buildhtml/lib/python3.12/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html\n  from .autonotebook import tqdm as notebook_tqdm\n"}],"key":"F9BrZfB4NX"}],"key":"uJ9HdJtmAi"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"text","value":"Next, we define some parameters for ","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"Hg60lrtGEq"},{"type":"inlineCode","value":"Matplotlib","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"wYnzVQuUS4"},{"type":"text","value":" plotting.","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"giYx2mcrtc"}],"key":"LXMIPOvrpQ"}],"key":"LFdk8gKhjI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"## Plotting stuff\nmpl.rcParams['font.size'] = 14\nmpl.rcParams['axes.labelpad'] = 7\nmpl.rcParams['xtick.major.pad'] = 7\nmpl.rcParams['ytick.major.pad'] = 7\nmpl.rcParams['xtick.minor.visible'] = True\nmpl.rcParams['ytick.minor.visible'] = True\nmpl.rcParams['xtick.minor.top'] = True\nmpl.rcParams['xtick.minor.bottom'] = True\nmpl.rcParams['ytick.minor.left'] = True\nmpl.rcParams['ytick.minor.right'] = True\nmpl.rcParams['xtick.major.size'] = 5\nmpl.rcParams['ytick.major.size'] = 5\nmpl.rcParams['xtick.minor.size'] = 3\nmpl.rcParams['ytick.minor.size'] = 3\nmpl.rcParams['xtick.direction'] = 'in'\nmpl.rcParams['ytick.direction'] = 'in'\n#mpl.rc('text', usetex=True)\nmpl.rc('font', family='serif')\nmpl.rcParams['xtick.top'] = True\nmpl.rcParams['ytick.right'] = True\nmpl.rcParams['hatch.linewidth'] = 1\n\ndef_cols = plt.rcParams['axes.prop_cycle'].by_key()['color']","key":"CBPo7Qzn4q"},{"type":"output","id":"bTR-jUXiX8kPhAodbsCms","data":[],"key":"hLABjotwzs"}],"key":"miNiAtLNQr"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"text","value":"Setting up the Environment","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"GnjrtR3nFB"}],"identifier":"setting-up-the-environment","label":"Setting up the Environment","html_id":"setting-up-the-environment","implicit":true,"key":"DdETM6HeLC"},{"type":"paragraph","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"text","value":"Next, we set up the environment. This includes","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"KSB7YP4Fnh"}],"key":"Bestk9Js0G"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":129,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"setting up an output data directory (will be created if it does not exist)","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"dFdM7xAdps"}],"key":"CRfUkZFfl2"}],"key":"tF7Q8kvrk4"},{"type":"listItem","spread":true,"position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"define the search radius around the target of interest to pull data from the Gaia catalog","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"LepI7dQ9we"}],"key":"Ctg6mbfu5p"}],"key":"da3PIwYT1C"},{"type":"listItem","spread":true,"position":{"start":{"line":131,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"define the cutout size that will be used to download a certain part of the Euclid ERO images","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"xk3u5hm6GB"}],"key":"v6j8M7nGKG"}],"key":"uMgclHnPR4"}],"key":"FtjVVnBAay"},{"type":"paragraph","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"Finally, we also define the target of interest here. We can choose between two globular clusters, ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"TtV6xjEFe8"},{"type":"strong","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"NGC 6254","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"wxYxRyW0Po"}],"key":"h3mPJJgiOr"},{"type":"text","value":" and ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"qvkfI4Ip2m"},{"type":"strong","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"NGC6397","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"ZAgRJlM8CS"}],"key":"ZYd69WvjMQ"},{"type":"text","value":", both covered by the Euclid ERO data.","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"n7BLeLB1xX"}],"key":"CPrF93mTyD"},{"type":"paragraph","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"text","value":"Note that ","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"LRBjAhS1vc"},{"type":"inlineCode","value":"astropy","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"EzzVlgDFHs"},{"type":"text","value":" units can be attached to the ","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"si6rQnrRpS"},{"type":"inlineCode","value":"search_radius","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"n0IqTx50qX"},{"type":"text","value":" and ","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"QBkrj8BHDi"},{"type":"inlineCode","value":"cutout_size","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"rDicLlhPop"},{"type":"text","value":".","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"bPhmz6AH1c"}],"key":"ezheKHVr3j"}],"key":"AtI1iwwR0O"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# create output directory\nif os.path.exists(\"./data/\"):\n    print(\"Output directory already created.\")\nelse:\n    print(\"Creating data directory.\")\n    os.mkdir(\"./data/\")\n\nsearch_radius = 1.5 * u.arcmin # search radius\ncutout_size = 1.5 * u.arcmin # cutout size\n\ncoord = SkyCoord.from_name('NGC 6397')","key":"PJ5NQDU89Y"},{"type":"output","id":"-KF-3Wp9B7o1VnmuA00Kb","data":[{"output_type":"stream","name":"stdout","text":"Creating data directory.\n"}],"key":"jOm7GQWqCP"}],"key":"TT1hWM4Ieu"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"text","value":"Search Euclid ERO Images","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"K0sJ6g2VBN"}],"identifier":"search-euclid-ero-images","label":"Search Euclid ERO Images","html_id":"search-euclid-ero-images","implicit":true,"key":"xWAsdkqsvt"},{"type":"paragraph","position":{"start":{"line":153,"column":1},"end":{"line":154,"column":1}},"children":[{"type":"text","value":"Now, we search for the Euclid ERO images using the ","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"fn2QC9eRok"},{"type":"inlineCode","value":"astroquery","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"OK18Mdhby0"},{"type":"text","value":" package.\nNote that the Euclid ERO images are no in the cloud currently, but we access them directly from IRSA using IRSA’s ","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"bRnKYHwaw0"},{"type":"emphasis","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"text","value":"Simple Image Access","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"zsBCRXZD6X"}],"key":"mIOTFJCulK"},{"type":"text","value":" (SIA) methods.","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"wJzxGTYCq1"}],"key":"qZmuXYMZT1"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"EwUbxG46AS"}],"key":"EKE8HNjnLX"},{"type":"paragraph","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"children":[{"type":"text","value":"The following only works for combined images (either extended or point source stacks). This would not work if there are multiple, let’s say, H-band images of Euclid at a given position. Therefore, no time domain studies here (which is anyway not one of the main goals of Euclid).","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"key":"UbRwzsR6YQ"}],"key":"s38rSVd8jD"}],"key":"Rc0nnevS4h"},{"type":"comment","value":"The IRSA SIA products can be listed via\n ```\n Irsa.list_collections(servicetype='SIA')\n ```","position":{"start":{"line":160,"column":1},"end":{"line":163,"column":1}},"key":"o32FRT3hF7"},{"type":"paragraph","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"text","value":"Here we use the collection ","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"YS55vdEW54"},{"type":"emphasis","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"text","value":"euclid_ero","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"Huytu3nB8s"}],"key":"LIy67Ci1Xw"},{"type":"text","value":", containing the Euclid ERO images. We first create a ","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"XdFr6NYVVh"},{"type":"inlineCode","value":"SkyCoord","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"AH0fPmuypg"},{"type":"text","value":" object and then query the SIA.","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"HkOSMbi9WT"}],"key":"mRUSlL4UW0"}],"key":"Lm6EO4gv9d"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"image_tab = Irsa.query_sia(pos=(coord, search_radius), collection='euclid_ero')\nprint(\"Number of images available: {}\".format(len(image_tab)))","key":"sN3rTN0zJ1"},{"type":"output","id":"0XP8r4F37lj1ITIwLcJxX","data":[{"output_type":"stream","name":"stdout","text":"Number of images available: 25\n"}],"key":"tWJ6kT5JDj"}],"key":"zJpXeIhK1Z"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"children":[{"type":"text","value":"Sort the queried table by wavelength (column ","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"POgOqCH3cR"},{"type":"inlineCode","value":"em_min","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"X2Q23ac8nr"},{"type":"text","value":"). This allows us later when we plot the images to keep them sorted by wavelength (VIS, Y, J, H).","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"TBsejeYG6e"}],"key":"VnMw5aybQ3"}],"key":"r3aOxGlehh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"image_tab.sort('em_min')","key":"mFec0PNC5p"},{"type":"output","id":"Zp8Jb46GSh0aLw-E9chJu","data":[],"key":"OtD64xtMN9"}],"key":"soI1p7BdA7"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"children":[{"type":"text","value":"Let’s inspec the table that was downloaded.","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"ipSH3ZBC5z"}],"key":"XiBozVmX7y"}],"key":"BvE1rofjPQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"image_tab[0:3]","key":"IaFviuXqE6"},{"type":"output","id":"hCi70RXvS7rGTeCcUE6BM","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"\u003cTable length=3\u003e\n    s_ra       s_dec    facility_name ... cloud_access o_ucd  upload_row_id\n    deg         deg                   ...                                  \n  float64     float64       object    ...    object    object     int64    \n----------- ----------- ------------- ... ------------ ------ -------------\n265.1744234 -53.6588139        Euclid ...           {}                    1\n265.1744234 -53.6588139        Euclid ...           {}                    1\n265.1744234 -53.6588139        Euclid ...           {}                    1","content_type":"text/plain"},"text/html":{"content":"\u003cdiv\u003e\u003ci\u003eTable length=3\u003c/i\u003e\n\u003ctable id=\"table140099201773696\" class=\"table-striped table-bordered table-condensed\"\u003e\n\u003cthead\u003e\u003ctr\u003e\u003cth\u003es_ra\u003c/th\u003e\u003cth\u003es_dec\u003c/th\u003e\u003cth\u003efacility_name\u003c/th\u003e\u003cth\u003einstrument_name\u003c/th\u003e\u003cth\u003edataproduct_subtype\u003c/th\u003e\u003cth\u003ecalib_level\u003c/th\u003e\u003cth\u003edataproduct_type\u003c/th\u003e\u003cth\u003eenergy_bandpassname\u003c/th\u003e\u003cth\u003eenergy_emband\u003c/th\u003e\u003cth\u003eobs_id\u003c/th\u003e\u003cth\u003es_resolution\u003c/th\u003e\u003cth\u003eem_min\u003c/th\u003e\u003cth\u003eem_max\u003c/th\u003e\u003cth\u003eem_res_power\u003c/th\u003e\u003cth\u003eproposal_title\u003c/th\u003e\u003cth\u003eaccess_url\u003c/th\u003e\u003cth\u003eaccess_format\u003c/th\u003e\u003cth\u003eaccess_estsize\u003c/th\u003e\u003cth\u003et_exptime\u003c/th\u003e\u003cth\u003es_region\u003c/th\u003e\u003cth\u003eobs_collection\u003c/th\u003e\u003cth\u003eobs_intent\u003c/th\u003e\u003cth\u003ealgorithm_name\u003c/th\u003e\u003cth\u003efacility_keywords\u003c/th\u003e\u003cth\u003einstrument_keywords\u003c/th\u003e\u003cth\u003eenvironment_photometric\u003c/th\u003e\u003cth\u003eproposal_id\u003c/th\u003e\u003cth\u003eproposal_pi\u003c/th\u003e\u003cth\u003eproposal_project\u003c/th\u003e\u003cth\u003etarget_name\u003c/th\u003e\u003cth\u003etarget_type\u003c/th\u003e\u003cth\u003etarget_standard\u003c/th\u003e\u003cth\u003etarget_moving\u003c/th\u003e\u003cth\u003etarget_keywords\u003c/th\u003e\u003cth\u003eobs_release_date\u003c/th\u003e\u003cth\u003es_xel1\u003c/th\u003e\u003cth\u003es_xel2\u003c/th\u003e\u003cth\u003es_pixel_scale\u003c/th\u003e\u003cth\u003eposition_timedependent\u003c/th\u003e\u003cth\u003et_min\u003c/th\u003e\u003cth\u003et_max\u003c/th\u003e\u003cth\u003et_resolution\u003c/th\u003e\u003cth\u003et_xel\u003c/th\u003e\u003cth\u003eobs_publisher_did\u003c/th\u003e\u003cth\u003es_fov\u003c/th\u003e\u003cth\u003eem_xel\u003c/th\u003e\u003cth\u003epol_states\u003c/th\u003e\u003cth\u003epol_xel\u003c/th\u003e\u003cth\u003ecloud_access\u003c/th\u003e\u003cth\u003eo_ucd\u003c/th\u003e\u003cth\u003eupload_row_id\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\n\u003cthead\u003e\u003ctr\u003e\u003cth\u003edeg\u003c/th\u003e\u003cth\u003edeg\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003earcsec\u003c/th\u003e\u003cth\u003em\u003c/th\u003e\u003cth\u003em\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003ekbyte\u003c/th\u003e\u003cth\u003es\u003c/th\u003e\u003cth\u003edeg\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003earcsec\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003ed\u003c/th\u003e\u003cth\u003ed\u003c/th\u003e\u003cth\u003es\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003edeg\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003cth\u003e\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\n\u003cthead\u003e\u003ctr\u003e\u003cth\u003efloat64\u003c/th\u003e\u003cth\u003efloat64\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eint16\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003efloat64\u003c/th\u003e\u003cth\u003efloat64\u003c/th\u003e\u003cth\u003efloat64\u003c/th\u003e\u003cth\u003efloat64\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eint64\u003c/th\u003e\u003cth\u003efloat64\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003ebool\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003ebool\u003c/th\u003e\u003cth\u003ebool\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eint64\u003c/th\u003e\u003cth\u003eint64\u003c/th\u003e\u003cth\u003efloat64\u003c/th\u003e\u003cth\u003ebool\u003c/th\u003e\u003cth\u003efloat64\u003c/th\u003e\u003cth\u003efloat64\u003c/th\u003e\u003cth\u003efloat64\u003c/th\u003e\u003cth\u003eint64\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003efloat64\u003c/th\u003e\u003cth\u003eint64\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eint64\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eobject\u003c/th\u003e\u003cth\u003eint64\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\n\u003ctr\u003e\u003ctd\u003e265.1744234\u003c/td\u003e\u003ctd\u003e-53.6588139\u003c/td\u003e\u003ctd\u003eEuclid\u003c/td\u003e\u003ctd\u003eVIS\u003c/td\u003e\u003ctd\u003escience\u003c/td\u003e\u003ctd\u003e3\u003c/td\u003e\u003ctd\u003eimage\u003c/td\u003e\u003ctd\u003eVIS\u003c/td\u003e\u003ctd\u003eOptical\u003c/td\u003e\u003ctd\u003eVIS-ERO-NGC6397\u003c/td\u003e\u003ctd\u003e0.16\u003c/td\u003e\u003ctd\u003e5.5e-07\u003c/td\u003e\u003ctd\u003e9e-07\u003c/td\u003e\u003ctd\u003e2.1\u003c/td\u003e\u003ctd\u003eEuclid Early Release Observations\u003c/td\u003e\u003ctd\u003ehttps://irsa.ipac.caltech.edu/data/Euclid/ERO/images/NGC6397/ERO-NGC6397/Euclid-VIS-ERO-NGC6397-LSB.DR3.fits\u003c/td\u003e\u003ctd\u003eimage/fits\u003c/td\u003e\u003ctd\u003e5184015\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003ePOLYGON ICRS 266.0282156 -54.1557675 266.0082 -53.1559013 264.3406 -53.1559013 264.3205844 -54.1557675 266.0282156 -54.1557675\u003c/td\u003e\u003ctd\u003eeuclid_ero\u003c/td\u003e\u003ctd\u003escience\u003c/td\u003e\u003ctd\u003ecoadd\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003eEuclid\u003c/td\u003e\u003ctd\u003eNGC 6397\u003c/td\u003e\u003ctd\u003eobject\u003c/td\u003e\u003ctd\u003eFalse\u003c/td\u003e\u003ctd\u003eFalse\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003e2024-05-23 00:00:00\u003c/td\u003e\u003ctd\u003e36000\u003c/td\u003e\u003ctd\u003e36000\u003c/td\u003e\u003ctd\u003e0.1000000000008\u003c/td\u003e\u003ctd\u003eFalse\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003eivo://irsa.ipac/euclid_ero?VIS-ERO-NGC6397/LSB\u003c/td\u003e\u003ctd\u003e1.000000000008\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003e{}\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003e1\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e265.1744234\u003c/td\u003e\u003ctd\u003e-53.6588139\u003c/td\u003e\u003ctd\u003eEuclid\u003c/td\u003e\u003ctd\u003eVIS\u003c/td\u003e\u003ctd\u003eweight\u003c/td\u003e\u003ctd\u003e3\u003c/td\u003e\u003ctd\u003eimage\u003c/td\u003e\u003ctd\u003eVIS\u003c/td\u003e\u003ctd\u003eOptical\u003c/td\u003e\u003ctd\u003eVIS-ERO-NGC6397\u003c/td\u003e\u003ctd\u003e0.16\u003c/td\u003e\u003ctd\u003e5.5e-07\u003c/td\u003e\u003ctd\u003e9e-07\u003c/td\u003e\u003ctd\u003e2.1\u003c/td\u003e\u003ctd\u003eEuclid Early Release Observations\u003c/td\u003e\u003ctd\u003ehttps://irsa.ipac.caltech.edu/data/Euclid/ERO/images/NGC6397/ERO-NGC6397/Euclid-VIS-ERO-NGC6397-Flattened.DR3.weight.fits\u003c/td\u003e\u003ctd\u003eimage/fits\u003c/td\u003e\u003ctd\u003e5184009\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003ePOLYGON ICRS 266.0282156 -54.1557675 266.0082 -53.1559013 264.3406 -53.1559013 264.3205844 -54.1557675 266.0282156 -54.1557675\u003c/td\u003e\u003ctd\u003eeuclid_ero\u003c/td\u003e\u003ctd\u003escience\u003c/td\u003e\u003ctd\u003ecoadd\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003eEuclid\u003c/td\u003e\u003ctd\u003eNGC 6397\u003c/td\u003e\u003ctd\u003eobject\u003c/td\u003e\u003ctd\u003eFalse\u003c/td\u003e\u003ctd\u003eFalse\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003e2024-05-23 00:00:00\u003c/td\u003e\u003ctd\u003e36000\u003c/td\u003e\u003ctd\u003e36000\u003c/td\u003e\u003ctd\u003e0.1000000000008\u003c/td\u003e\u003ctd\u003eFalse\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003eivo://irsa.ipac/euclid_ero?VIS-ERO-NGC6397/Flattened\u003c/td\u003e\u003ctd\u003e1.000000000008\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003e{}\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003e1\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e265.1744234\u003c/td\u003e\u003ctd\u003e-53.6588139\u003c/td\u003e\u003ctd\u003eEuclid\u003c/td\u003e\u003ctd\u003eVIS\u003c/td\u003e\u003ctd\u003eauxiliary\u003c/td\u003e\u003ctd\u003e3\u003c/td\u003e\u003ctd\u003eimage\u003c/td\u003e\u003ctd\u003eVIS\u003c/td\u003e\u003ctd\u003eOptical\u003c/td\u003e\u003ctd\u003eVIS-ERO-NGC6397\u003c/td\u003e\u003ctd\u003e0.16\u003c/td\u003e\u003ctd\u003e5.5e-07\u003c/td\u003e\u003ctd\u003e9e-07\u003c/td\u003e\u003ctd\u003e2.1\u003c/td\u003e\u003ctd\u003eEuclid Early Release Observations\u003c/td\u003e\u003ctd\u003ehttps://irsa.ipac.caltech.edu/data/Euclid/ERO/images/NGC6397/ERO-NGC6397/Euclid-VIS-Mask-ERO-NGC6397-LSB.DR3.fits\u003c/td\u003e\u003ctd\u003eimage/fits\u003c/td\u003e\u003ctd\u003e5184006\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003ePOLYGON ICRS 266.0282156 -54.1557675 266.0082 -53.1559013 264.3406 -53.1559013 264.3205844 -54.1557675 266.0282156 -54.1557675\u003c/td\u003e\u003ctd\u003eeuclid_ero\u003c/td\u003e\u003ctd\u003escience\u003c/td\u003e\u003ctd\u003ecoadd\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003eEuclid\u003c/td\u003e\u003ctd\u003eNGC 6397\u003c/td\u003e\u003ctd\u003eobject\u003c/td\u003e\u003ctd\u003eFalse\u003c/td\u003e\u003ctd\u003eFalse\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003e2024-05-23 00:00:00\u003c/td\u003e\u003ctd\u003e36000\u003c/td\u003e\u003ctd\u003e36000\u003c/td\u003e\u003ctd\u003e0.1000000000008\u003c/td\u003e\u003ctd\u003eFalse\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003eivo://irsa.ipac/euclid_ero?VIS-ERO-NGC6397/LSB\u003c/td\u003e\u003ctd\u003e1.000000000008\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003e--\u003c/td\u003e\u003ctd\u003e{}\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003e1\u003c/td\u003e\u003c/tr\u003e\n\u003c/table\u003e\u003c/div\u003e","content_type":"text/html"}}}],"key":"WgLdwoUELj"}],"key":"h4mxrkG7mx"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"children":[{"type":"text","value":"Next, we add additional restrictions to narrow down the images.","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"ah2wu8l2es"}],"key":"L6h9TeYgrv"},{"type":"paragraph","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"text","value":"The Euclid ERO images come in two different flavors:","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"hTSEkiDxxa"}],"key":"BsN6aldibV"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":187,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"children":[{"type":"paragraph","children":[{"type":"emphasis","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"children":[{"type":"text","value":"Flattened","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"ZjDoij7ATt"}],"key":"klDjOFUHqN"},{"type":"text","value":" images: idealized for compact sources (for example stars)","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"wkknfyuRXc"}],"key":"QvQUZURCVn"}],"key":"IZ5xHDubER"},{"type":"listItem","spread":true,"position":{"start":{"line":188,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"paragraph","children":[{"type":"emphasis","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"text","value":"LSB","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"muQAH5wQzj"}],"key":"NLkN71aL5F"},{"type":"text","value":" images: idealized for low surface brightness objects (for example galaxies)","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"Kos40r0ngN"}],"key":"Y9k4qihA0E"}],"key":"D4NZj1xCbk"}],"key":"GQhc6xnRxn"},{"type":"paragraph","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"children":[{"type":"text","value":"Maybe counter-intuitively, we select the ","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"eFRIxj2hOS"},{"type":"emphasis","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"children":[{"type":"text","value":"LSB","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"QzySjQEUhb"}],"key":"Sz9Yui80xw"},{"type":"text","value":" images here by checking if the file name given in the URL (","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"f5GqyMa0wR"},{"type":"inlineCode","value":"access_url","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"E6iHEzYTSL"},{"type":"text","value":" column) contains that key word. We found that the ","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"g8MxGN4eAX"},{"type":"emphasis","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"children":[{"type":"text","value":"Flattened","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"ypB8RV0tlU"}],"key":"nlDvp7zvRm"},{"type":"text","value":" images contain many masked pixels.","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"O85B81S6S0"}],"key":"SgOjnmKnaA"}],"key":"o9qIwCHVCY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#sel_basic = np.where( [\"Flattened\" in tt[\"access_url\"] for tt in image_tab] )[0]\nsel_basic = np.where( [\"LSB\" in tt[\"access_url\"] for tt in image_tab] )[0]\nimage_tab = image_tab[sel_basic]","key":"N5Ekdi8nHA"},{"type":"output","id":"OvYaMegG8t5FVqQIf0D1N","data":[],"key":"YyHjlgiNyi"}],"key":"ibmlMxPyZJ"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"Next, we want to check what filteres are available. This can be done by ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"OeHF2sEH9R"},{"type":"inlineCode","value":"np.unique()","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"ozatwd6LAK"},{"type":"text","value":", however, in that case it would sort the filters alphabetically. We want to keep the sorting based on the wavelength, therefore we opt for a more complicated way.","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"ZWUQTgxLYJ"}],"key":"StUbALf8eT"}],"key":"ftcPei6Zsa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"idxs = np.unique(image_tab[\"energy_bandpassname\"], return_index=True)[1]\nfilters = [image_tab[\"energy_bandpassname\"][idx] for idx in sorted(idxs)]\nprint(\"Filters: {}\".format(filters))","key":"hj0xP1LdGl"},{"type":"output","id":"OL9QTJNa1eFJERMDBpUQa","data":[{"output_type":"stream","name":"stdout","text":"Filters: ['VIS', 'Y', 'J', 'H']\n"}],"key":"jpxEW9gLjA"}],"key":"inUFkn5HpL"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"children":[{"type":"text","value":"We can now loop throught the filters and collect the images to create a handy summary table with all the data we have. This way we will have an easier time to later access the data.","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"wB6hTZWLmE"}],"key":"xqAvQA1dhr"}],"key":"ah99hdP7MV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create a dictionary with all the necessary information (science, weight, noise, mask)\nsummary_table = Table(names=[\"filter\",\"products\",\"facility_name\",\"instrument_name\"] , dtype=[str,str,str,str])\nfor filt in filters:\n    sel = np.where(image_tab['energy_bandpassname'] == filt)[0]\n    products = list( np.unique(image_tab[\"dataproduct_subtype\"][sel].value) )\n    if \"science\" in products: # sort so that science is the first in the list. This is the order we create the hdu extensions\n        products.remove(\"science\")\n        products.insert(0,\"science\")\n    else:\n        print(\"WARNING: no science image found!\")\n    print(products)\n\n    summary_table.add_row( [filt , \";\".join(products), str(np.unique(image_tab[\"facility_name\"][sel].value)[0]), str(np.unique(image_tab[\"instrument_name\"][sel].value)[0])] )","key":"JjZQHLeyEC"},{"type":"output","id":"XH06FABQ2gOanVJ4GbK7V","data":[{"output_type":"stream","name":"stdout","text":"['science', 'auxiliary']\n['science', 'auxiliary']\n['science', 'auxiliary']\n['science', 'auxiliary']\n"}],"key":"Qf7ZzUYlxU"}],"key":"Dh07421LVw"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"children":[{"type":"text","value":"Let’s check out the summary table that we have created. We see that we have all the 4 Euclid bands and what data products are available for each of them.","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"XjR6pxprRL"}],"key":"IjNqfQtjam"}],"key":"XfVXUMasHb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"summary_table","key":"r9xyMQyKL3"},{"type":"output","id":"IKiW_HVJ4otaqMmqMXMW9","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"\u003cTable length=4\u003e\nfilter      products     facility_name instrument_name\n str3        str17            str6           str4     \n------ ----------------- ------------- ---------------\n   VIS science;auxiliary        Euclid             VIS\n     Y science;auxiliary        Euclid            NISP\n     J science;auxiliary        Euclid            NISP\n     H science;auxiliary        Euclid            NISP","content_type":"text/plain"},"text/html":{"content":"\u003cdiv\u003e\u003ci\u003eTable length=4\u003c/i\u003e\n\u003ctable id=\"table140099197501072\" class=\"table-striped table-bordered table-condensed\"\u003e\n\u003cthead\u003e\u003ctr\u003e\u003cth\u003efilter\u003c/th\u003e\u003cth\u003eproducts\u003c/th\u003e\u003cth\u003efacility_name\u003c/th\u003e\u003cth\u003einstrument_name\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\n\u003cthead\u003e\u003ctr\u003e\u003cth\u003estr3\u003c/th\u003e\u003cth\u003estr17\u003c/th\u003e\u003cth\u003estr6\u003c/th\u003e\u003cth\u003estr4\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\n\u003ctr\u003e\u003ctd\u003eVIS\u003c/td\u003e\u003ctd\u003escience;auxiliary\u003c/td\u003e\u003ctd\u003eEuclid\u003c/td\u003e\u003ctd\u003eVIS\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003eY\u003c/td\u003e\u003ctd\u003escience;auxiliary\u003c/td\u003e\u003ctd\u003eEuclid\u003c/td\u003e\u003ctd\u003eNISP\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003eJ\u003c/td\u003e\u003ctd\u003escience;auxiliary\u003c/td\u003e\u003ctd\u003eEuclid\u003c/td\u003e\u003ctd\u003eNISP\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003eH\u003c/td\u003e\u003ctd\u003escience;auxiliary\u003c/td\u003e\u003ctd\u003eEuclid\u003c/td\u003e\u003ctd\u003eNISP\u003c/td\u003e\u003c/tr\u003e\n\u003c/table\u003e\u003c/div\u003e","content_type":"text/html"}}}],"key":"XSRYvo9feB"}],"key":"nOECUknzIh"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"children":[{"type":"text","value":"Create Cutout Images","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"LVjKGBqGJ6"}],"identifier":"create-cutout-images","label":"Create Cutout Images","html_id":"create-cutout-images","implicit":true,"key":"o03mi1q0bd"},{"type":"paragraph","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"children":[{"type":"text","value":"Now that we have a list of data products, we can create the cutouts. This is important as the full Euclid ERO images would be too large to run extraction and photometry software on them (they would simply fail due to memory issues).","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"key":"g2CzpUndey"}],"key":"HvxazX9uNC"},{"type":"paragraph","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"children":[{"type":"text","value":"For each image, we create a cutout around the target of interest, using the ","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"KIFfH1knGB"},{"type":"inlineCode","value":"cutout_size","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"CjZPo6QwlJ"},{"type":"text","value":" defined above. The cutouts are then collected into HDUs. That way we can easily access the different data products. Note that we only use the ","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"F44fBrMbxa"},{"type":"emphasis","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"children":[{"type":"text","value":"science","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"YrLsLRAByS"}],"key":"jDk6hHHk9V"},{"type":"text","value":" products as the ","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"c9dEs0JAFn"},{"type":"emphasis","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"children":[{"type":"text","value":"ancillary","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"wWVXtuZTJy"}],"key":"DTP2DNhfE1"},{"type":"text","value":" products are not needed.","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"bkNcOA7K7w"}],"key":"k9fyWPb5JT"},{"type":"paragraph","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"children":[{"type":"text","value":"We save the HDU to disk as it will be later used when we visualize the Euclid ERO FITS images in ","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"XokaNfnFSd"},{"type":"inlineCode","value":"Firefly","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"VDb3J54BhI"},{"type":"text","value":".","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"XsfI4xijYu"}],"key":"vb7QWlRxy5"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"OwgoiOujJV"}],"key":"t6sui9qdlN"},{"type":"paragraph","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"children":[{"type":"text","value":"You will notice that ","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"key":"OK2bFRkYGs"},{"type":"inlineCode","value":"Cutout2D","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"key":"nxDmDiV4FC"},{"type":"text","value":" can be applied to an URL. That way, it we do not need to download the full image to create a cutout. This is a useful trick to keep in mind when analyzing large images. This makes creating cutout images very fast.","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"key":"eFcPOLP9Zk"}],"key":"e8Mweg3hKS"}],"key":"bH32noxI2J"}],"key":"SArmE9DdO9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nfor ii,filt in tqdm(enumerate(filters)):\n    products = summary_table[summary_table[\"filter\"] == filt][\"products\"][0].split(\";\")\n\n    for product in products:\n        sel = np.where( (image_tab[\"energy_bandpassname\"] == filt) \u0026 (image_tab[\"dataproduct_subtype\"] == product) )[0]\n\n        with fits.open(image_tab['access_url'][sel[0]], use_fsspec=True) as hdul:\n            tmp = Cutout2D(hdul[0].section, position=coord, size=cutout_size, wcs=WCS(hdul[0].header)) # create cutout\n\n\n            if (product == \"science\") \u0026 (ii == 0): # if science image, then create a new hdu.\n                hdu0 = fits.PrimaryHDU(data = tmp.data, header=hdul[0].header)\n                hdu0.header.update(tmp.wcs.to_header()) # update header with WCS info\n                hdu0.header[\"EXTNAME\"] = \"{}_{}\".format(filt,product.upper())\n                hdu0.header[\"PRODUCT\"] = product.upper()\n                hdu0.header[\"FILTER\"] = filt.upper()\n                hdulcutout = fits.HDUList([hdu0])\n            elif (product == \"science\") \u0026 (ii \u003e 0):\n                hdu = fits.ImageHDU(data = tmp.data, header=hdul[0].header)\n                hdu.header.update(tmp.wcs.to_header()) # update header with WCS info\n                hdu.header[\"EXTNAME\"] = \"{}_{}\".format(filt,product.upper())\n                hdu.header[\"PRODUCT\"] = product.upper()\n                hdu.header[\"FILTER\"] = filt.upper()\n                hdulcutout.append(hdu)\n\n## Save the HDUL cube:\nhdulcutout.writeto(\"./data/euclid_images_test.fits\", overwrite=True)","key":"Ad77K2xgVD"},{"type":"output","id":"oQDCX5GsZHkgB7_G5hqI_","data":[{"output_type":"stream","name":"stderr","text":"\r0it [00:00, ?it/s]"},{"output_type":"stream","name":"stderr","text":"\r1it [00:17, 17.56s/it]"},{"output_type":"stream","name":"stderr","text":"\r2it [00:19,  8.38s/it]"},{"output_type":"stream","name":"stderr","text":"\r3it [00:22,  5.85s/it]"},{"output_type":"stream","name":"stderr","text":"\r4it [00:24,  4.25s/it]"},{"output_type":"stream","name":"stderr","text":"\r4it [00:24,  6.04s/it]"},{"output_type":"stream","name":"stdout","text":"CPU times: user 1.68 s, sys: 454 ms, total: 2.14 s\nWall time: 24.3 s\n"},{"output_type":"stream","name":"stderr","text":"\n"}],"key":"Qz8Xx52p2e"}],"key":"LEQt1q5Xoe"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"text","value":"Let’s look at the HDU that we created to check what information we have. You see that all filters are collected in different extensions. Also note the different dimensions of the FITS layers as the pixel scale of VIS and NISP are different.","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"OzB7rS0spk"}],"key":"nzQV4OPL58"}],"key":"ETvzEcznHo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"hdulcutout.info()","key":"J2GoFF9M6z"},{"type":"output","id":"WPKKKx0Cj98hu2oVfNa0B","data":[{"output_type":"stream","name":"stdout","text":"Filename: (No file associated with this HDUList)\nNo.    Name      Ver    Type      Cards   Dimensions   Format\n  0  VIS_SCIENCE    1 PrimaryHDU     190   (900, 900)   float32   \n  1  Y_SCIENCE     1 ImageHDU       191   (300, 300)   float32   \n  2  J_SCIENCE     1 ImageHDU       191   (300, 300)   float32   \n  3  H_SCIENCE     1 ImageHDU       191   (300, 300)   float32   \n"}],"key":"DVMqRZa7Cm"}],"key":"PbuH4X40on"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"children":[{"type":"text","value":"We can now plot the image cutouts that we generated. The globular cluster is clearly visible.","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"Nx5OXgFpae"}],"key":"piPCLQ6ov9"}],"key":"id8Fgs17yg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"nimages = len(filters) # number of images\nncols = int(4) # number of columns\nnrows = int( nimages // ncols ) # number of rows\n\nfig = plt.figure(figsize = (5*ncols,5*nrows) )\naxs = [fig.add_subplot(nrows,ncols,ii+1) for ii in range(nimages)]\n\nfor ii,filt in enumerate(filters):\n    img = hdulcutout[\"{}_SCIENCE\".format(filt)].data\n    axs[ii].imshow(img , origin=\"lower\")\n    axs[ii].text(0.05,0.05 , \"{} ({}/{})\".format(summary_table[\"facility_name\"][ii],summary_table[\"instrument_name\"][ii],filt) , fontsize=14 , color=\"white\",\n                 va=\"bottom\", ha=\"left\" , transform=axs[ii].transAxes)\n\nplt.show()","key":"w1a4fSyP3v"},{"type":"output","id":"pRsSYaZdG6N91zVRzGI0l","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 2000x500 with 4 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"8a9efd35bd69fb89255c3f362485d5f6","path":"/irsa-tutorials/build/8a9efd35bd69fb89255c3f362485d5f6.png"}}}],"key":"kuxaqzYPkv"}],"key":"Cc2wmCizMZ"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"children":[{"type":"text","value":"Extract Sources and Measure their Photometry on the VIS Image","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"jI78MMrWXs"}],"identifier":"extract-sources-and-measure-their-photometry-on-the-vis-image","label":"Extract Sources and Measure their Photometry on the VIS Image","html_id":"extract-sources-and-measure-their-photometry-on-the-vis-image","implicit":true,"key":"Nx1N5ty1x7"},{"type":"paragraph","position":{"start":{"line":300,"column":1},"end":{"line":301,"column":1}},"children":[{"type":"text","value":"Now that we have the images in memory (and on disk - but we do not need them, yet), we can measure the fluxes of the individual stars.\nOur simple photometry pipeline has different parts:","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"LH7kolq4OE"}],"key":"gChhEoMhgM"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":303,"column":1},"end":{"line":306,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"First, we are using the Python package ","position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"key":"vim3JsYuY7"},{"type":"inlineCode","value":"sep","position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"key":"kWc60IJDpI"},{"type":"text","value":" (similar to SExtractor) to extract the position of the sources. We do that on the VIS image, which provides the highest resolution.","position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"key":"PFDiSOGG3m"}],"key":"GVaNb77nhf"}],"key":"dj0SuFOKCK"},{"type":"listItem","spread":true,"position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Second, we use ","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"zgolLD9Jc2"},{"type":"inlineCode","value":"sep","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"AJwa8L56CO"},{"type":"text","value":" to perform aperture measurements of the photometry. We will use that to compare the obtained fluxes to our forced photometry method","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"Lw30qFftjx"}],"key":"WSc9ocSE4I"}],"key":"uRFoLSEhl5"},{"type":"listItem","spread":true,"position":{"start":{"line":305,"column":1},"end":{"line":306,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Third, we apply a PSF fitting technique (using the ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"AtLg7DIrMN"},{"type":"inlineCode","value":"photutils","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"rNASbS20jc"},{"type":"text","value":" Python package) to improve the photometry measurement","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"vAXeW1qoZh"}],"key":"fPv5i8re4s"}],"key":"oxAGNWCsWu"}],"key":"rHjEmDeAcj"}],"key":"tzulfzNrMU"},{"type":"block","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"children":[{"type":"text","value":"We start by extracting the sources using ","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"d4NI0tDJbx"},{"type":"inlineCode","value":"sep","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"xedkuHdaWF"},{"type":"text","value":". We first isolate the data that we want to look at (the VIS image only).","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"T7lddlbFTJ"}],"key":"gTjCl9DzmL"}],"key":"xUan9lIwiA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"## Get Data (this will be replaced later)\nimg = hdulcutout[\"VIS_SCIENCE\"].data\nhdr = hdulcutout[\"VIS_SCIENCE\"].header\nimg[img == 0] = np.nan","key":"vDUbvmgx1x"},{"type":"output","id":"K1_qsrcuIrHmCNP7kYLX5","data":[],"key":"XPglspvLkT"}],"key":"goSommZPbn"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"children":[{"type":"text","value":"There are some NaN value on the image that we need to mask out. For this we create a mask image that we later feed to ","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"usqRI8p764"},{"type":"inlineCode","value":"sep","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"U1X9Vt5jdw"},{"type":"text","value":".","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"lGguF57dBf"}],"key":"TNmjnhvEbh"}],"key":"kUq5Ulwm9L"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mask = np.isnan(img)","key":"aOWhSPThQ6"},{"type":"output","id":"dbyTElOggkBPJqJOAQB9s","data":[],"key":"L53Vh1KE2h"}],"key":"UAZYMbOALD"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"children":[{"type":"text","value":"Next, we compute the background statistics what will be used by ","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"h4xWmP0gsJ"},{"type":"inlineCode","value":"sep","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"w7rFgAcves"},{"type":"text","value":" to extract the sources above a certain threshold.","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"igevEphWXC"}],"key":"kq0HrjGb9z"}],"key":"zpkNlf6Oye"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mean, median, std = sigma_clipped_stats(img, sigma=3.0)\nprint(np.array((mean, median, std)))","key":"n87EOz2Xy4"},{"type":"output","id":"5vp9NLiCeR0nvoFkqAg90","data":[{"output_type":"stream","name":"stdout","text":"[135.95871  99.62191 100.63356]\n"},{"output_type":"stream","name":"stderr","text":"WARNING: Input data contains invalid values (NaNs or infs), which were automatically clipped. [astropy.stats.sigma_clipping]\n"}],"key":"EPJPbAnT5t"}],"key":"B4KCVpOLhf"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"children":[{"type":"text","value":"Finally, we perform object detection with ","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"OjOKkixIlj"},{"type":"inlineCode","value":"sep","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"Z7N9XBIaKf"},{"type":"text","value":". There are also modules in ","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"F8kpbrQOS2"},{"type":"inlineCode","value":"photutils","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"nQG9L67cfG"},{"type":"text","value":" to do that, however, we found that ","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"EC6WA68o2y"},{"type":"inlineCode","value":"sep","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"forebwsiKC"},{"type":"text","value":" works best here. We output the number of objects found on the image.","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"eXrvYN3sQU"}],"key":"fyMlZPiYMZ"}],"key":"C0pVuH6ORn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"objects = sep.extract(img-median, thresh=1.2, err=std, minarea=3, mask=mask, deblend_cont=0.0002, deblend_nthresh=64 )\nprint(\"Number of sources extracted: \", len(objects))","key":"XCCbXUCe9X"},{"type":"output","id":"Z59FHTzh8OJsQbdbd4FRl","data":[{"output_type":"stream","name":"stdout","text":"Number of sources extracted:  2759\n"}],"key":"z755xcpIFb"}],"key":"RbVg1uRyqG"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"children":[{"type":"text","value":"Next, we perform simple aperture photometry on the detected sources. Again, we use the ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"UXiUiK5yQ4"},{"type":"inlineCode","value":"sep","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"jkqi4r2Sf8"},{"type":"text","value":" package for this. We will use these aperture photometry later to compare to the PSF photometry.","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"hopWJTCUll"}],"key":"FiqrjmsMmK"}],"key":"M7oZa9rQ0z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"flux, fluxerr, flag = sep.sum_circle(img-median, objects['x'], objects['y'],r=3.0, err=std, gain=1.0)","key":"arEVrw09y9"},{"type":"output","id":"RjXaldFRtXapvjvxLWtoQ","data":[],"key":"dfmLKneeZv"}],"key":"JJjE8gzVbY"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"children":[{"type":"text","value":"Now, we use the ","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"MWsb07LwIf"},{"type":"inlineCode","value":"photutils","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"VICTtMAzs0"},{"type":"text","value":" Python package to perform PSF fitting. Here we assume a simple Gaussian with a FWHM given by ","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"aqoJQE7knJ"},{"type":"inlineCode","value":"psf_fwhm","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"bSSSh6DcIE"},{"type":"text","value":" as PSF.","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"o95FTUQlki"}],"key":"o1YMl4jcbJ"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"dCZtyg9zJm"}],"key":"XVDojWOjE6"},{"type":"paragraph","position":{"start":{"line":347,"column":1},"end":{"line":347,"column":1}},"children":[{"type":"text","value":"We use a Gaussian PSF here for simplicity. The photometry can be improved by using a pixelated PSF measured directly from the Euclid images (for example by stacking stars).","position":{"start":{"line":347,"column":1},"end":{"line":347,"column":1}},"key":"mnbhGTTHtt"}],"key":"QjC7Nx3dZS"}],"key":"vFxQk2lZP8"}],"key":"iWMjKk1sZ5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"psf_fwhm = 0.16 # PSF FWHM in arcsec\npixscale = 0.1 # VIS pixel scale in arcsec/px\n\ninit_params = Table([objects[\"x\"],objects[\"y\"]] , names=[\"x\",\"y\"]) # initial positions\npsf_model = CircularGaussianSigmaPRF(flux=1, sigma=psf_fwhm/pixscale / 2.35)\npsf_model.x_0.fixed = True\npsf_model.y_0.fixed = True\npsf_model.sigma.fixed = False\nfit_shape = (5, 5)\npsfphot = PSFPhotometry(psf_model,\n                        fit_shape,\n                        finder = DAOStarFinder(fwhm=0.1, threshold=3.*std, exclude_border=True), # not needed because we are using fixed initial positions.\n                        aperture_radius = 4,\n                        progress_bar = True)","key":"KIhJCLUxj4"},{"type":"output","id":"xPAsZhF6z9N5xgpghIrbU","data":[],"key":"ybhjjxb85X"}],"key":"HEO74QcDMe"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"children":[{"type":"text","value":"After initiating the ","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"key":"oeJNmm23oM"},{"type":"inlineCode","value":"PSFPhotometry","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"key":"Q2FkURotQ4"},{"type":"text","value":" object, we can run the PSF photometry measurement. This can take a while (typically between 1 and 2 minutes).","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"key":"ju8rIOKmpT"}],"key":"NePQdF8vmE"}],"key":"mvlibJHqDC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"phot = psfphot(img-median, error=None, mask=mask, init_params=init_params)","key":"uzOz2g3QRx"},{"type":"output","id":"BsevhKRdVaRLy54cJFTTb","data":[{"output_type":"stream","name":"stderr","text":"\rFit source/group:   0%|          | 0/2759 [00:00\u003c?, ?it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   0%|          | 11/2759 [00:00\u003c00:25, 106.36it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   1%|          | 26/2759 [00:00\u003c00:21, 126.46it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   1%|▏         | 39/2759 [00:00\u003c00:21, 125.93it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   2%|▏         | 54/2759 [00:00\u003c00:20, 131.59it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   3%|▎         | 70/2759 [00:00\u003c00:19, 140.92it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   3%|▎         | 85/2759 [00:00\u003c00:20, 128.03it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   4%|▎         | 101/2759 [00:00\u003c00:19, 136.06it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   4%|▍         | 117/2759 [00:00\u003c00:18, 141.60it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   5%|▍         | 132/2759 [00:00\u003c00:18, 142.94it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   5%|▌         | 147/2759 [00:01\u003c00:18, 142.86it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   6%|▌         | 162/2759 [00:01\u003c00:18, 140.01it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   6%|▋         | 177/2759 [00:01\u003c00:18, 139.05it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   7%|▋         | 192/2759 [00:01\u003c00:18, 139.94it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   8%|▊         | 207/2759 [00:01\u003c00:18, 141.44it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   8%|▊         | 222/2759 [00:01\u003c00:17, 141.94it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   9%|▊         | 237/2759 [00:01\u003c00:17, 143.26it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   9%|▉         | 253/2759 [00:01\u003c00:17, 145.35it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  10%|▉         | 268/2759 [00:01\u003c00:17, 142.24it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  10%|█         | 283/2759 [00:02\u003c00:17, 141.30it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  11%|█         | 298/2759 [00:02\u003c00:17, 140.54it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  11%|█▏        | 314/2759 [00:02\u003c00:16, 144.40it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  12%|█▏        | 329/2759 [00:02\u003c00:16, 144.19it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  13%|█▎        | 346/2759 [00:02\u003c00:16, 148.43it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  13%|█▎        | 363/2759 [00:02\u003c00:15, 153.29it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  14%|█▎        | 379/2759 [00:02\u003c00:17, 133.13it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  14%|█▍        | 394/2759 [00:02\u003c00:17, 134.66it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  15%|█▍        | 411/2759 [00:02\u003c00:16, 142.87it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  16%|█▌        | 428/2759 [00:03\u003c00:15, 148.79it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  16%|█▌        | 445/2759 [00:03\u003c00:15, 153.73it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  17%|█▋        | 462/2759 [00:03\u003c00:14, 156.64it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  17%|█▋        | 479/2759 [00:03\u003c00:14, 158.20it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  18%|█▊        | 495/2759 [00:03\u003c00:14, 157.62it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  19%|█▊        | 513/2759 [00:03\u003c00:13, 161.95it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  19%|█▉        | 530/2759 [00:03\u003c00:14, 158.29it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  20%|█▉        | 546/2759 [00:03\u003c00:14, 156.64it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  20%|██        | 562/2759 [00:03\u003c00:13, 156.95it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  21%|██        | 578/2759 [00:03\u003c00:13, 157.71it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  22%|██▏       | 596/2759 [00:04\u003c00:13, 162.87it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  22%|██▏       | 613/2759 [00:04\u003c00:14, 153.15it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  23%|██▎       | 629/2759 [00:04\u003c00:14, 148.92it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  23%|██▎       | 645/2759 [00:04\u003c00:14, 150.79it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  24%|██▍       | 663/2759 [00:04\u003c00:13, 157.53it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  25%|██▍       | 679/2759 [00:04\u003c00:14, 143.19it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  25%|██▌       | 695/2759 [00:04\u003c00:14, 145.93it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  26%|██▌       | 711/2759 [00:04\u003c00:13, 148.58it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  26%|██▋       | 727/2759 [00:04\u003c00:13, 148.31it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  27%|██▋       | 742/2759 [00:05\u003c00:13, 148.12it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  27%|██▋       | 757/2759 [00:05\u003c00:13, 146.87it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  28%|██▊       | 772/2759 [00:05\u003c00:14, 141.90it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  29%|██▊       | 789/2759 [00:05\u003c00:13, 149.73it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  29%|██▉       | 806/2759 [00:05\u003c00:12, 154.62it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  30%|██▉       | 822/2759 [00:05\u003c00:12, 153.10it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  30%|███       | 838/2759 [00:05\u003c00:12, 153.79it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  31%|███       | 855/2759 [00:05\u003c00:12, 156.72it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  32%|███▏      | 873/2759 [00:05\u003c00:11, 161.33it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  32%|███▏      | 891/2759 [00:06\u003c00:11, 164.30it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  33%|███▎      | 908/2759 [00:06\u003c00:11, 161.41it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  34%|███▎      | 925/2759 [00:06\u003c00:11, 163.05it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  34%|███▍      | 942/2759 [00:06\u003c00:11, 158.65it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  35%|███▍      | 958/2759 [00:06\u003c00:13, 138.30it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  35%|███▌      | 976/2759 [00:06\u003c00:12, 148.28it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  36%|███▌      | 992/2759 [00:06\u003c00:11, 148.34it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  37%|███▋      | 1008/2759 [00:06\u003c00:11, 146.27it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  37%|███▋      | 1025/2759 [00:06\u003c00:11, 149.17it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  38%|███▊      | 1042/2759 [00:07\u003c00:11, 154.79it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  38%|███▊      | 1058/2759 [00:07\u003c00:10, 154.76it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  39%|███▉      | 1076/2759 [00:07\u003c00:10, 161.29it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  40%|███▉      | 1094/2759 [00:07\u003c00:10, 166.33it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  40%|████      | 1112/2759 [00:07\u003c00:09, 169.86it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  41%|████      | 1130/2759 [00:07\u003c00:09, 172.10it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  42%|████▏     | 1148/2759 [00:07\u003c00:09, 171.68it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  42%|████▏     | 1166/2759 [00:07\u003c00:09, 173.62it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  43%|████▎     | 1184/2759 [00:07\u003c00:09, 173.78it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  44%|████▎     | 1202/2759 [00:07\u003c00:09, 167.14it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  44%|████▍     | 1219/2759 [00:08\u003c00:09, 164.65it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  45%|████▍     | 1236/2759 [00:08\u003c00:09, 162.56it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  45%|████▌     | 1254/2759 [00:08\u003c00:09, 166.28it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  46%|████▌     | 1272/2759 [00:08\u003c00:08, 167.98it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  47%|████▋     | 1289/2759 [00:08\u003c00:08, 165.65it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  47%|████▋     | 1306/2759 [00:08\u003c00:08, 165.36it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  48%|████▊     | 1323/2759 [00:08\u003c00:08, 160.15it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  49%|████▊     | 1340/2759 [00:08\u003c00:08, 158.44it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  49%|████▉     | 1356/2759 [00:08\u003c00:09, 154.30it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  50%|████▉     | 1372/2759 [00:09\u003c00:09, 152.32it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  50%|█████     | 1388/2759 [00:09\u003c00:09, 142.58it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  51%|█████     | 1403/2759 [00:09\u003c00:09, 137.88it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  51%|█████▏    | 1417/2759 [00:09\u003c00:10, 132.36it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  52%|█████▏    | 1435/2759 [00:09\u003c00:09, 143.24it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  53%|█████▎    | 1455/2759 [00:09\u003c00:08, 156.97it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  53%|█████▎    | 1474/2759 [00:09\u003c00:07, 163.43it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  54%|█████▍    | 1491/2759 [00:09\u003c00:07, 162.79it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  55%|█████▍    | 1508/2759 [00:09\u003c00:07, 162.69it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  55%|█████▌    | 1525/2759 [00:10\u003c00:08, 143.58it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  56%|█████▌    | 1544/2759 [00:10\u003c00:07, 154.42it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  57%|█████▋    | 1563/2759 [00:10\u003c00:07, 161.81it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  57%|█████▋    | 1580/2759 [00:10\u003c00:07, 162.43it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  58%|█████▊    | 1598/2759 [00:10\u003c00:06, 165.94it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  59%|█████▊    | 1615/2759 [00:10\u003c00:07, 156.38it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  59%|█████▉    | 1631/2759 [00:10\u003c00:07, 156.08it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  60%|█████▉    | 1647/2759 [00:10\u003c00:07, 153.01it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  60%|██████    | 1665/2759 [00:10\u003c00:06, 157.23it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  61%|██████    | 1682/2759 [00:11\u003c00:06, 157.60it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  62%|██████▏   | 1698/2759 [00:11\u003c00:06, 153.94it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  62%|██████▏   | 1715/2759 [00:11\u003c00:06, 157.13it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  63%|██████▎   | 1731/2759 [00:11\u003c00:06, 154.14it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  63%|██████▎   | 1747/2759 [00:11\u003c00:07, 142.30it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  64%|██████▍   | 1762/2759 [00:11\u003c00:06, 142.83it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  64%|██████▍   | 1777/2759 [00:11\u003c00:07, 137.16it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  65%|██████▌   | 1795/2759 [00:11\u003c00:06, 148.03it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  66%|██████▌   | 1811/2759 [00:11\u003c00:06, 150.09it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  66%|██████▌   | 1827/2759 [00:12\u003c00:06, 148.86it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  67%|██████▋   | 1846/2759 [00:12\u003c00:05, 158.22it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  67%|██████▋   | 1862/2759 [00:12\u003c00:05, 158.50it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  68%|██████▊   | 1878/2759 [00:12\u003c00:05, 156.97it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  69%|██████▊   | 1894/2759 [00:12\u003c00:05, 157.70it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  69%|██████▉   | 1911/2759 [00:12\u003c00:05, 159.09it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  70%|██████▉   | 1929/2759 [00:12\u003c00:05, 163.17it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  71%|███████   | 1946/2759 [00:12\u003c00:05, 161.30it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  71%|███████   | 1963/2759 [00:12\u003c00:04, 160.58it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  72%|███████▏  | 1980/2759 [00:13\u003c00:06, 125.38it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  72%|███████▏  | 1994/2759 [00:13\u003c00:06, 123.82it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  73%|███████▎  | 2012/2759 [00:13\u003c00:05, 133.36it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  74%|███████▎  | 2032/2759 [00:13\u003c00:04, 149.12it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  74%|███████▍  | 2049/2759 [00:13\u003c00:04, 152.76it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  75%|███████▍  | 2067/2759 [00:13\u003c00:04, 159.35it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  76%|███████▌  | 2084/2759 [00:13\u003c00:04, 139.55it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  76%|███████▌  | 2100/2759 [00:13\u003c00:04, 143.99it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  77%|███████▋  | 2116/2759 [00:13\u003c00:04, 148.19it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  77%|███████▋  | 2134/2759 [00:14\u003c00:03, 156.58it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  78%|███████▊  | 2152/2759 [00:14\u003c00:03, 161.03it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  79%|███████▊  | 2172/2759 [00:14\u003c00:03, 169.45it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  79%|███████▉  | 2191/2759 [00:14\u003c00:03, 173.65it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  80%|████████  | 2210/2759 [00:14\u003c00:03, 178.35it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  81%|████████  | 2230/2759 [00:14\u003c00:02, 183.74it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  82%|████████▏ | 2249/2759 [00:14\u003c00:02, 182.56it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  82%|████████▏ | 2270/2759 [00:14\u003c00:02, 189.72it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  83%|████████▎ | 2290/2759 [00:14\u003c00:02, 184.69it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  84%|████████▎ | 2309/2759 [00:15\u003c00:02, 184.63it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  84%|████████▍ | 2328/2759 [00:15\u003c00:02, 179.53it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  85%|████████▌ | 2347/2759 [00:15\u003c00:02, 177.07it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  86%|████████▌ | 2367/2759 [00:15\u003c00:02, 182.71it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  86%|████████▋ | 2386/2759 [00:15\u003c00:02, 181.08it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  87%|████████▋ | 2406/2759 [00:15\u003c00:01, 183.12it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  88%|████████▊ | 2425/2759 [00:15\u003c00:01, 184.87it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  89%|████████▊ | 2444/2759 [00:15\u003c00:02, 155.15it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  89%|████████▉ | 2462/2759 [00:15\u003c00:01, 160.76it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  90%|████████▉ | 2481/2759 [00:16\u003c00:01, 166.99it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  91%|█████████ | 2499/2759 [00:16\u003c00:02, 127.00it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  91%|█████████ | 2516/2759 [00:16\u003c00:01, 135.46it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  92%|█████████▏| 2532/2759 [00:16\u003c00:01, 113.50it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  92%|█████████▏| 2550/2759 [00:16\u003c00:01, 127.24it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  93%|█████████▎| 2565/2759 [00:16\u003c00:01, 121.85it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  93%|█████████▎| 2579/2759 [00:17\u003c00:01, 103.91it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  94%|█████████▍| 2591/2759 [00:17\u003c00:01, 92.45it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  94%|█████████▍| 2606/2759 [00:17\u003c00:01, 94.83it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  95%|█████████▍| 2617/2759 [00:17\u003c00:01, 86.10it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  95%|█████████▌| 2628/2759 [00:17\u003c00:01, 85.88it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  96%|█████████▌| 2637/2759 [00:17\u003c00:01, 85.68it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  96%|█████████▌| 2646/2759 [00:17\u003c00:01, 85.02it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  96%|█████████▌| 2655/2759 [00:17\u003c00:01, 84.69it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  97%|█████████▋| 2668/2759 [00:18\u003c00:01, 88.33it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  97%|█████████▋| 2682/2759 [00:18\u003c00:00, 100.46it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  98%|█████████▊| 2693/2759 [00:18\u003c00:01, 65.18it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  98%|█████████▊| 2702/2759 [00:18\u003c00:00, 69.09it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  98%|█████████▊| 2711/2759 [00:18\u003c00:00, 72.96it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  99%|█████████▊| 2723/2759 [00:18\u003c00:00, 73.19it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  99%|█████████▉| 2735/2759 [00:18\u003c00:00, 82.94it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group: 100%|█████████▉| 2748/2759 [00:19\u003c00:00, 92.64it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group: 100%|██████████| 2759/2759 [00:19\u003c00:00, 143.91it/s]"},{"output_type":"stream","name":"stderr","text":"\n"},{"output_type":"stream","name":"stderr","text":"WARNING: One or more fit(s) may not have converged. Please check the \"flags\" column in the output table. [photutils.psf._components]\n"}],"key":"x7EO62FSOh"}],"key":"TZIAXELnOK"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":373,"column":1},"end":{"line":373,"column":1}},"children":[{"type":"text","value":"Once this is done, we can create a residual image.","position":{"start":{"line":373,"column":1},"end":{"line":373,"column":1}},"key":"wE3O3Vd9az"}],"key":"ge728yQO2J"}],"key":"dAADFGoBb7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"resimage = psfphot.make_residual_image(data = img-median, psf_shape = (9, 9))","key":"w5GNkMONXJ"},{"type":"output","id":"CEy38QnR66YPzaBiOSF1Y","data":[{"output_type":"stream","name":"stderr","text":"\rAdd model sources:   0%|          | 0/2759 [00:00\u003c?, ?it/s]"},{"output_type":"stream","name":"stderr","text":"\rAdd model sources:  11%|█         | 294/2759 [00:00\u003c00:00, 2932.57it/s]"},{"output_type":"stream","name":"stderr","text":"\rAdd model sources:  21%|██▏       | 592/2759 [00:00\u003c00:00, 2959.23it/s]"},{"output_type":"stream","name":"stderr","text":"\rAdd model sources:  32%|███▏      | 888/2759 [00:00\u003c00:00, 2949.16it/s]"},{"output_type":"stream","name":"stderr","text":"\rAdd model sources:  43%|████▎     | 1187/2759 [00:00\u003c00:00, 2963.45it/s]"},{"output_type":"stream","name":"stderr","text":"\rAdd model sources:  54%|█████▍    | 1491/2759 [00:00\u003c00:00, 2989.83it/s]"},{"output_type":"stream","name":"stderr","text":"\rAdd model sources:  65%|██████▌   | 1794/2759 [00:00\u003c00:00, 3000.38it/s]"},{"output_type":"stream","name":"stderr","text":"\rAdd model sources:  76%|███████▌  | 2095/2759 [00:00\u003c00:00, 2990.07it/s]"},{"output_type":"stream","name":"stderr","text":"\rAdd model sources:  87%|████████▋ | 2399/2759 [00:00\u003c00:00, 3003.46it/s]"},{"output_type":"stream","name":"stderr","text":"\rAdd model sources:  98%|█████████▊| 2705/2759 [00:00\u003c00:00, 3018.41it/s]"},{"output_type":"stream","name":"stderr","text":"\rAdd model sources: 100%|██████████| 2759/2759 [00:00\u003c00:00, 2989.09it/s]"},{"output_type":"stream","name":"stderr","text":"\n"}],"key":"mc3Cdmd2G4"}],"key":"jiF6CHjqyE"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"children":[{"type":"text","value":"We now want to add the best-fit coordinates (R.A. and Decl.) to the VIS photometry catalog. For this, we have to convert the image coordinates into sky coordinates using the WCS information. We will need these coordinates because we want to use them as positional priors for the photometry measurement on the NISP images.","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"ZZvUJN7EzU"}],"key":"xgvmexyV2s"}],"key":"MT9NxHIDi7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"## Add coordinates to catalog\nwcs1 = WCS(hdr) # VIS\nradec = wcs1.all_pix2world(phot[\"x_fit\"],phot[\"y_fit\"],0)\nphot[\"ra_fit\"] = radec[0]\nphot[\"dec_fit\"] = radec[1]","key":"Ho3EpXa5Et"},{"type":"output","id":"2owQGl39T_C_Y2J2bPP5c","data":[],"key":"FKc32Plk38"}],"key":"cogVCYVmWp"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"children":[{"type":"text","value":"Finally, we plot the VIS image and the residual with the extracted sources overlaid.","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"key":"fwiwI2X6W5"}],"key":"Pt7dn8zFOv"}],"key":"blqyG1bzqx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure(figsize=(20,10))\nax1 = fig.add_subplot(1,2,1)\nax2 = fig.add_subplot(1,2,2)\nax1.imshow(np.log10(img), cmap=\"Greys\", origin=\"lower\")\nax1.plot(phot[\"x_fit\"], phot[\"y_fit\"] , \"o\", markersize=8 , markeredgecolor=\"red\", fillstyle=\"none\")\n\nax2.imshow(resimage,vmin=-5*std, vmax=5*std, cmap=\"RdBu\", origin=\"lower\")\nax2.plot(phot[\"x_fit\"], phot[\"y_fit\"] , \"o\", markersize=8 , markeredgecolor=\"red\", fillstyle=\"none\")\n\nplt.show()","key":"rLZx1CUcjB"},{"type":"output","id":"5ZYLZw8BNkheiTbLkQ6be","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 2000x1000 with 2 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"259d0a3dd736cf4fec47882dffdd7017","path":"/irsa-tutorials/build/259d0a3dd736cf4fec47882dffdd7017.png"}}}],"key":"pWup5YUKBX"}],"key":"Q0Od9huzcq"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"children":[{"type":"text","value":"As an additional check, we can compare the aperture photometry and the PSF photometry. We should find a good agreement between those two measurement methods. However, note that the PSF photometry should do a better job in deblending the fluxes of sources that are close by.","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"key":"Vx0tnrKLKe"}],"key":"EclAgqWIjW"}],"key":"JE2l4wZbT3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x = objects[\"flux\"]\ny = phot[\"flux_fit\"]\n\nfig = plt.figure(figsize=(6,5))\nax1 = fig.add_subplot(1,1,1)\n\nax1.plot(x , y , \"o\", markersize=2, alpha=0.5)\nminlim = np.nanmin(np.concatenate((x,y)))\nmaxlim = np.nanmax(np.concatenate((x,y)))\n\nax1.fill_between(np.asarray([minlim,maxlim]),np.asarray([minlim,maxlim])/1.5,np.asarray([minlim,maxlim])*1.5, color=\"gray\", alpha=0.2, linewidth=0)\nax1.fill_between(np.asarray([minlim,maxlim]),np.asarray([minlim,maxlim])/1.2,np.asarray([minlim,maxlim])*1.2, color=\"gray\", alpha=0.4, linewidth=0)\nax1.plot(np.asarray([minlim,maxlim]),np.asarray([minlim,maxlim]), \":\", color=\"gray\")\n\nax1.set_xlabel(\"Aperture Photometry [flux]\")\nax1.set_ylabel(\"PSF forced-photometry [flux]\")\nax1.set_xscale('log')\nax1.set_yscale('log')\nplt.show()","key":"e7gOK7Av7y"},{"type":"output","id":"5TEk_nttLabaRrENb4sz-","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 600x500 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"16fa53b792afdac5bc54cac1d8671dfe","path":"/irsa-tutorials/build/16fa53b792afdac5bc54cac1d8671dfe.png"}}}],"key":"lxa13xvQlK"}],"key":"ZNRuGQp6Rs"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":428,"column":1},"end":{"line":428,"column":1}},"children":[{"type":"text","value":"Measure the Photometry on the NISP Images","position":{"start":{"line":428,"column":1},"end":{"line":428,"column":1}},"key":"Hh63fx1ip9"}],"identifier":"measure-the-photometry-on-the-nisp-images","label":"Measure the Photometry on the NISP Images","html_id":"measure-the-photometry-on-the-nisp-images","implicit":true,"key":"SMb55yyS0m"},{"type":"paragraph","position":{"start":{"line":430,"column":1},"end":{"line":431,"column":1}},"children":[{"type":"text","value":"We now have the photometry and the position of sources on the VIS image. We can now proceed with similar steps on the NISP images. Because the NISP PSF and pixel scale are larger that those of the VIS images, we utilize the advantage of position prior-based forced photometry.\nFor this, we use the positions of the VIS measurements and perform PSF fitting on the NISP image using these priors.","position":{"start":{"line":430,"column":1},"end":{"line":430,"column":1}},"key":"nea3OG918F"}],"key":"yhSQ0YRsXD"},{"type":"paragraph","position":{"start":{"line":433,"column":1},"end":{"line":433,"column":1}},"children":[{"type":"text","value":"The steps below are almost identical to the ones applied to the VIS images.","position":{"start":{"line":433,"column":1},"end":{"line":433,"column":1}},"key":"fAlLZrqz8p"}],"key":"LABaux8IAJ"}],"key":"e5n3UYVRXE"},{"type":"block","position":{"start":{"line":435,"column":1},"end":{"line":435,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":437,"column":1},"end":{"line":437,"column":1}},"children":[{"type":"text","value":"We first isolate the data, which is in this case the NISP ","position":{"start":{"line":437,"column":1},"end":{"line":437,"column":1}},"key":"wA6DgHk0s0"},{"type":"emphasis","position":{"start":{"line":437,"column":1},"end":{"line":437,"column":1}},"children":[{"type":"text","value":"H","position":{"start":{"line":437,"column":1},"end":{"line":437,"column":1}},"key":"xBnGbIug2g"}],"key":"hbm51Z0ufm"},{"type":"text","value":"-band filter. Note that this is an arbitrary choice and you should be encouraged to try other filters as well!","position":{"start":{"line":437,"column":1},"end":{"line":437,"column":1}},"key":"AuyLBIxDUh"}],"key":"I0HedjGw02"}],"key":"q2kSvB2dGz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"img2 = hdulcutout[\"H_SCIENCE\"].data\nhdr2 = hdulcutout[\"H_SCIENCE\"].header\nimg2[img2 == 0] = np.nan","key":"izUV0Rjwij"},{"type":"output","id":"xfR1BRAyAiE50A1g-agGr","data":[],"key":"fJ97BNV9VM"}],"key":"EJgIBk6wPP"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"children":[{"type":"text","value":"We again need to create a mask that will be fed to the PSF fitting module.","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"key":"DL3vsfi9Wh"}],"key":"kwkHRow7ww"}],"key":"yteZ1XTaN5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mask2 = np.isnan(img2)","key":"fs2Q7Ayf6b"},{"type":"output","id":"wuW2dly0h4tz91lSvg_sV","data":[],"key":"iryDORu4VC"}],"key":"R5umhUEyXx"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":451,"column":1},"end":{"line":451,"column":1}},"children":[{"type":"text","value":"... and we also get some statistics on the sky background.","position":{"start":{"line":451,"column":1},"end":{"line":451,"column":1}},"key":"rdD22SiqBw"}],"key":"fxdR8cD0Gu"}],"key":"WiYXNKIMdL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mean2, median2, std2 = sigma_clipped_stats(img2, sigma=3.0)\nprint(np.array((mean2, median2, std2)))","key":"fI3PCzWDOB"},{"type":"output","id":"QF-uOZUgEhIo9BcMtMncO","data":[{"output_type":"stream","name":"stdout","text":"[2626.3018 1889.8518 2043.9841]\n"}],"key":"epONGVUqBM"}],"key":"HIZJ8mBFUV"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":458,"column":1},"end":{"line":458,"column":1}},"children":[{"type":"text","value":"Now, we need to obtain the (x,y) image coordinates on the NISP image that correspond to the extracted sources on the VIS image. We use the WCS information from the NISP image for this case and apply it to the sky coordinates obtained on the VIS image.","position":{"start":{"line":458,"column":1},"end":{"line":458,"column":1}},"key":"PaMBgY2WEP"}],"key":"MtSeupuNwW"}],"key":"udvzCF00J2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"wcs = WCS(hdr) # VIS\nwcs2 = WCS(hdr2) # NISP\nradec = wcs.all_pix2world(objects[\"x\"],objects[\"y\"], 0)\nxy = wcs2.all_world2pix(radec[0],radec[1],0)","key":"rxfVEDo09O"},{"type":"output","id":"rOtx6OPFMPdU-qsd84Yln","data":[],"key":"NAmMMrVrhn"}],"key":"B8Vd2BqGb4"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"children":[{"type":"text","value":"Having all this set up, we can now again perform the PSF photometry using ","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"key":"j5qdtzw0d4"},{"type":"inlineCode","value":"PSFPhotometry()","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"key":"lNyv3ERipC"},{"type":"text","value":" from the ","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"key":"h9aT9083hN"},{"type":"inlineCode","value":"photutils","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"key":"vAOZsUGpBk"},{"type":"text","value":" package. This again can take a while, typically 1 minute.","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"key":"W6HuS9Rh5d"}],"key":"S8BTLQsEuR"}],"key":"JPNu6Awrly"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"psf_fwhm = 0.3 # arcsec\npixscale = 0.3 # arcsec/px\n\ninit_params = Table([xy[0],xy[1]] , names=[\"x\",\"y\"]) # initial positions\npsf_model = CircularGaussianSigmaPRF(flux=1, sigma=psf_fwhm/pixscale / 2.35)\npsf_model.x_0.fixed = True\npsf_model.y_0.fixed = True\npsf_model.sigma.fixed = False\nfit_shape = (3, 3)\npsfphot2 = PSFPhotometry(psf_model,\n                        fit_shape,\n                        finder = DAOStarFinder(fwhm=0.1, threshold=3.*std2, exclude_border=True), # not needed because we are using fixed initial positions.\n                        aperture_radius = 4,\n                        progress_bar = True)\nphot2 = psfphot2(img2-median2, error=None, mask=mask2, init_params=init_params)\nresimage2 = psfphot2.make_residual_image(data = img2-median2, psf_shape = (3, 3))","key":"XTawkmDUdN"},{"type":"output","id":"T2OECC8AOOCeNwsYXb0PU","data":[{"output_type":"stream","name":"stderr","text":"\rFit source/group:   0%|          | 0/2759 [00:00\u003c?, ?it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   0%|          | 5/2759 [00:00\u003c00:58, 47.37it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   0%|          | 12/2759 [00:00\u003c00:46, 58.93it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   1%|          | 28/2759 [00:00\u003c00:26, 102.08it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   1%|▏         | 41/2759 [00:00\u003c00:26, 100.80it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   2%|▏         | 53/2759 [00:00\u003c00:26, 101.90it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   2%|▏         | 64/2759 [00:00\u003c00:27, 99.36it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   3%|▎         | 75/2759 [00:00\u003c00:27, 95.94it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   3%|▎         | 85/2759 [00:00\u003c00:32, 81.98it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   3%|▎         | 94/2759 [00:01\u003c00:32, 82.90it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   4%|▎         | 103/2759 [00:01\u003c00:31, 83.30it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   4%|▍         | 112/2759 [00:01\u003c00:32, 82.45it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   4%|▍         | 121/2759 [00:01\u003c00:31, 83.86it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   5%|▍         | 130/2759 [00:01\u003c00:31, 84.11it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   5%|▌         | 140/2759 [00:01\u003c00:33, 77.22it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   5%|▌         | 148/2759 [00:01\u003c00:34, 76.55it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   6%|▌         | 157/2759 [00:01\u003c00:32, 79.59it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   6%|▌         | 166/2759 [00:02\u003c00:38, 67.89it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   6%|▋         | 175/2759 [00:02\u003c00:35, 72.23it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   7%|▋         | 191/2759 [00:02\u003c00:27, 93.56it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   7%|▋         | 201/2759 [00:02\u003c00:27, 94.27it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   8%|▊         | 211/2759 [00:02\u003c00:27, 92.86it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   8%|▊         | 227/2759 [00:02\u003c00:22, 110.50it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   9%|▊         | 239/2759 [00:02\u003c00:27, 92.45it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:   9%|▉         | 255/2759 [00:02\u003c00:23, 106.90it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  10%|▉         | 267/2759 [00:03\u003c00:25, 96.28it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  10%|█         | 278/2759 [00:03\u003c00:25, 96.44it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  10%|█         | 289/2759 [00:03\u003c00:25, 95.11it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  11%|█         | 301/2759 [00:03\u003c00:25, 95.28it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  11%|█▏        | 311/2759 [00:03\u003c00:37, 64.54it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  12%|█▏        | 319/2759 [00:03\u003c00:41, 58.57it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  12%|█▏        | 332/2759 [00:03\u003c00:33, 71.88it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  12%|█▏        | 344/2759 [00:04\u003c00:29, 81.75it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  13%|█▎        | 358/2759 [00:04\u003c00:25, 94.56it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  13%|█▎        | 369/2759 [00:04\u003c00:31, 76.66it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  14%|█▍        | 386/2759 [00:04\u003c00:24, 96.74it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  14%|█▍        | 398/2759 [00:04\u003c00:26, 88.88it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  15%|█▌        | 415/2759 [00:04\u003c00:22, 106.45it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  16%|█▌        | 433/2759 [00:04\u003c00:18, 123.21it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  16%|█▌        | 447/2759 [00:04\u003c00:19, 118.84it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  17%|█▋        | 460/2759 [00:05\u003c00:22, 103.76it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  17%|█▋        | 472/2759 [00:05\u003c00:24, 93.54it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  18%|█▊        | 488/2759 [00:05\u003c00:20, 108.45it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  18%|█▊        | 502/2759 [00:05\u003c00:21, 106.15it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  19%|█▊        | 514/2759 [00:05\u003c00:21, 104.28it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  19%|█▉        | 528/2759 [00:05\u003c00:21, 105.31it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  20%|█▉        | 539/2759 [00:05\u003c00:24, 92.11it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  20%|█▉        | 549/2759 [00:06\u003c00:26, 82.76it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  20%|██        | 560/2759 [00:06\u003c00:25, 86.07it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  21%|██        | 570/2759 [00:06\u003c00:25, 86.82it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  21%|██        | 579/2759 [00:06\u003c00:24, 87.30it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  21%|██▏       | 588/2759 [00:06\u003c00:25, 86.62it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  22%|██▏       | 597/2759 [00:06\u003c00:25, 85.07it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  22%|██▏       | 606/2759 [00:06\u003c00:28, 74.63it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  22%|██▏       | 614/2759 [00:07\u003c00:34, 61.48it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  23%|██▎       | 629/2759 [00:07\u003c00:26, 80.93it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  23%|██▎       | 639/2759 [00:07\u003c00:25, 84.73it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  24%|██▍       | 657/2759 [00:07\u003c00:19, 107.68it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  24%|██▍       | 669/2759 [00:07\u003c00:22, 93.59it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  25%|██▍       | 680/2759 [00:07\u003c00:21, 94.52it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  25%|██▌       | 691/2759 [00:07\u003c00:21, 95.86it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  25%|██▌       | 702/2759 [00:07\u003c00:25, 79.26it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  26%|██▌       | 711/2759 [00:08\u003c00:27, 74.31it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  26%|██▌       | 720/2759 [00:08\u003c00:28, 71.58it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  26%|██▋       | 730/2759 [00:08\u003c00:26, 77.77it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  27%|██▋       | 746/2759 [00:08\u003c00:22, 90.69it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  27%|██▋       | 756/2759 [00:08\u003c00:27, 73.69it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  28%|██▊       | 773/2759 [00:08\u003c00:21, 94.42it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  28%|██▊       | 784/2759 [00:08\u003c00:21, 93.41it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  29%|██▉       | 796/2759 [00:08\u003c00:20, 96.90it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  29%|██▉       | 813/2759 [00:09\u003c00:16, 114.72it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  30%|██▉       | 826/2759 [00:09\u003c00:19, 100.11it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  30%|███       | 837/2759 [00:09\u003c00:19, 99.25it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  31%|███       | 848/2759 [00:09\u003c00:19, 98.09it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  31%|███       | 859/2759 [00:09\u003c00:19, 97.71it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  32%|███▏      | 870/2759 [00:09\u003c00:21, 88.09it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  32%|███▏      | 881/2759 [00:09\u003c00:20, 92.37it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  32%|███▏      | 891/2759 [00:09\u003c00:20, 90.25it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  33%|███▎      | 904/2759 [00:10\u003c00:20, 92.61it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  33%|███▎      | 914/2759 [00:10\u003c00:19, 92.67it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  34%|███▎      | 926/2759 [00:10\u003c00:19, 94.90it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  34%|███▍      | 942/2759 [00:10\u003c00:16, 111.88it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  35%|███▍      | 954/2759 [00:10\u003c00:21, 85.94it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  35%|███▌      | 968/2759 [00:10\u003c00:19, 90.07it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  35%|███▌      | 978/2759 [00:10\u003c00:22, 80.06it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  36%|███▌      | 987/2759 [00:11\u003c00:24, 72.66it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  36%|███▌      | 995/2759 [00:11\u003c00:27, 63.15it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  37%|███▋      | 1011/2759 [00:11\u003c00:21, 82.44it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  37%|███▋      | 1025/2759 [00:11\u003c00:19, 89.09it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  38%|███▊      | 1042/2759 [00:11\u003c00:16, 105.23it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  38%|███▊      | 1054/2759 [00:11\u003c00:19, 86.46it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  39%|███▊      | 1069/2759 [00:11\u003c00:16, 100.15it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  39%|███▉      | 1081/2759 [00:12\u003c00:18, 92.32it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  40%|███▉      | 1092/2759 [00:12\u003c00:17, 94.04it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  40%|████      | 1108/2759 [00:12\u003c00:15, 109.31it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  41%|████      | 1120/2759 [00:12\u003c00:17, 94.15it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  41%|████      | 1131/2759 [00:12\u003c00:20, 78.44it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  41%|████▏     | 1140/2759 [00:12\u003c00:22, 72.75it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  42%|████▏     | 1149/2759 [00:12\u003c00:21, 75.96it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  42%|████▏     | 1164/2759 [00:13\u003c00:18, 85.97it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  43%|████▎     | 1181/2759 [00:13\u003c00:15, 105.04it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  43%|████▎     | 1193/2759 [00:13\u003c00:15, 99.92it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  44%|████▎     | 1204/2759 [00:13\u003c00:19, 78.97it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  44%|████▍     | 1214/2759 [00:13\u003c00:18, 82.98it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  44%|████▍     | 1224/2759 [00:13\u003c00:19, 77.76it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  45%|████▍     | 1233/2759 [00:13\u003c00:20, 74.30it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  45%|████▌     | 1242/2759 [00:14\u003c00:19, 76.63it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  45%|████▌     | 1252/2759 [00:14\u003c00:18, 82.00it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  46%|████▌     | 1267/2759 [00:14\u003c00:15, 98.78it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  47%|████▋     | 1285/2759 [00:14\u003c00:13, 106.61it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  47%|████▋     | 1296/2759 [00:14\u003c00:14, 102.23it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  47%|████▋     | 1307/2759 [00:14\u003c00:14, 99.96it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  48%|████▊     | 1318/2759 [00:14\u003c00:15, 90.50it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  48%|████▊     | 1328/2759 [00:14\u003c00:17, 81.79it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  48%|████▊     | 1337/2759 [00:15\u003c00:19, 74.29it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  49%|████▉     | 1349/2759 [00:15\u003c00:17, 81.19it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  49%|████▉     | 1358/2759 [00:15\u003c00:19, 72.72it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  50%|████▉     | 1366/2759 [00:15\u003c00:19, 70.88it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  50%|████▉     | 1374/2759 [00:15\u003c00:19, 72.76it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  50%|█████     | 1382/2759 [00:15\u003c00:22, 60.75it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  50%|█████     | 1393/2759 [00:15\u003c00:20, 65.06it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  51%|█████     | 1407/2759 [00:16\u003c00:18, 74.38it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  51%|█████▏    | 1415/2759 [00:16\u003c00:21, 63.91it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  52%|█████▏    | 1433/2759 [00:16\u003c00:15, 88.30it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  53%|█████▎    | 1449/2759 [00:16\u003c00:12, 104.64it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  53%|█████▎    | 1461/2759 [00:16\u003c00:12, 104.72it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  54%|█████▎    | 1479/2759 [00:16\u003c00:10, 122.83it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  54%|█████▍    | 1493/2759 [00:16\u003c00:10, 116.57it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  55%|█████▍    | 1506/2759 [00:16\u003c00:10, 114.61it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  55%|█████▌    | 1518/2759 [00:17\u003c00:12, 97.41it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  55%|█████▌    | 1529/2759 [00:17\u003c00:14, 84.38it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  56%|█████▌    | 1539/2759 [00:17\u003c00:14, 87.10it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  56%|█████▌    | 1549/2759 [00:17\u003c00:15, 80.37it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  57%|█████▋    | 1565/2759 [00:17\u003c00:13, 91.00it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  57%|█████▋    | 1575/2759 [00:17\u003c00:13, 89.83it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  58%|█████▊    | 1587/2759 [00:17\u003c00:12, 96.37it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  58%|█████▊    | 1598/2759 [00:18\u003c00:11, 99.14it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  58%|█████▊    | 1609/2759 [00:18\u003c00:14, 79.53it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  59%|█████▊    | 1618/2759 [00:18\u003c00:15, 73.79it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  59%|█████▉    | 1626/2759 [00:18\u003c00:15, 75.14it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  59%|█████▉    | 1635/2759 [00:18\u003c00:14, 77.88it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  60%|█████▉    | 1644/2759 [00:18\u003c00:15, 70.00it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  60%|█████▉    | 1652/2759 [00:18\u003c00:15, 72.00it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  60%|██████    | 1661/2759 [00:18\u003c00:14, 75.66it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  61%|██████    | 1671/2759 [00:19\u003c00:13, 81.16it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  61%|██████    | 1680/2759 [00:19\u003c00:12, 83.10it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  61%|██████▏   | 1690/2759 [00:19\u003c00:12, 86.33it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  62%|██████▏   | 1706/2759 [00:19\u003c00:09, 106.72it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  62%|██████▏   | 1717/2759 [00:19\u003c00:11, 94.66it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  63%|██████▎   | 1728/2759 [00:19\u003c00:10, 97.60it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  63%|██████▎   | 1739/2759 [00:19\u003c00:11, 86.29it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  63%|██████▎   | 1751/2759 [00:19\u003c00:10, 92.26it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  64%|██████▍   | 1761/2759 [00:20\u003c00:11, 83.82it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  64%|██████▍   | 1771/2759 [00:20\u003c00:12, 79.89it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  65%|██████▍   | 1780/2759 [00:20\u003c00:14, 69.19it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  65%|██████▍   | 1790/2759 [00:20\u003c00:12, 75.27it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  65%|██████▌   | 1801/2759 [00:20\u003c00:11, 82.65it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  66%|██████▌   | 1812/2759 [00:20\u003c00:10, 89.32it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  66%|██████▋   | 1829/2759 [00:20\u003c00:09, 101.46it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  67%|██████▋   | 1840/2759 [00:20\u003c00:09, 92.06it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  67%|██████▋   | 1852/2759 [00:21\u003c00:09, 96.23it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  67%|██████▋   | 1862/2759 [00:21\u003c00:09, 97.18it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  68%|██████▊   | 1872/2759 [00:21\u003c00:11, 79.17it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  69%|██████▊   | 1891/2759 [00:21\u003c00:08, 104.87it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  69%|██████▉   | 1903/2759 [00:21\u003c00:08, 102.36it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  69%|██████▉   | 1914/2759 [00:21\u003c00:09, 84.72it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  70%|██████▉   | 1924/2759 [00:21\u003c00:10, 81.54it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  70%|███████   | 1936/2759 [00:22\u003c00:09, 87.49it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  71%|███████   | 1946/2759 [00:22\u003c00:09, 83.14it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  71%|███████   | 1955/2759 [00:22\u003c00:10, 78.38it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  71%|███████▏  | 1972/2759 [00:22\u003c00:07, 99.94it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  72%|███████▏  | 1983/2759 [00:22\u003c00:09, 83.14it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  72%|███████▏  | 1993/2759 [00:22\u003c00:09, 78.34it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  73%|███████▎  | 2003/2759 [00:22\u003c00:09, 83.12it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  73%|███████▎  | 2012/2759 [00:22\u003c00:09, 82.12it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  73%|███████▎  | 2021/2759 [00:23\u003c00:09, 76.10it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  74%|███████▎  | 2031/2759 [00:23\u003c00:09, 78.83it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  74%|███████▍  | 2046/2759 [00:23\u003c00:08, 89.04it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  75%|███████▍  | 2056/2759 [00:23\u003c00:07, 90.83it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  75%|███████▌  | 2071/2759 [00:23\u003c00:06, 103.63it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  75%|███████▌  | 2082/2759 [00:23\u003c00:08, 83.55it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  76%|███████▌  | 2097/2759 [00:23\u003c00:07, 93.91it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  76%|███████▋  | 2108/2759 [00:23\u003c00:06, 96.89it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  77%|███████▋  | 2119/2759 [00:24\u003c00:06, 99.81it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  77%|███████▋  | 2132/2759 [00:24\u003c00:06, 103.54it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  78%|███████▊  | 2143/2759 [00:24\u003c00:06, 102.51it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  78%|███████▊  | 2154/2759 [00:24\u003c00:06, 92.34it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  78%|███████▊  | 2164/2759 [00:24\u003c00:06, 85.19it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  79%|███████▉  | 2175/2759 [00:24\u003c00:06, 89.14it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  79%|███████▉  | 2186/2759 [00:24\u003c00:06, 93.28it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  80%|███████▉  | 2197/2759 [00:24\u003c00:05, 96.57it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  80%|████████  | 2210/2759 [00:25\u003c00:05, 99.50it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  81%|████████  | 2221/2759 [00:25\u003c00:06, 80.56it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  81%|████████  | 2233/2759 [00:25\u003c00:06, 87.23it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  81%|████████▏ | 2243/2759 [00:25\u003c00:06, 81.94it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  82%|████████▏ | 2253/2759 [00:25\u003c00:05, 85.49it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  82%|████████▏ | 2264/2759 [00:25\u003c00:05, 91.56it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  82%|████████▏ | 2274/2759 [00:25\u003c00:05, 89.90it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  83%|████████▎ | 2285/2759 [00:25\u003c00:04, 94.83it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  83%|████████▎ | 2296/2759 [00:26\u003c00:04, 97.89it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  84%|████████▎ | 2310/2759 [00:26\u003c00:04, 108.43it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  84%|████████▍ | 2322/2759 [00:26\u003c00:04, 103.51it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  85%|████████▍ | 2338/2759 [00:26\u003c00:03, 117.31it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  85%|████████▌ | 2350/2759 [00:26\u003c00:04, 87.50it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  86%|████████▌ | 2360/2759 [00:26\u003c00:05, 79.16it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  86%|████████▌ | 2369/2759 [00:26\u003c00:05, 73.23it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  86%|████████▌ | 2377/2759 [00:27\u003c00:05, 64.54it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  86%|████████▋ | 2385/2759 [00:27\u003c00:05, 62.68it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  87%|████████▋ | 2396/2759 [00:27\u003c00:05, 72.04it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  87%|████████▋ | 2405/2759 [00:27\u003c00:04, 76.16it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  88%|████████▊ | 2416/2759 [00:27\u003c00:04, 83.92it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  88%|████████▊ | 2426/2759 [00:27\u003c00:03, 87.30it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  88%|████████▊ | 2436/2759 [00:27\u003c00:04, 72.96it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  89%|████████▊ | 2445/2759 [00:27\u003c00:04, 76.20it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  89%|████████▉ | 2454/2759 [00:28\u003c00:03, 79.63it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  89%|████████▉ | 2463/2759 [00:28\u003c00:03, 75.38it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  90%|████████▉ | 2473/2759 [00:28\u003c00:03, 76.81it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  90%|█████████ | 2485/2759 [00:28\u003c00:03, 83.64it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  90%|█████████ | 2494/2759 [00:28\u003c00:04, 65.17it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  91%|█████████ | 2512/2759 [00:28\u003c00:02, 90.13it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  91%|█████████▏| 2523/2759 [00:28\u003c00:02, 93.16it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  92%|█████████▏| 2534/2759 [00:29\u003c00:03, 68.61it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  92%|█████████▏| 2544/2759 [00:29\u003c00:02, 73.84it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  93%|█████████▎| 2555/2759 [00:29\u003c00:02, 80.99it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  93%|█████████▎| 2565/2759 [00:29\u003c00:02, 82.81it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  93%|█████████▎| 2575/2759 [00:29\u003c00:02, 86.73it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  94%|█████████▍| 2590/2759 [00:29\u003c00:01, 96.36it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  94%|█████████▍| 2607/2759 [00:29\u003c00:01, 114.43it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  95%|█████████▍| 2619/2759 [00:29\u003c00:01, 109.73it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  96%|█████████▌| 2635/2759 [00:29\u003c00:01, 122.99it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  96%|█████████▌| 2648/2759 [00:30\u003c00:00, 114.19it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  97%|█████████▋| 2665/2759 [00:30\u003c00:00, 128.58it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  97%|█████████▋| 2679/2759 [00:30\u003c00:00, 124.38it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  98%|█████████▊| 2692/2759 [00:30\u003c00:00, 120.56it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  98%|█████████▊| 2708/2759 [00:30\u003c00:00, 119.40it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  99%|█████████▊| 2721/2759 [00:30\u003c00:00, 80.68it/s] "},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  99%|█████████▉| 2734/2759 [00:30\u003c00:00, 90.30it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group:  99%|█████████▉| 2745/2759 [00:31\u003c00:00, 91.81it/s]"},{"output_type":"stream","name":"stderr","text":"\rFit source/group: 100%|██████████| 2759/2759 [00:31\u003c00:00, 88.54it/s]"},{"output_type":"stream","name":"stderr","text":"\n"},{"output_type":"stream","name":"stderr","text":"WARNING: One or more fit(s) may not have converged. Please check the \"flags\" column in the output table. [photutils.psf._components]\n"},{"output_type":"stream","name":"stderr","text":"\rAdd model sources:   0%|          | 0/2759 [00:00\u003c?, ?it/s]"},{"output_type":"stream","name":"stderr","text":"\rAdd model sources:  17%|█▋        | 462/2759 [00:00\u003c00:00, 4611.35it/s]"},{"output_type":"stream","name":"stderr","text":"\rAdd model sources:  35%|███▍      | 957/2759 [00:00\u003c00:00, 4808.23it/s]"},{"output_type":"stream","name":"stderr","text":"\rAdd model sources:  53%|█████▎    | 1457/2759 [00:00\u003c00:00, 4894.62it/s]"},{"output_type":"stream","name":"stderr","text":"\rAdd model sources:  71%|███████   | 1947/2759 [00:00\u003c00:00, 4741.99it/s]"},{"output_type":"stream","name":"stderr","text":"\rAdd model sources:  88%|████████▊ | 2428/2759 [00:00\u003c00:00, 4764.59it/s]"},{"output_type":"stream","name":"stderr","text":"\rAdd model sources: 100%|██████████| 2759/2759 [00:00\u003c00:00, 4760.30it/s]"},{"output_type":"stream","name":"stderr","text":"\n"}],"key":"Kt93lW47s6"}],"key":"VqG0RXIVhB"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":488,"column":1},"end":{"line":488,"column":1}},"children":[{"type":"text","value":"Again, we convert the pixel coordinates to sky coordinates and add them to the catalog.","position":{"start":{"line":488,"column":1},"end":{"line":488,"column":1}},"key":"k8VtmjIivV"}],"key":"wlEFKnuwRk"}],"key":"gBf68xB6qi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"wcs2 = WCS(hdr2) # NISP\nradec = wcs2.all_pix2world(phot2[\"x_fit\"],phot2[\"y_fit\"],0)\nphot2[\"ra_fit\"] = radec[0]\nphot2[\"dec_fit\"] = radec[1]","key":"X1AGJaKce6"},{"type":"output","id":"ldxyGwXSwiYz2VbYdyVGN","data":[],"key":"fFgAvaL5RX"}],"key":"wPV1TMSDSQ"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"children":[{"type":"text","value":"Finally, we create the same figure as above, showing the NISP image and the residual with the (VIS-extracted) sources overlaid.","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"u4Kgcz6RTz"}],"key":"Ed2wqBJCbv"}],"key":"c5rWYY8AZx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure(figsize=(20,10))\nax1 = fig.add_subplot(1,2,1)\nax2 = fig.add_subplot(1,2,2)\nax1.imshow(np.log10(img2), cmap=\"Greys\", origin=\"lower\")\nax1.plot(phot2[\"x_fit\"], phot2[\"y_fit\"] , \"o\", markersize=8 , markeredgecolor=\"red\", fillstyle=\"none\")\n\nax2.imshow(resimage2,vmin=-20*std2, vmax=20*std2, cmap=\"RdBu\", origin=\"lower\")\nax2.plot(phot2[\"x_fit\"], phot2[\"y_fit\"] , \"o\", markersize=8 , markeredgecolor=\"red\", fillstyle=\"none\")\n\nplt.show()","key":"QjQfdNq85R"},{"type":"output","id":"C5PwrWpaYAAeHd1z3gN6h","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 2000x1000 with 2 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"17938692777de4260dc806d857fa1fae","path":"/irsa-tutorials/build/17938692777de4260dc806d857fa1fae.png"}}}],"key":"BVYUovDx9Q"}],"key":"ITifOqsBTV"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"children":[{"type":"text","value":"Load Gaia Catalog","position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"key":"rPNZ1qyLXF"}],"identifier":"load-gaia-catalog","label":"Load Gaia Catalog","html_id":"load-gaia-catalog","implicit":true,"key":"giCOEmjBJe"},{"type":"paragraph","position":{"start":{"line":514,"column":1},"end":{"line":515,"column":1}},"children":[{"type":"text","value":"We now load the Gaia sources at the location of the globular clusters. The goal is to compare the photometry of Gaia to the one derived above for the Euclid VIS and NISP images. This is scientifically useful, for example we can compute the colors of the stars in the Gaia optical bands and the Euclid near-IR bands.\nTo search for Gaia sources, we use ","position":{"start":{"line":514,"column":1},"end":{"line":514,"column":1}},"key":"HvvVQZqsWO"},{"type":"inlineCode","value":"astroquery","position":{"start":{"line":514,"column":1},"end":{"line":514,"column":1}},"key":"xKYInnWnYS"},{"type":"text","value":" again.","position":{"start":{"line":514,"column":1},"end":{"line":514,"column":1}},"key":"waLOevIvZa"}],"key":"RhGGUWBMs2"},{"type":"paragraph","position":{"start":{"line":517,"column":1},"end":{"line":517,"column":1}},"children":[{"type":"text","value":"We first have to elimiate the row limit for the Gaia query by setting","position":{"start":{"line":517,"column":1},"end":{"line":517,"column":1}},"key":"XXOsQ8MeNU"}],"key":"sZ3T0n1HnA"}],"key":"Yi2MtTTjI2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"Gaia.ROW_LIMIT = -1","key":"jRBEbcGYU5"},{"type":"output","id":"BROMhCs4PSdoG5khPLHcc","data":[],"key":"ZDOMKICNsz"}],"key":"vegik5gVH6"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":523,"column":1},"end":{"line":523,"column":1}},"children":[{"type":"text","value":"Next, we request the Gaia catalog around the position of the globular cluster. We use the same size as the cutout size.","position":{"start":{"line":523,"column":1},"end":{"line":523,"column":1}},"key":"tV3ss8GCdi"}],"key":"yrzl4OyJj8"}],"key":"w8R2ExVNhW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"gaia_objects = Gaia.query_object_async(coordinate=coord, radius = cutout_size/2)\nprint(\"Number of Gaia stars found: {}\".format(len(gaia_objects)))","key":"i5lNLXL7Jt"},{"type":"output","id":"pciUEx4_snaRW2flBdpxp","data":[{"output_type":"stream","name":"stdout","text":"INFO: Query finished. [astroquery.utils.tap.core]\nNumber of Gaia stars found: 1202\n"}],"key":"fbauapr6jN"}],"key":"IU1PqAnseb"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":530,"column":1},"end":{"line":530,"column":1}},"children":[{"type":"text","value":"We then convert the sky coordinates of the Gaia stars to (x,y) image coordinates for VIS and NISP images using the corresponding WCS. This makes it more easy to plot the Gaia sources later on the images.","position":{"start":{"line":530,"column":1},"end":{"line":530,"column":1}},"key":"zOr8iWMwS0"}],"key":"d76kq5hrmw"}],"key":"hbKFH3Dvt4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"wcs = WCS(hdr) # VIS\nwcs2 = WCS(hdr2) # NISP\nxy = wcs.all_world2pix(gaia_objects[\"ra\"],gaia_objects[\"dec\"],0)\nxy2 = wcs2.all_world2pix(gaia_objects[\"ra\"],gaia_objects[\"dec\"],0)\n\ngaia_objects[\"x_vis\"] = xy[0]\ngaia_objects[\"y_vis\"] = xy[1]\ngaia_objects[\"x_nisp\"] = xy2[0]\ngaia_objects[\"y_nisp\"] = xy2[1]","key":"kB58WRr87v"},{"type":"output","id":"jPgMDhBdTZeQODs7rYhjc","data":[],"key":"s43MOludt3"}],"key":"zkTkXqW4B8"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"children":[{"type":"text","value":"We save the Gaia table to disk as we will later use it for the visualization in ","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"HveiQs8HZQ"},{"type":"inlineCode","value":"Firefly","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"mMLHwqb0Cj"},{"type":"text","value":".","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"UrdTkOB5tM"}],"key":"eH3U1kHkNr"}],"key":"YmJKZWZDgk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"gaia_objects.write(\"./data/gaiatable.csv\", format=\"csv\", overwrite=True)","key":"Kzyxj1AI2h"},{"type":"output","id":"SsN0zQsFs73JdESYAGTqU","data":[],"key":"dsQlBSsPL6"}],"key":"cFI3GbaAT0"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":550,"column":1},"end":{"line":550,"column":1}},"children":[{"type":"text","value":"Now we can overlay the Gaia sources on the VIS and NISP images (here the x/y coordinates become handy).","position":{"start":{"line":550,"column":1},"end":{"line":550,"column":1}},"key":"JFAYrVLQhc"}],"key":"h9OQcYJZOA"}],"key":"ITryywcZMi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure(figsize=(20,10))\nax1 = fig.add_subplot(1,2,1)\nax2 = fig.add_subplot(1,2,2)\nax1.imshow(np.log10(img), cmap=\"Greys\", origin=\"lower\")\nax1.plot(gaia_objects[\"x_vis\"], gaia_objects[\"y_vis\"] , \"o\", markersize=8 , markeredgecolor=\"red\", fillstyle=\"none\")\nax1.set_title(\"VIS\")\n\nax2.imshow(np.log10(img2), cmap=\"Greys\", origin=\"lower\")\nax2.plot(gaia_objects[\"x_nisp\"], gaia_objects[\"y_nisp\"] , \"o\", markersize=8 , markeredgecolor=\"red\", fillstyle=\"none\")\nax2.set_title(\"NISP\")\n\nplt.show()","key":"p5WEcYDH6W"},{"type":"output","id":"BJd8ygS6mfkCNMXdsjW0d","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 2000x1000 with 2 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"3c8d9b314fb39e4efbb608f925a0d98c","path":"/irsa-tutorials/build/3c8d9b314fb39e4efbb608f925a0d98c.png"}}}],"key":"qBw637yFM1"}],"key":"hyvUTfSutx"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":567,"column":1},"end":{"line":567,"column":1}},"children":[{"type":"text","value":"Match the Gaia Catalog to the VIS and NISP Catalogs","position":{"start":{"line":567,"column":1},"end":{"line":567,"column":1}},"key":"RkIpoGQz7B"}],"identifier":"match-the-gaia-catalog-to-the-vis-and-nisp-catalogs","label":"Match the Gaia Catalog to the VIS and NISP Catalogs","html_id":"match-the-gaia-catalog-to-the-vis-and-nisp-catalogs","implicit":true,"key":"rPKnrCV8tF"},{"type":"paragraph","position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"children":[{"type":"text","value":"Now, we match the Gaia source positions to the extracted sources in the VIS and NISP images.","position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"key":"bKApD4X1WL"}],"key":"UO5Oacvo9n"},{"type":"paragraph","position":{"start":{"line":571,"column":1},"end":{"line":571,"column":1}},"children":[{"type":"text","value":"We first define which Gaia columns to copy to the matched catalog as well as the matching distance.","position":{"start":{"line":571,"column":1},"end":{"line":571,"column":1}},"key":"L4b4advHaI"}],"key":"csjYZj2afP"}],"key":"E8zRu7TfkV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"gaia_keys = [\"source_id\", \"phot_g_mean_mag\", \"phot_bp_mean_mag\", \"phot_rp_mean_mag\",\"ra\",\"dec\",\"pmra\",\"pmdec\"]\nmatching_distance = 0.6*u.arcsecond","key":"TdKK5edtb2"},{"type":"output","id":"Di_SznH-jfmilv0XLtKZM","data":[],"key":"Q0KX640aBU"}],"key":"nIxl2NuRqE"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":578,"column":1},"end":{"line":578,"column":1}},"children":[{"type":"text","value":"First match to the VIS image. We use the ","position":{"start":{"line":578,"column":1},"end":{"line":578,"column":1}},"key":"PykMhvOnrp"},{"type":"inlineCode","value":"astropy","position":{"start":{"line":578,"column":1},"end":{"line":578,"column":1}},"key":"R4mvYwiVLW"},{"type":"text","value":" ","position":{"start":{"line":578,"column":1},"end":{"line":578,"column":1}},"key":"qqWZAVBuKq"},{"type":"emphasis","position":{"start":{"line":578,"column":1},"end":{"line":578,"column":1}},"children":[{"type":"text","value":"SkyCoord()","position":{"start":{"line":578,"column":1},"end":{"line":578,"column":1}},"key":"j9QijOUhGh"}],"key":"QmR7bSJ5Iv"},{"type":"text","value":" function for matching in sky coordinates.","position":{"start":{"line":578,"column":1},"end":{"line":578,"column":1}},"key":"lF0wn8hsit"}],"key":"zvGrOOLjdf"}],"key":"LdQnVFtt2V"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"c = SkyCoord(ra=phot[\"ra_fit\"]*u.degree, dec=phot[\"dec_fit\"]*u.degree )\ncatalog = SkyCoord(ra=gaia_objects[\"ra\"].data*u.degree, dec=gaia_objects[\"dec\"].data*u.degree)\nidx, d2d, d3d = c.match_to_catalog_sky(catalog)\n\nsel_matched = np.where(d2d.to(u.arcsecond) \u003c (matching_distance))[0]\nprint(\"Gaia Sources matched to VIS: {}\".format( len(sel_matched) ) )\nphot[\"gaia_distance\"] = d2d.to(u.arcsecond)\n\nfor gaia_key in gaia_keys:\n    phot[\"gaia_{}\".format(gaia_key)] = 0.0\n    phot[\"gaia_{}\".format(gaia_key)][sel_matched] = gaia_objects[gaia_key][idx[sel_matched]]","key":"PFih3FmzPa"},{"type":"output","id":"PpJhPe4SYONohNATNrdop","data":[{"output_type":"stream","name":"stdout","text":"Gaia Sources matched to VIS: 1223\n"}],"key":"TNcmxHBSFK"}],"key":"mBH0KKx4tr"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":594,"column":1},"end":{"line":594,"column":1}},"children":[{"type":"text","value":"And then we add the NISP sources. Note that we do not have to perform matching here because by design the VIS and NISP sources are matched (spatial prior forced photometry).","position":{"start":{"line":594,"column":1},"end":{"line":594,"column":1}},"key":"JaOiZ6z0zz"}],"key":"Yv3br5qDon"}],"key":"V5i8TUJSxh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"phot2[\"gaia_distance\"] = d2d.to(u.arcsecond)\n\nfor gaia_key in gaia_keys:\n    phot2[\"gaia_{}\".format(gaia_key)] = 0.0\n    phot2[\"gaia_{}\".format(gaia_key)][sel_matched] = gaia_objects[gaia_key][idx[sel_matched]]","key":"KcskdZfzhX"},{"type":"output","id":"0tAl1uGqCHA7UUD04z9hZ","data":[],"key":"SDsq99U5Cx"}],"key":"HXppH74xiC"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":604,"column":1},"end":{"line":604,"column":1}},"children":[{"type":"text","value":"Once matched, we can now compare the Gaia and Euclid/NISP magnitudes of the stars.","position":{"start":{"line":604,"column":1},"end":{"line":604,"column":1}},"key":"TRZ6RIHs8X"}],"key":"i7nyshQgo8"}],"key":"ceYGHsQ4Fv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Data\nx = phot[\"gaia_phot_rp_mean_mag\"]\ny = -2.5*np.log10(phot[\"flux_fit\"]) + hdr[\"ZP_STACK\"]\n\n# selection\nsel_good = np.where(phot[\"gaia_source_id\"] \u003e 0)[0]\nx = x[sel_good]\ny = y[sel_good]\n\nfig = plt.figure(figsize=(6,5))\nax1 = fig.add_subplot(1,1,1)\n\nax1.plot(x , y , \"o\", markersize=2)\nminlim = np.nanmin(np.concatenate((x,y)))\nmaxlim = np.nanmax(np.concatenate((x,y)))\n\nax1.fill_between(np.asarray([minlim,maxlim]),np.asarray([minlim,maxlim])/1.5,np.asarray([minlim,maxlim])*1.5, color=\"gray\", alpha=0.2, linewidth=0)\nax1.fill_between(np.asarray([minlim,maxlim]),np.asarray([minlim,maxlim])/1.2,np.asarray([minlim,maxlim])*1.2, color=\"gray\", alpha=0.4, linewidth=0)\nax1.plot(np.asarray([minlim,maxlim]),np.asarray([minlim,maxlim]), \":\", color=\"gray\")\n\nax1.set_xlabel(\"Gaia Rp [mag]\")\nax1.set_ylabel(\"I$_E$ [mag]\")\nplt.show()","key":"eXfycNThB6"},{"type":"output","id":"DtLIk9QPqj6e85zkeTWF3","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 600x500 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"dfaa3975ed0b422fbd63c8aff8ad5c89","path":"/irsa-tutorials/build/dfaa3975ed0b422fbd63c8aff8ad5c89.png"}}}],"key":"DHTbcZgf28"}],"key":"RKqYluZU93"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":632,"column":1},"end":{"line":632,"column":1}},"children":[{"type":"text","value":"Visualization with Firefly","position":{"start":{"line":632,"column":1},"end":{"line":632,"column":1}},"key":"fXoMxJPxN1"}],"identifier":"visualization-with-firefly","label":"Visualization with Firefly","html_id":"visualization-with-firefly","implicit":true,"key":"b69uY58iiF"},{"type":"paragraph","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":1}},"children":[{"type":"text","value":"At the end of this Notebook, we demonstrate how we can visualize the images and catalogs created above in ","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":1}},"key":"NH1yiNIaFR"},{"type":"inlineCode","value":"Firefly","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":1}},"key":"KwqWC94Fo4"},{"type":"text","value":".","position":{"start":{"line":634,"column":1},"end":{"line":634,"column":1}},"key":"MGXLJdHYbU"}],"key":"ZhLpwwxhBl"},{"type":"paragraph","position":{"start":{"line":636,"column":1},"end":{"line":637,"column":1}},"children":[{"type":"text","value":"We start by initializing the Firefly client.\nThe following line will open a new ","position":{"start":{"line":636,"column":1},"end":{"line":636,"column":1}},"key":"A3lTu6Xxho"},{"type":"inlineCode","value":"Firefly","position":{"start":{"line":636,"column":1},"end":{"line":636,"column":1}},"key":"XJTlXAQsId"},{"type":"text","value":" GUI in a separate tab ","position":{"start":{"line":636,"column":1},"end":{"line":636,"column":1}},"key":"JGy38NQ4Y4"},{"type":"strong","position":{"start":{"line":636,"column":1},"end":{"line":636,"column":1}},"children":[{"type":"text","value":"inside","position":{"start":{"line":636,"column":1},"end":{"line":636,"column":1}},"key":"P5z1Y7IWEe"}],"key":"wMQx7KDo5F"},{"type":"text","value":" the Jupyter Notebook environment. The user can drag the tab onto the currently open tab to create a “split tab”. This the user to see the code and images side-by-side.","position":{"start":{"line":636,"column":1},"end":{"line":636,"column":1}},"key":"zb3lb4qPln"}],"key":"TTJurBxlf3"}],"key":"WoPRnxbFL8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Uncomment when using within Jupyter Lab with jupyter_firefly_extensions installed\n# fc = FireflyClient.make_lab_client()\n\n# Uncomment for contexts other than the above\nfc = FireflyClient.make_client(url=\"https://irsa.ipac.caltech.edu/irsaviewer\")","key":"O8TDCKDpbX"},{"type":"output","id":"tk5CgZ12cdkcTKv0gqWsU","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cIPython.core.display.HTML object\u003e","content_type":"text/plain"},"text/html":{"content":"Open your web browser to \u003ca href=\"https://irsa.ipac.caltech.edu/irsaviewer/?__wsch=MjAyNS0xMS0wNg\"\" target=\"_blank\"\u003ethis link\u003c/a\u003e","content_type":"text/html"}}}],"key":"Y3q03ea6wA"}],"key":"LmsGY3Soz5"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":647,"column":1},"end":{"line":648,"column":1}},"children":[{"type":"text","value":"In order to display in image or catalog in ","position":{"start":{"line":647,"column":1},"end":{"line":647,"column":1}},"key":"NYD7jPXD2Y"},{"type":"inlineCode","value":"Firefly","position":{"start":{"line":647,"column":1},"end":{"line":647,"column":1}},"key":"Y03wynIowP"},{"type":"text","value":", it needs to be uploaded to the ","position":{"start":{"line":647,"column":1},"end":{"line":647,"column":1}},"key":"mxfSWLitO6"},{"type":"inlineCode","value":"Firefly","position":{"start":{"line":647,"column":1},"end":{"line":647,"column":1}},"key":"uWdQXGxt8N"},{"type":"text","value":" server. We do this here using the ","position":{"start":{"line":647,"column":1},"end":{"line":647,"column":1}},"key":"S9lLSnEJHH"},{"type":"inlineCode","value":"upload_file()","position":{"start":{"line":647,"column":1},"end":{"line":647,"column":1}},"key":"Blj2MPx3Y4"},{"type":"text","value":" function.\nWe first upload the FITS image that we created above.","position":{"start":{"line":647,"column":1},"end":{"line":647,"column":1}},"key":"ujZsl2rjsx"}],"key":"puIio6PwvN"}],"key":"CQ2lcChmyT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fval = fc.upload_file('./data/euclid_images_test.fits')","key":"waBOcWjZKd"},{"type":"output","id":"rwu5GfLA99152QJ_gAYdU","data":[],"key":"zwm3R3nch3"}],"key":"GSnRerNJ8K"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":654,"column":1},"end":{"line":655,"column":1}},"children":[{"type":"text","value":"Once the image is uploaded we can use the ","position":{"start":{"line":654,"column":1},"end":{"line":654,"column":1}},"key":"DUrTst30Bz"},{"type":"inlineCode","value":"show_fits()","position":{"start":{"line":654,"column":1},"end":{"line":654,"column":1}},"key":"ZioWalhVOv"},{"type":"text","value":" function to display it.\nNote that our FITS image has multiple extensions (VIS, and NISP bands). We can open them separately in new ","position":{"start":{"line":654,"column":1},"end":{"line":654,"column":1}},"key":"YMguijUssc"},{"type":"inlineCode","value":"Firefly","position":{"start":{"line":654,"column":1},"end":{"line":654,"column":1}},"key":"bhkTem19CQ"},{"type":"text","value":" tabs by looping over the HDUs and specifying the plot ID by the extension’s name.","position":{"start":{"line":654,"column":1},"end":{"line":654,"column":1}},"key":"P0GzSQZ08Q"}],"key":"j5k3VB52hX"}],"key":"BupmpGwf6d"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for hh,hdu in enumerate(hdulcutout):\n    fc.show_fits(fval, MultiImageIdx=hh, plot_id=hdu.header[\"EXTNAME\"] )","key":"GQ0739cqVU"},{"type":"output","id":"dBfw5UhLGm0Bl_ugzcT0n","data":[{"output_type":"stream","name":"stdout","text":"WARNING: show_fits() is deprecated. Use show_fits_image() instead.\nWARNING: show_fits() is deprecated. Use show_fits_image() instead.\nWARNING: show_fits() is deprecated. Use show_fits_image() instead.\n"},{"output_type":"stream","name":"stdout","text":"WARNING: show_fits() is deprecated. Use show_fits_image() instead.\n"}],"key":"D4maDlO1VI"}],"key":"ruF7SgB9v5"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":662,"column":1},"end":{"line":662,"column":1}},"children":[{"type":"text","value":"We can lock the WCS between the images (allowing the user to pan and zoom the images simultaneously) by running:","position":{"start":{"line":662,"column":1},"end":{"line":662,"column":1}},"key":"IxejvRLOrm"}],"key":"P4H1EPv4lx"}],"key":"NqPBs7Yl1H"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fc.align_images(lock_match=True)","key":"WNcPaN7jnz"},{"type":"output","id":"hnJvke2iAyalBApgFyd7e","data":[{"output_type":"execute_result","execution_count":45,"metadata":{},"data":{"text/plain":{"content":"{'success': True}","content_type":"text/plain"}}}],"key":"VkIw0mygCg"}],"key":"IWUKlk2o9c"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"children":[{"type":"text","value":"In the same way, we can upload a table, in this case our Gaia table. We again use ","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"K16IWXoBWV"},{"type":"inlineCode","value":"upload_file()","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"ZfQmPuSWPm"},{"type":"text","value":" but in this case we use ","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"j7alox5JHn"},{"type":"inlineCode","value":"show_table()","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"Y5S4CIX5Q3"},{"type":"text","value":" to show it in ","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"Dy6Ek44KpI"},{"type":"inlineCode","value":"Firefly","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"nQjuaRi6y8"},{"type":"text","value":".","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"m4TdcQEOXf"}],"key":"yJjxNeVrgA"}],"key":"iZtSblKybS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"tval = fc.upload_file('./data/gaiatable.csv')\nfc.show_table(tval, tbl_id = \"gaiatable\")","key":"sussCkwL7Y"},{"type":"output","id":"dzKZ15B_v2283hv3PDJzQ","data":[{"output_type":"execute_result","execution_count":46,"metadata":{},"data":{"text/plain":{"content":"{'success': True}","content_type":"text/plain"}}}],"key":"pT60SIkyFr"}],"key":"FM0rf1P1lX"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":675,"column":1},"end":{"line":675,"column":1}},"children":[{"type":"text","value":"Now, check out the ","position":{"start":{"line":675,"column":1},"end":{"line":675,"column":1}},"key":"jQiun3W71N"},{"type":"inlineCode","value":"Firefly","position":{"start":{"line":675,"column":1},"end":{"line":675,"column":1}},"key":"D3Ls1oOPeI"},{"type":"text","value":" GUI. You can zoom the images, click on sources, filter the table, display different selection, and much more!","position":{"start":{"line":675,"column":1},"end":{"line":675,"column":1}},"key":"VDGY40Z4t7"}],"key":"lrvMPoOCZB"}],"key":"LZsZ8HnyEN"},{"type":"block","position":{"start":{"line":677,"column":1},"end":{"line":677,"column":1}},"children":[{"type":"thematicBreak","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"key":"B4OpCBYNQR"},{"type":"heading","depth":2,"position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"children":[{"type":"text","value":"About this Notebook","position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"key":"KjNLZiqS34"}],"identifier":"about-this-notebook","label":"About this Notebook","html_id":"about-this-notebook","implicit":true,"key":"Vx0oK2DScz"},{"type":"paragraph","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":1}},"children":[{"type":"strong","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":1}},"children":[{"type":"text","value":"Author","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":1}},"key":"w2XL0sk741"}],"key":"idfsSmvMUm"},{"type":"text","value":": Andreas Faisst (IPAC Scientist)","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":1}},"key":"Pncvm96MTq"}],"key":"WQMg9smRau"},{"type":"paragraph","position":{"start":{"line":685,"column":1},"end":{"line":685,"column":1}},"children":[{"type":"strong","position":{"start":{"line":685,"column":1},"end":{"line":685,"column":1}},"children":[{"type":"text","value":"Updated","position":{"start":{"line":685,"column":1},"end":{"line":685,"column":1}},"key":"cqfFRQGBpE"}],"key":"b3BLQY4Zle"},{"type":"text","value":": 2025-03-17","position":{"start":{"line":685,"column":1},"end":{"line":685,"column":1}},"key":"ZWFKJ7f0gh"}],"key":"i53s3Q0oG4"},{"type":"paragraph","position":{"start":{"line":687,"column":1},"end":{"line":687,"column":1}},"children":[{"type":"strong","position":{"start":{"line":687,"column":1},"end":{"line":687,"column":1}},"children":[{"type":"text","value":"Contact","position":{"start":{"line":687,"column":1},"end":{"line":687,"column":1}},"key":"CDm7zMLw0b"}],"key":"SbrWNIQbnf"},{"type":"text","value":": the ","position":{"start":{"line":687,"column":1},"end":{"line":687,"column":1}},"key":"EJQMLrAhYw"},{"type":"link","url":"https://irsa.ipac.caltech.edu/docs/help_desk.html","position":{"start":{"line":687,"column":1},"end":{"line":687,"column":1}},"children":[{"type":"text","value":"IRSA Helpdesk","position":{"start":{"line":687,"column":1},"end":{"line":687,"column":1}},"key":"sN8AWxgBrU"}],"urlSource":"https://irsa.ipac.caltech.edu/docs/help_desk.html","key":"ToqaUV3uKO"},{"type":"text","value":" with questions or reporting problems.","position":{"start":{"line":687,"column":1},"end":{"line":687,"column":1}},"key":"zThJvffcDw"}],"key":"vnxqnO8GRQ"}],"key":"QH6m3Zl58h"}],"key":"hsvLfesgN9"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Understanding and Extracting the PSF Extension in a SPHEREx Cutout","url":"/spherex-psf","group":"SPHEREx"},"next":{"title":"Euclid Q1: MER mosaics","url":"/euclid-intro-mer-images","group":"Euclid Quick Release 1"}}},"domain":"http://localhost:3000"},"project":{"subject":"IRSA Tutorials","settings":{"output_matplotlib_strings":"remove"},"title":"IRSA Tutorials","description":"IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)","authors":[{"id":"IRSA Scientists and Developers","name":"IRSA Scientists and Developers"}],"github":"https://github.com/Caltech-IPAC/irsa-tutorials/","keywords":["astronomy"],"thebe":{"binder":{"url":"https://mybinder.org","provider":"github","repo":"https://github.com/Caltech-IPAC/irsa-tutorials/","ref":"HEAD"}},"toc":[{"file":"index.md","title":"IRSA Tutorials"},{"children":[{"file":"tutorials/spherex/spherex_intro.md"},{"file":"tutorials/spherex/spherex_cutouts.md"},{"file":"tutorials/spherex/spherex_psf.md"}],"title":"SPHEREx"},{"children":[{"children":[{"file":"tutorials/euclid_access/Euclid_ERO.md"}],"title":"Euclid Early Release Observations"},{"children":[{"file":"tutorials/euclid_access/1_Euclid_intro_MER_images.md"},{"file":"tutorials/euclid_access/2_Euclid_intro_MER_catalog.md"},{"file":"tutorials/euclid_access/3_Euclid_intro_1D_spectra.md"},{"file":"tutorials/euclid_access/4_Euclid_intro_PHZ_catalog.md"},{"file":"tutorials/euclid_access/5_Euclid_intro_SPE_catalog.md"},{"file":"tutorials/cloud_access/euclid-cloud-access.md"}],"title":"Euclid Quick Release 1"}],"title":"Euclid"},{"children":[{"children":[{"file":"tutorials/irsa-sia-examples/sia_allwise_atlas.md"},{"file":"tutorials/parquet-catalog-demos/wise-allwise-catalog-demo.md"}],"title":"AllWISE"},{"children":[{"file":"tutorials/firefly/NEOWISE_light_curve_demo.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-strategies.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-lightcurves.md"}],"title":"NEOWISE"}],"title":"WISE"},{"children":[{"file":"tutorials/irsa-sia-examples/siav2_seip.md"}],"title":"Spitzer"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_2mass_allsky.md"}],"title":"2MASS"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_cosmos.md"}],"title":"COSMOS"},{"children":[{"children":[{"file":"tutorials/roman_simulations/roman_hlss_number_density.md"}],"title":"Roman HLSS Galaxy Mock Catalog"},{"children":[{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_wideareasurvey.md"},{"file":"tutorials/firefly/OpenUniverse2024Preview_Firefly.md"},{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_timedomainsurvey.md"}],"title":"OpenUniverse 2024"},{"children":[{"file":"tutorials/cosmodc2/cosmoDC2_TAP_access.md"}],"title":"CosmoDC2"}],"title":"Simulated Data"},{"children":[{"file":"tutorials/cloud_access/cloud-access-intro.md"},{"file":"tutorials/parquet-catalog-demos/irsa-hats-with-lsdb.md"},{"file":"tutorials/firefly/SEDs_in_Firefly.md"},{"file":"tutorials/parallelize/Parallelize_Convolution.md"}],"title":"Special Topics"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"SPHEREx"},{"slug":"spherex-intro","title":"Introduction to SPHEREx Spectral Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-cutouts","title":"Download a collection of SPHEREx Spectral Image cutouts as a multi-extension FITS file","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-psf","title":"Understanding and Extracting the PSF Extension in a SPHEREx Cutout","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Euclid"},{"level":2,"title":"Euclid Early Release Observations"},{"slug":"euclid-ero","title":"Exploring Star Clusters in the Euclid ERO Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Euclid Quick Release 1"},{"slug":"euclid-intro-mer-images","title":"Euclid Q1: MER mosaics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-mer-catalog","title":"Euclid Q1: MER catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-1d-spectra","title":"Euclid Q1: 1D spectra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-phz-catalog","title":"Euclid Q1: PHZ catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-spe-catalog","title":"Euclid Q1: SPE catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-cloud-access","title":"Euclid Q1: cloud access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"WISE"},{"level":2,"title":"AllWISE"},{"slug":"sia-allwise-atlas","title":"Searching for AllWISE Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"wise-allwise-catalog-demo","title":"Analyzing cloud-hosted AllWISE Source Catalog in Parquet format","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"NEOWISE"},{"slug":"neowise-light-curve-demo","title":"Using Firefly visualization tools to understand the light curves of Solar System objects","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-strategies","title":"Strategies to Efficiently Work with NEOWISE Single-exposure Source Table in Parquet","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-lightcurves","title":"Make Light Curves from NEOWISE Single-exposure Source Table","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Spitzer"},{"slug":"siav2-seip","title":"Searching for Spitzer Enhanced Imaging Products","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"2MASS"},{"slug":"sia-2mass-allsky","title":"Searching for 2MASS All-Sky Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"COSMOS"},{"slug":"sia-cosmos","title":"Searching for contributed COSMOS images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Simulated Data"},{"level":2,"title":"Roman HLSS Galaxy Mock Catalog"},{"slug":"roman-hlss-number-density","title":"Number Density as a Function of Redshift","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"OpenUniverse 2024"},{"slug":"openuniverse2024-roman-simulated-wideareasurvey","title":"Analyzing cloud-hosted simulated Roman coadded images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024preview-firefly","title":"Using Firefly to Explore OpenUniverse2024 Data Preview Simulated Roman and Rubin Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024-roman-simulated-timedomainsurvey","title":"Analyzing cloud-hosted simulated Roman Time Domain Survey images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"CosmoDC2"},{"slug":"cosmodc2-tap-access","title":"Querying CosmoDC2 Mock v1 catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Special Topics"},{"slug":"cloud-access-intro","title":"IRSA cloud access introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"irsa-hats-with-lsdb","title":"Access HATS Collections Using LSDB: Euclid Q1 and ZTF DR23","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"seds-in-firefly","title":"Using Firefly visualization tools in Python to vet SEDs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"parallelize-convolution","title":"Parallelizing image convolution","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/irsa-tutorials/build/manifest-ED236704.js";
import * as route0 from "/irsa-tutorials/build/root-ZJOPFBMV.js";
import * as route1 from "/irsa-tutorials/build/routes/$-CQPS5IOR.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/irsa-tutorials/build/entry.client-UNPC4GT3.js");</script></body></html>