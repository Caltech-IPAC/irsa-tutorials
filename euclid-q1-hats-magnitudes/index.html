<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Euclid Q1 Merged Objects HATS Catalog: Magnitudes - IRSA Tutorials</title><meta property="og:title" content="Euclid Q1 Merged Objects HATS Catalog: Magnitudes - IRSA Tutorials"/><meta name="generator" content="mystmd"/><meta name="description" content="IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)"/><meta property="og:description" content="IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)"/><meta name="keywords" content="astronomy"/><link rel="stylesheet" href="/irsa-tutorials/build/_assets/app-2K3KGISG.css"/><link rel="stylesheet" href="/irsa-tutorials/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/irsa-tutorials/favicon.ico"/><link rel="stylesheet" href="/irsa-tutorials/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="myst-skip-to-article fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article content</a></div><dialog id="myst-no-css" style="position:fixed;left:0px;top:0px;width:100%;height:100vh;font-size:4rem;padding:1rem;color:black;background:white"><strong>Site not loading correctly?</strong><p>This may be due to an incorrect <code>BASE_URL</code> configuration. See<!-- --> <a href="https://mystmd.org/guide/deployment#deploy-base-url">the MyST Documentation</a> <!-- -->for reference.</p><script>
    (() => {
            // Test for has-styling variable set by the MyST stylesheet
            const node = document.currentScript.parentNode;
            const hasCSS = window.getComputedStyle(node).getPropertyValue("--has-styling");
            if (hasCSS === ""){
                    node.showModal();
            }

    })()
</script></dialog><div class="myst-top-nav bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-full top-0 z-30 h-[60px]"><nav class="myst-top-nav-bar flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="myst-top-nav-menu-button flex items-center justify-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100 w-10 h-10"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="myst-home-link flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/irsa-tutorials/"><div class="myst-home-link-logo mr-3 flex items-center dark:bg-white dark:rounded px-1"><img src="/irsa-tutorials/build/irsa_logo-4e5abb7b6b904d81b25e7ff1c9f34dae.png" class="h-9" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R75cp:" data-state="closed" class="myst-search-bar flex items-center h-10 aspect-square sm:w-64 text-left text-gray-600 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 myst-search-bar-disabled hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="myst-search-text-placeholder hidden sm:block grow">Search</span><div aria-hidden="true" class="myst-search-shortcut items-center hidden mx-1 font-mono text-sm text-gray-600 dark:text-gray-300 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="myst-theme-button theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-10 h-10 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-moon-icon h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-sun-icon h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="myst-primary-sidebar fixed xl:article-grid grid-gap xl:w-full xl:pointer-events-none overflow-auto max-xl:w-[75vw] max-xl:max-w-[350px] max-xl:!top-0 max-xl:h-screen hidden z-10" style="top:60px"><div class="myst-primary-sidebar-pointer pointer-events-auto xl:col-margin-left flex-col overflow-hidden max-xl:h-full hidden xl:flex"><div class="myst-primary-sidebar-nav flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="myst-primary-sidebar-topnav overflow-y-hidden transition-opacity lg:hidden ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="myst-primary-sidebar-toc flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="myst-toc w-full px-1 dark:text-white"><a title="IRSA Tutorials" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/irsa-tutorials/">IRSA Tutorials</a><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Spherex Tutorial Notebooks" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/irsa-tutorials/spherex">SPHEREx</a><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmpsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmpsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Euclid Tutorial Notebooks" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/irsa-tutorials/euclid">Euclid</a><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rupsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rupsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="WISE Tutorial Notebooks" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/irsa-tutorials/wise">WISE</a><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R16psp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R16psp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Spitzer" class="block break-words rounded py-2 grow cursor-pointer">Spitzer</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1epsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1epsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="2MASS" class="block break-words rounded py-2 grow cursor-pointer">2MASS</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1mpsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1mpsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="COSMOS" class="block break-words rounded py-2 grow cursor-pointer">COSMOS</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1upsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1upsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Simulated Data Tutorial Notebooks" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/irsa-tutorials/simulated">Simulated Data</a><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R26psp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R26psp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Techniques &amp; Tools Tutorial Notebooks" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/irsa-tutorials/techniques">Techniques &amp; Tools</a><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R2epsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R2epsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="myst-primary-sidebar-footer flex-none py-6 transition-all duration-700 translate-y-6 opacity-0 ml-3 xl:ml-0 mr-3 max-w-[350px]"><a class="myst-made-with-myst flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="myst-fm-block mb-8 pt-9"><div class="myst-fm-block-header flex items-center mb-5 h-6 text-sm font-light"><div class="myst-fm-block-subject flex-none pr-2 smallcaps">IRSA Tutorials</div><div class="flex-grow"></div><div class="myst-fm-block-badges"><a href="https://github.com/Caltech-IPAC/irsa-tutorials/" title="GitHub Repository: Caltech-IPAC/irsa-tutorials/" target="_blank" rel="noopener noreferrer" class="myst-fm-github-link text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="myst-fm-github-icon inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a></div><a href="https://github.com/Caltech-IPAC/irsa-tutorials//edit/main/tutorials/euclid/merged-objects-hats-catalog/4-euclid-q1-hats-magnitudes.md" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="myst-fm-edit-link text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-edit-icon inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="myst-fm-downloads-dropdown relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="myst-fm-downloads-button relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8ucp:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-downloads-icon"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div><button class="myst-fm-launch-button inline-flex size-[24px] hover:text-[#E18435] items-center justify-center" aria-label="Launch in external computing interface" title="Launch in external computing interface" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Re8ucp:" data-state="closed"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg" class="myst-fm-launch-icon"><path d="M6.85357 3.85355L7.65355 3.05353C8.2981 2.40901 9.42858 1.96172 10.552 1.80125C11.1056 1.72217 11.6291 1.71725 12.0564 1.78124C12.4987 1.84748 12.7698 1.97696 12.8965 2.10357C13.0231 2.23018 13.1526 2.50125 13.2188 2.94357C13.2828 3.37086 13.2779 3.89439 13.1988 4.44801C13.0383 5.57139 12.591 6.70188 11.9464 7.34645L7.49999 11.7929L6.35354 10.6465C6.15827 10.4512 5.84169 10.4512 5.64643 10.6465C5.45117 10.8417 5.45117 11.1583 5.64643 11.3536L7.14644 12.8536C7.34171 13.0488 7.65829 13.0488 7.85355 12.8536L8.40073 12.3064L9.57124 14.2572C9.65046 14.3893 9.78608 14.4774 9.9389 14.4963C10.0917 14.5151 10.2447 14.4624 10.3535 14.3536L12.3535 12.3536C12.4648 12.2423 12.5172 12.0851 12.495 11.9293L12.0303 8.67679L12.6536 8.05355C13.509 7.19808 14.0117 5.82855 14.1887 4.58943C14.2784 3.9618 14.2891 3.33847 14.2078 2.79546C14.1287 2.26748 13.9519 1.74482 13.6035 1.39645C13.2552 1.04809 12.7325 0.871332 12.2045 0.792264C11.6615 0.710945 11.0382 0.721644 10.4105 0.8113C9.17143 0.988306 7.80189 1.491 6.94644 2.34642L6.32322 2.96968L3.07071 2.50504C2.91492 2.48278 2.75773 2.53517 2.64645 2.64646L0.646451 4.64645C0.537579 4.75533 0.484938 4.90829 0.50375 5.0611C0.522563 5.21391 0.61073 5.34954 0.742757 5.42876L2.69364 6.59928L2.14646 7.14645C2.0527 7.24022 2.00002 7.3674 2.00002 7.50001C2.00002 7.63261 2.0527 7.75979 2.14646 7.85356L3.64647 9.35356C3.84173 9.54883 4.15831 9.54883 4.35357 9.35356C4.54884 9.1583 4.54884 8.84172 4.35357 8.64646L3.20712 7.50001L3.85357 6.85356L6.85357 3.85355ZM10.0993 13.1936L9.12959 11.5775L11.1464 9.56067L11.4697 11.8232L10.0993 13.1936ZM3.42251 5.87041L5.43935 3.85356L3.17678 3.53034L1.80638 4.90074L3.42251 5.87041ZM2.35356 10.3535C2.54882 10.1583 2.54882 9.8417 2.35356 9.64644C2.1583 9.45118 1.84171 9.45118 1.64645 9.64644L0.646451 10.6464C0.451188 10.8417 0.451188 11.1583 0.646451 11.3535C0.841713 11.5488 1.1583 11.5488 1.35356 11.3535L2.35356 10.3535ZM3.85358 11.8536C4.04884 11.6583 4.04885 11.3417 3.85359 11.1465C3.65833 10.9512 3.34175 10.9512 3.14648 11.1465L1.14645 13.1464C0.95119 13.3417 0.951187 13.6583 1.14645 13.8535C1.34171 14.0488 1.65829 14.0488 1.85355 13.8536L3.85358 11.8536ZM5.35356 13.3535C5.54882 13.1583 5.54882 12.8417 5.35356 12.6464C5.1583 12.4512 4.84171 12.4512 4.64645 12.6464L3.64645 13.6464C3.45119 13.8417 3.45119 14.1583 3.64645 14.3535C3.84171 14.5488 4.1583 14.5488 4.35356 14.3535L5.35356 13.3535ZM9.49997 6.74881C10.1897 6.74881 10.7488 6.1897 10.7488 5.5C10.7488 4.8103 10.1897 4.25118 9.49997 4.25118C8.81026 4.25118 8.25115 4.8103 8.25115 5.5C8.25115 6.1897 8.81026 6.74881 9.49997 6.74881Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button></div><h1 class="myst-fm-block-title mb-0">Euclid Q1 Merged Objects HATS Catalog: Magnitudes</h1><header class="myst-fm-authors-affiliations mt-4 not-prose"><div class="myst-fm-authors-list"><span class="myst-fm-author font-semibold text-sm myst-fm-author-item inline-block"><button class="myst-fm-author-popover focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78ucp:" data-state="closed"><span class="myst-fm-author-name">IRSA Scientists and Developers</span></button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div class="myst-jp-nb-toolbar sticky top-[60px] pb-[14px] flex justify-end w-full z-20 pointer-events-none"><div class="myst-jp-nb-toolbar-inner flex p-1 m-1 space-x-1 border rounded-full shadow pointer-events-auto border-stone-300 bg-white/80 dark:bg-stone-900/80 backdrop-blur"><div class="myst-jp-nb-toolbar-power rounded"><button class="myst-jp-nb-toolbar-power-btn flex text-center rounded-full cursor-pointer text-stone-800 dark:text-white hover:opacity-100 opacity-60" aria-label="start compute environment"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="inline-block w-6 h-6 align-top"><title>Launch kernel</title><path stroke-linecap="round" stroke-linejoin="round" d="M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"></path></svg></button></div></div></div><div id="skip-to-article"></div><p>This tutorial explores Euclid photometry measurements.
It assumes you are familiar with the <a class="link" href="/irsa-tutorials/euclid-q1-hats-intro">first tutorial</a> in this series, which covers the Euclid Q1 Merged Objects HATS Catalog content, format, and basic access.</p><h2 id="learning-goals" class="relative group"><span class="heading-text">Learning Goals</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#learning-goals" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>By the end of this tutorial, you will be able to:</p><ul><li><p>Understand the different Euclid Q1 flux measurements and their intended use cases.</p></li><li><p>Load aperture and template-fit magnitudes for Euclid I, Y, J, and H bands from the Euclid Q1 Merged Objects HATS Catalog.</p></li><li><p>Visualize and understand the template-fit magnitude distributions as a function of object classification.</p></li><li><p>Compare aperture and template-fit magnitudes to understand their differences.</p></li></ul><h2 id="id-1-introduction" class="relative group"><span class="heading-text">1. Introduction</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-introduction" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The <a target="_blank" rel="noreferrer" href="https://irsa.ipac.caltech.edu/data/Euclid/docs/overview_q1.html" class="link whitespace-nowrap"><span class="link-text whitespace-normal">Euclid Q1</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> data release contains photometry from Euclid as well as from external surveys.
There are several flux measurements per band.
The measurements are described in <a target="_blank" rel="noreferrer" href="https://arxiv.org/pdf/2503.15305" class="link whitespace-nowrap"><span class="link-text whitespace-normal">Euclid Collaboration: Romelli et al., 2025</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> (hereafter, Romelli), especially sections 6 and 8.</p><p>In this tutorial, we will look at aperture and template-fit photometry measurements in the four Euclid bands: I (from the VIS instrument), Y, J, and H (from the NISP instrument).
<strong>Aperture fluxes</strong> are generally more accurate for point-like sources, especially bright stars in the NIR bands, likely due to better handling of PSF-related effects.
<strong>Template-fit fluxes</strong> are expected to be more accurate for extended sources because the templates do a better job of excluding contamination from nearby sources.
Additional photometry measurements that we won’t cover here include: <strong>Sérsic-fit fluxes</strong> (computed for parametric morphology), <strong>PSF-fit fluxes</strong> (VIS only), and <strong>class-corrected fluxes</strong> that were corrected based on the PHZ (photometric) classifications.</p><p>The best-estimate flux in the detection band is given by the column <code>mer_flux_detection_total</code>.
This can also be used to color-correct flux measurements in non-detection bands, as we will demonstrate.
The object detection process is described in Romelli.
The <a target="_blank" rel="noreferrer" href="http://st-dm.pages.euclid-sgs.uk/data-product-doc/dmq1/merdpd/merphotometrycookbook.html" class="link whitespace-nowrap"><span class="link-text whitespace-normal">MER Photometry Cookbook</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> describes the color corrections and how to convert from flux to magnitude.
In this tutorial, we will restrict to objects detected in VIS (I band) because it simplifies the calculations.</p><h2 id="id-2-imports-and-paths" class="relative group"><span class="heading-text">2. Imports and Paths</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-imports-and-paths" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><div id="zKiWeccRDe" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># # Uncomment the next line to install dependencies if needed.
# %pip install hpgeom matplotlib pandas pyarrow</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="PNabAZJwZe24fdfrnqjck" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="KxM6sp34NN" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import hpgeom  # Find HEALPix indexes from RA and Dec
import matplotlib.pyplot as plt  # Create figures
import pyarrow.compute as pc  # Filter dataset
import pyarrow.dataset  # Load the dataset
import pyarrow.fs  # Simple S3 filesystem pointer
import pyarrow.parquet  # Load the schema

# Increase font size in figures.
plt.rcParams.update({&quot;font.size&quot;: 14})</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="u8FMjV-4tz2LUSDeU9EwE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Z9rRwA3ev3" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># AWS S3 paths.
s3_bucket = &quot;nasa-irsa-euclid-q1&quot;
dataset_prefix = &quot;contributed/q1/merged_objects/hats/euclid_q1_merged_objects-hats/dataset&quot;
dataset_path = f&quot;{s3_bucket}/{dataset_prefix}&quot;

# S3 pointer. Use `anonymous=True` to access without credentials.
s3 = pyarrow.fs.S3FileSystem(anonymous=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="XIbLRB7lPfj0BRlfB7LcP" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="id-3-load-template-fit-and-aperture-magnitudes" class="relative group"><span class="heading-text">3. Load Template-fit and Aperture Magnitudes</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-load-template-fit-and-aperture-magnitudes" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The following columns will be important.
Descriptions come from Romelli.</p><div id="mUH1WDwijh" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Whether the source was detected in VIS mosaic (1) or only in NIR-stack mosaic (0).
VIS_DET = &quot;mer_vis_det&quot;

# Best estimate of the total flux in the detection band.
# From aperture photometry within a Kron radius.
# Detection band is VIS if `VIS_DET == 1`. Otherwise, this is a
# non-physical NIR-stack flux and there was no VIS detection (aka, NIR-only).
# We will only deal with VIS-detected objects in this notebook.
FLUX_DET_TOTAL = &quot;mer_flux_detection_total&quot;

# Peak surface brightness minus the magnitude used for `mer_point_like_prob`.
# This is a measure of compactness.
MUMAX_MINUS_MAG = &quot;mer_mumax_minus_mag&quot;

# Whether the detection has a &gt;50% probability of being spurious (1=Yes, 0=No).
SPURIOUS_FLAG = &quot;mer_spurious_flag&quot;

# PHZ classification: 1=Star, 2=Galaxy, 4=QSO.
# Combinations (3, 5, 6, and 7) indicate multiple probability thresholds were exceeded.
PHZ_CLASS = &quot;phz_phz_classification&quot;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="6-BWSXBQaV2AmAngiqWma" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>We’ll convert the catalog fluxes to magnitudes following the <a target="_blank" rel="noreferrer" href="http://st-dm.pages.euclid-sgs.uk/data-product-doc/dmq1/merdpd/merphotometrycookbook.html" class="link whitespace-nowrap"><span class="link-text whitespace-normal">MER Photometry Cookbook</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.
PyArrow can do the conversion during the read operation and return only the magnitudes.
To do this, we’ll use the following function to define the magnitudes as <code>pyarrow.compute</code> (<code>pc</code>) functions, which are described at <a target="_blank" rel="noreferrer" href="https://arrow.apache.org/docs/python/api/compute.html" class="link whitespace-nowrap"><span class="link-text whitespace-normal">Compute Functions</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.</p><div id="I8pZAzUX0J" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def flux_to_magnitude(flux_col_name: str) -&gt; pc.Expression:
    &quot;&quot;&quot;Convert catalog fluxes to magnitudes following the MER Photometry Cookbook.

    Parameters
    ----------
    flux_col_name : str
        The name of the flux column to convert to magnitude.

    Returns
    -------
    pyarrow.compute.Expression
        An expression for the magnitude. It can be used in the `filter` and `columns`
        keyword arguments when loading data from a PyArrow dataset.
    &quot;&quot;&quot;
    # We expect to be dealing with VIS_DET == 1 objects, so FLUX_DET_TOTAL == VIS flux.
    vis_flux = pc.field(FLUX_DET_TOTAL)
    band_flux = pc.field(flux_col_name)

    if flux_col_name == FLUX_DET_TOTAL:
        # Best-estimate flux in VIS is FLUX_DET_TOTAL.
        best_flux = vis_flux
    elif flux_col_name.endswith(&quot;_templfit&quot;):
        # Best-estimate template-fit flux is the band flux scaled by a color correction.
        band = flux_col_name.split(&quot;_&quot;)[-2]  # y, j, or h
        color_scale = pc.divide(vis_flux, pc.field(f&quot;mer_flux_vis_to_{band}_templfit&quot;))
        best_flux = pc.multiply(band_flux, color_scale)
    elif flux_col_name.endswith(&quot;aper&quot;):
        # Best-estimate aperture flux is the band flux scaled by a color correction.
        nfwhm = flux_col_name.split(&quot;_&quot;)[-2]  # e.g., 2fwhm
        color_scale = pc.divide(vis_flux, pc.field(f&quot;mer_flux_vis_{nfwhm}_aper&quot;))
        best_flux = pc.multiply(band_flux, color_scale)

    # magnitude = -2.5 * log10(flux) + 23.9.
    scale = pc.scalar(-2.5)
    log10_flux = pc.log10(best_flux)
    zeropoint = pc.scalar(23.9)
    mag_expression = pc.add(pc.multiply(scale, log10_flux), zeropoint)
    return mag_expression</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="zl2hOxzBYo06Bkb5Qb_Ui" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Define the columns we want to load.
This needs to be a dictionary (rather than a simple list of column names) because we’re asking PyArrow to compute the magnitudes dynamically from the catalog fluxes.
The dictionary keys will be the column names in the resultant table.
The values must be <code>pyarrow.compute</code> expressions (described above).</p><div id="huPDYzTNCh" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">I_MAG = &quot;I (mag)&quot;
columns = {
    PHZ_CLASS: pc.field(PHZ_CLASS),
    I_MAG: flux_to_magnitude(FLUX_DET_TOTAL),
    &quot;Y aperture (mag)&quot;: flux_to_magnitude(&quot;mer_flux_y_2fwhm_aper&quot;),
    &quot;J aperture (mag)&quot;: flux_to_magnitude(&quot;mer_flux_j_2fwhm_aper&quot;),
    &quot;H aperture (mag)&quot;: flux_to_magnitude(&quot;mer_flux_h_2fwhm_aper&quot;),
    &quot;Y templfit (mag)&quot;: flux_to_magnitude(&quot;mer_flux_y_templfit&quot;),
    &quot;J templfit (mag)&quot;: flux_to_magnitude(&quot;mer_flux_j_templfit&quot;),
    &quot;H templfit (mag)&quot;: flux_to_magnitude(&quot;mer_flux_h_templfit&quot;),
    MUMAX_MINUS_MAG: pc.field(MUMAX_MINUS_MAG),
}
# Let&#x27;s see what one of these looks like.
columns[&quot;Y aperture (mag)&quot;]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Yf_x0pCxG5XH9RDG2Ef-6" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-text" class="font-mono text-sm whitespace-pre-wrap myst-jp-safe-output-text"><code><span>&lt;pyarrow.compute.Expression add(multiply(-2.5, log10(multiply(mer_flux_y_2fwhm_aper, divide(mer_flux_detection_total, mer_flux_vis_2fwhm_aper)))), 23.9)&gt;</span></code></div></div></div><p>We’ll restrict to the Euclid Deep Field - Fornax (EDF-F) to reduce the amount of data loaded.
Compute the HEALPix order 9 pixel indexes, following the <a class="link" href="/irsa-tutorials/euclid-q1-hats-intro">introductory tutorial</a>.</p><div id="HCkksOjPiX" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">ra, dec, radius = 52.932, -28.088, 3  # 10 sq deg
edff_k9_pixels = hpgeom.query_circle(hpgeom.order_to_nside(9), ra, dec, radius, inclusive=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="mut9CLyyX9ROMBBNkz0cV" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Construct the row filter.</p><div id="VDPhwxY5KR" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">row_filter = (
    # Stars, Galaxies, QSOs, and mixed classes.
    pc.field(PHZ_CLASS).isin([1, 2, 3, 4, 5, 6, 7])
    # Basic quality cut.
    &amp; (pc.field(SPURIOUS_FLAG) == 0)
    # VIS-detected objects. (If you want to include NIR-only objects, alter flux_to_magnitude()
    # following MER Photometry Cookbook and also comment out the next line.)
    &amp; (pc.field(VIS_DET) == 1)
    # EDF-F region. (Comment out the next line to do an all-sky search.)
    &amp; pc.field(&quot;_healpix_9&quot;).isin(edff_k9_pixels)
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="cmo6BOicXk0yGH-ipsNvK" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Load the data.</p><div id="NwqEd2kRTT" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Load the catalog as a PyArrow dataset. Include partitioning=&quot;hive&quot;
# so PyArrow understands the file naming scheme and can navigate the partitions.
schema = pyarrow.parquet.read_schema(f&quot;{dataset_path}/_common_metadata&quot;, filesystem=s3)
dataset = pyarrow.dataset.dataset(dataset_path, partitioning=&quot;hive&quot;, filesystem=s3, schema=schema)

mags_df = dataset.to_table(columns=columns, filter=row_filter).to_pandas()
mags_df</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="AB2_ac-2tRKlPzMwW6VZW" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><h2 id="id-4-magnitude-distributions-of-galaxies-stars-and-qsos" class="relative group"><span class="heading-text">4. Magnitude Distributions of Galaxies, Stars, and QSOs</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4-magnitude-distributions-of-galaxies-stars-and-qsos" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Let’s visualize the template-fit magnitude distributions as a function of PHZ classification.
Since the template-fit photometry is recommended for extended objects, we’ll separate the point-like objects.
<a target="_blank" rel="noreferrer" href="https://arxiv.org/pdf/2503.15306" class="link whitespace-nowrap"><span class="link-text whitespace-normal">Euclid Collaboration: Tucci et al., 2025</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> defines point-like objects as having <code>MUMAX_MINUS_MAG &lt; -2.5</code>.</p><div id="IlA2HGbq0c" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Galaxy + any. Star + galaxy. QSO + galaxy.
classes = {&quot;Galaxy&quot;: (2, 3, 6, 7), &quot;Star&quot;: (1, 3), &quot;QSO&quot;: (4, 6)}
class_colors = [&quot;tab:green&quot;, &quot;tab:blue&quot;, &quot;tab:orange&quot;]

bands = [I_MAG, &quot;Y templfit (mag)&quot;, &quot;J templfit (mag)&quot;, &quot;H templfit (mag)&quot;]
mag_limits = (14, 28)  # Excluding all magnitudes outside this range.
hist_kwargs = dict(bins=20, range=mag_limits, histtype=&quot;step&quot;)

fig, axes = plt.subplots(3, 4, figsize=(18, 12), sharey=&quot;row&quot;, sharex=True)
for (class_name, class_ids), class_color in zip(classes.items(), class_colors):
    hist_kwargs[&quot;color&quot;] = class_color

    # Get the objects that are in this class only.
    class_df = mags_df.loc[mags_df[PHZ_CLASS] == class_ids[0]]
    # Plot histograms for each band. Galaxies on top row, then stars, then QSOs.
    axs = axes[0] if class_name == &quot;Galaxy&quot; else (axes[1] if class_name == &quot;Star&quot; else axes[2])
    for ax, band in zip(axs, bands):
        ax.hist(class_df[band], label=class_name, **hist_kwargs)

    # Get the objects that were accepted as multiple classes.
    class_df = mags_df.loc[mags_df[PHZ_CLASS].isin(class_ids)]
    label = &quot;+Galaxy&quot; if class_name != &quot;Galaxy&quot; else &quot;+any&quot;
    # Of those objects, restrict to the ones that are point-like.
    classpt_df = class_df.loc[class_df[MUMAX_MINUS_MAG] &lt; -2.5]
    pt_label = f&quot;{label} (point-like)&quot;
    # Plot histograms for both sets of objects.
    for ax, band in zip(axs, bands):
        ax.hist(class_df[band], label=label, linestyle=&quot;:&quot;, **hist_kwargs)
        ax.hist(classpt_df[band], linestyle=&quot;-.&quot;, label=pt_label, **hist_kwargs)

# Add axis labels, etc.
for ax, loc in zip(axes[:, 0], [2, 3, 2]):
    ax.legend(loc=loc)
    ax.set_ylabel(&quot;Counts&quot;)
for axs, band in zip(axes.transpose(), bands):
    axs[0].set_title(band.split()[0])
    axs[-1].set_xlabel(band)
fig.suptitle(&quot;Magnitude Distributions by Object Type&quot;)
plt.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="oPId6K24QHzhvAW_-3Gdg" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/irsa-tutorials/build/656b71f536fe5310ff69428b5aee52ff.png" alt="&lt;Figure size 1800x1200 with 12 Axes&gt;"/></div></div></div><p>The Euclid instruments are tuned to detect galaxies for cosmology studies, so it’s no surprise that there are many more galaxies than other object types.</p><p>The green lines (top row) show the magnitude distributions of objects classified as galaxy only (solid) and those classified as galaxy plus possibly other types (dot and dash-dot).
The dash-dot line highlights the population of point-like “galaxies”, which are likely misclassified stars or QSOs and mostly appear at faint magnitudes.</p><p>The star distributions (middle row, blue) are broader and peak at brighter magnitudes than the galaxy distributions, as expected.
Adding objects classified as both star and galaxy (dotted line) adds significant numbers, especially near the peak and toward the faint end where confusion is more likely.
Restricting these to point-like objects (dash-dot line) shows that many bright objects surpassing both probability thresholds are likely to be stars, not galaxies.
However, this doesn’t hold at the faint end where even some star-only classified objects fail the point-like cut.</p><p>The bottom row (orange) is the same as the middle row but for QSOs instead of stars.
There are very few point-like QSOs, reminding us that most QSO classifications in Q1 should be treated with skepticism (as discussed in the Classifications tutorial).
By default, this figure only includes objects in the EDF-F region.
High-confidence QSOs are more concentrated in the EDF-N region where advantageous external photometry (particularly u-band from UNIONS) was available.</p><h2 id="id-5-template-fit-vs-aperture-magnitudes" class="relative group"><span class="heading-text">5. Template-fit vs. Aperture Magnitudes</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-5-template-fit-vs-aperture-magnitudes" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Now let’s compare template-fit and aperture magnitudes by plotting their differences.
This comparison reveals systematic offsets that depend on factors including morphology (extended vs. point-like) and brightness.</p><p>This figure is inspired by Romelli Fig. 6 (top panel).</p><div id="XoX0AvZbS9" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Only consider objects within these mag and mag difference limits.
mag_limits, mag_diff_limits = (16, 24), (-1, 1)
mag_limited_df = mags_df.loc[(mags_df[I_MAG] &gt; mag_limits[0]) &amp; (mags_df[I_MAG] &lt; mag_limits[1])]

bands = [
    (&quot;Y templfit (mag)&quot;, &quot;Y aperture (mag)&quot;),
    (&quot;J templfit (mag)&quot;, &quot;J aperture (mag)&quot;),
    (&quot;H templfit (mag)&quot;, &quot;H aperture (mag)&quot;),
]
hexbin_kwargs = dict(
    cmap=&quot;YlGnBu&quot;, bins=&quot;log&quot;, extent=(*mag_limits, *mag_diff_limits), gridsize=25
)
annotate_kwargs = dict(
    xycoords=&quot;axes fraction&quot;, ha=&quot;left&quot;, fontweight=&quot;bold&quot;, bbox=dict(facecolor=&quot;white&quot;, alpha=0.8)
)

# Plot
fig, axes = plt.subplots(2, 3, figsize=(18, 9), sharey=True, sharex=True)
for axs, (ref_band, aper_band) in zip(axes.transpose(), bands):
    # Extended objects, top row.
    ax = axs[0]
    extended = mags_df.loc[mags_df[MUMAX_MINUS_MAG] &gt;= -2.5, [I_MAG, ref_band, aper_band]]
    extended[&quot;mag_diff&quot;] = extended[ref_band] - extended[aper_band]
    extended = extended.dropna(subset=&quot;mag_diff&quot;)
    cb = ax.hexbin(extended[I_MAG], extended[&quot;mag_diff&quot;], **hexbin_kwargs)
    plt.colorbar(cb)
    ax.set_ylabel(f&quot;{ref_band} - {aper_band}&quot;)
    # Annotate top (bottom) with the fraction of objects having a magnitude difference greater (less) than 0.
    frac_tmpl_greater = len(extended.loc[extended[&quot;mag_diff&quot;] &gt; 0]) / len(extended)
    ax.annotate(f&quot;{frac_tmpl_greater:.3f}&quot;, xy=(0.01, 0.99), va=&quot;top&quot;, **annotate_kwargs)
    frac_tmpl_less = len(extended.loc[extended[&quot;mag_diff&quot;] &lt; 0]) / len(extended)
    ax.annotate(f&quot;{frac_tmpl_less:.3f}&quot;, xy=(0.01, 0.01), va=&quot;bottom&quot;, **annotate_kwargs)

    # Point-like objects, bottom row.
    ax = axs[1]
    pointlike = mags_df.loc[mags_df[MUMAX_MINUS_MAG] &lt; -2.5, [I_MAG, ref_band, aper_band]]
    pointlike[&quot;mag_diff&quot;] = pointlike[ref_band] - pointlike[aper_band]
    pointlike = pointlike.dropna(subset=&quot;mag_diff&quot;)
    cb = ax.hexbin(pointlike[I_MAG], pointlike[&quot;mag_diff&quot;], **hexbin_kwargs)
    plt.colorbar(cb)
    ax.set_ylabel(f&quot;{ref_band} - {aper_band}&quot;)
    # Annotate top (bottom) with the fraction of objects having a magnitude difference greater (less) than 0.
    frac_tmpl_greater = len(pointlike.loc[pointlike[&quot;mag_diff&quot;] &gt; 0]) / len(pointlike)
    ax.annotate(f&quot;{frac_tmpl_greater:.3f}&quot;, xy=(0.01, 0.99), va=&quot;top&quot;, **annotate_kwargs)
    frac_tmpl_less = len(pointlike.loc[pointlike[&quot;mag_diff&quot;] &lt; 0]) / len(pointlike)
    ax.annotate(f&quot;{frac_tmpl_less:.3f}&quot;, xy=(0.01, 0.01), va=&quot;bottom&quot;, **annotate_kwargs)

# Add axis labels, etc.
for i, ax in enumerate(axes.flatten()):
    ax.axhline(0, color=&quot;gray&quot;, linewidth=1)
    if i == 1:
        ax.set_title(&quot;Extended objects&quot;)
    if i == 4:
        ax.set_title(&quot;Point-like objects&quot;)
    if i &gt; 2:
        ax.set_xlabel(I_MAG)
fig.suptitle(&quot;Magnitude Offsets (Template fit - Aperture)&quot;)
plt.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="gki1MpAjuSW9HgRiIWffh" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/irsa-tutorials/build/cf7ca7b7579887ddb85e78eccbb823b2.png" alt="&lt;Figure size 1800x900 with 12 Axes&gt;"/></div></div></div><p>The panel annotations give the fraction of objects with magnitude differences that are positive (top number) and negative (bottom number).
The magnitude difference is fairly tightly clustered around 0 for extended objects (top row), but with asymmetric outliers.
There is a positive offset, indicating fainter template-fit magnitudes, as expected: templates better exclude contaminating light from nearby sources.
The offset is more pronounced for point-like objects (bottom row), likely due to the PSF handling mentioned above, and we are reminded that aperture magnitudes are more reliable here.</p><h2 id="about-this-notebook" class="relative group"><span class="heading-text">About this notebook</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#about-this-notebook" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p><strong>Authors:</strong> Troy Raen, Vandana Desai, Andreas Faisst, Shoubaneh Hemmati, Jaladh Singhal, Brigitta Sipőcz, Jessica Krick, the IRSA Data Science Team, and the Euclid NASA Science Center at IPAC (ENSCI).</p><p><strong>Updated:</strong> 2025-12-23</p><p><strong>Contact:</strong> <a target="_blank" rel="noreferrer" href="https://irsa.ipac.caltech.edu/docs/help_desk.html" class="link whitespace-nowrap"><span class="link-text whitespace-normal">IRSA Helpdesk</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a></p><div class="myst-backmatter-parts"></div></article></main><script>((a,l)=>{if(!window.history.state||!window.history.state.key){let u=Math.random().toString(32).slice(2);window.history.replaceState({key:u},"")}try{let d=JSON.parse(sessionStorage.getItem(a)||"{}")[l||window.history.state.key];typeof d=="number"&&window.scrollTo(0,d)}catch(u){console.error(u),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/irsa-tutorials/build/entry.client-PCJPW7TK.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-AQ2CODAG.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-JJXTQVMA.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-OZE3FFNP.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-G62B6HZR.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-C4DFGG5C.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-J7TUH54J.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-FZ2S7OYD.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-JEM6JXYA.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-34XIY2DH.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-KQM5FBHR.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-7HNKBP4B.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-CUKUDK3R.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-3EBOCCHJ.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-O4VQNZ62.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-4OEDG4JQ.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/irsa-tutorials/build/root-PMP5BIHC.js"/><link rel="modulepreload" href="/irsa-tutorials/build/_shared/chunk-IX5KPAHP.js"/><link rel="modulepreload" href="/irsa-tutorials/build/routes/$-5ZLZ2O3Y.js"/><script>window.__remixContext = {"url":"/euclid-q1-hats-magnitudes","state":{"loaderData":{"root":{"config":{"version":3,"myst":"1.8.0","options":{"hide_footer_links":true,"outline_maxdepth":1,"favicon":"/irsa-tutorials/build/irsa-favicon-ac3253230b70ac3d7898ad9d271bbd2c.ico","logo":"/irsa-tutorials/build/irsa_logo-4e5abb7b6b904d81b25e7ff1c9f34dae.png","style":"/irsa-tutorials/build/custom-b4bf96095978ae82c65cba37f60f53f0.css"},"nav":[],"actions":[],"projects":[{"subject":"IRSA Tutorials","settings":{"output_matplotlib_strings":"remove"},"title":"IRSA Tutorials","description":"IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)","authors":[{"id":"IRSA Scientists and Developers","name":"IRSA Scientists and Developers"}],"github":"https://github.com/Caltech-IPAC/irsa-tutorials/","keywords":["astronomy"],"thebe":{"binder":{"url":"https://mybinder.org","provider":"github","repo":"https://github.com/Caltech-IPAC/irsa-tutorials/","ref":"HEAD"}},"toc":[{"file":"index.md","title":"IRSA Tutorials"},{"children":[{"file":"tutorials/spherex/spherex_intro.md","title":"Data Overview"},{"file":"tutorials/spherex/spherex_cutouts.md","title":"Spectral Image Cutouts"},{"file":"tutorials/spherex/spherex_psf.md","title":"PSF Models"}],"file":"tutorials/spherex/spherex.md","title":"SPHEREx"},{"children":[{"file":"tutorials/euclid/1_Euclid_intro_MER_images.md","title":"MER Mosaics"},{"file":"tutorials/euclid/3_Euclid_intro_1D_spectra.md","title":"SIR 1D Spectra"},{"file":"tutorials/euclid/2_Euclid_intro_MER_catalog.md","title":"MER Catalogs"},{"file":"tutorials/euclid/4_Euclid_intro_PHZ_catalog.md","title":"PHZ Catalogs"},{"file":"tutorials/euclid/5_Euclid_intro_SPE_catalog.md","title":"SPE Catalogs"},{"children":[{"file":"tutorials/euclid/merged-objects-hats-catalog/1-euclid-q1-hats-intro.md","title":"Introduction"},{"file":"tutorials/euclid/merged-objects-hats-catalog/4-euclid-q1-hats-magnitudes.md","title":"Magnitudes"}],"title":"Merged Objects HATS Catalog"},{"file":"tutorials/euclid/euclid-cloud-access.md","title":"Cloud Access"},{"file":"tutorials/euclid/Euclid_ERO.md","title":"ERO Star Clusters"}],"file":"tutorials/euclid/euclid.md","title":"Euclid"},{"children":[{"file":"tutorials/wise/sia_allwise_atlas.md","title":"AllWISE Images"},{"file":"tutorials/wise/wise-allwise-catalog-demo.md","title":"AllWISE Catalog"},{"file":"tutorials/wise/NEOWISE_light_curve_demo.md","title":"NEOWISE Firefly"},{"file":"tutorials/wise/neowise-source-table-strategies.md","title":"NEOWISE Strategies"},{"file":"tutorials/wise/neowise-source-table-lightcurves.md","title":"NEOWISE Light Curves"}],"file":"tutorials/wise/wise.md","title":"WISE"},{"children":[{"file":"tutorials/spitzer/siav2_seip.md"}],"title":"Spitzer"},{"children":[{"file":"tutorials/2mass/sia_2mass_allsky.md"}],"title":"2MASS"},{"children":[{"file":"tutorials/cosmos/sia_cosmos.md"}],"title":"COSMOS"},{"children":[{"file":"tutorials/simulated-data/roman_hlss_number_density.md","title":"Roman HLSS Number Density"},{"file":"tutorials/simulated-data/openuniverse2024_roman_simulated_wideareasurvey.md","title":"OpenUniverse2024 Roman coadds"},{"file":"tutorials/simulated-data/OpenUniverse2024Preview_Firefly.md","title":"OpenUniverse2024 Visualization"},{"file":"tutorials/simulated-data/openuniverse2024_roman_simulated_timedomainsurvey.md","title":"OpenUniverse2024 Time Domain"},{"file":"tutorials/simulated-data/cosmoDC2_TAP_access.md","title":"CosmoDC2 Data Access"}],"file":"tutorials/simulated-data/simulated.md","title":"Simulated Data"},{"children":[{"file":"tutorials/techniques-and-tools/cloud-access-intro.md","title":"Cloud Access"},{"file":"tutorials/techniques-and-tools/irsa-hats-with-lsdb.md","title":"LSDB HATS"},{"file":"tutorials/techniques-and-tools/SEDs_in_Firefly.md","title":"SED visualization"},{"file":"tutorials/techniques-and-tools/Parallelize_Convolution.md","title":"Parallelization"}],"file":"tutorials/techniques-and-tools/techniques.md","title":"Techniques \u0026 Tools"}],"exports":[],"bibliography":[],"index":"index","pages":[{"slug":"spherex","title":"Spherex Tutorial Notebooks","short_title":"SPHEREx","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"spherex-intro","title":"Introduction to SPHEREx Spectral Images","short_title":"Data Overview","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-cutouts","title":"Download a collection of SPHEREx Spectral Image cutouts as a multi-extension FITS file","short_title":"Spectral Image Cutouts","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-psf","title":"Understanding and Extracting the PSF Extension in a SPHEREx Cutout","short_title":"PSF Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euclid","title":"Euclid Tutorial Notebooks","short_title":"Euclid","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"euclid-intro-mer-images","title":"Euclid Q1: MER Mosaics","short_title":"MER Mosaics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euclid-intro-1d-spectra","title":"Euclid Q1: SIR 1D Spectra","short_title":"SIR 1D Spectra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euclid-intro-mer-catalog","title":"Euclid Q1: MER Catalogs","short_title":"MER Catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euclid-intro-phz-catalog","title":"Euclid Q1: PHZ Catalogs","short_title":"PHZ Catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euclid-intro-spe-catalog","title":"Euclid Q1: SPE Catalogs","short_title":"SPE Catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"Merged Objects HATS Catalog"},{"slug":"euclid-q1-hats-intro","title":"Euclid Q1 Merged Objects HATS Catalog: Introduction","short_title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-q1-hats-magnitudes","title":"Euclid Q1 Merged Objects HATS Catalog: Magnitudes","short_title":"Magnitudes","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-cloud-access","title":"Euclid Q1: Cloud Access","short_title":"Cloud Access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euclid-ero","title":"Exploring Star Clusters in the Euclid ERO Data","short_title":"ERO Star Clusters","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"wise","title":"WISE Tutorial Notebooks","short_title":"WISE","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"sia-allwise-atlas","title":"Searching for AllWISE Atlas Images","short_title":"AllWISE Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"wise-allwise-catalog-demo","title":"Analyzing cloud-hosted AllWISE Source Catalog in Parquet format","short_title":"AllWISE Catalog","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"neowise-light-curve-demo","title":"Using Firefly visualization tools to understand the light curves of Solar System objects","short_title":"NEOWISE Firefly","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"neowise-source-table-strategies","title":"Strategies to Efficiently Work with NEOWISE Single-exposure Source Table in Parquet","short_title":"NEOWISE Strategies","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"neowise-source-table-lightcurves","title":"Make Light Curves from NEOWISE Single-exposure Source Table","short_title":"NEOWISE Light Curves","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Spitzer"},{"slug":"siav2-seip","title":"Searching for Spitzer Enhanced Imaging Products","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"2MASS"},{"slug":"sia-2mass-allsky","title":"Searching for 2MASS All-Sky Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"COSMOS"},{"slug":"sia-cosmos","title":"Searching for contributed COSMOS images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"simulated","title":"Simulated Data Tutorial Notebooks","short_title":"Simulated Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"roman-hlss-number-density","title":"Number Density as a Function of Redshift","short_title":"Roman HLSS Number Density","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"openuniverse2024-roman-simulated-wideareasurvey","title":"Analyzing cloud-hosted simulated Roman coadded images","short_title":"OpenUniverse2024 Roman coadds","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"openuniverse2024preview-firefly","title":"Using Firefly to Explore OpenUniverse2024 Data Preview Simulated Roman and Rubin Images","short_title":"OpenUniverse2024 Visualization","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"openuniverse2024-roman-simulated-timedomainsurvey","title":"Analyzing cloud-hosted simulated Roman Time Domain Survey images","short_title":"OpenUniverse2024 Time Domain","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"cosmodc2-tap-access","title":"Querying the CosmoDC2 Mock v1 Catalogs","short_title":"CosmoDC2 Data Access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"techniques","title":"Techniques \u0026 Tools Tutorial Notebooks","short_title":"Techniques \u0026 Tools","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"cloud-access-intro","title":"IRSA cloud access introduction","short_title":"Cloud Access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"irsa-hats-with-lsdb","title":"Access HATS Collections Using LSDB: Euclid Q1 and ZTF DR23","short_title":"LSDB HATS","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"seds-in-firefly","title":"Using Firefly visualization tools in Python to vet SEDs","short_title":"SED visualization","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"parallelize-convolution","title":"Parallelizing image convolution","short_title":"Parallelization","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/irsa-tutorials"},"routes/$":{"config":{"version":3,"myst":"1.8.0","options":{"hide_footer_links":true,"outline_maxdepth":1,"favicon":"/irsa-tutorials/build/irsa-favicon-ac3253230b70ac3d7898ad9d271bbd2c.ico","logo":"/irsa-tutorials/build/irsa_logo-4e5abb7b6b904d81b25e7ff1c9f34dae.png","style":"/irsa-tutorials/build/custom-b4bf96095978ae82c65cba37f60f53f0.css"},"nav":[],"actions":[],"projects":[{"subject":"IRSA Tutorials","settings":{"output_matplotlib_strings":"remove"},"title":"IRSA Tutorials","description":"IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)","authors":[{"id":"IRSA Scientists and Developers","name":"IRSA Scientists and Developers"}],"github":"https://github.com/Caltech-IPAC/irsa-tutorials/","keywords":["astronomy"],"thebe":{"binder":{"url":"https://mybinder.org","provider":"github","repo":"https://github.com/Caltech-IPAC/irsa-tutorials/","ref":"HEAD"}},"toc":[{"file":"index.md","title":"IRSA Tutorials"},{"children":[{"file":"tutorials/spherex/spherex_intro.md","title":"Data Overview"},{"file":"tutorials/spherex/spherex_cutouts.md","title":"Spectral Image Cutouts"},{"file":"tutorials/spherex/spherex_psf.md","title":"PSF Models"}],"file":"tutorials/spherex/spherex.md","title":"SPHEREx"},{"children":[{"file":"tutorials/euclid/1_Euclid_intro_MER_images.md","title":"MER Mosaics"},{"file":"tutorials/euclid/3_Euclid_intro_1D_spectra.md","title":"SIR 1D Spectra"},{"file":"tutorials/euclid/2_Euclid_intro_MER_catalog.md","title":"MER Catalogs"},{"file":"tutorials/euclid/4_Euclid_intro_PHZ_catalog.md","title":"PHZ Catalogs"},{"file":"tutorials/euclid/5_Euclid_intro_SPE_catalog.md","title":"SPE Catalogs"},{"children":[{"file":"tutorials/euclid/merged-objects-hats-catalog/1-euclid-q1-hats-intro.md","title":"Introduction"},{"file":"tutorials/euclid/merged-objects-hats-catalog/4-euclid-q1-hats-magnitudes.md","title":"Magnitudes"}],"title":"Merged Objects HATS Catalog"},{"file":"tutorials/euclid/euclid-cloud-access.md","title":"Cloud Access"},{"file":"tutorials/euclid/Euclid_ERO.md","title":"ERO Star Clusters"}],"file":"tutorials/euclid/euclid.md","title":"Euclid"},{"children":[{"file":"tutorials/wise/sia_allwise_atlas.md","title":"AllWISE Images"},{"file":"tutorials/wise/wise-allwise-catalog-demo.md","title":"AllWISE Catalog"},{"file":"tutorials/wise/NEOWISE_light_curve_demo.md","title":"NEOWISE Firefly"},{"file":"tutorials/wise/neowise-source-table-strategies.md","title":"NEOWISE Strategies"},{"file":"tutorials/wise/neowise-source-table-lightcurves.md","title":"NEOWISE Light Curves"}],"file":"tutorials/wise/wise.md","title":"WISE"},{"children":[{"file":"tutorials/spitzer/siav2_seip.md"}],"title":"Spitzer"},{"children":[{"file":"tutorials/2mass/sia_2mass_allsky.md"}],"title":"2MASS"},{"children":[{"file":"tutorials/cosmos/sia_cosmos.md"}],"title":"COSMOS"},{"children":[{"file":"tutorials/simulated-data/roman_hlss_number_density.md","title":"Roman HLSS Number Density"},{"file":"tutorials/simulated-data/openuniverse2024_roman_simulated_wideareasurvey.md","title":"OpenUniverse2024 Roman coadds"},{"file":"tutorials/simulated-data/OpenUniverse2024Preview_Firefly.md","title":"OpenUniverse2024 Visualization"},{"file":"tutorials/simulated-data/openuniverse2024_roman_simulated_timedomainsurvey.md","title":"OpenUniverse2024 Time Domain"},{"file":"tutorials/simulated-data/cosmoDC2_TAP_access.md","title":"CosmoDC2 Data Access"}],"file":"tutorials/simulated-data/simulated.md","title":"Simulated Data"},{"children":[{"file":"tutorials/techniques-and-tools/cloud-access-intro.md","title":"Cloud Access"},{"file":"tutorials/techniques-and-tools/irsa-hats-with-lsdb.md","title":"LSDB HATS"},{"file":"tutorials/techniques-and-tools/SEDs_in_Firefly.md","title":"SED visualization"},{"file":"tutorials/techniques-and-tools/Parallelize_Convolution.md","title":"Parallelization"}],"file":"tutorials/techniques-and-tools/techniques.md","title":"Techniques \u0026 Tools"}],"exports":[],"bibliography":[],"index":"index","pages":[{"slug":"spherex","title":"Spherex Tutorial Notebooks","short_title":"SPHEREx","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"spherex-intro","title":"Introduction to SPHEREx Spectral Images","short_title":"Data Overview","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-cutouts","title":"Download a collection of SPHEREx Spectral Image cutouts as a multi-extension FITS file","short_title":"Spectral Image Cutouts","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-psf","title":"Understanding and Extracting the PSF Extension in a SPHEREx Cutout","short_title":"PSF Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euclid","title":"Euclid Tutorial Notebooks","short_title":"Euclid","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"euclid-intro-mer-images","title":"Euclid Q1: MER Mosaics","short_title":"MER Mosaics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euclid-intro-1d-spectra","title":"Euclid Q1: SIR 1D Spectra","short_title":"SIR 1D Spectra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euclid-intro-mer-catalog","title":"Euclid Q1: MER Catalogs","short_title":"MER Catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euclid-intro-phz-catalog","title":"Euclid Q1: PHZ Catalogs","short_title":"PHZ Catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euclid-intro-spe-catalog","title":"Euclid Q1: SPE Catalogs","short_title":"SPE Catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"Merged Objects HATS Catalog"},{"slug":"euclid-q1-hats-intro","title":"Euclid Q1 Merged Objects HATS Catalog: Introduction","short_title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-q1-hats-magnitudes","title":"Euclid Q1 Merged Objects HATS Catalog: Magnitudes","short_title":"Magnitudes","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-cloud-access","title":"Euclid Q1: Cloud Access","short_title":"Cloud Access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euclid-ero","title":"Exploring Star Clusters in the Euclid ERO Data","short_title":"ERO Star Clusters","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"wise","title":"WISE Tutorial Notebooks","short_title":"WISE","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"sia-allwise-atlas","title":"Searching for AllWISE Atlas Images","short_title":"AllWISE Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"wise-allwise-catalog-demo","title":"Analyzing cloud-hosted AllWISE Source Catalog in Parquet format","short_title":"AllWISE Catalog","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"neowise-light-curve-demo","title":"Using Firefly visualization tools to understand the light curves of Solar System objects","short_title":"NEOWISE Firefly","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"neowise-source-table-strategies","title":"Strategies to Efficiently Work with NEOWISE Single-exposure Source Table in Parquet","short_title":"NEOWISE Strategies","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"neowise-source-table-lightcurves","title":"Make Light Curves from NEOWISE Single-exposure Source Table","short_title":"NEOWISE Light Curves","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Spitzer"},{"slug":"siav2-seip","title":"Searching for Spitzer Enhanced Imaging Products","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"2MASS"},{"slug":"sia-2mass-allsky","title":"Searching for 2MASS All-Sky Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"COSMOS"},{"slug":"sia-cosmos","title":"Searching for contributed COSMOS images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"simulated","title":"Simulated Data Tutorial Notebooks","short_title":"Simulated Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"roman-hlss-number-density","title":"Number Density as a Function of Redshift","short_title":"Roman HLSS Number Density","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"openuniverse2024-roman-simulated-wideareasurvey","title":"Analyzing cloud-hosted simulated Roman coadded images","short_title":"OpenUniverse2024 Roman coadds","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"openuniverse2024preview-firefly","title":"Using Firefly to Explore OpenUniverse2024 Data Preview Simulated Roman and Rubin Images","short_title":"OpenUniverse2024 Visualization","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"openuniverse2024-roman-simulated-timedomainsurvey","title":"Analyzing cloud-hosted simulated Roman Time Domain Survey images","short_title":"OpenUniverse2024 Time Domain","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"cosmodc2-tap-access","title":"Querying the CosmoDC2 Mock v1 Catalogs","short_title":"CosmoDC2 Data Access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"techniques","title":"Techniques \u0026 Tools Tutorial Notebooks","short_title":"Techniques \u0026 Tools","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"cloud-access-intro","title":"IRSA cloud access introduction","short_title":"Cloud Access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"irsa-hats-with-lsdb","title":"Access HATS Collections Using LSDB: Euclid Q1 and ZTF DR23","short_title":"LSDB HATS","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"seds-in-firefly","title":"Using Firefly visualization tools in Python to vet SEDs","short_title":"SED visualization","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"parallelize-convolution","title":"Parallelizing image convolution","short_title":"Parallelization","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":3,"kind":"Notebook","sha256":"b671d570bc7314860ac9188ae060002cddd1648d8f2aff026956f04060a192b9","slug":"euclid-q1-hats-magnitudes","location":"/tutorials/euclid/merged-objects-hats-catalog/4-euclid-q1-hats-magnitudes.md","dependencies":[],"frontmatter":{"title":"Euclid Q1 Merged Objects HATS Catalog: Magnitudes","kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"jupytext":{"text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.18.1"}},"content_includes_title":false,"authors":[{"id":"IRSA Scientists and Developers","name":"IRSA Scientists and Developers"}],"github":"https://github.com/Caltech-IPAC/irsa-tutorials/","subject":"IRSA Tutorials","keywords":["astronomy"],"settings":{"output_matplotlib_strings":"remove"},"numbering":{"title":{"offset":2}},"source_url":"https://github.com/Caltech-IPAC/irsa-tutorials//blob/main/tutorials/euclid/merged-objects-hats-catalog/4-euclid-q1-hats-magnitudes.md","edit_url":"https://github.com/Caltech-IPAC/irsa-tutorials//edit/main/tutorials/euclid/merged-objects-hats-catalog/4-euclid-q1-hats-magnitudes.md","exports":[{"format":"md","filename":"4-euclid-q1-hats-magnitudes.md","url":"/irsa-tutorials/build/4-euclid-q1-hats-mag-042fce4249f53169008a933a94ce3df9.md"}]},"mdast":{"type":"root","children":[{"type":"block","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"This tutorial explores Euclid photometry measurements.\nIt assumes you are familiar with the ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"h9DyYvQh87"},{"type":"link","url":"/euclid-q1-hats-intro","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"first tutorial","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"Ay1goFZ0kv"}],"urlSource":"1-euclid-q1-hats-intro.md","dataUrl":"/euclid-q1-hats-intro.json","internal":true,"protocol":"file","key":"JN5yShZuKS"},{"type":"text","value":" in this series, which covers the Euclid Q1 Merged Objects HATS Catalog content, format, and basic access.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"yNIWkniIMn"}],"key":"la555boYo1"}],"key":"LH5E5qHQen"},{"type":"block","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Learning Goals","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"j7cKS98kwM"}],"identifier":"learning-goals","label":"Learning Goals","html_id":"learning-goals","implicit":true,"key":"qhr07nZYYz"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"By the end of this tutorial, you will be able to:","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"X41ApHw2bP"}],"key":"pDmBg8HbPe"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":27,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Understand the different Euclid Q1 flux measurements and their intended use cases.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"kS6PnuS4OH"}],"key":"DonKQeq2ZP"}],"key":"A48Ioncb5P"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Load aperture and template-fit magnitudes for Euclid I, Y, J, and H bands from the Euclid Q1 Merged Objects HATS Catalog.","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"u5PoIUsyY2"}],"key":"hOO6161rZc"}],"key":"L35EFVypUR"},{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Visualize and understand the template-fit magnitude distributions as a function of object classification.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"BKZiLhkeqv"}],"key":"xORDSOYXc1"}],"key":"RP1Bxh6Kby"},{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Compare aperture and template-fit magnitudes to understand their differences.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"J1LvZb7vgK"}],"key":"tzgY07tefj"}],"key":"sJrGnxsaus"}],"key":"HNC53mrCZ4"}],"key":"BbRiXNEgRi"},{"type":"block","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"1. Introduction","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"jMUMXpRPnR"}],"identifier":"id-1-introduction","label":"1. Introduction","html_id":"id-1-introduction","implicit":true,"key":"uykdK6HJ4b"},{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"gN1sQnWUW4"},{"type":"link","url":"https://irsa.ipac.caltech.edu/data/Euclid/docs/overview_q1.html","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Euclid Q1","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"eqSfFUuab9"}],"urlSource":"https://irsa.ipac.caltech.edu/data/Euclid/docs/overview_q1.html","key":"ciTS2YbNRz"},{"type":"text","value":" data release contains photometry from Euclid as well as from external surveys.\nThere are several flux measurements per band.\nThe measurements are described in ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"gFyJnWiq7R"},{"type":"link","url":"https://arxiv.org/pdf/2503.15305","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Euclid Collaboration: Romelli et al., 2025","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"RmK3WSfid1"}],"urlSource":"https://arxiv.org/pdf/2503.15305","key":"nvVNpIISgF"},{"type":"text","value":" (hereafter, Romelli), especially sections 6 and 8.","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"gcMbhimQUJ"}],"key":"ynHs5Tht9N"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"In this tutorial, we will look at aperture and template-fit photometry measurements in the four Euclid bands: I (from the VIS instrument), Y, J, and H (from the NISP instrument).\n","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"tVIuBU9tuV"},{"type":"strong","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Aperture fluxes","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"N941HoXSOK"}],"key":"rbxeCziIFV"},{"type":"text","value":" are generally more accurate for point-like sources, especially bright stars in the NIR bands, likely due to better handling of PSF-related effects.\n","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"WEPT0w59iU"},{"type":"strong","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Template-fit fluxes","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"TFjpiBtLH1"}],"key":"H7HiKrAAQN"},{"type":"text","value":" are expected to be more accurate for extended sources because the templates do a better job of excluding contamination from nearby sources.\nAdditional photometry measurements that we won’t cover here include: ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"a5Jn6qtanj"},{"type":"strong","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Sérsic-fit fluxes","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"N87TsO7gt9"}],"key":"PsSl0VSEqk"},{"type":"text","value":" (computed for parametric morphology), ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"cjKWsLbvUd"},{"type":"strong","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"PSF-fit fluxes","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"p7razNWjb2"}],"key":"lQYtCgiQUA"},{"type":"text","value":" (VIS only), and ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"jm0CEmy92z"},{"type":"strong","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"class-corrected fluxes","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"Hdc4mwEg0L"}],"key":"TCtbzNNocu"},{"type":"text","value":" that were corrected based on the PHZ (photometric) classifications.","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"QjYKUZQkIz"}],"key":"MUIKOP8lmW"},{"type":"paragraph","position":{"start":{"line":45,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"The best-estimate flux in the detection band is given by the column ","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"dqCcIeO4gG"},{"type":"inlineCode","value":"mer_flux_detection_total","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"ObMCNGrRCh"},{"type":"text","value":".\nThis can also be used to color-correct flux measurements in non-detection bands, as we will demonstrate.\nThe object detection process is described in Romelli.\nThe ","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"fIv97v8jqR"},{"type":"link","url":"http://st-dm.pages.euclid-sgs.uk/data-product-doc/dmq1/merdpd/merphotometrycookbook.html","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"MER Photometry Cookbook","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"Crv5VMlQwd"}],"urlSource":"http://st-dm.pages.euclid-sgs.uk/data-product-doc/dmq1/merdpd/merphotometrycookbook.html","key":"OGWfcRhXmp"},{"type":"text","value":" describes the color corrections and how to convert from flux to magnitude.\nIn this tutorial, we will restrict to objects detected in VIS (I band) because it simplifies the calculations.","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"f6bWPRUMLw"}],"key":"mCzdmDg2hJ"}],"key":"wDLUkaENPF"},{"type":"block","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"2. Imports and Paths","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"qTq5JMGyHH"}],"identifier":"id-2-imports-and-paths","label":"2. Imports and Paths","html_id":"id-2-imports-and-paths","implicit":true,"key":"pZEH2chwqK"}],"key":"bvof0rYIMQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# # Uncomment the next line to install dependencies if needed.\n# %pip install hpgeom matplotlib pandas pyarrow","key":"ciR052gFhb"},{"type":"outputs","id":"PNabAZJwZe24fdfrnqjck","children":[],"key":"islYcWDmYE"}],"key":"zKiWeccRDe"},{"type":"block","children":[],"key":"fRyBjq2VRL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import hpgeom  # Find HEALPix indexes from RA and Dec\nimport matplotlib.pyplot as plt  # Create figures\nimport pyarrow.compute as pc  # Filter dataset\nimport pyarrow.dataset  # Load the dataset\nimport pyarrow.fs  # Simple S3 filesystem pointer\nimport pyarrow.parquet  # Load the schema\n\n# Increase font size in figures.\nplt.rcParams.update({\"font.size\": 14})","key":"OgA9dIRyDa"},{"type":"outputs","id":"u8FMjV-4tz2LUSDeU9EwE","children":[],"key":"HLjStK4Yts"}],"key":"KxM6sp34NN"},{"type":"block","children":[],"key":"GKt2RxP9p0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# AWS S3 paths.\ns3_bucket = \"nasa-irsa-euclid-q1\"\ndataset_prefix = \"contributed/q1/merged_objects/hats/euclid_q1_merged_objects-hats/dataset\"\ndataset_path = f\"{s3_bucket}/{dataset_prefix}\"\n\n# S3 pointer. Use `anonymous=True` to access without credentials.\ns3 = pyarrow.fs.S3FileSystem(anonymous=True)","key":"S4RZm1yRI2"},{"type":"outputs","id":"XIbLRB7lPfj0BRlfB7LcP","children":[],"key":"ngYNCOXiYv"}],"key":"Z9rRwA3ev3"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"3. Load Template-fit and Aperture Magnitudes","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"cgLt3CZYQJ"}],"identifier":"id-3-load-template-fit-and-aperture-magnitudes","label":"3. Load Template-fit and Aperture Magnitudes","html_id":"id-3-load-template-fit-and-aperture-magnitudes","implicit":true,"key":"Zy3R0qmCYI"},{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"The following columns will be important.\nDescriptions come from Romelli.","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"RLIAitEhbB"}],"key":"onD9LV7nHE"}],"key":"qcleDO1Cg7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Whether the source was detected in VIS mosaic (1) or only in NIR-stack mosaic (0).\nVIS_DET = \"mer_vis_det\"\n\n# Best estimate of the total flux in the detection band.\n# From aperture photometry within a Kron radius.\n# Detection band is VIS if `VIS_DET == 1`. Otherwise, this is a\n# non-physical NIR-stack flux and there was no VIS detection (aka, NIR-only).\n# We will only deal with VIS-detected objects in this notebook.\nFLUX_DET_TOTAL = \"mer_flux_detection_total\"\n\n# Peak surface brightness minus the magnitude used for `mer_point_like_prob`.\n# This is a measure of compactness.\nMUMAX_MINUS_MAG = \"mer_mumax_minus_mag\"\n\n# Whether the detection has a \u003e50% probability of being spurious (1=Yes, 0=No).\nSPURIOUS_FLAG = \"mer_spurious_flag\"\n\n# PHZ classification: 1=Star, 2=Galaxy, 4=QSO.\n# Combinations (3, 5, 6, and 7) indicate multiple probability thresholds were exceeded.\nPHZ_CLASS = \"phz_phz_classification\"","key":"Te6zpzYg3i"},{"type":"outputs","id":"6-BWSXBQaV2AmAngiqWma","children":[],"key":"J69qWrNJf7"}],"key":"mUH1WDwijh"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":110,"column":1},"end":{"line":112,"column":1}},"children":[{"type":"text","value":"We’ll convert the catalog fluxes to magnitudes following the ","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"alwfDowKLP"},{"type":"link","url":"http://st-dm.pages.euclid-sgs.uk/data-product-doc/dmq1/merdpd/merphotometrycookbook.html","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"children":[{"type":"text","value":"MER Photometry Cookbook","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"BGc5nc3udo"}],"urlSource":"http://st-dm.pages.euclid-sgs.uk/data-product-doc/dmq1/merdpd/merphotometrycookbook.html","key":"jamEfohB5n"},{"type":"text","value":".\nPyArrow can do the conversion during the read operation and return only the magnitudes.\nTo do this, we’ll use the following function to define the magnitudes as ","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"k3lPuzNATW"},{"type":"inlineCode","value":"pyarrow.compute","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"g6XjsnAVt3"},{"type":"text","value":" (","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"uCIACVU3C8"},{"type":"inlineCode","value":"pc","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"Mqx4YdUYGe"},{"type":"text","value":") functions, which are described at ","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"zgexdyUksQ"},{"type":"link","url":"https://arrow.apache.org/docs/python/api/compute.html","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"children":[{"type":"text","value":"Compute Functions","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"W4SsO38FPA"}],"urlSource":"https://arrow.apache.org/docs/python/api/compute.html","key":"twxkP7Miuw"},{"type":"text","value":".","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"SMmenQeZ8z"}],"key":"i0d2depEbL"}],"key":"GDnpeXDzLb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def flux_to_magnitude(flux_col_name: str) -\u003e pc.Expression:\n    \"\"\"Convert catalog fluxes to magnitudes following the MER Photometry Cookbook.\n\n    Parameters\n    ----------\n    flux_col_name : str\n        The name of the flux column to convert to magnitude.\n\n    Returns\n    -------\n    pyarrow.compute.Expression\n        An expression for the magnitude. It can be used in the `filter` and `columns`\n        keyword arguments when loading data from a PyArrow dataset.\n    \"\"\"\n    # We expect to be dealing with VIS_DET == 1 objects, so FLUX_DET_TOTAL == VIS flux.\n    vis_flux = pc.field(FLUX_DET_TOTAL)\n    band_flux = pc.field(flux_col_name)\n\n    if flux_col_name == FLUX_DET_TOTAL:\n        # Best-estimate flux in VIS is FLUX_DET_TOTAL.\n        best_flux = vis_flux\n    elif flux_col_name.endswith(\"_templfit\"):\n        # Best-estimate template-fit flux is the band flux scaled by a color correction.\n        band = flux_col_name.split(\"_\")[-2]  # y, j, or h\n        color_scale = pc.divide(vis_flux, pc.field(f\"mer_flux_vis_to_{band}_templfit\"))\n        best_flux = pc.multiply(band_flux, color_scale)\n    elif flux_col_name.endswith(\"aper\"):\n        # Best-estimate aperture flux is the band flux scaled by a color correction.\n        nfwhm = flux_col_name.split(\"_\")[-2]  # e.g., 2fwhm\n        color_scale = pc.divide(vis_flux, pc.field(f\"mer_flux_vis_{nfwhm}_aper\"))\n        best_flux = pc.multiply(band_flux, color_scale)\n\n    # magnitude = -2.5 * log10(flux) + 23.9.\n    scale = pc.scalar(-2.5)\n    log10_flux = pc.log10(best_flux)\n    zeropoint = pc.scalar(23.9)\n    mag_expression = pc.add(pc.multiply(scale, log10_flux), zeropoint)\n    return mag_expression","key":"GFkMjTjnev"},{"type":"outputs","id":"zl2hOxzBYo06Bkb5Qb_Ui","children":[],"key":"QpssiJBSQ3"}],"key":"I8pZAzUX0J"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":155,"column":1},"end":{"line":158,"column":1}},"children":[{"type":"text","value":"Define the columns we want to load.\nThis needs to be a dictionary (rather than a simple list of column names) because we’re asking PyArrow to compute the magnitudes dynamically from the catalog fluxes.\nThe dictionary keys will be the column names in the resultant table.\nThe values must be ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"Lk1WwOApQq"},{"type":"inlineCode","value":"pyarrow.compute","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"uqTSmMkmPs"},{"type":"text","value":" expressions (described above).","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"ujSRmu9dRR"}],"key":"Ph5ArSw0dZ"}],"key":"Loq3YouDhy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"I_MAG = \"I (mag)\"\ncolumns = {\n    PHZ_CLASS: pc.field(PHZ_CLASS),\n    I_MAG: flux_to_magnitude(FLUX_DET_TOTAL),\n    \"Y aperture (mag)\": flux_to_magnitude(\"mer_flux_y_2fwhm_aper\"),\n    \"J aperture (mag)\": flux_to_magnitude(\"mer_flux_j_2fwhm_aper\"),\n    \"H aperture (mag)\": flux_to_magnitude(\"mer_flux_h_2fwhm_aper\"),\n    \"Y templfit (mag)\": flux_to_magnitude(\"mer_flux_y_templfit\"),\n    \"J templfit (mag)\": flux_to_magnitude(\"mer_flux_j_templfit\"),\n    \"H templfit (mag)\": flux_to_magnitude(\"mer_flux_h_templfit\"),\n    MUMAX_MINUS_MAG: pc.field(MUMAX_MINUS_MAG),\n}\n# Let's see what one of these looks like.\ncolumns[\"Y aperture (mag)\"]","key":"sweoIIuyWG"},{"type":"outputs","id":"Yf_x0pCxG5XH9RDG2Ef-6","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"\u003cpyarrow.compute.Expression add(multiply(-2.5, log10(multiply(mer_flux_y_2fwhm_aper, divide(mer_flux_detection_total, mer_flux_vis_2fwhm_aper)))), 23.9)\u003e","content_type":"text/plain"}}},"key":"UCVP0H7oPu"}],"key":"bYaqC5j3T1"}],"key":"huPDYzTNCh"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":177,"column":1},"end":{"line":178,"column":1}},"children":[{"type":"text","value":"We’ll restrict to the Euclid Deep Field - Fornax (EDF-F) to reduce the amount of data loaded.\nCompute the HEALPix order 9 pixel indexes, following the ","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"BUxlGrGFGO"},{"type":"link","url":"/euclid-q1-hats-intro","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"children":[{"type":"text","value":"introductory tutorial","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"Ap8kSZ0lzs"}],"urlSource":"1-euclid-q1-hats-intro.md","dataUrl":"/euclid-q1-hats-intro.json","internal":true,"protocol":"file","key":"phxDRUWUKR"},{"type":"text","value":".","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"Auzajk57uY"}],"key":"qGxDR2Be8U"}],"key":"zOKYY8SyqX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ra, dec, radius = 52.932, -28.088, 3  # 10 sq deg\nedff_k9_pixels = hpgeom.query_circle(hpgeom.order_to_nside(9), ra, dec, radius, inclusive=True)","key":"r5aMJHBWUq"},{"type":"outputs","id":"mut9CLyyX9ROMBBNkz0cV","children":[],"key":"mN3x5hyXOm"}],"key":"HCkksOjPiX"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"text","value":"Construct the row filter.","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"rvx5NqOAWT"}],"key":"RfQ1iaEciw"}],"key":"Ad1kAL9crZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"row_filter = (\n    # Stars, Galaxies, QSOs, and mixed classes.\n    pc.field(PHZ_CLASS).isin([1, 2, 3, 4, 5, 6, 7])\n    # Basic quality cut.\n    \u0026 (pc.field(SPURIOUS_FLAG) == 0)\n    # VIS-detected objects. (If you want to include NIR-only objects, alter flux_to_magnitude()\n    # following MER Photometry Cookbook and also comment out the next line.)\n    \u0026 (pc.field(VIS_DET) == 1)\n    # EDF-F region. (Comment out the next line to do an all-sky search.)\n    \u0026 pc.field(\"_healpix_9\").isin(edff_k9_pixels)\n)","key":"Lx833g4efE"},{"type":"outputs","id":"cmo6BOicXk0yGH-ipsNvK","children":[],"key":"B8dnxgo0Oy"}],"key":"VDPhwxY5KR"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"children":[{"type":"text","value":"Load the data.","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"H5LwAaQLXU"}],"key":"DPwqM2eGBW"}],"key":"z4C6JBIEW4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Load the catalog as a PyArrow dataset. Include partitioning=\"hive\"\n# so PyArrow understands the file naming scheme and can navigate the partitions.\nschema = pyarrow.parquet.read_schema(f\"{dataset_path}/_common_metadata\", filesystem=s3)\ndataset = pyarrow.dataset.dataset(dataset_path, partitioning=\"hive\", filesystem=s3, schema=schema)\n\nmags_df = dataset.to_table(columns=columns, filter=row_filter).to_pandas()\nmags_df","key":"CdKkdwftoA"},{"type":"outputs","id":"AB2_ac-2tRKlPzMwW6VZW","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"         phz_phz_classification    I (mag)  Y aperture (mag)  \\\n0                             2  21.130836         20.246357   \n1                             2  23.530122         20.404094   \n2                             2  25.603993         21.344415   \n3                             2  25.896114         24.694210   \n4                             2  25.146416         23.833867   \n...                         ...        ...               ...   \n3498996                       2  24.066025         24.704767   \n3498997                       2  24.372916         23.401461   \n3498998                       2  23.682455         23.030631   \n3498999                       2  23.257301         22.340015   \n3499000                       2  19.420445         24.079663   \n\n         J aperture (mag)  H aperture (mag)  Y templfit (mag)  \\\n0               19.660702         19.518608         20.328621   \n1               20.915967         20.605527         22.824030   \n2               22.156335         20.702953         32.709300   \n3               24.528586         24.726851         25.301338   \n4               24.412396         23.194615         27.318547   \n...                   ...               ...               ...   \n3498996         23.426418         23.251519         23.694467   \n3498997         25.628531         23.528569         23.455045   \n3498998               NaN         23.019727         23.157976   \n3498999         22.342694         22.132900         22.572963   \n3499000         26.476873               NaN               NaN   \n\n         J templfit (mag)  H templfit (mag)  mer_mumax_minus_mag  \n0               20.037912         19.567936            -1.081560  \n1               23.206607         23.420897            -1.182308  \n2               31.160601         32.235024            -2.167992  \n3               24.629402         25.307131            -1.992109  \n4               26.941532               NaN            -1.763762  \n...                   ...               ...                  ...  \n3498996         23.526109         23.461376            -1.640509  \n3498997         23.588801         23.409819            -2.022856  \n3498998         23.637121         22.932438            -1.608324  \n3498999         22.269022         22.126816            -0.928865  \n3499000         28.360588               NaN            -3.214653  \n\n[3499001 rows x 9 columns]","content_type":"text/plain"},"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003ephz_phz_classification\u003c/th\u003e\n      \u003cth\u003eI (mag)\u003c/th\u003e\n      \u003cth\u003eY aperture (mag)\u003c/th\u003e\n      \u003cth\u003eJ aperture (mag)\u003c/th\u003e\n      \u003cth\u003eH aperture (mag)\u003c/th\u003e\n      \u003cth\u003eY templfit (mag)\u003c/th\u003e\n      \u003cth\u003eJ templfit (mag)\u003c/th\u003e\n      \u003cth\u003eH templfit (mag)\u003c/th\u003e\n      \u003cth\u003emer_mumax_minus_mag\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e0\u003c/th\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003e21.130836\u003c/td\u003e\n      \u003ctd\u003e20.246357\u003c/td\u003e\n      \u003ctd\u003e19.660702\u003c/td\u003e\n      \u003ctd\u003e19.518608\u003c/td\u003e\n      \u003ctd\u003e20.328621\u003c/td\u003e\n      \u003ctd\u003e20.037912\u003c/td\u003e\n      \u003ctd\u003e19.567936\u003c/td\u003e\n      \u003ctd\u003e-1.081560\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1\u003c/th\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003e23.530122\u003c/td\u003e\n      \u003ctd\u003e20.404094\u003c/td\u003e\n      \u003ctd\u003e20.915967\u003c/td\u003e\n      \u003ctd\u003e20.605527\u003c/td\u003e\n      \u003ctd\u003e22.824030\u003c/td\u003e\n      \u003ctd\u003e23.206607\u003c/td\u003e\n      \u003ctd\u003e23.420897\u003c/td\u003e\n      \u003ctd\u003e-1.182308\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e2\u003c/th\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003e25.603993\u003c/td\u003e\n      \u003ctd\u003e21.344415\u003c/td\u003e\n      \u003ctd\u003e22.156335\u003c/td\u003e\n      \u003ctd\u003e20.702953\u003c/td\u003e\n      \u003ctd\u003e32.709300\u003c/td\u003e\n      \u003ctd\u003e31.160601\u003c/td\u003e\n      \u003ctd\u003e32.235024\u003c/td\u003e\n      \u003ctd\u003e-2.167992\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e3\u003c/th\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003e25.896114\u003c/td\u003e\n      \u003ctd\u003e24.694210\u003c/td\u003e\n      \u003ctd\u003e24.528586\u003c/td\u003e\n      \u003ctd\u003e24.726851\u003c/td\u003e\n      \u003ctd\u003e25.301338\u003c/td\u003e\n      \u003ctd\u003e24.629402\u003c/td\u003e\n      \u003ctd\u003e25.307131\u003c/td\u003e\n      \u003ctd\u003e-1.992109\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e4\u003c/th\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003e25.146416\u003c/td\u003e\n      \u003ctd\u003e23.833867\u003c/td\u003e\n      \u003ctd\u003e24.412396\u003c/td\u003e\n      \u003ctd\u003e23.194615\u003c/td\u003e\n      \u003ctd\u003e27.318547\u003c/td\u003e\n      \u003ctd\u003e26.941532\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e-1.763762\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e...\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e3498996\u003c/th\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003e24.066025\u003c/td\u003e\n      \u003ctd\u003e24.704767\u003c/td\u003e\n      \u003ctd\u003e23.426418\u003c/td\u003e\n      \u003ctd\u003e23.251519\u003c/td\u003e\n      \u003ctd\u003e23.694467\u003c/td\u003e\n      \u003ctd\u003e23.526109\u003c/td\u003e\n      \u003ctd\u003e23.461376\u003c/td\u003e\n      \u003ctd\u003e-1.640509\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e3498997\u003c/th\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003e24.372916\u003c/td\u003e\n      \u003ctd\u003e23.401461\u003c/td\u003e\n      \u003ctd\u003e25.628531\u003c/td\u003e\n      \u003ctd\u003e23.528569\u003c/td\u003e\n      \u003ctd\u003e23.455045\u003c/td\u003e\n      \u003ctd\u003e23.588801\u003c/td\u003e\n      \u003ctd\u003e23.409819\u003c/td\u003e\n      \u003ctd\u003e-2.022856\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e3498998\u003c/th\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003e23.682455\u003c/td\u003e\n      \u003ctd\u003e23.030631\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e23.019727\u003c/td\u003e\n      \u003ctd\u003e23.157976\u003c/td\u003e\n      \u003ctd\u003e23.637121\u003c/td\u003e\n      \u003ctd\u003e22.932438\u003c/td\u003e\n      \u003ctd\u003e-1.608324\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e3498999\u003c/th\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003e23.257301\u003c/td\u003e\n      \u003ctd\u003e22.340015\u003c/td\u003e\n      \u003ctd\u003e22.342694\u003c/td\u003e\n      \u003ctd\u003e22.132900\u003c/td\u003e\n      \u003ctd\u003e22.572963\u003c/td\u003e\n      \u003ctd\u003e22.269022\u003c/td\u003e\n      \u003ctd\u003e22.126816\u003c/td\u003e\n      \u003ctd\u003e-0.928865\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e3499000\u003c/th\u003e\n      \u003ctd\u003e2\u003c/td\u003e\n      \u003ctd\u003e19.420445\u003c/td\u003e\n      \u003ctd\u003e24.079663\u003c/td\u003e\n      \u003ctd\u003e26.476873\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e28.360588\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e-3.214653\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e3499001 rows × 9 columns\u003c/p\u003e\n\u003c/div\u003e","content_type":"text/html"}}},"key":"AlCoWargxi"}],"key":"ZRpgz8Ebvx"}],"key":"NwqEd2kRTT"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"children":[{"type":"text","value":"4. Magnitude Distributions of Galaxies, Stars, and QSOs","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"ZZsJGf031V"}],"identifier":"id-4-magnitude-distributions-of-galaxies-stars-and-qsos","label":"4. Magnitude Distributions of Galaxies, Stars, and QSOs","html_id":"id-4-magnitude-distributions-of-galaxies-stars-and-qsos","implicit":true,"key":"vi6uFuMyie"}],"key":"XHbpIxQVXt"},{"type":"block","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":217,"column":1},"end":{"line":219,"column":1}},"children":[{"type":"text","value":"Let’s visualize the template-fit magnitude distributions as a function of PHZ classification.\nSince the template-fit photometry is recommended for extended objects, we’ll separate the point-like objects.\n","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"RwANoIGGOP"},{"type":"link","url":"https://arxiv.org/pdf/2503.15306","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"children":[{"type":"text","value":"Euclid Collaboration: Tucci et al., 2025","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"G4t3oY0ooO"}],"urlSource":"https://arxiv.org/pdf/2503.15306","key":"jUe338W198"},{"type":"text","value":" defines point-like objects as having ","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"j0er8c58gX"},{"type":"inlineCode","value":"MUMAX_MINUS_MAG \u003c -2.5","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"svPPu5d4Xa"},{"type":"text","value":".","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"UE1wvL0DCg"}],"key":"JDRPqReiUh"}],"key":"fPy43xQfug"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Galaxy + any. Star + galaxy. QSO + galaxy.\nclasses = {\"Galaxy\": (2, 3, 6, 7), \"Star\": (1, 3), \"QSO\": (4, 6)}\nclass_colors = [\"tab:green\", \"tab:blue\", \"tab:orange\"]\n\nbands = [I_MAG, \"Y templfit (mag)\", \"J templfit (mag)\", \"H templfit (mag)\"]\nmag_limits = (14, 28)  # Excluding all magnitudes outside this range.\nhist_kwargs = dict(bins=20, range=mag_limits, histtype=\"step\")\n\nfig, axes = plt.subplots(3, 4, figsize=(18, 12), sharey=\"row\", sharex=True)\nfor (class_name, class_ids), class_color in zip(classes.items(), class_colors):\n    hist_kwargs[\"color\"] = class_color\n\n    # Get the objects that are in this class only.\n    class_df = mags_df.loc[mags_df[PHZ_CLASS] == class_ids[0]]\n    # Plot histograms for each band. Galaxies on top row, then stars, then QSOs.\n    axs = axes[0] if class_name == \"Galaxy\" else (axes[1] if class_name == \"Star\" else axes[2])\n    for ax, band in zip(axs, bands):\n        ax.hist(class_df[band], label=class_name, **hist_kwargs)\n\n    # Get the objects that were accepted as multiple classes.\n    class_df = mags_df.loc[mags_df[PHZ_CLASS].isin(class_ids)]\n    label = \"+Galaxy\" if class_name != \"Galaxy\" else \"+any\"\n    # Of those objects, restrict to the ones that are point-like.\n    classpt_df = class_df.loc[class_df[MUMAX_MINUS_MAG] \u003c -2.5]\n    pt_label = f\"{label} (point-like)\"\n    # Plot histograms for both sets of objects.\n    for ax, band in zip(axs, bands):\n        ax.hist(class_df[band], label=label, linestyle=\":\", **hist_kwargs)\n        ax.hist(classpt_df[band], linestyle=\"-.\", label=pt_label, **hist_kwargs)\n\n# Add axis labels, etc.\nfor ax, loc in zip(axes[:, 0], [2, 3, 2]):\n    ax.legend(loc=loc)\n    ax.set_ylabel(\"Counts\")\nfor axs, band in zip(axes.transpose(), bands):\n    axs[0].set_title(band.split()[0])\n    axs[-1].set_xlabel(band)\nfig.suptitle(\"Magnitude Distributions by Object Type\")\nplt.tight_layout()","key":"onlpNNRaQY"},{"type":"outputs","id":"oPId6K24QHzhvAW_-3Gdg","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 1800x1200 with 12 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"656b71f536fe5310ff69428b5aee52ff","path":"/irsa-tutorials/build/656b71f536fe5310ff69428b5aee52ff.png"}}},"key":"FqybzpL2Gf"}],"key":"d9ANCozT27"}],"key":"IlA2HGbq0c"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"children":[{"type":"text","value":"The Euclid instruments are tuned to detect galaxies for cosmology studies, so it’s no surprise that there are many more galaxies than other object types.","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"AGn6tsA0wB"}],"key":"BXD04qYMns"},{"type":"paragraph","position":{"start":{"line":269,"column":1},"end":{"line":270,"column":1}},"children":[{"type":"text","value":"The green lines (top row) show the magnitude distributions of objects classified as galaxy only (solid) and those classified as galaxy plus possibly other types (dot and dash-dot).\nThe dash-dot line highlights the population of point-like “galaxies”, which are likely misclassified stars or QSOs and mostly appear at faint magnitudes.","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"IRZ8BI9f3O"}],"key":"uZSt67yPfM"},{"type":"paragraph","position":{"start":{"line":272,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"text","value":"The star distributions (middle row, blue) are broader and peak at brighter magnitudes than the galaxy distributions, as expected.\nAdding objects classified as both star and galaxy (dotted line) adds significant numbers, especially near the peak and toward the faint end where confusion is more likely.\nRestricting these to point-like objects (dash-dot line) shows that many bright objects surpassing both probability thresholds are likely to be stars, not galaxies.\nHowever, this doesn’t hold at the faint end where even some star-only classified objects fail the point-like cut.","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"C1GKVJIAwQ"}],"key":"FfGK3QsXZf"},{"type":"paragraph","position":{"start":{"line":277,"column":1},"end":{"line":280,"column":1}},"children":[{"type":"text","value":"The bottom row (orange) is the same as the middle row but for QSOs instead of stars.\nThere are very few point-like QSOs, reminding us that most QSO classifications in Q1 should be treated with skepticism (as discussed in the Classifications tutorial).\nBy default, this figure only includes objects in the EDF-F region.\nHigh-confidence QSOs are more concentrated in the EDF-N region where advantageous external photometry (particularly u-band from UNIONS) was available.","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"bUboblKAWX"}],"key":"xJ23aBPC35"}],"key":"dyLdyFoxES"},{"type":"block","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"children":[{"type":"text","value":"5. Template-fit vs. Aperture Magnitudes","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"Tf0SxzUy4X"}],"identifier":"id-5-template-fit-vs-aperture-magnitudes","label":"5. Template-fit vs. Aperture Magnitudes","html_id":"id-5-template-fit-vs-aperture-magnitudes","implicit":true,"key":"UxnsEHrnTv"}],"key":"YHm8tuixjn"},{"type":"block","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":288,"column":1},"end":{"line":289,"column":1}},"children":[{"type":"text","value":"Now let’s compare template-fit and aperture magnitudes by plotting their differences.\nThis comparison reveals systematic offsets that depend on factors including morphology (extended vs. point-like) and brightness.","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"HnkhXabbIt"}],"key":"tQciy1VsHO"},{"type":"paragraph","position":{"start":{"line":291,"column":1},"end":{"line":291,"column":1}},"children":[{"type":"text","value":"This figure is inspired by Romelli Fig. 6 (top panel).","position":{"start":{"line":291,"column":1},"end":{"line":291,"column":1}},"key":"ZrJ3OlylMW"}],"key":"i6YK1h4IHa"}],"key":"S9CUTTyvpU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Only consider objects within these mag and mag difference limits.\nmag_limits, mag_diff_limits = (16, 24), (-1, 1)\nmag_limited_df = mags_df.loc[(mags_df[I_MAG] \u003e mag_limits[0]) \u0026 (mags_df[I_MAG] \u003c mag_limits[1])]\n\nbands = [\n    (\"Y templfit (mag)\", \"Y aperture (mag)\"),\n    (\"J templfit (mag)\", \"J aperture (mag)\"),\n    (\"H templfit (mag)\", \"H aperture (mag)\"),\n]\nhexbin_kwargs = dict(\n    cmap=\"YlGnBu\", bins=\"log\", extent=(*mag_limits, *mag_diff_limits), gridsize=25\n)\nannotate_kwargs = dict(\n    xycoords=\"axes fraction\", ha=\"left\", fontweight=\"bold\", bbox=dict(facecolor=\"white\", alpha=0.8)\n)\n\n# Plot\nfig, axes = plt.subplots(2, 3, figsize=(18, 9), sharey=True, sharex=True)\nfor axs, (ref_band, aper_band) in zip(axes.transpose(), bands):\n    # Extended objects, top row.\n    ax = axs[0]\n    extended = mags_df.loc[mags_df[MUMAX_MINUS_MAG] \u003e= -2.5, [I_MAG, ref_band, aper_band]]\n    extended[\"mag_diff\"] = extended[ref_band] - extended[aper_band]\n    extended = extended.dropna(subset=\"mag_diff\")\n    cb = ax.hexbin(extended[I_MAG], extended[\"mag_diff\"], **hexbin_kwargs)\n    plt.colorbar(cb)\n    ax.set_ylabel(f\"{ref_band} - {aper_band}\")\n    # Annotate top (bottom) with the fraction of objects having a magnitude difference greater (less) than 0.\n    frac_tmpl_greater = len(extended.loc[extended[\"mag_diff\"] \u003e 0]) / len(extended)\n    ax.annotate(f\"{frac_tmpl_greater:.3f}\", xy=(0.01, 0.99), va=\"top\", **annotate_kwargs)\n    frac_tmpl_less = len(extended.loc[extended[\"mag_diff\"] \u003c 0]) / len(extended)\n    ax.annotate(f\"{frac_tmpl_less:.3f}\", xy=(0.01, 0.01), va=\"bottom\", **annotate_kwargs)\n\n    # Point-like objects, bottom row.\n    ax = axs[1]\n    pointlike = mags_df.loc[mags_df[MUMAX_MINUS_MAG] \u003c -2.5, [I_MAG, ref_band, aper_band]]\n    pointlike[\"mag_diff\"] = pointlike[ref_band] - pointlike[aper_band]\n    pointlike = pointlike.dropna(subset=\"mag_diff\")\n    cb = ax.hexbin(pointlike[I_MAG], pointlike[\"mag_diff\"], **hexbin_kwargs)\n    plt.colorbar(cb)\n    ax.set_ylabel(f\"{ref_band} - {aper_band}\")\n    # Annotate top (bottom) with the fraction of objects having a magnitude difference greater (less) than 0.\n    frac_tmpl_greater = len(pointlike.loc[pointlike[\"mag_diff\"] \u003e 0]) / len(pointlike)\n    ax.annotate(f\"{frac_tmpl_greater:.3f}\", xy=(0.01, 0.99), va=\"top\", **annotate_kwargs)\n    frac_tmpl_less = len(pointlike.loc[pointlike[\"mag_diff\"] \u003c 0]) / len(pointlike)\n    ax.annotate(f\"{frac_tmpl_less:.3f}\", xy=(0.01, 0.01), va=\"bottom\", **annotate_kwargs)\n\n# Add axis labels, etc.\nfor i, ax in enumerate(axes.flatten()):\n    ax.axhline(0, color=\"gray\", linewidth=1)\n    if i == 1:\n        ax.set_title(\"Extended objects\")\n    if i == 4:\n        ax.set_title(\"Point-like objects\")\n    if i \u003e 2:\n        ax.set_xlabel(I_MAG)\nfig.suptitle(\"Magnitude Offsets (Template fit - Aperture)\")\nplt.tight_layout()","key":"bN2isAPF9l"},{"type":"outputs","id":"gki1MpAjuSW9HgRiIWffh","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 1800x900 with 12 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"cf7ca7b7579887ddb85e78eccbb823b2","path":"/irsa-tutorials/build/cf7ca7b7579887ddb85e78eccbb823b2.png"}}},"key":"BQYIYEmYKD"}],"key":"Yf16pP1EKr"}],"key":"XoX0AvZbS9"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":358,"column":1},"end":{"line":361,"column":1}},"children":[{"type":"text","value":"The panel annotations give the fraction of objects with magnitude differences that are positive (top number) and negative (bottom number).\nThe magnitude difference is fairly tightly clustered around 0 for extended objects (top row), but with asymmetric outliers.\nThere is a positive offset, indicating fainter template-fit magnitudes, as expected: templates better exclude contaminating light from nearby sources.\nThe offset is more pronounced for point-like objects (bottom row), likely due to the PSF handling mentioned above, and we are reminded that aperture magnitudes are more reliable here.","position":{"start":{"line":358,"column":1},"end":{"line":358,"column":1}},"key":"MxnGn1fjBr"}],"key":"R2GAB5RCB4"}],"key":"BAawIBFSNI"},{"type":"block","position":{"start":{"line":363,"column":1},"end":{"line":363,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":365,"column":1},"end":{"line":365,"column":1}},"children":[{"type":"text","value":"About this notebook","position":{"start":{"line":365,"column":1},"end":{"line":365,"column":1}},"key":"GbWs7ZOscf"}],"identifier":"about-this-notebook","label":"About this notebook","html_id":"about-this-notebook","implicit":true,"key":"NqnEB1La3D"},{"type":"paragraph","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"children":[{"type":"strong","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"children":[{"type":"text","value":"Authors:","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"key":"O6i7cLQwcY"}],"key":"Wz9zP7aYlm"},{"type":"text","value":" Troy Raen, Vandana Desai, Andreas Faisst, Shoubaneh Hemmati, Jaladh Singhal, Brigitta Sipőcz, Jessica Krick, the IRSA Data Science Team, and the Euclid NASA Science Center at IPAC (ENSCI).","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"key":"O9s9ICxubA"}],"key":"xkjUXgGUuk"},{"type":"paragraph","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"children":[{"type":"strong","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"children":[{"type":"text","value":"Updated:","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"Pv1QlPICAo"}],"key":"zuvyXOwvx7"},{"type":"text","value":" 2025-12-23","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"yu4js6m6Lc"}],"key":"SinXPwG4pR"},{"type":"paragraph","position":{"start":{"line":371,"column":1},"end":{"line":371,"column":1}},"children":[{"type":"strong","position":{"start":{"line":371,"column":1},"end":{"line":371,"column":1}},"children":[{"type":"text","value":"Contact:","position":{"start":{"line":371,"column":1},"end":{"line":371,"column":1}},"key":"syHLlfDMdV"}],"key":"ydt8wn3qKG"},{"type":"text","value":" ","position":{"start":{"line":371,"column":1},"end":{"line":371,"column":1}},"key":"fiewQSjcPj"},{"type":"link","url":"https://irsa.ipac.caltech.edu/docs/help_desk.html","position":{"start":{"line":371,"column":1},"end":{"line":371,"column":1}},"children":[{"type":"text","value":"IRSA Helpdesk","position":{"start":{"line":371,"column":1},"end":{"line":371,"column":1}},"key":"bOnaHaPqZp"}],"urlSource":"https://irsa.ipac.caltech.edu/docs/help_desk.html","key":"J6TFCqNMmW"}],"key":"MWxwm1cg1r"}],"key":"KFmo8LqTtR"}],"key":"yLEI5rScgJ"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Euclid Q1 Merged Objects HATS Catalog: Introduction","short_title":"Introduction","url":"/euclid-q1-hats-intro","group":"Merged Objects HATS Catalog"},"next":{"title":"Euclid Q1: Cloud Access","short_title":"Cloud Access","url":"/euclid-cloud-access","group":"Merged Objects HATS Catalog"}}},"domain":"http://localhost:3000"},"project":{"subject":"IRSA Tutorials","settings":{"output_matplotlib_strings":"remove"},"title":"IRSA Tutorials","description":"IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)","authors":[{"id":"IRSA Scientists and Developers","name":"IRSA Scientists and Developers"}],"github":"https://github.com/Caltech-IPAC/irsa-tutorials/","keywords":["astronomy"],"thebe":{"binder":{"url":"https://mybinder.org","provider":"github","repo":"https://github.com/Caltech-IPAC/irsa-tutorials/","ref":"HEAD"}},"toc":[{"file":"index.md","title":"IRSA Tutorials"},{"children":[{"file":"tutorials/spherex/spherex_intro.md","title":"Data Overview"},{"file":"tutorials/spherex/spherex_cutouts.md","title":"Spectral Image Cutouts"},{"file":"tutorials/spherex/spherex_psf.md","title":"PSF Models"}],"file":"tutorials/spherex/spherex.md","title":"SPHEREx"},{"children":[{"file":"tutorials/euclid/1_Euclid_intro_MER_images.md","title":"MER Mosaics"},{"file":"tutorials/euclid/3_Euclid_intro_1D_spectra.md","title":"SIR 1D Spectra"},{"file":"tutorials/euclid/2_Euclid_intro_MER_catalog.md","title":"MER Catalogs"},{"file":"tutorials/euclid/4_Euclid_intro_PHZ_catalog.md","title":"PHZ Catalogs"},{"file":"tutorials/euclid/5_Euclid_intro_SPE_catalog.md","title":"SPE Catalogs"},{"children":[{"file":"tutorials/euclid/merged-objects-hats-catalog/1-euclid-q1-hats-intro.md","title":"Introduction"},{"file":"tutorials/euclid/merged-objects-hats-catalog/4-euclid-q1-hats-magnitudes.md","title":"Magnitudes"}],"title":"Merged Objects HATS Catalog"},{"file":"tutorials/euclid/euclid-cloud-access.md","title":"Cloud Access"},{"file":"tutorials/euclid/Euclid_ERO.md","title":"ERO Star Clusters"}],"file":"tutorials/euclid/euclid.md","title":"Euclid"},{"children":[{"file":"tutorials/wise/sia_allwise_atlas.md","title":"AllWISE Images"},{"file":"tutorials/wise/wise-allwise-catalog-demo.md","title":"AllWISE Catalog"},{"file":"tutorials/wise/NEOWISE_light_curve_demo.md","title":"NEOWISE Firefly"},{"file":"tutorials/wise/neowise-source-table-strategies.md","title":"NEOWISE Strategies"},{"file":"tutorials/wise/neowise-source-table-lightcurves.md","title":"NEOWISE Light Curves"}],"file":"tutorials/wise/wise.md","title":"WISE"},{"children":[{"file":"tutorials/spitzer/siav2_seip.md"}],"title":"Spitzer"},{"children":[{"file":"tutorials/2mass/sia_2mass_allsky.md"}],"title":"2MASS"},{"children":[{"file":"tutorials/cosmos/sia_cosmos.md"}],"title":"COSMOS"},{"children":[{"file":"tutorials/simulated-data/roman_hlss_number_density.md","title":"Roman HLSS Number Density"},{"file":"tutorials/simulated-data/openuniverse2024_roman_simulated_wideareasurvey.md","title":"OpenUniverse2024 Roman coadds"},{"file":"tutorials/simulated-data/OpenUniverse2024Preview_Firefly.md","title":"OpenUniverse2024 Visualization"},{"file":"tutorials/simulated-data/openuniverse2024_roman_simulated_timedomainsurvey.md","title":"OpenUniverse2024 Time Domain"},{"file":"tutorials/simulated-data/cosmoDC2_TAP_access.md","title":"CosmoDC2 Data Access"}],"file":"tutorials/simulated-data/simulated.md","title":"Simulated Data"},{"children":[{"file":"tutorials/techniques-and-tools/cloud-access-intro.md","title":"Cloud Access"},{"file":"tutorials/techniques-and-tools/irsa-hats-with-lsdb.md","title":"LSDB HATS"},{"file":"tutorials/techniques-and-tools/SEDs_in_Firefly.md","title":"SED visualization"},{"file":"tutorials/techniques-and-tools/Parallelize_Convolution.md","title":"Parallelization"}],"file":"tutorials/techniques-and-tools/techniques.md","title":"Techniques \u0026 Tools"}],"exports":[],"bibliography":[],"index":"index","pages":[{"slug":"spherex","title":"Spherex Tutorial Notebooks","short_title":"SPHEREx","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"spherex-intro","title":"Introduction to SPHEREx Spectral Images","short_title":"Data Overview","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-cutouts","title":"Download a collection of SPHEREx Spectral Image cutouts as a multi-extension FITS file","short_title":"Spectral Image Cutouts","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spherex-psf","title":"Understanding and Extracting the PSF Extension in a SPHEREx Cutout","short_title":"PSF Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euclid","title":"Euclid Tutorial Notebooks","short_title":"Euclid","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"euclid-intro-mer-images","title":"Euclid Q1: MER Mosaics","short_title":"MER Mosaics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euclid-intro-1d-spectra","title":"Euclid Q1: SIR 1D Spectra","short_title":"SIR 1D Spectra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euclid-intro-mer-catalog","title":"Euclid Q1: MER Catalogs","short_title":"MER Catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euclid-intro-phz-catalog","title":"Euclid Q1: PHZ Catalogs","short_title":"PHZ Catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euclid-intro-spe-catalog","title":"Euclid Q1: SPE Catalogs","short_title":"SPE Catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"Merged Objects HATS Catalog"},{"slug":"euclid-q1-hats-intro","title":"Euclid Q1 Merged Objects HATS Catalog: Introduction","short_title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-q1-hats-magnitudes","title":"Euclid Q1 Merged Objects HATS Catalog: Magnitudes","short_title":"Magnitudes","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-cloud-access","title":"Euclid Q1: Cloud Access","short_title":"Cloud Access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euclid-ero","title":"Exploring Star Clusters in the Euclid ERO Data","short_title":"ERO Star Clusters","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"wise","title":"WISE Tutorial Notebooks","short_title":"WISE","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"sia-allwise-atlas","title":"Searching for AllWISE Atlas Images","short_title":"AllWISE Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"wise-allwise-catalog-demo","title":"Analyzing cloud-hosted AllWISE Source Catalog in Parquet format","short_title":"AllWISE Catalog","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"neowise-light-curve-demo","title":"Using Firefly visualization tools to understand the light curves of Solar System objects","short_title":"NEOWISE Firefly","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"neowise-source-table-strategies","title":"Strategies to Efficiently Work with NEOWISE Single-exposure Source Table in Parquet","short_title":"NEOWISE Strategies","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"neowise-source-table-lightcurves","title":"Make Light Curves from NEOWISE Single-exposure Source Table","short_title":"NEOWISE Light Curves","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Spitzer"},{"slug":"siav2-seip","title":"Searching for Spitzer Enhanced Imaging Products","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"2MASS"},{"slug":"sia-2mass-allsky","title":"Searching for 2MASS All-Sky Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"COSMOS"},{"slug":"sia-cosmos","title":"Searching for contributed COSMOS images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"simulated","title":"Simulated Data Tutorial Notebooks","short_title":"Simulated Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"roman-hlss-number-density","title":"Number Density as a Function of Redshift","short_title":"Roman HLSS Number Density","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"openuniverse2024-roman-simulated-wideareasurvey","title":"Analyzing cloud-hosted simulated Roman coadded images","short_title":"OpenUniverse2024 Roman coadds","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"openuniverse2024preview-firefly","title":"Using Firefly to Explore OpenUniverse2024 Data Preview Simulated Roman and Rubin Images","short_title":"OpenUniverse2024 Visualization","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"openuniverse2024-roman-simulated-timedomainsurvey","title":"Analyzing cloud-hosted simulated Roman Time Domain Survey images","short_title":"OpenUniverse2024 Time Domain","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"cosmodc2-tap-access","title":"Querying the CosmoDC2 Mock v1 Catalogs","short_title":"CosmoDC2 Data Access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"techniques","title":"Techniques \u0026 Tools Tutorial Notebooks","short_title":"Techniques \u0026 Tools","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"cloud-access-intro","title":"IRSA cloud access introduction","short_title":"Cloud Access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"irsa-hats-with-lsdb","title":"Access HATS Collections Using LSDB: Euclid Q1 and ZTF DR23","short_title":"LSDB HATS","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"seds-in-firefly","title":"Using Firefly visualization tools in Python to vet SEDs","short_title":"SED visualization","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"parallelize-convolution","title":"Parallelizing image convolution","short_title":"Parallelization","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/irsa-tutorials/build/manifest-54BD5942.js";
import * as route0 from "/irsa-tutorials/build/root-PMP5BIHC.js";
import * as route1 from "/irsa-tutorials/build/routes/$-5ZLZ2O3Y.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/irsa-tutorials/build/entry.client-PCJPW7TK.js");</script></body></html>