<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Using Firefly to Explore OpenUniverse2024 Data Preview Simulated Roman and Rubin Images - IRSA Tutorials</title><meta property="og:title" content="Using Firefly to Explore OpenUniverse2024 Data Preview Simulated Roman and Rubin Images - IRSA Tutorials"/><meta name="generator" content="mystmd"/><meta name="description" content="IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)"/><meta property="og:description" content="IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)"/><meta name="keywords" content="astronomy"/><link rel="stylesheet" href="/build/_assets/app-5WKS5EPQ.css"/><link rel="stylesheet" href="/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/favicon.ico"/><link rel="stylesheet" href="/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/"><div class="p-1 mr-3 dark:bg-white dark:rounded"><img src="/build/irsa_logo-2376335cd55626fdfef6fc361185182d.png" class="h-9" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="IRSA Tutorials" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/">IRSA Tutorials</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="SPHEREx" class="block break-words rounded py-2 grow cursor-pointer">SPHEREx</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Euclid" class="block break-words rounded py-2 grow cursor-pointer">Euclid</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rup8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rup8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="WISE" class="block break-words rounded py-2 grow cursor-pointer">WISE</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R16p8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R16p8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Spitzer" class="block break-words rounded py-2 grow cursor-pointer">Spitzer</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1ep8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1ep8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="2MASS" class="block break-words rounded py-2 grow cursor-pointer">2MASS</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1mp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1mp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="COSMOS" class="block break-words rounded py-2 grow cursor-pointer">COSMOS</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1up8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1up8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="open" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Simulated Data" class="block break-words rounded py-2 grow font-semibold text-blue-800 dark:text-blue-200 cursor-pointer">Simulated Data</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R26p8p:" aria-expanded="true" data-state="open"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="open" id="radix-:R26p8p:" class="pl-3 pr-[2px] collapsible-content"><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Roman HLSS Galaxy Mock Catalog" class="block break-words rounded py-2 grow cursor-pointer">Roman HLSS Galaxy Mock Catalog</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1m6p8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1m6p8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="open" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="OpenUniverse 2024" class="block break-words rounded py-2 grow font-semibold text-blue-800 dark:text-blue-200 cursor-pointer">OpenUniverse 2024</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R2m6p8p:" aria-expanded="true" data-state="open"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="open" id="radix-:R2m6p8p:" class="pl-3 pr-[2px] collapsible-content"><a title="Analyzing cloud-hosted simulated Roman coadded images" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/openuniverse2024-roman-simulated-wideareasurvey">Analyzing cloud-hosted simulated Roman coadded images</a><a title="Using Firefly to Explore OpenUniverse2024 Data Preview Simulated Roman and Rubin Images" aria-current="page" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg bg-blue-300/30 active" href="/openuniverse2024preview-firefly">Using Firefly to Explore OpenUniverse2024 Data Preview Simulated Roman and Rubin Images</a><a title="Analyzing cloud-hosted simulated Roman Time Domain Survey images" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/openuniverse2024-roman-simulated-timedomainsurvey">Analyzing cloud-hosted simulated Roman Time Domain Survey images</a></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="CosmoDC2" class="block break-words rounded py-2 grow cursor-pointer">CosmoDC2</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R3m6p8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R3m6p8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Special Topics" class="block break-words rounded py-2 grow cursor-pointer">Special Topics</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R2ep8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R2ep8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><article class="article content article-grid grid-gap"><main class="article-grid subgrid-gap col-screen"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-none pr-2 smallcaps">IRSA Tutorials</div><div class="flex-grow"></div><a href="https://github.com/Caltech-IPAC/irsa-tutorials/" title="GitHub Repository: Caltech-IPAC/irsa-tutorials/" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><a href="https://github.com/Caltech-IPAC/irsa-tutorials//blob/main/tutorials/firefly/OpenUniverse2024Preview_Firefly.md" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Using Firefly to Explore OpenUniverse2024 Data Preview Simulated Roman and Rubin Images</h1><header class="mt-4 not-prose"><div><span class="font-semibold text-sm inline-block"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78top:" data-state="closed">IRSA Scientists and Developers</button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><h2 id="learning-goals" class="relative group"><span class="heading-text">Learning Goals</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#learning-goals" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>By the end of this tutorial, you will:</p><ul><li><p>Learn how to access cloud-hosted Roman and Rubin simulated images.</p></li><li><p>Learn how to launch an interactive Firefly instance inside JupyterLab.</p></li><li><p>Learn how to use the Firefly Jupyterlab extension to visualize cloud-hosted simulated images, overplot ds9 regions, overplot catalogs in Parquet format, and create 3 color images.</p></li></ul><h2 id="introduction" class="relative group"><span class="heading-text">Introduction</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#introduction" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The purpose of this tutorial is to become familiar with simulated Roman and Rubin simulated data published through the OpenUniverse 2024 data preview, and to become familiar with the Firefly JupyterLab Extension for visualizing astronomical data products.</p><p>OpenUniverse2024 is a project to simulate spatially overlapping imaging surveys to be carried out by the Nancy Grace Roman Telescope and the Vera C. Rubin Observatory. The simulations were carried out on Argonne’s Theta cluster and consist of:</p><ul><li>The LSST ELAIS-S1 Deep Drilling Field (DDF)</li><li>The Roman Time-Domain Survey (TDS) shifted to overlap the ELAIS region and LSST DDF</li><li>Overlapping LSST Wide-Fast-Deep (WFD) survey (with rolling cadence)</li><li>Overlapping Roman Wide-Area Survey (WAS) in the same region</li><li>A deep-field calibration region of the Roman WAS in the same region</li></ul><p>This data preview release consists of a subset of data from each of the five categories above. More information about data preview can be found at <a target="_blank" rel="noreferrer" href="https://irsa.ipac.caltech.edu/data/theory/openuniverse2024/overview.html" class="">IRSA holding of this dataset</a>.</p><p>Firefly is an open-source web-based UI library for astronomical data archive access and visualization developed at Caltech and used by multiple space- and ground-based astrophysics archives. More information on Firefly can be found <a href="https://github.com/Caltech-IPAC/firefly/blob/dev/README.md" class="italic" target="_blank" rel="noreferrer" data-state="closed">here</a>.</p><p>In addition to being used to make web applications, Firefly can be used from Python. More information on Firefly Python client can be found <a target="_blank" rel="noreferrer" href="https://caltech-ipac.github.io/firefly_client/usage/index.html" class="">here</a>.</p><p>The Firefly JupyterLab Extension makes it particularly easy to use Firefly to efficiently visualize cloud-hosted astronomical data using JupyterLab instances running locally or on cloud. More information on Firefly JupyterLab Extension can be found <a href="https://github.com/Caltech-IPAC/jupyter_firefly_extensions/blob/master/README.md" class="italic" target="_blank" rel="noreferrer" data-state="closed">here</a>.</p><h2 id="imports" class="relative group"><span class="heading-text">Imports</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#imports" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><ul><li>astropy.io.fits for accessing FITS files</li><li>numpy for numerical computing</li><li>s3fs for browsing cloud buckets</li><li>matplotlib.pyplot for creating static visualizations of FITS images</li><li>matplotlib.patches for annotating visualizations of FITS images</li><li>astropy.wcs for dealing with astronomical world coordinate systems</li><li>astropy.units for dealing with astronomical units</li><li>astropy.coordinates.SkyCoord for dealing with astronomical coordinates</li><li>firefly_client.FireflyClient for using the Firefly python client</li><li>astropy.nddata.Cutout2D for making image cutouts</li><li>itertools.product to support looping over Roman blocks</li><li>reproject.reproject_interp to convert Roman coadds from STG to TAN projection</li><li>io.BytesIO for writing a fits file to an in-memory stream</li></ul><div id="phqdDCRx1U" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Uncomment the next line to install dependencies if needed.
# !pip install numpy astropy s3fs matplotlib firefly_client reproject</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="LiSgMUvsxI0bem7s9DXEz" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="UVZZTxYv7r" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from astropy.io import fits
import numpy as np
import s3fs
from matplotlib import pyplot as plt
from matplotlib import patches
from astropy import wcs
from astropy import units as u
from astropy.coordinates import SkyCoord
from firefly_client import FireflyClient
from astropy.nddata import Cutout2D
from itertools import product
from reproject import reproject_interp
from io import BytesIO</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="b1TOtV-CcudfePiNNjmXf" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="learn-where-the-openuniverse2024-data-are-hosted-in-the-cloud" class="relative group"><span class="heading-text">Learn where the OpenUniverse2024 data are hosted in the cloud.</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#learn-where-the-openuniverse2024-data-are-hosted-in-the-cloud" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The OpenUniverse2024 data preview is hosted in the cloud via Amazon Web Services (AWS). To access these data, you need to create a client to read data from Amazon’s Simple Storage Service (s3) buckets, and you need to know some information about those buckets. The OpenUniverse2024 data preview contains simulations of the Roman Wide-Area Survey (WAS) and the Roman Time Domain Survey (TDS). In this tutorial, we will focus on the WAS.</p><div id="TpTqnwIjcW" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">BUCKET_NAME = &quot;nasa-irsa-simulations&quot;
ROMAN_PREFIX = &quot;openuniverse2024/roman/preview&quot;
ROMAN_COADD_PATH = f&quot;{ROMAN_PREFIX}/RomanWAS/images/coadds&quot;
TRUTH_FILES_PATH = f&quot;{ROMAN_PREFIX}/roman_rubin_cats_v1.1.2_faint&quot;

RUBIN_PREFIX = &quot;openuniverse2024/rubin/preview&quot;
RUBIN_COADD_PATH = f&quot;{RUBIN_PREFIX}/u/descdm/preview_data_step3_2877_19_w_2024_12/20240403T150003Z/deepCoadd_calexp/2877/19&quot;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="GauXQooyznT1yX4dRsNoS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="roman-coadds" class="relative group"><span class="heading-text">Roman Coadds</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#roman-coadds" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The Nancy Grace Roman Space Telescope will carry out a wide-area survey (WAS) in the near infrared. The OpenUniverse2024 data preview includes coadded mosaics of simulated WAS data, created with the IMCOM algorithm (Rowe et al. 2011). Bands include F184, H158, J129, K213, Y106. In this section, we define some functions that make it convenient to retrieve a given cloud-hosted simulated Roman coadd based on position and filter.</p><h3 id="define-roman-simulated-blocks" class="relative group"><span class="heading-text">Define Roman Simulated “Blocks”</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#define-roman-simulated-blocks" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The simulated Roman coadds are arranged in 100 arcsecond blocks, as described in Hirata et al. 2024. Below we define the RA and Dec of the block centers. This cell should not be altered.</p><div id="uqTyrCdNUJ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#Centers of roman data preview blocks. Do not alter.
ra_block_centers = np.array([9.76330352298415, 9.724522605135252, 9.68574158906671,
                        9.646960496603766, 9.608179349571955, 9.56939816979703,
                        9.530616979104877, 9.491835799321422, 9.453054652272561,
                        9.414273559784032, 9.375492543681393, 9.336711625789874]) * u.deg
dec_block_centers = np.array([-44.252584927082495, -44.22480733304182, -44.197029724175756,
                            -44.16925210374898, -44.14147447502621, -44.11369684127218,
                            -44.08591920575162, -44.05814157172923, -44.03036394246976,
                            -44.0025863212379, -43.974808711298394, -43.94703111591591]) * u.deg
block_size = 100 * u.arcsec # each block is 100 arcsec across</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="DDghrQeEgigSJ1Z3RWjW7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h3 id="define-a-function-that-returns-the-simulated-roman-block-column-row-for-a-given-ra-dec" class="relative group"><span class="heading-text">Define a function that returns the simulated Roman block column/row for a given RA/Dec.</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#define-a-function-that-returns-the-simulated-roman-block-column-row-for-a-given-ra-dec" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Blocks are arranged in a grid with axes parallel to RA and Dec. A given RA represents a column of blocks and a given Dec represents a row of blocks. This function returns the block column or row given the block centers from the cell above and a given RA or Dec, respectively.</p><div id="YhVd3XxVZG" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def get_block_axis(block_centers, coord, ra_or_dec):
    ra_or_dec_coord = getattr(coord, ra_or_dec)
    block_dist_array = np.absolute(block_centers - ra_or_dec_coord)
    closest_block_idx = block_dist_array.argmin()
    if (ra_or_dec_coord &lt; block_centers.min()-block_size/2 
        or ra_or_dec_coord &gt; block_centers.max()+block_size/2):
        raise ValueError(f&quot;Chosen {ra_or_dec}: {ra_or_dec_coord} not covered by OpenUniverse 2024 data preview simulated Roman coadds&quot;)
    else:
        return closest_block_idx + 12 # preview covers central 12 rows 12 columns, in a grid of 36x36 blocks</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_eMGZdyW3Uyh116ml03Ip" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h3 id="define-a-function-that-retrieves-a-roman-simulated-coadd-given-a-sky-position-and-filter" class="relative group"><span class="heading-text">Define a function that retrieves a Roman simulated coadd given a sky position and filter.</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#define-a-function-that-retrieves-a-roman-simulated-coadd-given-a-sky-position-and-filter" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Each of the cloud-hosted simulated Roman coadds can be accessed via a S3 filepath. This function returns the access path for the simulated Roman coadd that includes a specified position on the sky and desired filter.</p><div id="jovyNJqXQO" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def get_roman_coadd_fpath(coord, filter):
    col = get_block_axis(ra_block_centers, coord, &#x27;ra&#x27;)
    row = get_block_axis(dec_block_centers, coord, &#x27;dec&#x27;)
    
    # Construct the coadd filename from the chosen filter, row, and column.
    coadd_fname_root = f&quot;prod_{filter[0]}_{col}_{row}_map.fits&quot;
    coadd_fpath = f&quot;{BUCKET_NAME}/{ROMAN_COADD_PATH}/{filter}/Row{row}/{coadd_fname_root}&quot;
    return coadd_fpath</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5bLlV69hz9jaslZjiDz2X" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Now we use this access path and prefix it with <code>s3://</code> and use astropy.fits to extract a subset of it (for more info see <a target="_blank" rel="noreferrer" href="https://docs.astropy.org/en/stable/io/fits/usage/cloud.html#subsetting-fits-files-hosted-in-amazon-s3-cloud-storage" class="">this section</a> of astropy docs).</p><p>We use <code>.section</code> to retrieve just the science image data from fits HDU as a 2D <code>numpy.array</code>, and extract WCS information from fits header as <code>astropy.wcs.WCS</code> object. The following function returns a dictionary of both.</p><div id="aW1xawlo2u" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def get_roman_coadd(coord, filter):
    # retrive fits file of block/tile from the coadd mosiac
    coadd_s3_fpath = get_roman_coadd_fpath(coord, filter)
    coadd_s3_uri = f&quot;s3://{coadd_s3_fpath}&quot;

    with fits.open(coadd_s3_uri, fsspec_kwargs={&quot;anon&quot;: True}) as hdul:
        # retrieve science data from coadd fits
        coadd_data = hdul[0].section[0,0, :, :]  # has (2688, 2688, 15, 1) shape, with 0th layer in the cube as science image

        # make wcs using header
        coadd_wcs = wcs.WCS(hdul[0].header, naxis=2)

        return {&#x27;data&#x27;: coadd_data, &#x27;wcs&#x27;: coadd_wcs}</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="aeAjwa4bNMQDIekIUoomk" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h3 id="inspect-a-simulated-roman-coadd" class="relative group"><span class="heading-text">Inspect a simulated Roman Coadd</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#inspect-a-simulated-roman-coadd" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Choose a filter and position that lies within the data preview region</p><div id="GGrALW1Nn5" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">coord = SkyCoord(ra=9.6055383, dec=-44.1895542, unit=&quot;deg&quot;)
filter_roman = &#x27;H158&#x27; #F184, H158, J129, K213, and Y106 are available in the data preview</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="dZah-AYLI8lVKF4vxOkRt" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Retrieve the data and header information from the simulated Roman coadd corresponding to the chosen position and filter.</p><div id="ChG0yKZUB8" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">coadd_roman = get_roman_coadd(coord, filter_roman)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5Zx4brUaNhhroI6Wovp4C" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h3 id="understand-the-size-of-a-simulated-roman-coadd" class="relative group"><span class="heading-text">Understand the size of a simulated Roman coadd.</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#understand-the-size-of-a-simulated-roman-coadd" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><div id="dT71HVIlwr" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Number of pixels (Y, X)
coadd_roman[&#x27;data&#x27;].shape</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="8iCBqzvIy--4qDhuxRuN3" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>(2688, 2688)</span></code></div></div></div><div id="j4eV2ds9Dn" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Pixel size (scale Y, scale X) [degrees/pixel]
coadd_roman[&#x27;wcs&#x27;].proj_plane_pixel_scales()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="yrc50PFjKIcT9V_OoD9Hs" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>[&lt;Quantity 1.08506944e-05 deg&gt;, &lt;Quantity 1.08506944e-05 deg&gt;]</span></code></div></div></div><div id="O5Tol8JDxI" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Coadd size (FOV Y, FOV X)
[(num * size).to(&#x27;arcsec&#x27;) for num, size in zip(
    coadd_roman[&#x27;data&#x27;].shape, coadd_roman[&#x27;wcs&#x27;].proj_plane_pixel_scales())]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Mhm1DpdKDYAzCJMwIPzib" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>[&lt;Quantity 105. arcsec&gt;, &lt;Quantity 105. arcsec&gt;]</span></code></div></div></div><p>The field of view of Roman coadd is ~100 arcsec.</p><h3 id="use-the-wcs-from-the-roman-simulated-header-to-convert-the-specified-coordinate-into-a-pixel-position" class="relative group"><span class="heading-text">Use the WCS from the Roman simulated header to convert the specified coordinate into a pixel position.</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-the-wcs-from-the-roman-simulated-header-to-convert-the-specified-coordinate-into-a-pixel-position" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><div id="Hnmjv7uRWu" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def coord_to_xy(w, coord):
    return w.world_to_array_index(coord)[::-1] #reverse since 0th axis is y, 1st axis is x

coord_arr_idx = coord_to_xy(coadd_roman[&#x27;wcs&#x27;], coord)
coord_arr_idx</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="XdqUFaERcCI7TN7Q7v_oB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>(1513, 2049)</span></code></div></div></div><h3 id="use-matplotlib-imshow-to-create-a-static-visualization-of-the-roman-simulated-coadd-and-overplot-the-selected-position" class="relative group"><span class="heading-text">Use matplotlib imshow to create a static visualization of the Roman simulated coadd and overplot the selected position.</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-matplotlib-imshow-to-create-a-static-visualization-of-the-roman-simulated-coadd-and-overplot-the-selected-position" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><div id="V5XxbN1bOS" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def stretch_color(data, clipPercent):
    return np.percentile(data, (0 + clipPercent, 100 - clipPercent))

plt.imshow(coadd_roman[&#x27;data&#x27;], origin=&#x27;lower&#x27;, 
           clim=stretch_color(coadd_roman[&#x27;data&#x27;], 1)
           )

plt.plot(*coord_arr_idx, &#x27;r+&#x27;, markersize=15)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="P_Igr_mT1yaFV8b7LhvLT" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/build/c36058d0c4214f50395c6ec3c6fc51a0.png" alt="&lt;Figure size 640x480 with 1 Axes&gt;"/></div></div><h2 id="rubin-coadds" class="relative group"><span class="heading-text">Rubin Coadds</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#rubin-coadds" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The OpenUniverse2024 data preview includes coadded mosaics in the following filters: u, g, r, i, z, y. In this section, we define some functions that make it convenient to retrieve a given cloud-hosted simulated Roman coadd based on position and filter.</p><h3 id="retrieve-rubin-coadds" class="relative group"><span class="heading-text">Retrieve Rubin Coadds</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#retrieve-rubin-coadds" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The OpenUniverse2024 data preview includes only one simulated Rubin coadd per filter. Below we define functions that make it convenient to retrieve the simulated Rubin coadd corresponding to the desired filter. We return data in same structure as the functions we defined above for Roman.</p><div id="Ga4rQdoCn6" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def get_rubin_coadd_fpath(filter): 
    coadd_fname_root = f&quot;deepCoadd_calexp_2877_19_{filter}_DC2_u_descdm_preview_data_step3_2877_19_w_2024_12_20240403T150003Z.fits&quot;
    coadd_fpath = f&quot;{BUCKET_NAME}/{RUBIN_COADD_PATH}/{filter}/{coadd_fname_root}&quot;
    return coadd_fpath</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="KiijOirQ4-50wZRnkcDsP" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ZI4bnqtcik" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def get_rubin_coadd(filter):
    coadd_s3_fpath = get_rubin_coadd_fpath(filter)

    with fits.open(f&quot;s3://{coadd_s3_fpath}&quot;, fsspec_kwargs={&quot;anon&quot;: True}) as hdul:
        # retrieve science data from coadd fits
        coadd_data = hdul[1].section[:,:]

        # make wcs using header
        coadd_wcs = wcs.WCS(hdul[1].header)

        return {&#x27;data&#x27;: coadd_data, &#x27;wcs&#x27;: coadd_wcs}</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="JeaAGiUC65UYPaYJB6XU3" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h3 id="inspect-a-simulated-rubin-coadd" class="relative group"><span class="heading-text">Inspect a simulated Rubin Coadd</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#inspect-a-simulated-rubin-coadd" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Choose a filter and retrieve the data and header information from the simulated Rubin coadd corresponding to that filter.</p><div id="MNSdVFIt1X" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">filter_rubin = &#x27;r&#x27;
coadd_rubin = get_rubin_coadd(filter_rubin)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ZSO2WiiLhXI8m4Iqi-orU" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h3 id="understand-the-size-of-a-simulated-rubin-coadd" class="relative group"><span class="heading-text">Understand the size of a simulated Rubin coadd.</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#understand-the-size-of-a-simulated-rubin-coadd" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><div id="mRvki3zHzc" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Number of pixels (Y, X)
coadd_rubin[&#x27;data&#x27;].shape</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="hoqPCbqKPza6M3H2HoqWs" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>(4200, 4200)</span></code></div></div></div><div id="vzO15cs5Vo" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Pixel size (scale Y, scale X) [degrees/pixel]
coadd_rubin[&#x27;wcs&#x27;].proj_plane_pixel_scales()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="StuHfuRS3TmL4u7m3-R_5" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>[&lt;Quantity 5.55555556e-05 deg&gt;, &lt;Quantity 5.55555556e-05 deg&gt;]</span></code></div></div></div><div id="fIY0W93YyO" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Coadd size (FOV Y, FOV X)
[(num * size).to(&#x27;arcsec&#x27;) for num, size in zip(
    coadd_rubin[&#x27;data&#x27;].shape, coadd_rubin[&#x27;wcs&#x27;].proj_plane_pixel_scales())]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="7dxC80ILeeodNzmwkFOQ9" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>[&lt;Quantity 840. arcsec&gt;, &lt;Quantity 840. arcsec&gt;]</span></code></div></div></div><p>The field of view of Rubin coadd is 840 arcsec.</p><h3 id="use-matplotlib-imshow-to-create-a-static-visualization-of-the-rubin-simulated-coadd-and-overplot-the-selected-position" class="relative group"><span class="heading-text">Use matplotlib imshow to create a static visualization of the Rubin simulated coadd and overplot the selected position.</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-matplotlib-imshow-to-create-a-static-visualization-of-the-rubin-simulated-coadd-and-overplot-the-selected-position" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><div id="i95SQWFa60" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">plt.imshow(coadd_rubin[&#x27;data&#x27;], origin=&#x27;lower&#x27;, 
           clim=stretch_color(coadd_rubin[&#x27;data&#x27;], 1)
           )

plt.plot(*coord_to_xy(coadd_rubin[&#x27;wcs&#x27;], coord), &#x27;r+&#x27;, markersize=15)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="nCDw89ze6-QTU0TNlssSb" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/build/1e2cd8fa1cf9ff6e928fb283c980ac60.png" alt="&lt;Figure size 640x480 with 1 Axes&gt;"/></div></div><h3 id="define-a-function-that-returns-the-url-for-a-given-s3-filepath" class="relative group"><span class="heading-text">Define a function that returns the URL for a given S3 filepath</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#define-a-function-that-returns-the-url-for-a-given-s3-filepath" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Since the OpenUniverse2024 data is available through a public S3 bucket, we can access a given S3 file using HTTPS URL as follows:</p><div id="sNj7vSxx5P" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def https_url(s3_fpath):
    s3_fpath_without_bucket = s3_fpath.split(&#x27;/&#x27;, 1)[1]
    return f&quot;https://{BUCKET_NAME}.s3.amazonaws.com/{s3_fpath_without_bucket}&quot;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="nVJI2i9gpoAHyWj08AOd_" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Let’s generate URL for the Rubin coadd we plotted above. Clicking on the returned URL will allow you to download this image locally.</p><div id="DDQoEcfLDg" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">coadd_s3_fpath_rubin = get_rubin_coadd_fpath(filter_rubin)
https_url(coadd_s3_fpath_rubin)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Wq_E-l4aysux81IgaB5sY" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&#x27;https://nasa-irsa-simulations.s3.amazonaws.com/openuniverse2024/rubin/preview/u/descdm/preview_data_step3_2877_19_w_2024_12/20240403T150003Z/deepCoadd_calexp/2877/19/r/deepCoadd_calexp_2877_19_r_DC2_u_descdm_preview_data_step3_2877_19_w_2024_12_20240403T150003Z.fits&#x27;</span></code></div></div></div><h2 id="compare-simulated-roman-and-rubin-cutouts-for-a-selected-position" class="relative group"><span class="heading-text">Compare simulated Roman and Rubin cutouts for a selected position</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#compare-simulated-roman-and-rubin-cutouts-for-a-selected-position" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="choose-cutout-size" class="relative group"><span class="heading-text">Choose cutout size</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#choose-cutout-size" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><div id="BSrr3cjgME" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">cutout_size = 50*u.arcsec</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="CuZa0URelHl1yrldS-35A" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h3 id="create-the-cutouts" class="relative group"><span class="heading-text">Create the cutouts</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#create-the-cutouts" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><div id="ClbrPnUD1s" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">cutout_roman = Cutout2D(coadd_roman[&#x27;data&#x27;], coord, size=cutout_size, wcs=coadd_roman[&#x27;wcs&#x27;])
cutout_rubin = Cutout2D(coadd_rubin[&#x27;data&#x27;], coord, size=cutout_size, wcs=coadd_rubin[&#x27;wcs&#x27;])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="e-fFb1YS0mm3YQz8h7J6l" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h3 id="use-matplotlib-imshow-to-plot-static-side-by-side-comparisons-of-the-cutouts" class="relative group"><span class="heading-text">Use matplotlib imshow to plot static side-by-side comparisons of the cutouts</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-matplotlib-imshow-to-plot-static-side-by-side-comparisons-of-the-cutouts" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><div id="r2wJbnHFBV" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig, axs = plt.subplots(1, 2, figsize=(12, 6))


axs[0].imshow(cutout_roman.data, origin=&#x27;lower&#x27;, 
              clim=stretch_color(cutout_roman.data, .5)
              )
axs[0].plot(*coord_to_xy(cutout_roman.wcs, coord), &#x27;r+&#x27;, markersize=15)
axs[0].set_title(f&quot;ROMAN in filter {filter_roman}&quot;)

axs[1].imshow(cutout_rubin.data, origin=&#x27;lower&#x27;, 
              clim=stretch_color(cutout_rubin.data, .5)
              )
axs[1].plot(*coord_to_xy(cutout_rubin.wcs, coord), &#x27;r+&#x27;, markersize=15)
axs[1].set_title(f&quot;RUBIN in filter {filter_rubin}&quot;)

fig.suptitle(f&quot;Cutouts at ({coord.ra}, {coord.dec}) with {cutout_size} size&quot;, fontsize=14)
plt.tight_layout(rect=[0, 0, 1, 0.97])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ChIgHhWrSk9AXmepPmBUZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/build/3703381dc05d156f99882f3a65c78caa.png" alt="&lt;Figure size 1200x600 with 2 Axes&gt;"/></div></div><h2 id="use-firefly-to-interactively-identify-a-blended-source" class="relative group"><span class="heading-text">Use Firefly to interactively identify a blended source</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-firefly-to-interactively-identify-a-blended-source" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Clearly, the simulated Roman coadd has higher spatial resolution than the Rubin simulated coadd. Let’s try to locate blended objects to compare in the simulated Rubin and Roman images. We will use Firefly’s interactive visualization to make this task easier.</p><h3 id="launch-and-initialize-firefly" class="relative group"><span class="heading-text">Launch and initialize Firefly</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#launch-and-initialize-firefly" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>There are two ways to initialize a Firefly client from Python, depending on whether you’re running the notebook in JupyterLab or not. Assuming you have <code>jupyter-firefly-extensions</code> set up in your environment as explained <a href="https://github.com/Caltech-IPAC/jupyter_firefly_extensions/blob/master/README.md" class="italic" target="_blank" rel="noreferrer" data-state="closed">here</a>, you can use <code>make_lab_client()</code> in JupyterLab, which will open the Firefly viewer in a new tab within the Lab. Otherwise, you can use <code>make_client()</code> in a Jupyter Notebook (or even a Python shell), which will open the Firefly viewer in a new web browser tab.</p><p>You also need a Firefly server to communicate with your Firefly Python client. In this notebook, we use a public Firefly server: the IRSA Viewer (<a target="_blank" rel="noreferrer" href="https://irsa.ipac.caltech.edu/irsaviewer" class="">https://<wbr/>irsa<wbr/>.ipac<wbr/>.caltech<wbr/>.edu<wbr/>/irsaviewer</a>). However, you can also run a local Firefly server via a <a target="_blank" rel="noreferrer" href="https://hub.docker.com/r/ipac/firefly" class="">Firefly Docker image</a> and access it at <code>http://localhost:8080/firefly</code>. The URL of the Firefly server is read by both <code>make_client()</code> and <code>make_lab_client()</code> through the environment variable <code>FIREFLY_URL</code>. However, <code>make_client()</code> also allows you to pass the URL directly as the <code>url</code> parameter.</p><div id="GJtzDwVVah" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Uncomment when using within Jupyter Lab with jupyter_firefly_extensions installed
# fc = FireflyClient.make_lab_client()

# Uncomment for contexts other than above 
fc = FireflyClient.make_client(url=&quot;https://irsa.ipac.caltech.edu/irsaviewer&quot;)

fc.reinit_viewer() # to clean the state, if this cell ran earlier</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_2JNMq6C2JfTIXpCgc0KD" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><h3 id="send-the-simulated-rubin-coadd-to-firefly-using-show-fits" class="relative group"><span class="heading-text">Send the simulated Rubin coadd to Firefly using show_fits.</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#send-the-simulated-rubin-coadd-to-firefly-using-show-fits" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>For displaying the FITS image of Rubin coadd in Firefly, we use <a target="_blank" rel="noreferrer" href="https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.show_fits" class=""><code>show_fits</code></a>:</p><div id="IVhKUeaQS6" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">coadd_ff_id_rubin = &#x27;rubin-coadd-filter-r&#x27;
fc.show_fits(url=https_url(coadd_s3_fpath_rubin),
             plot_id=coadd_ff_id_rubin,
             Title=&quot;Rubin Coadd&quot;
             )</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="tLvIZx4xwLkD2aqOoK8wa" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>WARNING: show_fits() is deprecated. Use show_fits_image() instead.
WARNING: url is deprecated, use file_input parameter instead
</span></code></pre></div><div class="font-mono text-sm whitespace-pre-wrap"><code><span>{&#x27;success&#x27;: True}</span></code></div></div></div><h3 id="use-ds9-region-syntax-to-overplot-the-simulated-roman-image-blocks-on-the-interactive-display" class="relative group"><span class="heading-text">Use ds9 region syntax to overplot the simulated Roman image blocks on the interactive display</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-ds9-region-syntax-to-overplot-the-simulated-roman-image-blocks-on-the-interactive-display" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The Firefly client includes several methods related to controlling ds9 region overlays. To
overlay a region layer on the loaded FITS images, we can use <a target="_blank" rel="noreferrer" href="https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.overlay_region_layer" class=""><code>overlay_region_layer</code></a>.</p><p>Region data is defined in ds9 region syntax that can be found <a target="_blank" rel="noreferrer" href="https://ds9.si.edu/doc/ref/region.html" class="">here</a>.</p><div id="Z0eeDBkCh4" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># mark the roman coadd blocks as boxes
roman_regions = [
    f&#x27;icrs;box {ra_block_center.value}d {dec_block_center.value}d {block_size.value}&quot; {block_size.value}&quot; 0d&#x27;
    for (ra_block_center, dec_block_center) in product(ra_block_centers, dec_block_centers)
]

roman_regions_id = &#x27;roman_regions&#x27;
fc.overlay_region_layer(region_data=roman_regions,
                        title=&#x27;Roman Mosiac&#x27;, 
                        region_layer_id=roman_regions_id)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="k4yDKbS8l_XNueeGehGej" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>{&#x27;success&#x27;: True}</span></code></div></div></div><h3 id="use-fireflys-pan-and-zoom-capabilities-to-locate-a-region-of-interest-a-blended-source" class="relative group"><span class="heading-text">Use Firefly’s pan and zoom capabilities to locate a region of interest (a blended source)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-fireflys-pan-and-zoom-capabilities-to-locate-a-region-of-interest-a-blended-source" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>You can view the coordinates of your mouse pointer at the bottom left of the display window. To copy the coordinates for a specific coordinate:</p><ul><li>Toggle the “Click Lock” to “on” in the bottom right of the image display.</li><li>Click on the position of interest, and notice that the coordinate display is now frozen.</li><li>Click on “EQ-J2000”, the coordinate label in the bottom left of the image display. In the dialog that opens, change copy options to “[Python] Astropy SkyCoord” so that we can directly work with them in python.</li><li>Close the dialog and click on the copy icon next to the coordinate values display.</li></ul><h3 id="copy-the-coordinates-from-the-coordinate-display-to-the-python-notebook" class="relative group"><span class="heading-text">Copy the coordinates from the coordinate display to the Python notebook</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#copy-the-coordinates-from-the-coordinate-display-to-the-python-notebook" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>We have provided an example. You can change this based on your interests.</p><div id="qmiP1UvbHu" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">coords_of_interest = SkyCoord(&#x27;0h38m25.35s -44d00m10.1s&#x27;, frame=&#x27;icrs&#x27;) # located and copied through UI
coords_of_interest</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="WUxjaQz9I-aM3D4_UuJti" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;SkyCoord (ICRS): (ra, dec) in deg
    (9.605625, -44.00280556)&gt;</span></code></div></div></div><p>We can now use this <a target="_blank" rel="noreferrer" href="https://docs.astropy.org/en/stable/api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" class="">astropy <code>SkyCoord</code> object</a> to compare our coadds.</p><h3 id="use-ds9-region-syntax-to-overplot-the-selected-position" class="relative group"><span class="heading-text">Use ds9 region syntax to overplot the selected position</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-ds9-region-syntax-to-overplot-the-selected-position" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>For this we use the id of the region layer we defined above, and add more region data using <a target="_blank" rel="noreferrer" href="https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.add_region_data" class=""><code>add_region_data</code></a>.</p><div id="gGf0EWdnRY" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">point_region = f&#x27;icrs;point {coords_of_interest.ra.value}d {coords_of_interest.dec.value}d # point=cross 15 text={{Blended source}}&#x27;
fc.add_region_data(region_data=point_region, region_layer_id=roman_regions_id)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="0cyKppvnfTFy78cDSqGN5" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>{&#x27;success&#x27;: True}</span></code></div></div></div><h2 id="plot-cutouts-of-the-identified-blended-source" class="relative group"><span class="heading-text">Plot cutouts of the identified blended source</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#plot-cutouts-of-the-identified-blended-source" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><div id="nJHXgMPEDI" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">coadd_roman = get_roman_coadd(coords_of_interest, filter_roman)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="r5hkMRgPZJl29SHfE96Fr" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="qtdRvskEWC" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">cutout_size = 20*u.arcsec</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="8UVz_B5lzlOlDHlZrk4uj" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="RFwQMbF5Jl" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">cutout_roman = Cutout2D(coadd_roman[&#x27;data&#x27;], coords_of_interest, size=cutout_size, wcs=coadd_roman[&#x27;wcs&#x27;])
cutout_rubin = Cutout2D(coadd_rubin[&#x27;data&#x27;], coords_of_interest, size=cutout_size, wcs=coadd_rubin[&#x27;wcs&#x27;])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="JFQXsMQ13wcKOs5cOraBX" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="smXRA20Em2" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig, axs = plt.subplots(1, 2, figsize=(12, 6))

axs[0].imshow(cutout_roman.data, origin=&#x27;lower&#x27;, 
              clim=stretch_color(cutout_roman.data, .5)
              )
axs[0].set_title(f&quot;ROMAN in filter {filter_roman}&quot;)

# Let&#x27;s also encircle the blended source we identified 
axs[0].add_patch(patches.Circle(coord_to_xy(cutout_roman.wcs, coords_of_interest), 
                                radius=50, color=&#x27;r&#x27;, fill=False, linewidth=2))
# and a bonus blended source that is close to it
other_coords = SkyCoord(coords_of_interest.ra-9.2*u.arcsec, coords_of_interest.dec+5*u.arcsec)
axs[0].add_patch(patches.Circle(coord_to_xy(cutout_roman.wcs, other_coords),
                                radius=36, color=&#x27;cyan&#x27;, fill=False, linewidth=2))


axs[1].imshow(cutout_rubin.data, origin=&#x27;lower&#x27;, 
              clim=stretch_color(cutout_rubin.data, .5)
              )
axs[1].set_title(f&quot;RUBIN in filter {filter_rubin}&quot;)

# Let&#x27;s also encircle the source we identified 
axs[1].add_patch(patches.Circle(coord_to_xy(cutout_rubin.wcs, coords_of_interest),
                                radius=10, color=&#x27;r&#x27;, fill=False, linewidth=2))
axs[1].add_patch(patches.Circle(coord_to_xy(cutout_rubin.wcs, other_coords),
                                radius=8, color=&#x27;cyan&#x27;, fill=False, linewidth=2))


fig.suptitle(f&quot;Cutouts at ({coords_of_interest.ra:6f}, {coords_of_interest.dec:6f}) with {cutout_size} size&quot;, fontsize=14);
plt.tight_layout(rect=[0, 0, 1, 0.97])
# plt.savefig(&quot;plot.pdf&quot;, bbox_inches=&#x27;tight&#x27;, pad_inches=0.2)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="PN6Jcyt7U51-Pn3y01r2f" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/build/a0ca8138ab696115e58c40dae5cc254e.png" alt="&lt;Figure size 1200x600 with 2 Axes&gt;"/></div></div><h2 id="use-firefly-to-visualize-the-openuniverse2024-data-preview-catalogs" class="relative group"><span class="heading-text">Use Firefly to visualize the OpenUniverse2024 data preview catalogs</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-firefly-to-visualize-the-openuniverse2024-data-preview-catalogs" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Let’s inspect the properties of sources in the Rubin coadd image. For this we will use the input truth files present in S3 bucket.</p><p>The OpenUniverse2024 data preview includes the input truth files that were used to create the simulated images. These files are in Parquet and HDF5 format, and include information about the properties of galaxies, stars, and transients.</p><p>To list the available files, we use <a target="_blank" rel="noreferrer" href="https://s3fs.readthedocs.io/en/latest/index.html" class="">s3fs</a>. We open a file-system like connection
to AWS S3 and then simply list (<code>ls</code>) truth files directory:</p><div id="lVkTdKfkkM" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">s3 = s3fs.S3FileSystem(anon=True) # to browse s3 bucket
s3.ls(f&quot;{BUCKET_NAME}/{TRUTH_FILES_PATH}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="k1Rgj1iyj_qDlrvxxIDea" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>[&#x27;nasa-irsa-simulations/openuniverse2024/roman/preview/roman_rubin_cats_v1.1.2_faint/galaxy_10307.parquet&#x27;,
 &#x27;nasa-irsa-simulations/openuniverse2024/roman/preview/roman_rubin_cats_v1.1.2_faint/galaxy_flux_10307.parquet&#x27;,
 &#x27;nasa-irsa-simulations/openuniverse2024/roman/preview/roman_rubin_cats_v1.1.2_faint/galaxy_sed_10307.hdf5&#x27;,
 &#x27;nasa-irsa-simulations/openuniverse2024/roman/preview/roman_rubin_cats_v1.1.2_faint/pointsource_10307.parquet&#x27;,
 &#x27;nasa-irsa-simulations/openuniverse2024/roman/preview/roman_rubin_cats_v1.1.2_faint/pointsource_flux_10307.parquet&#x27;,
 &#x27;nasa-irsa-simulations/openuniverse2024/roman/preview/roman_rubin_cats_v1.1.2_faint/snana_10307.hdf5&#x27;,
 &#x27;nasa-irsa-simulations/openuniverse2024/roman/preview/roman_rubin_cats_v1.1.2_faint/snana_10307.parquet&#x27;]</span></code></div></div></div><div id="YOiBvVZ0ed" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Catalog table of star properties (in parquet format)
pointsource_cat_path = f&quot;{BUCKET_NAME}/{TRUTH_FILES_PATH}/pointsource_10307.parquet&quot;
pointsource_cat_path</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="947yEByRvfObAlJVmourJ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&#x27;nasa-irsa-simulations/openuniverse2024/roman/preview/roman_rubin_cats_v1.1.2_faint/pointsource_10307.parquet&#x27;</span></code></div></div></div><div id="UrGwsVX3wQ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Catalog table of galaxy properties (in parquet format)
galaxy_cat_path = f&quot;{BUCKET_NAME}/{TRUTH_FILES_PATH}/galaxy_10307.parquet&quot;
galaxy_cat_path</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Gqgg-J9FvP91YtaIzoPrG" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&#x27;nasa-irsa-simulations/openuniverse2024/roman/preview/roman_rubin_cats_v1.1.2_faint/galaxy_10307.parquet&#x27;</span></code></div></div></div><h3 id="use-fireflys-show-table-to-overlay-the-catalogs-on-interactive-image-of-coadd" class="relative group"><span class="heading-text">Use Firefly’s show_table to overlay the catalogs on interactive image of coadd</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-fireflys-show-table-to-overlay-the-catalogs-on-interactive-image-of-coadd" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The input truth files cover a region much larger than the data preview, so we define filters on table to constraint the sources in catalog within the ra and dec bounds of preview data. (Note: you can remove filters through the table UI if you wish to see the entire data)</p><p>You can visualize catalogs interactively with Firefly using <a target="_blank" rel="noreferrer" href="https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.show_table" class=""><code>show_table</code></a>. This capability can take many parameters. Here we will simply send our catalog to Firefly so that we can (a) see an interactive table; (b) see this table plotted over the image that we’ve already sent; and (c) use the GUI to quickly create exploratory plots. See if you can use the GUI to quickly determine approximately how many galaxies cover the Rubin image and what the redshift distribution of these galaxies is.</p><div id="jDncKXhZco" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">cat_filters = [
    f&#x27;(&quot;ra&quot; &gt;= {ra_block_centers.min().value} AND &quot;ra&quot; &lt;= {ra_block_centers.max().value})&#x27;, 
    f&#x27;(&quot;dec&quot; &gt;= {dec_block_centers.min().value} AND &quot;dec&quot; &lt;= {dec_block_centers.max().value})&#x27;
]
cat_filters</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="W8iHzdu6THZ7FZg9m7FxL" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>[&#x27;(&quot;ra&quot; &gt;= 9.336711625789874 AND &quot;ra&quot; &lt;= 9.76330352298415)&#x27;,
 &#x27;(&quot;dec&quot; &gt;= -44.252584927082495 AND &quot;dec&quot; &lt;= -43.94703111591591)&#x27;]</span></code></div></div></div><div id="jak7LoXqNS" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fc.show_table(url=https_url(pointsource_cat_path),
              title=&#x27;Stars Catalog&#x27;,
              tbl_id=&#x27;stars_cat&#x27;,
              filters=&quot; AND &quot;.join(cat_filters))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="jnDTZ8342ZC6rZI_n-nza" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>WARNING: url is deprecated, use file_input parameter instead
</span></code></pre></div><div class="font-mono text-sm whitespace-pre-wrap"><code><span>{&#x27;success&#x27;: True}</span></code></div></div></div><div id="MCgB8XlV1N" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">gal_cat_tbl_id = &#x27;galaxy_cat&#x27;

# may take ~1.25min, because galaxy catalog is a big file
fc.show_table(url=https_url(galaxy_cat_path),
              title=&#x27;Galaxy Catalog&#x27;,
              tbl_id=gal_cat_tbl_id,
              filters=&quot; AND &quot;.join(cat_filters))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="GXsvgnIXrgiC7wu6UeeRb" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>WARNING: url is deprecated, use file_input parameter instead
</span></code></pre></div><div class="font-mono text-sm whitespace-pre-wrap"><code><span>{&#x27;success&#x27;: True}</span></code></div></div></div><p>For each row in the table you can notice a marker in the image. Selecting a row or marker changes the corresponding marker or row, respectively. You can click on “Details” tab in the UI to show properties of each source selected in image/table.</p><h3 id="use-fireflys-apply-table-filters-to-show-only-high-redshift-galaxies" class="relative group"><span class="heading-text">Use Firefly’s apply_table_filters to show only high-redshift galaxies</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-fireflys-apply-table-filters-to-show-only-high-redshift-galaxies" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>High redshift galaxies are the most interesting, so let’s filter the table we sent to Firefly to only include z&gt;3 galaxies. Notice how the table display and image overlay change. Notice how the chart becomes a scatterplot from a heatmap because the sources reduce. You can remove this filter or add new ones through the GUI.</p><p>For filtering, we will use <a target="_blank" rel="noreferrer" href="https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.apply_table_filters" class=""><code>apply_table_filters</code></a> method on the galaxy table we loaded above.</p><div id="zhxVybOwYe" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fc.apply_table_filters(tbl_id=gal_cat_tbl_id,
                       filters=&quot; AND &quot;.join(cat_filters+[&#x27;&quot;redshift&quot; &gt; 3&#x27;]))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="096cI-xBwiTwzn0BoEJw0" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>{&#x27;success&#x27;: True}</span></code></div></div></div><p>You can play with the filters directly from the UI as well. Try removing adding more filters in the tables and see how markers change.</p><h3 id="use-fireflys-show-fits-3color-to-create-a-3-color-image-of-the-simulated-rubin-images" class="relative group"><span class="heading-text">Use Firefly’s show_fits_3color to create a 3 color image of the simulated Rubin images</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-fireflys-show-fits-3color-to-create-a-3-color-image-of-the-simulated-rubin-images" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><div id="c9FFJ0fFsS" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># [R, G, B]
ROMAN_RGB_FILTERS = [&#x27;H158&#x27;, &#x27;J129&#x27;, &#x27;Y106&#x27;]
RUBIN_RGB_FILTERS = [&#x27;r&#x27;, &#x27;g&#x27;, &#x27;u&#x27;]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="t35IgfUwD35kq50i9l_o6" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>We already have Rubin coadd with catalog overlaid, let’s make a 3 color image to see colors of marked objects more clearly. For this we will use <a target="_blank" rel="noreferrer" href="https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.show_fits_3color" class=""><code>show_fits_3color</code></a> method:</p><div id="dsZuVfvrBn" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">coadd_ff_id_rubin_3color = &#x27;rubin-coadd-3color&#x27;
threeC = [
    dict(url=https_url(get_rubin_coadd_fpath(filter_name)),
         Title=&quot;Rubin Coadd 3 color&quot;)
    for filter_name in RUBIN_RGB_FILTERS
]

fc.show_fits_3color(three_color_params=threeC,
                    plot_id=coadd_ff_id_rubin_3color)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="9gEmJOZmRlmz6dyMaLgGG" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>{&#x27;success&#x27;: True}</span></code></div></div></div><h3 id="use-fireflys-interactivity-to-identify-a-region-of-interest" class="relative group"><span class="heading-text">Use Firefly’s interactivity to identify a region of interest</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-fireflys-interactivity-to-identify-a-region-of-interest" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>For example, we found a region of the sky that seems to have a high number of high redshift sources and we copy it from the image display:</p><div id="v7d8fDlMD8" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># located and copied through UI
high_z_gal_coords = SkyCoord(&#x27;0h38m00.77s -44d12m10.2s&#x27;, frame=&#x27;icrs&#x27;)
high_z_gal_coords</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="3rL7Rbgc98of2kDak-Fve" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;SkyCoord (ICRS): (ra, dec) in deg
    (9.50320833, -44.20283333)&gt;</span></code></div></div></div><div id="gEjnwa7F3P" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># let&#x27;s also mark it in our region layer, so that it&#x27;s easy to pinpoint later
point_region = f&#x27;icrs;point {high_z_gal_coords.ra.value}d {high_z_gal_coords.dec.value}d # point=cross 15 text={{z&gt;3 mock galaxies}}&#x27;
fc.add_region_data(region_data=point_region, region_layer_id=roman_regions_id)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="-9kbFPZZXBkRLg4uxavzF" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>{&#x27;success&#x27;: True}</span></code></div></div></div><h2 id="plot-3-color-roman-coadd-containing-your-region-of-interest" class="relative group"><span class="heading-text">Plot 3-color Roman coadd containing your region of interest</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#plot-3-color-roman-coadd-containing-your-region-of-interest" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Let’s inspect WCS of Roman coadd first</p><div id="xfZSOgKbzx" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">coadd_roman[&#x27;wcs&#x27;]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="T6jPjXmFnDZr0kuEpuWKB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>WCS Keywords

Number of WCS axes: 2
CTYPE : &#x27;RA---STG&#x27; &#x27;DEC--STG&#x27; 
CRVAL : 9.55 -44.1 
CRPIX : 5184.5 -7615.5 
PC1_1 PC1_2  : 1.0 0.0 
PC2_1 PC2_2  : 0.0 1.0 
CDELT : -1.0850694444444e-05 1.0850694444444e-05 
NAXIS : 2688  2688  15  1</span></code></div></div></div><h3 id="prepare-roman-coadds-for-displaying-in-firefly" class="relative group"><span class="heading-text">Prepare Roman coadds for displaying in Firefly</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#prepare-roman-coadds-for-displaying-in-firefly" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Roman coadds have STG projection which cannot be read by Firefly yet. Firefly can display any FITS image but it needs to read the WCS for overlaying catalogs and other interactive features. So unlike Rubin 3 color image where we directly passed URL of coadd files to Firefly, we will read Roman coadd files in Python, reproject them from STG to TAN, and write them back to FITS to pass them to Firefly.</p><p>Let’s first define functions to do so:</p><div id="uM9eoJAXYc" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def reproject_to_TAN(coadd_roman):
    # Define a new WCS with TAN projection (in CTYPE key)
    output_wcs = coadd_roman[&#x27;wcs&#x27;].deepcopy()
    output_wcs.wcs.ctype = [ctype.replace(&#x27;STG&#x27;, &#x27;TAN&#x27;) for ctype in coadd_roman[&#x27;wcs&#x27;].wcs.ctype]
    
    # Use reproject to convert a given data and wcs, to a desired wcs and shape
    reprojected_data, _ = reproject_interp(
        (coadd_roman[&#x27;data&#x27;], coadd_roman[&#x27;wcs&#x27;]),
        output_projection=output_wcs,
        shape_out=coadd_roman[&#x27;data&#x27;].shape
    )

    return {&#x27;data&#x27;: reprojected_data, &#x27;wcs&#x27;: output_wcs}</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="jimiaZ2cjE0cDm1jKhJdu" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="LihO7o87vl" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def get_fits_stream(coadd_roman):
    # Create a FITS PrimaryHDU object with the coadd data
    hdu = fits.PrimaryHDU(data=coadd_roman[&#x27;data&#x27;], header=coadd_roman[&#x27;wcs&#x27;].to_header())

    # Write the HDU to the in-memory stream (to save I/O time)
    fits_stream = BytesIO()
    hdu.writeto(fits_stream, overwrite=True)
    fits_stream.seek(0) # to bring reading pointer to the beginning of file

    return fits_stream</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="VIj8BEjJalz9BhwXJpZKn" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Then we perform all 3 operations we mentioned above for the RGB filters of Roman:</p><div id="DLhoPLuuxf" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">coadds_rgb = []
coadds_rgb_reprojected = []
coadds_rgb_fits_stream = []

for filter_name in ROMAN_RGB_FILTERS:
    print(f&#x27;\nFILTER: {filter_name}&#x27;)
    print(&#x27;Retrieving Roman coadd...&#x27;)
    coadd_roman = get_roman_coadd(high_z_gal_coords, filter_name)
    coadds_rgb.append(coadd_roman)

    print(&#x27;Reprojecting to TAN...&#x27;)
    coadd_roman_reprojected = reproject_to_TAN(coadd_roman)
    coadds_rgb_reprojected.append(coadd_roman_reprojected)

    print(&#x27;Writing back to fits stream...&#x27;)
    coadd_roman_fits_stream = get_fits_stream(coadd_roman_reprojected)
    coadds_rgb_fits_stream.append(coadd_roman_fits_stream)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="p4nL1vomGakNRE-VIaDiy" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>
FILTER: H158
Retrieving Roman coadd...
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Reprojecting to TAN...
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Writing back to fits stream...

FILTER: J129
Retrieving Roman coadd...
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Reprojecting to TAN...
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Writing back to fits stream...

FILTER: Y106
Retrieving Roman coadd...
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Reprojecting to TAN...
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Writing back to fits stream...
</span></code></pre></div></div></div><h3 id="use-fireflys-show-fits-3color-to-create-a-3-color-image-of-roman-coadds" class="relative group"><span class="heading-text">Use Firefly’s show_fits_3color to create a 3 color image of Roman coadds</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-fireflys-show-fits-3color-to-create-a-3-color-image-of-roman-coadds" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Now we upload each fits stream (in-memory fits file) to firefly using <a target="_blank" rel="noreferrer" href="https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.upload_fits_data" class=""><code>upload_fits_data()</code></a> and prepare color params to pass to the <a target="_blank" rel="noreferrer" href="https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.show_fits_3color" class=""><code>show_fits_3color()</code></a>.</p><div id="Klrz13WXT3" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">three_color_params = [
    {
        &#x27;file&#x27;: fc.upload_fits_data(fits_stream),
        &#x27;Title&#x27;: &quot;Roman Coadd 3 color&quot;
    } for fits_stream in coadds_rgb_fits_stream]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="gXc49XOAFFm0vTyfG54Mv" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="qspsFGcp5G" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">coadd_ff_id_roman_3color = &#x27;roman-coadd-3color-high_z_gal&#x27;
fc.show_fits_3color(three_color_params=three_color_params,
                    plot_id=coadd_ff_id_roman_3color)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="6-UON8_vpof7DqJSoqlJF" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>{&#x27;success&#x27;: True}</span></code></div></div></div><p>We can see 3 color image of Roman coadd containing the high-redshift galaxy sources. Try panning and zomming out, you can notice it spans over one block compared to the Rubin coadd which is much larger.</p><h3 id="use-fireflys-pan-zoom-align-methods-to-locate-high-redshift-sources" class="relative group"><span class="heading-text">Use Firefly’s pan/zoom/align methods to locate high redshift sources</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-fireflys-pan-zoom-align-methods-to-locate-high-redshift-sources" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Now, let’s pan &amp; zoom to the region where we located high-redshift galaxy sources. Also align &amp; lock all images being displayed by WCS. For these operations we use these 3 methods (click on them to see their documentation):</p><ul><li><a target="_blank" rel="noreferrer" href="https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.set_pan" class=""><code>set_pan</code></a></li><li><a target="_blank" rel="noreferrer" href="https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.set_zoom" class=""><code>set_zoom</code></a></li><li><a target="_blank" rel="noreferrer" href="https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.align_images" class=""><code>align_images</code></a></li></ul><div id="f61xkblzll" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fc.set_pan(plot_id=coadd_ff_id_roman_3color, x=high_z_gal_coords.ra.deg, y=high_z_gal_coords.dec.deg, coord=&#x27;j2000&#x27;)
fc.set_zoom(plot_id=coadd_ff_id_roman_3color, factor=1)
fc.align_images(lock_match=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Yt-1smOZSEhnswnHfF3p6" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>{&#x27;success&#x27;: True}</span></code></div></div></div><h3 id="use-fireflys-set-stretch-method-to-change-the-stretch-of-the-image-display-via-python" class="relative group"><span class="heading-text">Use Firefly’s set_stretch method to change the stretch of the image display via Python</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-fireflys-set-stretch-method-to-change-the-stretch-of-the-image-display-via-python" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The image has a lot of noise that obscures our high redshift sources of interest. You can use the Firefly GUI to change the stretch of the image display. We identify that squared stretch from -2 to 10 sigma highlights the colors of our sources better. You can also use the Firefly client’s <a target="_blank" rel="noreferrer" href="https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.set_stretch" class=""><code>set_stretch</code></a> to do this via Python. This is helpful for reproducibility and for scaling up to many images.</p><div id="ilvHOnFycq" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fc.set_stretch(plot_id=coadd_ff_id_roman_3color, stype=&#x27;sigma&#x27;, algorithm=&#x27;squared&#x27;, 
               band=&#x27;ALL&#x27;, lower_value=-2, upper_value=10)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="MejDD_Dy8LVvCjFyOaRx8" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>{&#x27;success&#x27;: True,
 &#x27;rv_string&#x27;: &#x27;92,-2.000000,92,10.000000,NaN,2.000000,48,25,600,120,0,NaN,1.000000&#x27;}</span></code></div></div></div><hr class="py-2 my-5 translate-y-2"/><h2 id="about-this-notebook" class="relative group"><span class="heading-text">About This Notebook</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#about-this-notebook" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p><strong>Author:</strong> Jaladh Singhal and Vandana Desai in conjunction with the IRSA Team</p><p><strong>Updated:</strong> 2024-12-19</p><p><strong>Contact:</strong> <a target="_blank" rel="noreferrer" href="https://irsa.ipac.caltech.edu/docs/help_desk.html" class="">the IRSA Helpdesk</a> with questions or reporting problems.</p><div></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/openuniverse2024-roman-simulated-wideareasurvey"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">OpenUniverse 2024</div>Analyzing cloud-hosted simulated Roman coadded images</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/openuniverse2024-roman-simulated-timedomainsurvey"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">OpenUniverse 2024</div>Analyzing cloud-hosted simulated Roman Time Domain Survey images</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></main></article><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/build/_shared/chunk-JSE36H2O.js"/><link rel="modulepreload" href="/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/build/_shared/chunk-C7FW3E47.js"/><link rel="modulepreload" href="/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/build/_shared/chunk-ND43KHSX.js"/><link rel="modulepreload" href="/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/build/root-IB5726YR.js"/><link rel="modulepreload" href="/build/_shared/chunk-NBON2RSI.js"/><link rel="modulepreload" href="/build/routes/$-LXLHKVOR.js"/><script>window.__remixContext = {"url":"/openuniverse2024preview-firefly","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.0","options":{"outline_maxdepth":1,"favicon":"/build/irsa-favicon-4c188aed8af3c18f387141296cb0249a.ico","logo":"/build/irsa_logo-2376335cd55626fdfef6fc361185182d.png"},"nav":[],"actions":[],"projects":[{"subject":"IRSA Tutorials","settings":{"output_matplotlib_strings":"remove"},"title":"IRSA Tutorials","description":"IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)","authors":[{"id":"IRSA Scientists and Developers","name":"IRSA Scientists and Developers"}],"github":"https://github.com/Caltech-IPAC/irsa-tutorials/","keywords":["astronomy"],"toc":[{"file":"index.md","title":"IRSA Tutorials"},{"children":[{"file":"tutorials/spherex/spherex_intro.md"}],"title":"SPHEREx"},{"children":[{"children":[{"file":"tutorials/euclid_access/Euclid_ERO.md"}],"title":"Euclid Early Release Observations"},{"children":[{"file":"tutorials/euclid_access/1_Euclid_intro_MER_images.md"},{"file":"tutorials/euclid_access/2_Euclid_intro_MER_catalog.md"},{"file":"tutorials/euclid_access/3_Euclid_intro_1D_spectra.md"},{"file":"tutorials/euclid_access/4_Euclid_intro_PHZ_catalog.md"},{"file":"tutorials/euclid_access/5_Euclid_intro_SPE_catalog.md"},{"file":"tutorials/cloud_access/euclid-cloud-access.md"}],"title":"Euclid Quick Release 1"}],"title":"Euclid"},{"children":[{"children":[{"file":"tutorials/irsa-sia-examples/sia_allwise_atlas.md"},{"file":"tutorials/parquet-catalog-demos/wise-allwise-catalog-demo.md"}],"title":"AllWISE"},{"children":[{"file":"tutorials/firefly/NEOWISE_light_curve_demo.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-strategies.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-lightcurves.md"}],"title":"NEOWISE"}],"title":"WISE"},{"children":[{"file":"tutorials/irsa-sia-examples/siav2_seip.md"}],"title":"Spitzer"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_2mass_allsky.md"}],"title":"2MASS"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_cosmos.md"}],"title":"COSMOS"},{"children":[{"children":[{"file":"tutorials/roman_simulations/roman_hlss_number_density.md"}],"title":"Roman HLSS Galaxy Mock Catalog"},{"children":[{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_wideareasurvey.md"},{"file":"tutorials/firefly/OpenUniverse2024Preview_Firefly.md"},{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_timedomainsurvey.md"}],"title":"OpenUniverse 2024"},{"children":[{"file":"tutorials/cosmodc2/cosmoDC2_TAP_access.md"}],"title":"CosmoDC2"}],"title":"Simulated Data"},{"children":[{"file":"tutorials/cloud_access/cloud-access-intro.md"},{"file":"tutorials/firefly/SEDs_in_Firefly.md"},{"file":"tutorials/parallelize/Parallelize_Convolution.md"}],"title":"Special Topics"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"SPHEREx"},{"slug":"spherex-intro","title":"Introduction to SPHEREx Spectral Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Euclid"},{"level":2,"title":"Euclid Early Release Observations"},{"slug":"euclid-ero","title":"Exploring Star Clusters in the Euclid ERO Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Euclid Quick Release 1"},{"slug":"euclid-intro-mer-images","title":"Euclid Q1: MER mosaics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-mer-catalog","title":"Euclid Q1: MER catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-1d-spectra","title":"Euclid Q1: 1D spectra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-phz-catalog","title":"Euclid Q1: PHZ catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-spe-catalog","title":"Euclid Q1: SPE catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-cloud-access","title":"Euclid Q1: cloud access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"WISE"},{"level":2,"title":"AllWISE"},{"slug":"sia-allwise-atlas","title":"Searching for AllWISE Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"wise-allwise-catalog-demo","title":"Analyzing cloud-hosted AllWISE Source Catalog in Parquet format","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"NEOWISE"},{"slug":"neowise-light-curve-demo","title":"Using Firefly visualization tools to understand the light curves of Solar System objects","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-strategies","title":"Strategies to Efficiently Work with NEOWISE Single-exposure Source Table in Parquet","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-lightcurves","title":"Make Light Curves from NEOWISE Single-exposure Source Table","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Spitzer"},{"slug":"siav2-seip","title":"Searching for Spitzer Enhanced Imaging Products","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"2MASS"},{"slug":"sia-2mass-allsky","title":"Searching for 2MASS All-Sky Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"COSMOS"},{"slug":"sia-cosmos","title":"Searching for contributed COSMOS images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Simulated Data"},{"level":2,"title":"Roman HLSS Galaxy Mock Catalog"},{"slug":"roman-hlss-number-density","title":"Number Density as a Function of Redshift","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"OpenUniverse 2024"},{"slug":"openuniverse2024-roman-simulated-wideareasurvey","title":"Analyzing cloud-hosted simulated Roman coadded images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024preview-firefly","title":"Using Firefly to Explore OpenUniverse2024 Data Preview Simulated Roman and Rubin Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024-roman-simulated-timedomainsurvey","title":"Analyzing cloud-hosted simulated Roman Time Domain Survey images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"CosmoDC2"},{"slug":"cosmodc2-tap-access","title":"Querying CosmoDC2 Mock v1 catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Special Topics"},{"slug":"cloud-access-intro","title":"IRSA cloud access introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"seds-in-firefly","title":"Using Firefly visualization tools in Python to vet SEDs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"parallelize-convolution","title":"Parallelizing image convolution","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static"},"routes/$":{"config":{"version":2,"myst":"1.6.0","options":{"outline_maxdepth":1,"favicon":"/build/irsa-favicon-4c188aed8af3c18f387141296cb0249a.ico","logo":"/build/irsa_logo-2376335cd55626fdfef6fc361185182d.png"},"nav":[],"actions":[],"projects":[{"subject":"IRSA Tutorials","settings":{"output_matplotlib_strings":"remove"},"title":"IRSA Tutorials","description":"IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)","authors":[{"id":"IRSA Scientists and Developers","name":"IRSA Scientists and Developers"}],"github":"https://github.com/Caltech-IPAC/irsa-tutorials/","keywords":["astronomy"],"toc":[{"file":"index.md","title":"IRSA Tutorials"},{"children":[{"file":"tutorials/spherex/spherex_intro.md"}],"title":"SPHEREx"},{"children":[{"children":[{"file":"tutorials/euclid_access/Euclid_ERO.md"}],"title":"Euclid Early Release Observations"},{"children":[{"file":"tutorials/euclid_access/1_Euclid_intro_MER_images.md"},{"file":"tutorials/euclid_access/2_Euclid_intro_MER_catalog.md"},{"file":"tutorials/euclid_access/3_Euclid_intro_1D_spectra.md"},{"file":"tutorials/euclid_access/4_Euclid_intro_PHZ_catalog.md"},{"file":"tutorials/euclid_access/5_Euclid_intro_SPE_catalog.md"},{"file":"tutorials/cloud_access/euclid-cloud-access.md"}],"title":"Euclid Quick Release 1"}],"title":"Euclid"},{"children":[{"children":[{"file":"tutorials/irsa-sia-examples/sia_allwise_atlas.md"},{"file":"tutorials/parquet-catalog-demos/wise-allwise-catalog-demo.md"}],"title":"AllWISE"},{"children":[{"file":"tutorials/firefly/NEOWISE_light_curve_demo.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-strategies.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-lightcurves.md"}],"title":"NEOWISE"}],"title":"WISE"},{"children":[{"file":"tutorials/irsa-sia-examples/siav2_seip.md"}],"title":"Spitzer"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_2mass_allsky.md"}],"title":"2MASS"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_cosmos.md"}],"title":"COSMOS"},{"children":[{"children":[{"file":"tutorials/roman_simulations/roman_hlss_number_density.md"}],"title":"Roman HLSS Galaxy Mock Catalog"},{"children":[{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_wideareasurvey.md"},{"file":"tutorials/firefly/OpenUniverse2024Preview_Firefly.md"},{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_timedomainsurvey.md"}],"title":"OpenUniverse 2024"},{"children":[{"file":"tutorials/cosmodc2/cosmoDC2_TAP_access.md"}],"title":"CosmoDC2"}],"title":"Simulated Data"},{"children":[{"file":"tutorials/cloud_access/cloud-access-intro.md"},{"file":"tutorials/firefly/SEDs_in_Firefly.md"},{"file":"tutorials/parallelize/Parallelize_Convolution.md"}],"title":"Special Topics"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"SPHEREx"},{"slug":"spherex-intro","title":"Introduction to SPHEREx Spectral Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Euclid"},{"level":2,"title":"Euclid Early Release Observations"},{"slug":"euclid-ero","title":"Exploring Star Clusters in the Euclid ERO Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Euclid Quick Release 1"},{"slug":"euclid-intro-mer-images","title":"Euclid Q1: MER mosaics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-mer-catalog","title":"Euclid Q1: MER catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-1d-spectra","title":"Euclid Q1: 1D spectra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-phz-catalog","title":"Euclid Q1: PHZ catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-spe-catalog","title":"Euclid Q1: SPE catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-cloud-access","title":"Euclid Q1: cloud access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"WISE"},{"level":2,"title":"AllWISE"},{"slug":"sia-allwise-atlas","title":"Searching for AllWISE Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"wise-allwise-catalog-demo","title":"Analyzing cloud-hosted AllWISE Source Catalog in Parquet format","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"NEOWISE"},{"slug":"neowise-light-curve-demo","title":"Using Firefly visualization tools to understand the light curves of Solar System objects","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-strategies","title":"Strategies to Efficiently Work with NEOWISE Single-exposure Source Table in Parquet","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-lightcurves","title":"Make Light Curves from NEOWISE Single-exposure Source Table","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Spitzer"},{"slug":"siav2-seip","title":"Searching for Spitzer Enhanced Imaging Products","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"2MASS"},{"slug":"sia-2mass-allsky","title":"Searching for 2MASS All-Sky Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"COSMOS"},{"slug":"sia-cosmos","title":"Searching for contributed COSMOS images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Simulated Data"},{"level":2,"title":"Roman HLSS Galaxy Mock Catalog"},{"slug":"roman-hlss-number-density","title":"Number Density as a Function of Redshift","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"OpenUniverse 2024"},{"slug":"openuniverse2024-roman-simulated-wideareasurvey","title":"Analyzing cloud-hosted simulated Roman coadded images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024preview-firefly","title":"Using Firefly to Explore OpenUniverse2024 Data Preview Simulated Roman and Rubin Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024-roman-simulated-timedomainsurvey","title":"Analyzing cloud-hosted simulated Roman Time Domain Survey images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"CosmoDC2"},{"slug":"cosmodc2-tap-access","title":"Querying CosmoDC2 Mock v1 catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Special Topics"},{"slug":"cloud-access-intro","title":"IRSA cloud access introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"seds-in-firefly","title":"Using Firefly visualization tools in Python to vet SEDs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"parallelize-convolution","title":"Parallelizing image convolution","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":2,"kind":"Notebook","sha256":"4a2d71e799aba2199e0208956671d4e66189e9b6b1947d6820d10ba2d3c600c0","slug":"openuniverse2024preview-firefly","location":"/tutorials/firefly/OpenUniverse2024Preview_Firefly.md","dependencies":[],"frontmatter":{"title":"Using Firefly to Explore OpenUniverse2024 Data Preview Simulated Roman and Rubin Images","kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"jupytext":{"text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.16.3"}},"content_includes_title":false,"authors":[{"id":"IRSA Scientists and Developers","name":"IRSA Scientists and Developers"}],"github":"https://github.com/Caltech-IPAC/irsa-tutorials/","subject":"IRSA Tutorials","keywords":["astronomy"],"settings":{"output_matplotlib_strings":"remove"},"numbering":{"title":{"offset":2}},"edit_url":"https://github.com/Caltech-IPAC/irsa-tutorials//blob/main/tutorials/firefly/OpenUniverse2024Preview_Firefly.md","exports":[{"format":"md","filename":"OpenUniverse2024Preview_Firefly.md","url":"/build/OpenUniverse2024Prev-05fbd8d4289cad55692f2d0546b608ea.md"}]},"mdast":{"type":"root","children":[{"type":"block","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Learning Goals","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"ckFltAaVEb"}],"identifier":"learning-goals","label":"Learning Goals","html_id":"learning-goals","implicit":true,"key":"hexq52MPfw"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"By the end of this tutorial, you will:","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"aWg0nPeJ6z"}],"key":"l8gE02iOBC"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":22,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Learn how to access cloud-hosted Roman and Rubin simulated images.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"lSjAFY3jvZ"}],"key":"xhOjVM5eX4"}],"key":"yND7wELano"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Learn how to launch an interactive Firefly instance inside JupyterLab.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"TN96pa6ujS"}],"key":"qZdWORrG4d"}],"key":"RvICiZKvdt"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Learn how to use the Firefly Jupyterlab extension to visualize cloud-hosted simulated images, overplot ds9 regions, overplot catalogs in Parquet format, and create 3 color images.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"APUx3NdS8V"}],"key":"rYgmvJrL4M"}],"key":"hDB0Uhs0hx"}],"key":"LzRfI4wBfx"}],"key":"IVcBwQxF5K"},{"type":"block","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"I5GJVLodgK"}],"identifier":"introduction","label":"Introduction","html_id":"introduction","implicit":true,"key":"GmuVyAbrpq"},{"type":"paragraph","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"The purpose of this tutorial is to become familiar with simulated Roman and Rubin simulated data published through the OpenUniverse 2024 data preview, and to become familiar with the Firefly JupyterLab Extension for visualizing astronomical data products.","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"nx2tj9CUWM"}],"key":"r2b9RH2bs3"},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"OpenUniverse2024 is a project to simulate spatially overlapping imaging surveys to be carried out by the Nancy Grace Roman Telescope and the Vera C. Rubin Observatory. The simulations were carried out on Argonne’s Theta cluster and consist of:","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"y11kGuBkGW"}],"key":"KucdpXdxIa"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":36,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"The LSST ELAIS-S1 Deep Drilling Field (DDF)","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"OyM35sBlcg"}],"key":"FNMg4g1DWd"},{"type":"listItem","spread":true,"position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"The Roman Time-Domain Survey (TDS) shifted to overlap the ELAIS region and LSST DDF","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"kXNvGzAj2U"}],"key":"tReW4yjSeT"},{"type":"listItem","spread":true,"position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Overlapping LSST Wide-Fast-Deep (WFD) survey (with rolling cadence)","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"u9cmfNrDsi"}],"key":"nGN4r9NyqL"},{"type":"listItem","spread":true,"position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"Overlapping Roman Wide-Area Survey (WAS) in the same region","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"esQmaz1iXF"}],"key":"egETrEjq7d"},{"type":"listItem","spread":true,"position":{"start":{"line":40,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"A deep-field calibration region of the Roman WAS in the same region","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"QJKRPXIehM"}],"key":"KO0LWZoXcY"}],"key":"HSQSGJ4uYf"},{"type":"paragraph","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"This data preview release consists of a subset of data from each of the five categories above. More information about data preview can be found at ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"UHOpIppSdb"},{"type":"link","url":"https://irsa.ipac.caltech.edu/data/theory/openuniverse2024/overview.html","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"IRSA holding of this dataset","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"qVoR7VeR3X"}],"urlSource":"https://irsa.ipac.caltech.edu/data/theory/openuniverse2024/overview.html","key":"CyiKcuEGSy"},{"type":"text","value":".","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"Mhv1fUeAN9"}],"key":"Xle6ybVZna"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"Firefly is an open-source web-based UI library for astronomical data archive access and visualization developed at Caltech and used by multiple space- and ground-based astrophysics archives. More information on Firefly can be found ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"ELn4wc90UE"},{"type":"link","url":"https://github.com/Caltech-IPAC/firefly/blob/dev/README.md","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"KTS6gJGo9R"}],"urlSource":"https://github.com/Caltech-IPAC/firefly/blob/dev/README.md","data":{"kind":"file","org":"Caltech-IPAC","repo":"firefly","reference":"dev","file":"README.md","raw":"https://raw.githubusercontent.com/Caltech-IPAC/firefly/dev/README.md"},"internal":false,"protocol":"github","key":"alQPagR8Jz"},{"type":"text","value":".","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"kc96F3fciF"}],"key":"y2X6jJQrbC"},{"type":"paragraph","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"In addition to being used to make web applications, Firefly can be used from Python. More information on Firefly Python client can be found ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"NXX3CdDKjk"},{"type":"link","url":"https://caltech-ipac.github.io/firefly_client/usage/index.html","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"qQ8ya6gFKh"}],"urlSource":"https://caltech-ipac.github.io/firefly_client/usage/index.html","key":"nvExZmFJLF"},{"type":"text","value":".","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"lDbWtObw6p"}],"key":"J9XlCGPcY8"},{"type":"paragraph","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"The Firefly JupyterLab Extension makes it particularly easy to use Firefly to efficiently visualize cloud-hosted astronomical data using JupyterLab instances running locally or on cloud. More information on Firefly JupyterLab Extension can be found ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"w6u0gZI0RZ"},{"type":"link","url":"https://github.com/Caltech-IPAC/jupyter_firefly_extensions/blob/master/README.md","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"e9IowqAvns"}],"urlSource":"https://github.com/Caltech-IPAC/jupyter_firefly_extensions/blob/master/README.md","data":{"kind":"file","org":"Caltech-IPAC","repo":"jupyter_firefly_extensions","reference":"master","file":"README.md","raw":"https://raw.githubusercontent.com/Caltech-IPAC/jupyter_firefly_extensions/master/README.md"},"internal":false,"protocol":"github","key":"xKEKZHBRJO"},{"type":"text","value":".","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"Di8h5jwRN3"}],"key":"nTBs1aDuvi"}],"key":"if86IGF5yf"},{"type":"block","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"KT4imqxZ0y"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"z3jjBylkVp"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":54,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"astropy.io.fits for accessing FITS files","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"nqGdz1YZv8"}],"key":"ivmqebxYo9"},{"type":"listItem","spread":true,"position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"numpy for numerical computing","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"gHdhJVXNlc"}],"key":"pLoCfdQKW4"},{"type":"listItem","spread":true,"position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"s3fs for browsing cloud buckets","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"phMWtE3J2d"}],"key":"SdELCeKCAw"},{"type":"listItem","spread":true,"position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"matplotlib.pyplot for creating static visualizations of FITS images","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"o85lmZQjR7"}],"key":"PFp4ew1rxY"},{"type":"listItem","spread":true,"position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"matplotlib.patches for annotating visualizations of FITS images","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"BS4yxXWUB5"}],"key":"AmzqABBnXt"},{"type":"listItem","spread":true,"position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"astropy.wcs for dealing with astronomical world coordinate systems","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"ZDQ29O3Ymp"}],"key":"kRJQASoKEq"},{"type":"listItem","spread":true,"position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"astropy.units for dealing with astronomical units","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"v0lKtcCJmo"}],"key":"slbzp35Xr7"},{"type":"listItem","spread":true,"position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"astropy.coordinates.SkyCoord for dealing with astronomical coordinates","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"aqxg7MmuVw"}],"key":"t6qaNXKjvl"},{"type":"listItem","spread":true,"position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"firefly_client.FireflyClient for using the Firefly python client","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"sOSbKPMSis"}],"key":"AkiWvwRhDO"},{"type":"listItem","spread":true,"position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"astropy.nddata.Cutout2D for making image cutouts","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"dwRcaait0f"}],"key":"wCUxdPF43m"},{"type":"listItem","spread":true,"position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"itertools.product to support looping over Roman blocks","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"KvHo5W3GaH"}],"key":"W93pKIpPbu"},{"type":"listItem","spread":true,"position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"reproject.reproject_interp to convert Roman coadds from STG to TAN projection","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"ZQrl87GsXd"}],"key":"OtHaKUaQED"},{"type":"listItem","spread":true,"position":{"start":{"line":66,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"io.BytesIO for writing a fits file to an in-memory stream","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"elJitfyoOF"}],"key":"vSsoWKFae4"}],"key":"UL4I0D0HLI"}],"key":"ldOZAxQRBi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Uncomment the next line to install dependencies if needed.\n# !pip install numpy astropy s3fs matplotlib firefly_client reproject","key":"AW9N8vY0in"},{"type":"output","id":"LiSgMUvsxI0bem7s9DXEz","data":[],"key":"TeuNOhVETY"}],"key":"phqdDCRx1U"},{"type":"block","children":[],"key":"eZSCmqwoNz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from astropy.io import fits\nimport numpy as np\nimport s3fs\nfrom matplotlib import pyplot as plt\nfrom matplotlib import patches\nfrom astropy import wcs\nfrom astropy import units as u\nfrom astropy.coordinates import SkyCoord\nfrom firefly_client import FireflyClient\nfrom astropy.nddata import Cutout2D\nfrom itertools import product\nfrom reproject import reproject_interp\nfrom io import BytesIO","key":"IT7gJQpo0J"},{"type":"output","id":"b1TOtV-CcudfePiNNjmXf","data":[],"key":"o7jq8AG3UZ"}],"key":"UVZZTxYv7r"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"Learn where the OpenUniverse2024 data are hosted in the cloud.","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"Kuoqul5cMj"}],"identifier":"learn-where-the-openuniverse2024-data-are-hosted-in-the-cloud","label":"Learn where the OpenUniverse2024 data are hosted in the cloud.","html_id":"learn-where-the-openuniverse2024-data-are-hosted-in-the-cloud","implicit":true,"key":"Y6FC4i77dJ"},{"type":"paragraph","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"The OpenUniverse2024 data preview is hosted in the cloud via Amazon Web Services (AWS). To access these data, you need to create a client to read data from Amazon’s Simple Storage Service (s3) buckets, and you need to know some information about those buckets. The OpenUniverse2024 data preview contains simulations of the Roman Wide-Area Survey (WAS) and the Roman Time Domain Survey (TDS). In this tutorial, we will focus on the WAS.","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"XKKooPpCOa"}],"key":"lsUIHTUUO1"}],"key":"ul9VYlCnFo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"BUCKET_NAME = \"nasa-irsa-simulations\"\nROMAN_PREFIX = \"openuniverse2024/roman/preview\"\nROMAN_COADD_PATH = f\"{ROMAN_PREFIX}/RomanWAS/images/coadds\"\nTRUTH_FILES_PATH = f\"{ROMAN_PREFIX}/roman_rubin_cats_v1.1.2_faint\"\n\nRUBIN_PREFIX = \"openuniverse2024/rubin/preview\"\nRUBIN_COADD_PATH = f\"{RUBIN_PREFIX}/u/descdm/preview_data_step3_2877_19_w_2024_12/20240403T150003Z/deepCoadd_calexp/2877/19\"","key":"gcYBoL1JDN"},{"type":"output","id":"GauXQooyznT1yX4dRsNoS","data":[],"key":"XYiMk1j5D4"}],"key":"TpTqnwIjcW"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"Roman Coadds","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"FAMVuBfAjU"}],"identifier":"roman-coadds","label":"Roman Coadds","html_id":"roman-coadds","implicit":true,"key":"ZOuG23WPLo"},{"type":"paragraph","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"The Nancy Grace Roman Space Telescope will carry out a wide-area survey (WAS) in the near infrared. The OpenUniverse2024 data preview includes coadded mosaics of simulated WAS data, created with the IMCOM algorithm (Rowe et al. 2011). Bands include F184, H158, J129, K213, Y106. In this section, we define some functions that make it convenient to retrieve a given cloud-hosted simulated Roman coadd based on position and filter.","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"DxI67HcNFb"}],"key":"ABcnQQoPeo"}],"key":"rUqBFIjSDo"},{"type":"block","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"Define Roman Simulated “Blocks”","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"TanQv1DzGD"}],"identifier":"define-roman-simulated-blocks","label":"Define Roman Simulated “Blocks”","html_id":"define-roman-simulated-blocks","implicit":true,"key":"WW53xjHQJn"},{"type":"paragraph","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"The simulated Roman coadds are arranged in 100 arcsecond blocks, as described in Hirata et al. 2024. Below we define the RA and Dec of the block centers. This cell should not be altered.","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"kumZhYdSiE"}],"key":"HB3pFfH01D"}],"key":"gmBOCsTgHI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Centers of roman data preview blocks. Do not alter.\nra_block_centers = np.array([9.76330352298415, 9.724522605135252, 9.68574158906671,\n                        9.646960496603766, 9.608179349571955, 9.56939816979703,\n                        9.530616979104877, 9.491835799321422, 9.453054652272561,\n                        9.414273559784032, 9.375492543681393, 9.336711625789874]) * u.deg\ndec_block_centers = np.array([-44.252584927082495, -44.22480733304182, -44.197029724175756,\n                            -44.16925210374898, -44.14147447502621, -44.11369684127218,\n                            -44.08591920575162, -44.05814157172923, -44.03036394246976,\n                            -44.0025863212379, -43.974808711298394, -43.94703111591591]) * u.deg\nblock_size = 100 * u.arcsec # each block is 100 arcsec across","key":"q1nksdWo6P"},{"type":"output","id":"DDghrQeEgigSJ1Z3RWjW7","data":[],"key":"wwekDbd70n"}],"key":"uqTyrCdNUJ"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"text","value":"Define a function that returns the simulated Roman block column/row for a given RA/Dec.","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"AaV8E1xIRF"}],"identifier":"define-a-function-that-returns-the-simulated-roman-block-column-row-for-a-given-ra-dec","label":"Define a function that returns the simulated Roman block column/row for a given RA/Dec.","html_id":"define-a-function-that-returns-the-simulated-roman-block-column-row-for-a-given-ra-dec","implicit":true,"key":"r2VK2XDNa5"},{"type":"paragraph","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"Blocks are arranged in a grid with axes parallel to RA and Dec. A given RA represents a column of blocks and a given Dec represents a row of blocks. This function returns the block column or row given the block centers from the cell above and a given RA or Dec, respectively.","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"qlrO66yb3C"}],"key":"Ap14GBG6pv"}],"key":"CCGeQ9pRKe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def get_block_axis(block_centers, coord, ra_or_dec):\n    ra_or_dec_coord = getattr(coord, ra_or_dec)\n    block_dist_array = np.absolute(block_centers - ra_or_dec_coord)\n    closest_block_idx = block_dist_array.argmin()\n    if (ra_or_dec_coord \u003c block_centers.min()-block_size/2 \n        or ra_or_dec_coord \u003e block_centers.max()+block_size/2):\n        raise ValueError(f\"Chosen {ra_or_dec}: {ra_or_dec_coord} not covered by OpenUniverse 2024 data preview simulated Roman coadds\")\n    else:\n        return closest_block_idx + 12 # preview covers central 12 rows 12 columns, in a grid of 36x36 blocks","key":"Sp5dE5XW12"},{"type":"output","id":"_eMGZdyW3Uyh116ml03Ip","data":[],"key":"Z2hpOMDsvo"}],"key":"YhVd3XxVZG"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"children":[{"type":"text","value":"Define a function that retrieves a Roman simulated coadd given a sky position and filter.","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"Na0HcrolJG"}],"identifier":"define-a-function-that-retrieves-a-roman-simulated-coadd-given-a-sky-position-and-filter","label":"Define a function that retrieves a Roman simulated coadd given a sky position and filter.","html_id":"define-a-function-that-retrieves-a-roman-simulated-coadd-given-a-sky-position-and-filter","implicit":true,"key":"k4c86KJKVK"}],"key":"cz9VGaGP9w"},{"type":"block","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"children":[{"type":"text","value":"Each of the cloud-hosted simulated Roman coadds can be accessed via a S3 filepath. This function returns the access path for the simulated Roman coadd that includes a specified position on the sky and desired filter.","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"EE2eyRxFdB"}],"key":"A2SPP5cnVO"}],"key":"qB6GjMyhGC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def get_roman_coadd_fpath(coord, filter):\n    col = get_block_axis(ra_block_centers, coord, 'ra')\n    row = get_block_axis(dec_block_centers, coord, 'dec')\n    \n    # Construct the coadd filename from the chosen filter, row, and column.\n    coadd_fname_root = f\"prod_{filter[0]}_{col}_{row}_map.fits\"\n    coadd_fpath = f\"{BUCKET_NAME}/{ROMAN_COADD_PATH}/{filter}/Row{row}/{coadd_fname_root}\"\n    return coadd_fpath","key":"QNepnTrJ8z"},{"type":"output","id":"5bLlV69hz9jaslZjiDz2X","data":[],"key":"Gm6l0Oyw4U"}],"key":"jovyNJqXQO"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"children":[{"type":"text","value":"Now we use this access path and prefix it with ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"dFhn2bzoz6"},{"type":"inlineCode","value":"s3://","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"xQxPnpKGo7"},{"type":"text","value":" and use astropy.fits to extract a subset of it (for more info see ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"hvhYpodGaP"},{"type":"link","url":"https://docs.astropy.org/en/stable/io/fits/usage/cloud.html#subsetting-fits-files-hosted-in-amazon-s3-cloud-storage","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"children":[{"type":"text","value":"this section","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"qhhxh8Yv1t"}],"urlSource":"https://docs.astropy.org/en/stable/io/fits/usage/cloud.html#subsetting-fits-files-hosted-in-amazon-s3-cloud-storage","key":"xG0v83OWym"},{"type":"text","value":" of astropy docs).","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"ghkLlvbmW6"}],"key":"UbEdP0iba8"},{"type":"paragraph","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"children":[{"type":"text","value":"We use ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"N6i0VSSjOi"},{"type":"inlineCode","value":".section","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"TCKEJx9vth"},{"type":"text","value":" to retrieve just the science image data from fits HDU as a 2D ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"thwScFWJuh"},{"type":"inlineCode","value":"numpy.array","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"ZQ71hsUqGU"},{"type":"text","value":", and extract WCS information from fits header as ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"s5eABBLInj"},{"type":"inlineCode","value":"astropy.wcs.WCS","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"aGneGuTtEx"},{"type":"text","value":" object. The following function returns a dictionary of both.","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"KKhYVs7TUE"}],"key":"RNbuAAzMee"}],"key":"ffvx11Kdyj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def get_roman_coadd(coord, filter):\n    # retrive fits file of block/tile from the coadd mosiac\n    coadd_s3_fpath = get_roman_coadd_fpath(coord, filter)\n    coadd_s3_uri = f\"s3://{coadd_s3_fpath}\"\n\n    with fits.open(coadd_s3_uri, fsspec_kwargs={\"anon\": True}) as hdul:\n        # retrieve science data from coadd fits\n        coadd_data = hdul[0].section[0,0, :, :]  # has (2688, 2688, 15, 1) shape, with 0th layer in the cube as science image\n\n        # make wcs using header\n        coadd_wcs = wcs.WCS(hdul[0].header, naxis=2)\n\n        return {'data': coadd_data, 'wcs': coadd_wcs}","key":"p3Hgo6TqFv"},{"type":"output","id":"aeAjwa4bNMQDIekIUoomk","data":[],"key":"zCy8vE6qde"}],"key":"aW1xawlo2u"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"children":[{"type":"text","value":"Inspect a simulated Roman Coadd","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"NJlVaDSrZs"}],"identifier":"inspect-a-simulated-roman-coadd","label":"Inspect a simulated Roman Coadd","html_id":"inspect-a-simulated-roman-coadd","implicit":true,"key":"zRZDh7gmtp"}],"key":"REurO8WYk4"},{"type":"block","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"text","value":"Choose a filter and position that lies within the data preview region","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"xGtk7TAHIL"}],"key":"LE90uIyUgh"}],"key":"Bk0sTLFfYX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"coord = SkyCoord(ra=9.6055383, dec=-44.1895542, unit=\"deg\")\nfilter_roman = 'H158' #F184, H158, J129, K213, and Y106 are available in the data preview","key":"Ixga81nZQW"},{"type":"output","id":"dZah-AYLI8lVKF4vxOkRt","data":[],"key":"y1MMsq5h0S"}],"key":"GGrALW1Nn5"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"text","value":"Retrieve the data and header information from the simulated Roman coadd corresponding to the chosen position and filter.","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"t7cphpqih4"}],"key":"PfCTQvqDL6"}],"key":"dYiAFWbsUd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"coadd_roman = get_roman_coadd(coord, filter_roman)","key":"HKninBPbbA"},{"type":"output","id":"5Zx4brUaNhhroI6Wovp4C","data":[],"key":"MSS1i8OJdz"}],"key":"ChG0yKZUB8"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"children":[{"type":"text","value":"Understand the size of a simulated Roman coadd.","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"fA5aUJHzeA"}],"identifier":"understand-the-size-of-a-simulated-roman-coadd","label":"Understand the size of a simulated Roman coadd.","html_id":"understand-the-size-of-a-simulated-roman-coadd","implicit":true,"key":"c7t5wEpjIp"}],"key":"JYjXt5tvFu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Number of pixels (Y, X)\ncoadd_roman['data'].shape","key":"pGx2CnX9hn"},{"type":"output","id":"8iCBqzvIy--4qDhuxRuN3","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"(2688, 2688)","content_type":"text/plain"}}}],"key":"vIvpiTvkxm"}],"key":"dT71HVIlwr"},{"type":"block","children":[],"key":"jLK3XwW2Mg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Pixel size (scale Y, scale X) [degrees/pixel]\ncoadd_roman['wcs'].proj_plane_pixel_scales()","key":"IoFwQNmgh4"},{"type":"output","id":"yrc50PFjKIcT9V_OoD9Hs","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"[\u003cQuantity 1.08506944e-05 deg\u003e, \u003cQuantity 1.08506944e-05 deg\u003e]","content_type":"text/plain"}}}],"key":"iXAr8vZMrF"}],"key":"j4eV2ds9Dn"},{"type":"block","children":[],"key":"oZx9hmAjkD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Coadd size (FOV Y, FOV X)\n[(num * size).to('arcsec') for num, size in zip(\n    coadd_roman['data'].shape, coadd_roman['wcs'].proj_plane_pixel_scales())]","key":"VCPCdVFGQp"},{"type":"output","id":"Mhm1DpdKDYAzCJMwIPzib","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"[\u003cQuantity 105. arcsec\u003e, \u003cQuantity 105. arcsec\u003e]","content_type":"text/plain"}}}],"key":"YRFMsE9tOH"}],"key":"O5Tol8JDxI"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"children":[{"type":"text","value":"The field of view of Roman coadd is ~100 arcsec.","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"IET0zKOBw0"}],"key":"NLF5Lo2F36"}],"key":"cOHniNH6Oc"},{"type":"block","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"children":[{"type":"text","value":"Use the WCS from the Roman simulated header to convert the specified coordinate into a pixel position.","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"KLhOkXCqgn"}],"identifier":"use-the-wcs-from-the-roman-simulated-header-to-convert-the-specified-coordinate-into-a-pixel-position","label":"Use the WCS from the Roman simulated header to convert the specified coordinate into a pixel position.","html_id":"use-the-wcs-from-the-roman-simulated-header-to-convert-the-specified-coordinate-into-a-pixel-position","implicit":true,"key":"k6MLHVEX1I"}],"key":"UdVQ3ZVWC2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def coord_to_xy(w, coord):\n    return w.world_to_array_index(coord)[::-1] #reverse since 0th axis is y, 1st axis is x\n\ncoord_arr_idx = coord_to_xy(coadd_roman['wcs'], coord)\ncoord_arr_idx","key":"wONHOJ9QjL"},{"type":"output","id":"XdqUFaERcCI7TN7Q7v_oB","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/plain":{"content":"(1513, 2049)","content_type":"text/plain"}}}],"key":"XNybbgV82r"}],"key":"Hnmjv7uRWu"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"children":[{"type":"text","value":"Use matplotlib imshow to create a static visualization of the Roman simulated coadd and overplot the selected position.","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"EUXwmvvoTe"}],"identifier":"use-matplotlib-imshow-to-create-a-static-visualization-of-the-roman-simulated-coadd-and-overplot-the-selected-position","label":"Use matplotlib imshow to create a static visualization of the Roman simulated coadd and overplot the selected position.","html_id":"use-matplotlib-imshow-to-create-a-static-visualization-of-the-roman-simulated-coadd-and-overplot-the-selected-position","implicit":true,"key":"IHJ0atIr3i"}],"key":"GfacdZeEUq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def stretch_color(data, clipPercent):\n    return np.percentile(data, (0 + clipPercent, 100 - clipPercent))\n\nplt.imshow(coadd_roman['data'], origin='lower', \n           clim=stretch_color(coadd_roman['data'], 1)\n           )\n\nplt.plot(*coord_arr_idx, 'r+', markersize=15)","key":"qvPiYpsSeg"},{"type":"output","id":"P_Igr_mT1yaFV8b7LhvLT","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 640x480 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"c36058d0c4214f50395c6ec3c6fc51a0","path":"/build/c36058d0c4214f50395c6ec3c6fc51a0.png"}}}],"key":"yn4uqJb1OT"}],"key":"V5XxbN1bOS"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"children":[{"type":"text","value":"Rubin Coadds","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"key":"HcQyZ0Wigc"}],"identifier":"rubin-coadds","label":"Rubin Coadds","html_id":"rubin-coadds","implicit":true,"key":"nMIwv20MJB"},{"type":"paragraph","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"children":[{"type":"text","value":"The OpenUniverse2024 data preview includes coadded mosaics in the following filters: u, g, r, i, z, y. In this section, we define some functions that make it convenient to retrieve a given cloud-hosted simulated Roman coadd based on position and filter.","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"d3eZZiiGmI"}],"key":"RGDpflyTTS"}],"key":"a4P5sZbxvU"},{"type":"block","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"children":[{"type":"text","value":"Retrieve Rubin Coadds","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"b9ZcFGjT9H"}],"identifier":"retrieve-rubin-coadds","label":"Retrieve Rubin Coadds","html_id":"retrieve-rubin-coadds","implicit":true,"key":"Ac4p71XpgZ"},{"type":"paragraph","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"children":[{"type":"text","value":"The OpenUniverse2024 data preview includes only one simulated Rubin coadd per filter. Below we define functions that make it convenient to retrieve the simulated Rubin coadd corresponding to the desired filter. We return data in same structure as the functions we defined above for Roman.","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"key":"AOaZZDhYtU"}],"key":"doTtYKEGBj"}],"key":"CtvWIpQbEn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def get_rubin_coadd_fpath(filter): \n    coadd_fname_root = f\"deepCoadd_calexp_2877_19_{filter}_DC2_u_descdm_preview_data_step3_2877_19_w_2024_12_20240403T150003Z.fits\"\n    coadd_fpath = f\"{BUCKET_NAME}/{RUBIN_COADD_PATH}/{filter}/{coadd_fname_root}\"\n    return coadd_fpath","key":"rZBAX7wYqv"},{"type":"output","id":"KiijOirQ4-50wZRnkcDsP","data":[],"key":"IJaqahd1il"}],"key":"Ga4rQdoCn6"},{"type":"block","children":[],"key":"RXXib8O4HH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def get_rubin_coadd(filter):\n    coadd_s3_fpath = get_rubin_coadd_fpath(filter)\n\n    with fits.open(f\"s3://{coadd_s3_fpath}\", fsspec_kwargs={\"anon\": True}) as hdul:\n        # retrieve science data from coadd fits\n        coadd_data = hdul[1].section[:,:]\n\n        # make wcs using header\n        coadd_wcs = wcs.WCS(hdul[1].header)\n\n        return {'data': coadd_data, 'wcs': coadd_wcs}","key":"VsL7wL2bbg"},{"type":"output","id":"JeaAGiUC65UYPaYJB6XU3","data":[],"key":"kKqmUW6Jxz"}],"key":"ZI4bnqtcik"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"children":[{"type":"text","value":"Inspect a simulated Rubin Coadd","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"JXkc3EIunH"}],"identifier":"inspect-a-simulated-rubin-coadd","label":"Inspect a simulated Rubin Coadd","html_id":"inspect-a-simulated-rubin-coadd","implicit":true,"key":"pZhSIM92bD"}],"key":"vNA0pFXQ08"},{"type":"block","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"text","value":"Choose a filter and retrieve the data and header information from the simulated Rubin coadd corresponding to that filter.","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"TbsykOd6HQ"}],"key":"k5Ca1MeTte"}],"key":"PBRzcFjoFD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"filter_rubin = 'r'\ncoadd_rubin = get_rubin_coadd(filter_rubin)","key":"XxJDABFOvD"},{"type":"output","id":"ZSO2WiiLhXI8m4Iqi-orU","data":[],"key":"qFAMiGCtIb"}],"key":"MNSdVFIt1X"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"children":[{"type":"text","value":"Understand the size of a simulated Rubin coadd.","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"Z7bYT8trdn"}],"identifier":"understand-the-size-of-a-simulated-rubin-coadd","label":"Understand the size of a simulated Rubin coadd.","html_id":"understand-the-size-of-a-simulated-rubin-coadd","implicit":true,"key":"F8yGoeZg2I"}],"key":"RNeY4khkDE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Number of pixels (Y, X)\ncoadd_rubin['data'].shape","key":"fNtwvPKL3q"},{"type":"output","id":"hoqPCbqKPza6M3H2HoqWs","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/plain":{"content":"(4200, 4200)","content_type":"text/plain"}}}],"key":"cdMa0XfQig"}],"key":"mRvki3zHzc"},{"type":"block","children":[],"key":"bEFEHBzNcp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Pixel size (scale Y, scale X) [degrees/pixel]\ncoadd_rubin['wcs'].proj_plane_pixel_scales()","key":"rtlMCk9tru"},{"type":"output","id":"StuHfuRS3TmL4u7m3-R_5","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"[\u003cQuantity 5.55555556e-05 deg\u003e, \u003cQuantity 5.55555556e-05 deg\u003e]","content_type":"text/plain"}}}],"key":"pQzsktb5rW"}],"key":"vzO15cs5Vo"},{"type":"block","children":[],"key":"I4dU4Nmktk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Coadd size (FOV Y, FOV X)\n[(num * size).to('arcsec') for num, size in zip(\n    coadd_rubin['data'].shape, coadd_rubin['wcs'].proj_plane_pixel_scales())]","key":"kP98RjLEK8"},{"type":"output","id":"7dxC80ILeeodNzmwkFOQ9","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/plain":{"content":"[\u003cQuantity 840. arcsec\u003e, \u003cQuantity 840. arcsec\u003e]","content_type":"text/plain"}}}],"key":"qcMWz3w4vd"}],"key":"fIY0W93YyO"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"children":[{"type":"text","value":"The field of view of Rubin coadd is 840 arcsec.","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"bdE6pM3VSR"}],"key":"RKzd65Fgxq"}],"key":"lso3bsqwQL"},{"type":"block","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"children":[{"type":"text","value":"Use matplotlib imshow to create a static visualization of the Rubin simulated coadd and overplot the selected position.","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"az7PVG1Vmz"}],"identifier":"use-matplotlib-imshow-to-create-a-static-visualization-of-the-rubin-simulated-coadd-and-overplot-the-selected-position","label":"Use matplotlib imshow to create a static visualization of the Rubin simulated coadd and overplot the selected position.","html_id":"use-matplotlib-imshow-to-create-a-static-visualization-of-the-rubin-simulated-coadd-and-overplot-the-selected-position","implicit":true,"key":"yPFWjRILQi"}],"key":"z8VaDoznnI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.imshow(coadd_rubin['data'], origin='lower', \n           clim=stretch_color(coadd_rubin['data'], 1)\n           )\n\nplt.plot(*coord_to_xy(coadd_rubin['wcs'], coord), 'r+', markersize=15)","key":"W6pNOuIvFB"},{"type":"output","id":"nCDw89ze6-QTU0TNlssSb","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 640x480 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"1e2cd8fa1cf9ff6e928fb283c980ac60","path":"/build/1e2cd8fa1cf9ff6e928fb283c980ac60.png"}}}],"key":"CRRyJYqBav"}],"key":"i95SQWFa60"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"children":[{"type":"text","value":"Define a function that returns the URL for a given S3 filepath","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"key":"nMWlYAQHTk"}],"identifier":"define-a-function-that-returns-the-url-for-a-given-s3-filepath","label":"Define a function that returns the URL for a given S3 filepath","html_id":"define-a-function-that-returns-the-url-for-a-given-s3-filepath","implicit":true,"key":"AJakB1VMPn"},{"type":"paragraph","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"text","value":"Since the OpenUniverse2024 data is available through a public S3 bucket, we can access a given S3 file using HTTPS URL as follows:","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"csqEEipUVL"}],"key":"jYSHoJWsrA"}],"key":"ARhPNPuqP5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def https_url(s3_fpath):\n    s3_fpath_without_bucket = s3_fpath.split('/', 1)[1]\n    return f\"https://{BUCKET_NAME}.s3.amazonaws.com/{s3_fpath_without_bucket}\"","key":"HykkxZiPKc"},{"type":"output","id":"nVJI2i9gpoAHyWj08AOd_","data":[],"key":"XgBDLIRMn1"}],"key":"sNj7vSxx5P"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":323,"column":1},"end":{"line":323,"column":1}},"children":[{"type":"text","value":"Let’s generate URL for the Rubin coadd we plotted above. Clicking on the returned URL will allow you to download this image locally.","position":{"start":{"line":323,"column":1},"end":{"line":323,"column":1}},"key":"jyEv6X8dst"}],"key":"YCCQJKDmXU"}],"key":"VvTj2FfMEN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"coadd_s3_fpath_rubin = get_rubin_coadd_fpath(filter_rubin)\nhttps_url(coadd_s3_fpath_rubin)","key":"iiFIPed1Cl"},{"type":"output","id":"Wq_E-l4aysux81IgaB5sY","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/plain":{"content":"'https://nasa-irsa-simulations.s3.amazonaws.com/openuniverse2024/rubin/preview/u/descdm/preview_data_step3_2877_19_w_2024_12/20240403T150003Z/deepCoadd_calexp/2877/19/r/deepCoadd_calexp_2877_19_r_DC2_u_descdm_preview_data_step3_2877_19_w_2024_12_20240403T150003Z.fits'","content_type":"text/plain"}}}],"key":"Zh0wKNq2Is"}],"key":"DDQoEcfLDg"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"children":[{"type":"text","value":"Compare simulated Roman and Rubin cutouts for a selected position","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"key":"sqVrWukDEj"}],"identifier":"compare-simulated-roman-and-rubin-cutouts-for-a-selected-position","label":"Compare simulated Roman and Rubin cutouts for a selected position","html_id":"compare-simulated-roman-and-rubin-cutouts-for-a-selected-position","implicit":true,"key":"BDOog3H5Rz"}],"key":"T6KgLPzKvH"},{"type":"block","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"children":[{"type":"text","value":"Choose cutout size","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"meeXyC7ZHC"}],"identifier":"choose-cutout-size","label":"Choose cutout size","html_id":"choose-cutout-size","implicit":true,"key":"bTLhDaOFtG"}],"key":"Qz9A6o3DDp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cutout_size = 50*u.arcsec","key":"nIaQjK0sS8"},{"type":"output","id":"CuZa0URelHl1yrldS-35A","data":[],"key":"EV7gAaACS8"}],"key":"BSrr3cjgME"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"children":[{"type":"text","value":"Create the cutouts","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"E8hAtKsHNN"}],"identifier":"create-the-cutouts","label":"Create the cutouts","html_id":"create-the-cutouts","implicit":true,"key":"CTqFSGBmB9"}],"key":"qB8GiBrnQF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cutout_roman = Cutout2D(coadd_roman['data'], coord, size=cutout_size, wcs=coadd_roman['wcs'])\ncutout_rubin = Cutout2D(coadd_rubin['data'], coord, size=cutout_size, wcs=coadd_rubin['wcs'])","key":"pLYUULaOCG"},{"type":"output","id":"e-fFb1YS0mm3YQz8h7J6l","data":[],"key":"B6MwQh2YwI"}],"key":"ClbrPnUD1s"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":347,"column":1},"end":{"line":347,"column":1}},"children":[{"type":"text","value":"Use matplotlib imshow to plot static side-by-side comparisons of the cutouts","position":{"start":{"line":347,"column":1},"end":{"line":347,"column":1}},"key":"Dt0qIK7jN6"}],"identifier":"use-matplotlib-imshow-to-plot-static-side-by-side-comparisons-of-the-cutouts","label":"Use matplotlib imshow to plot static side-by-side comparisons of the cutouts","html_id":"use-matplotlib-imshow-to-plot-static-side-by-side-comparisons-of-the-cutouts","implicit":true,"key":"Gx1iNpNXIC"}],"key":"m68dHjTylk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, axs = plt.subplots(1, 2, figsize=(12, 6))\n\n\naxs[0].imshow(cutout_roman.data, origin='lower', \n              clim=stretch_color(cutout_roman.data, .5)\n              )\naxs[0].plot(*coord_to_xy(cutout_roman.wcs, coord), 'r+', markersize=15)\naxs[0].set_title(f\"ROMAN in filter {filter_roman}\")\n\naxs[1].imshow(cutout_rubin.data, origin='lower', \n              clim=stretch_color(cutout_rubin.data, .5)\n              )\naxs[1].plot(*coord_to_xy(cutout_rubin.wcs, coord), 'r+', markersize=15)\naxs[1].set_title(f\"RUBIN in filter {filter_rubin}\")\n\nfig.suptitle(f\"Cutouts at ({coord.ra}, {coord.dec}) with {cutout_size} size\", fontsize=14)\nplt.tight_layout(rect=[0, 0, 1, 0.97])","key":"wEdLSPEwSO"},{"type":"output","id":"ChIgHhWrSk9AXmepPmBUZ","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 1200x600 with 2 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"3703381dc05d156f99882f3a65c78caa","path":"/build/3703381dc05d156f99882f3a65c78caa.png"}}}],"key":"LAbOpUdODa"}],"key":"r2wJbnHFBV"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"children":[{"type":"text","value":"Use Firefly to interactively identify a blended source","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"QICxqemD27"}],"identifier":"use-firefly-to-interactively-identify-a-blended-source","label":"Use Firefly to interactively identify a blended source","html_id":"use-firefly-to-interactively-identify-a-blended-source","implicit":true,"key":"cKeJDaKj81"},{"type":"paragraph","position":{"start":{"line":371,"column":1},"end":{"line":371,"column":1}},"children":[{"type":"text","value":"Clearly, the simulated Roman coadd has higher spatial resolution than the Rubin simulated coadd. Let’s try to locate blended objects to compare in the simulated Rubin and Roman images. We will use Firefly’s interactive visualization to make this task easier.","position":{"start":{"line":371,"column":1},"end":{"line":371,"column":1}},"key":"te9x1H4LZt"}],"key":"CSHdjKLzRK"}],"key":"iZoQvDt8wg"},{"type":"block","position":{"start":{"line":373,"column":1},"end":{"line":373,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"children":[{"type":"text","value":"Launch and initialize Firefly","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"key":"x1XsO0J8ZV"}],"identifier":"launch-and-initialize-firefly","label":"Launch and initialize Firefly","html_id":"launch-and-initialize-firefly","implicit":true,"key":"iMlHmhZouh"},{"type":"paragraph","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"children":[{"type":"text","value":"There are two ways to initialize a Firefly client from Python, depending on whether you’re running the notebook in JupyterLab or not. Assuming you have ","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"key":"VKDoZlwFkl"},{"type":"inlineCode","value":"jupyter-firefly-extensions","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"key":"UTgmePOpMR"},{"type":"text","value":" set up in your environment as explained ","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"key":"tSzsbNpGLr"},{"type":"link","url":"https://github.com/Caltech-IPAC/jupyter_firefly_extensions/blob/master/README.md","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"key":"LFnbOFA3dL"}],"urlSource":"https://github.com/Caltech-IPAC/jupyter_firefly_extensions/blob/master/README.md","data":{"kind":"file","org":"Caltech-IPAC","repo":"jupyter_firefly_extensions","reference":"master","file":"README.md","raw":"https://raw.githubusercontent.com/Caltech-IPAC/jupyter_firefly_extensions/master/README.md"},"internal":false,"protocol":"github","key":"cyiYxH2GXL"},{"type":"text","value":", you can use ","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"key":"lOFVcyDLdh"},{"type":"inlineCode","value":"make_lab_client()","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"key":"Ln3dGBvRhY"},{"type":"text","value":" in JupyterLab, which will open the Firefly viewer in a new tab within the Lab. Otherwise, you can use ","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"key":"C5JGvZGmnj"},{"type":"inlineCode","value":"make_client()","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"key":"tkkcTuzSlh"},{"type":"text","value":" in a Jupyter Notebook (or even a Python shell), which will open the Firefly viewer in a new web browser tab.","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"key":"PPLHmcOFMg"}],"key":"mbxRSybL5I"},{"type":"paragraph","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"children":[{"type":"text","value":"You also need a Firefly server to communicate with your Firefly Python client. In this notebook, we use a public Firefly server: the IRSA Viewer (","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"GbzQVqFORM"},{"type":"link","url":"https://irsa.ipac.caltech.edu/irsaviewer","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"children":[{"type":"text","value":"https://​irsa​.ipac​.caltech​.edu​/irsaviewer","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"S6s8d5Stq8"}],"urlSource":"https://irsa.ipac.caltech.edu/irsaviewer","key":"Vqi5Eix3tl"},{"type":"text","value":"). However, you can also run a local Firefly server via a ","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"hn4G4npHk1"},{"type":"link","url":"https://hub.docker.com/r/ipac/firefly","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"children":[{"type":"text","value":"Firefly Docker image","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"ZBcSG4fP73"}],"urlSource":"https://hub.docker.com/r/ipac/firefly","key":"K5o7pvumfl"},{"type":"text","value":" and access it at ","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"C8NOdqshaV"},{"type":"inlineCode","value":"http://localhost:8080/firefly","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"IUwK1ylkqU"},{"type":"text","value":". The URL of the Firefly server is read by both ","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"UEGFNi5OrD"},{"type":"inlineCode","value":"make_client()","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"zsb6m7CPhi"},{"type":"text","value":" and ","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"jfyrdM7ZmH"},{"type":"inlineCode","value":"make_lab_client()","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"CFLJwBtA5C"},{"type":"text","value":" through the environment variable ","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"CfmqS8hOXw"},{"type":"inlineCode","value":"FIREFLY_URL","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"drsRmmAMwW"},{"type":"text","value":". However, ","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"zi200iImF4"},{"type":"inlineCode","value":"make_client()","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"c7Akz1pyFw"},{"type":"text","value":" also allows you to pass the URL directly as the ","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"d65DFkS9Xw"},{"type":"inlineCode","value":"url","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"fF66UMnk2O"},{"type":"text","value":" parameter.","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"Ap0qak6iij"}],"key":"yK08ZKuHKr"}],"key":"wKIMvb6WoL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Uncomment when using within Jupyter Lab with jupyter_firefly_extensions installed\n# fc = FireflyClient.make_lab_client()\n\n# Uncomment for contexts other than above \nfc = FireflyClient.make_client(url=\"https://irsa.ipac.caltech.edu/irsaviewer\")\n\nfc.reinit_viewer() # to clean the state, if this cell ran earlier","key":"FnBLJjm7BQ"},{"type":"output","id":"_2JNMq6C2JfTIXpCgc0KD","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cIPython.core.display.HTML object\u003e","content_type":"text/plain"},"text/html":{"content":"Open your web browser to \u003ca href=\"https://irsa.ipac.caltech.edu/irsaviewer/?__wsch=MjAyNS0wOS0yNg\"\" target=\"_blank\"\u003ethis link\u003c/a\u003e","content_type":"text/html"}}},{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/plain":{"content":"{'success': True}","content_type":"text/plain"}}}],"key":"B1wB73sRda"}],"key":"GJtzDwVVah"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"children":[{"type":"text","value":"Send the simulated Rubin coadd to Firefly using show_fits.","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"YM7TbqvCXZ"}],"identifier":"send-the-simulated-rubin-coadd-to-firefly-using-show-fits","label":"Send the simulated Rubin coadd to Firefly using show_fits.","html_id":"send-the-simulated-rubin-coadd-to-firefly-using-show-fits","implicit":true,"key":"oSqZhxHHDT"},{"type":"paragraph","position":{"start":{"line":392,"column":1},"end":{"line":392,"column":1}},"children":[{"type":"text","value":"For displaying the FITS image of Rubin coadd in Firefly, we use ","position":{"start":{"line":392,"column":1},"end":{"line":392,"column":1}},"key":"R8p8EutQSH"},{"type":"link","url":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.show_fits","position":{"start":{"line":392,"column":1},"end":{"line":392,"column":1}},"children":[{"type":"inlineCode","value":"show_fits","position":{"start":{"line":392,"column":1},"end":{"line":392,"column":1}},"key":"hWGNWHFanP"}],"urlSource":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.show_fits","key":"U4SWkFRntx"},{"type":"text","value":":","position":{"start":{"line":392,"column":1},"end":{"line":392,"column":1}},"key":"rmIrwYzi64"}],"key":"Uxv1R5pP8z"}],"key":"IDfm49XrVV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"coadd_ff_id_rubin = 'rubin-coadd-filter-r'\nfc.show_fits(url=https_url(coadd_s3_fpath_rubin),\n             plot_id=coadd_ff_id_rubin,\n             Title=\"Rubin Coadd\"\n             )","key":"bSithZRQON"},{"type":"output","id":"tLvIZx4xwLkD2aqOoK8wa","data":[{"output_type":"stream","name":"stdout","text":"WARNING: show_fits() is deprecated. Use show_fits_image() instead.\nWARNING: url is deprecated, use file_input parameter instead\n"},{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/plain":{"content":"{'success': True}","content_type":"text/plain"}}}],"key":"AWhbCSfJxA"}],"key":"IVhKUeaQS6"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":402,"column":1},"end":{"line":402,"column":1}},"children":[{"type":"text","value":"Use ds9 region syntax to overplot the simulated Roman image blocks on the interactive display","position":{"start":{"line":402,"column":1},"end":{"line":402,"column":1}},"key":"UImfSgBuGk"}],"identifier":"use-ds9-region-syntax-to-overplot-the-simulated-roman-image-blocks-on-the-interactive-display","label":"Use ds9 region syntax to overplot the simulated Roman image blocks on the interactive display","html_id":"use-ds9-region-syntax-to-overplot-the-simulated-roman-image-blocks-on-the-interactive-display","implicit":true,"key":"Xqzd03w24X"},{"type":"paragraph","position":{"start":{"line":404,"column":1},"end":{"line":405,"column":1}},"children":[{"type":"text","value":"The Firefly client includes several methods related to controlling ds9 region overlays. To\noverlay a region layer on the loaded FITS images, we can use ","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"key":"lGtPVwVncx"},{"type":"link","url":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.overlay_region_layer","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"children":[{"type":"inlineCode","value":"overlay_region_layer","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"key":"gidilprTUg"}],"urlSource":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.overlay_region_layer","key":"jIzLHQg9xr"},{"type":"text","value":".","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"key":"x2A5oXq85Z"}],"key":"F6wfwcCfuh"},{"type":"paragraph","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"children":[{"type":"text","value":"Region data is defined in ds9 region syntax that can be found ","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"S2dbUEt3XD"},{"type":"link","url":"https://ds9.si.edu/doc/ref/region.html","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"FMPIgCBS9l"}],"urlSource":"https://ds9.si.edu/doc/ref/region.html","key":"l7KybQ9MrX"},{"type":"text","value":".","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"xCUTUCh6Ab"}],"key":"BSIisso54u"}],"key":"teAZWtM21Y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# mark the roman coadd blocks as boxes\nroman_regions = [\n    f'icrs;box {ra_block_center.value}d {dec_block_center.value}d {block_size.value}\" {block_size.value}\" 0d'\n    for (ra_block_center, dec_block_center) in product(ra_block_centers, dec_block_centers)\n]\n\nroman_regions_id = 'roman_regions'\nfc.overlay_region_layer(region_data=roman_regions,\n                        title='Roman Mosiac', \n                        region_layer_id=roman_regions_id)","key":"Ca83fdOkIk"},{"type":"output","id":"k4yDKbS8l_XNueeGehGej","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/plain":{"content":"{'success': True}","content_type":"text/plain"}}}],"key":"NTgM3YMB5x"}],"key":"Z0eeDBkCh4"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"children":[{"type":"text","value":"Use Firefly’s pan and zoom capabilities to locate a region of interest (a blended source)","position":{"start":{"line":422,"column":1},"end":{"line":422,"column":1}},"key":"A1Y3XQH41j"}],"identifier":"use-fireflys-pan-and-zoom-capabilities-to-locate-a-region-of-interest-a-blended-source","label":"Use Firefly’s pan and zoom capabilities to locate a region of interest (a blended source)","html_id":"use-fireflys-pan-and-zoom-capabilities-to-locate-a-region-of-interest-a-blended-source","implicit":true,"key":"CBEm9XMQIS"},{"type":"paragraph","position":{"start":{"line":424,"column":1},"end":{"line":424,"column":1}},"children":[{"type":"text","value":"You can view the coordinates of your mouse pointer at the bottom left of the display window. To copy the coordinates for a specific coordinate:","position":{"start":{"line":424,"column":1},"end":{"line":424,"column":1}},"key":"SM4QyiqaI7"}],"key":"MMlLWyC50C"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":426,"column":1},"end":{"line":430,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":426,"column":1},"end":{"line":426,"column":1}},"children":[{"type":"text","value":"Toggle the “Click Lock” to “on” in the bottom right of the image display.","position":{"start":{"line":426,"column":1},"end":{"line":426,"column":1}},"key":"MCaSQL1f3Q"}],"key":"RkKdY1GxDK"},{"type":"listItem","spread":true,"position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"children":[{"type":"text","value":"Click on the position of interest, and notice that the coordinate display is now frozen.","position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"key":"cf36Qugdl7"}],"key":"yPtIxcfwGa"},{"type":"listItem","spread":true,"position":{"start":{"line":428,"column":1},"end":{"line":428,"column":1}},"children":[{"type":"text","value":"Click on “EQ-J2000”, the coordinate label in the bottom left of the image display. In the dialog that opens, change copy options to “[Python] Astropy SkyCoord” so that we can directly work with them in python.","position":{"start":{"line":428,"column":1},"end":{"line":428,"column":1}},"key":"ICiZU6hBrB"}],"key":"E1vIHmIypW"},{"type":"listItem","spread":true,"position":{"start":{"line":429,"column":1},"end":{"line":430,"column":1}},"children":[{"type":"text","value":"Close the dialog and click on the copy icon next to the coordinate values display.","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"key":"lNseCsFvrW"}],"key":"K5zRNbrvkG"}],"key":"eg87w0ju14"}],"key":"mWAQraREmU"},{"type":"block","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":433,"column":1},"end":{"line":433,"column":1}},"children":[{"type":"text","value":"Copy the coordinates from the coordinate display to the Python notebook","position":{"start":{"line":433,"column":1},"end":{"line":433,"column":1}},"key":"KeLxnJn7Cd"}],"identifier":"copy-the-coordinates-from-the-coordinate-display-to-the-python-notebook","label":"Copy the coordinates from the coordinate display to the Python notebook","html_id":"copy-the-coordinates-from-the-coordinate-display-to-the-python-notebook","implicit":true,"key":"If2QVc633s"},{"type":"paragraph","position":{"start":{"line":435,"column":1},"end":{"line":435,"column":1}},"children":[{"type":"text","value":"We have provided an example. You can change this based on your interests.","position":{"start":{"line":435,"column":1},"end":{"line":435,"column":1}},"key":"FOP1D8oKKD"}],"key":"Ksn9kouBZa"}],"key":"Y6dicfAU10"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"coords_of_interest = SkyCoord('0h38m25.35s -44d00m10.1s', frame='icrs') # located and copied through UI\ncoords_of_interest","key":"QyI9jNUmgb"},{"type":"output","id":"WUxjaQz9I-aM3D4_UuJti","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/plain":{"content":"\u003cSkyCoord (ICRS): (ra, dec) in deg\n    (9.605625, -44.00280556)\u003e","content_type":"text/plain"}}}],"key":"yeHxyYBTKy"}],"key":"qmiP1UvbHu"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"children":[{"type":"text","value":"We can now use this ","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"key":"XGaoJnRGah"},{"type":"link","url":"https://docs.astropy.org/en/stable/api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"children":[{"type":"text","value":"astropy ","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"key":"wwLsY33kMp"},{"type":"inlineCode","value":"SkyCoord","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"key":"q3FJibf69P"},{"type":"text","value":" object","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"key":"jhunPwSFm0"}],"urlSource":"https://docs.astropy.org/en/stable/api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord","key":"LcFnROHh90"},{"type":"text","value":" to compare our coadds.","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"key":"usnOOH4XB9"}],"key":"ZSQe7VVfSw"}],"key":"acCZzSQcoD"},{"type":"block","position":{"start":{"line":444,"column":1},"end":{"line":444,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":446,"column":1},"end":{"line":446,"column":1}},"children":[{"type":"text","value":"Use ds9 region syntax to overplot the selected position","position":{"start":{"line":446,"column":1},"end":{"line":446,"column":1}},"key":"bJ6AGXse4K"}],"identifier":"use-ds9-region-syntax-to-overplot-the-selected-position","label":"Use ds9 region syntax to overplot the selected position","html_id":"use-ds9-region-syntax-to-overplot-the-selected-position","implicit":true,"key":"cCAXSa17zw"},{"type":"paragraph","position":{"start":{"line":448,"column":1},"end":{"line":448,"column":1}},"children":[{"type":"text","value":"For this we use the id of the region layer we defined above, and add more region data using ","position":{"start":{"line":448,"column":1},"end":{"line":448,"column":1}},"key":"XOZmhbF4B1"},{"type":"link","url":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.add_region_data","position":{"start":{"line":448,"column":1},"end":{"line":448,"column":1}},"children":[{"type":"inlineCode","value":"add_region_data","position":{"start":{"line":448,"column":1},"end":{"line":448,"column":1}},"key":"F54VO5o0at"}],"urlSource":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.add_region_data","key":"km3Az7BqLs"},{"type":"text","value":".","position":{"start":{"line":448,"column":1},"end":{"line":448,"column":1}},"key":"YgWlnwjRtq"}],"key":"KSgV4DJdeS"}],"key":"PWJEn6ezg3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"point_region = f'icrs;point {coords_of_interest.ra.value}d {coords_of_interest.dec.value}d # point=cross 15 text={{Blended source}}'\nfc.add_region_data(region_data=point_region, region_layer_id=roman_regions_id)","key":"fdR1Wcq48P"},{"type":"output","id":"0cyKppvnfTFy78cDSqGN5","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/plain":{"content":"{'success': True}","content_type":"text/plain"}}}],"key":"L4qBCnKVym"}],"key":"gGf0EWdnRY"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"children":[{"type":"text","value":"Plot cutouts of the identified blended source","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"key":"F283YGOj9N"}],"identifier":"plot-cutouts-of-the-identified-blended-source","label":"Plot cutouts of the identified blended source","html_id":"plot-cutouts-of-the-identified-blended-source","implicit":true,"key":"r6NZ3VGf0L"}],"key":"gjY2600XnT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"coadd_roman = get_roman_coadd(coords_of_interest, filter_roman)","key":"gJhIXZe6j2"},{"type":"output","id":"r5hkMRgPZJl29SHfE96Fr","data":[],"key":"gOEiEoIdhw"}],"key":"nJHXgMPEDI"},{"type":"block","children":[],"key":"UlWAfMlhG0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cutout_size = 20*u.arcsec","key":"Q7E9sNahUq"},{"type":"output","id":"8UVz_B5lzlOlDHlZrk4uj","data":[],"key":"GUFDejVh6i"}],"key":"qtdRvskEWC"},{"type":"block","children":[],"key":"chMp1LzSIE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cutout_roman = Cutout2D(coadd_roman['data'], coords_of_interest, size=cutout_size, wcs=coadd_roman['wcs'])\ncutout_rubin = Cutout2D(coadd_rubin['data'], coords_of_interest, size=cutout_size, wcs=coadd_rubin['wcs'])","key":"QeS1byvXcW"},{"type":"output","id":"JFQXsMQ13wcKOs5cOraBX","data":[],"key":"L8sWjyaciS"}],"key":"RFwQMbF5Jl"},{"type":"block","children":[],"key":"DM6VeNGUAQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, axs = plt.subplots(1, 2, figsize=(12, 6))\n\naxs[0].imshow(cutout_roman.data, origin='lower', \n              clim=stretch_color(cutout_roman.data, .5)\n              )\naxs[0].set_title(f\"ROMAN in filter {filter_roman}\")\n\n# Let's also encircle the blended source we identified \naxs[0].add_patch(patches.Circle(coord_to_xy(cutout_roman.wcs, coords_of_interest), \n                                radius=50, color='r', fill=False, linewidth=2))\n# and a bonus blended source that is close to it\nother_coords = SkyCoord(coords_of_interest.ra-9.2*u.arcsec, coords_of_interest.dec+5*u.arcsec)\naxs[0].add_patch(patches.Circle(coord_to_xy(cutout_roman.wcs, other_coords),\n                                radius=36, color='cyan', fill=False, linewidth=2))\n\n\naxs[1].imshow(cutout_rubin.data, origin='lower', \n              clim=stretch_color(cutout_rubin.data, .5)\n              )\naxs[1].set_title(f\"RUBIN in filter {filter_rubin}\")\n\n# Let's also encircle the source we identified \naxs[1].add_patch(patches.Circle(coord_to_xy(cutout_rubin.wcs, coords_of_interest),\n                                radius=10, color='r', fill=False, linewidth=2))\naxs[1].add_patch(patches.Circle(coord_to_xy(cutout_rubin.wcs, other_coords),\n                                radius=8, color='cyan', fill=False, linewidth=2))\n\n\nfig.suptitle(f\"Cutouts at ({coords_of_interest.ra:6f}, {coords_of_interest.dec:6f}) with {cutout_size} size\", fontsize=14);\nplt.tight_layout(rect=[0, 0, 1, 0.97])\n# plt.savefig(\"plot.pdf\", bbox_inches='tight', pad_inches=0.2)","key":"FaKDgOWRBk"},{"type":"output","id":"PN6Jcyt7U51-Pn3y01r2f","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 1200x600 with 2 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"a0ca8138ab696115e58c40dae5cc254e","path":"/build/a0ca8138ab696115e58c40dae5cc254e.png"}}}],"key":"OHqJxmNMjX"}],"key":"smXRA20Em2"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":504,"column":1},"end":{"line":504,"column":1}},"children":[{"type":"text","value":"Use Firefly to visualize the OpenUniverse2024 data preview catalogs","position":{"start":{"line":504,"column":1},"end":{"line":504,"column":1}},"key":"m9SK6rRfyG"}],"identifier":"use-firefly-to-visualize-the-openuniverse2024-data-preview-catalogs","label":"Use Firefly to visualize the OpenUniverse2024 data preview catalogs","html_id":"use-firefly-to-visualize-the-openuniverse2024-data-preview-catalogs","implicit":true,"key":"iMcVq1bkDw"},{"type":"paragraph","position":{"start":{"line":505,"column":1},"end":{"line":505,"column":1}},"children":[{"type":"text","value":"Let’s inspect the properties of sources in the Rubin coadd image. For this we will use the input truth files present in S3 bucket.","position":{"start":{"line":505,"column":1},"end":{"line":505,"column":1}},"key":"fDgBSz3Dpa"}],"key":"gEPmB18yB6"},{"type":"paragraph","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"children":[{"type":"text","value":"The OpenUniverse2024 data preview includes the input truth files that were used to create the simulated images. These files are in Parquet and HDF5 format, and include information about the properties of galaxies, stars, and transients.","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"key":"fOC2TfGfOS"}],"key":"kPgIINnyv8"},{"type":"paragraph","position":{"start":{"line":509,"column":1},"end":{"line":510,"column":1}},"children":[{"type":"text","value":"To list the available files, we use ","position":{"start":{"line":509,"column":1},"end":{"line":509,"column":1}},"key":"yswqtc7vzj"},{"type":"link","url":"https://s3fs.readthedocs.io/en/latest/index.html","position":{"start":{"line":509,"column":1},"end":{"line":509,"column":1}},"children":[{"type":"text","value":"s3fs","position":{"start":{"line":509,"column":1},"end":{"line":509,"column":1}},"key":"yVlbBUrEL7"}],"urlSource":"https://s3fs.readthedocs.io/en/latest/index.html","key":"a67pElSlYz"},{"type":"text","value":". We open a file-system like connection\nto AWS S3 and then simply list (","position":{"start":{"line":509,"column":1},"end":{"line":509,"column":1}},"key":"IhHwFCbFzA"},{"type":"inlineCode","value":"ls","position":{"start":{"line":509,"column":1},"end":{"line":509,"column":1}},"key":"nNM0TdSNtF"},{"type":"text","value":") truth files directory:","position":{"start":{"line":509,"column":1},"end":{"line":509,"column":1}},"key":"wPsVinsyFh"}],"key":"oO4BItqayx"}],"key":"Sna5aP8e0U"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"s3 = s3fs.S3FileSystem(anon=True) # to browse s3 bucket\ns3.ls(f\"{BUCKET_NAME}/{TRUTH_FILES_PATH}\")","key":"pjKC2gHTZI"},{"type":"output","id":"k1Rgj1iyj_qDlrvxxIDea","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"text/plain":{"content":"['nasa-irsa-simulations/openuniverse2024/roman/preview/roman_rubin_cats_v1.1.2_faint/galaxy_10307.parquet',\n 'nasa-irsa-simulations/openuniverse2024/roman/preview/roman_rubin_cats_v1.1.2_faint/galaxy_flux_10307.parquet',\n 'nasa-irsa-simulations/openuniverse2024/roman/preview/roman_rubin_cats_v1.1.2_faint/galaxy_sed_10307.hdf5',\n 'nasa-irsa-simulations/openuniverse2024/roman/preview/roman_rubin_cats_v1.1.2_faint/pointsource_10307.parquet',\n 'nasa-irsa-simulations/openuniverse2024/roman/preview/roman_rubin_cats_v1.1.2_faint/pointsource_flux_10307.parquet',\n 'nasa-irsa-simulations/openuniverse2024/roman/preview/roman_rubin_cats_v1.1.2_faint/snana_10307.hdf5',\n 'nasa-irsa-simulations/openuniverse2024/roman/preview/roman_rubin_cats_v1.1.2_faint/snana_10307.parquet']","content_type":"text/plain"}}}],"key":"C6aJ6RtJbO"}],"key":"lVkTdKfkkM"},{"type":"block","children":[],"key":"RceQ5v0PkK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Catalog table of star properties (in parquet format)\npointsource_cat_path = f\"{BUCKET_NAME}/{TRUTH_FILES_PATH}/pointsource_10307.parquet\"\npointsource_cat_path","key":"P0tvdCdAgY"},{"type":"output","id":"947yEByRvfObAlJVmourJ","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/plain":{"content":"'nasa-irsa-simulations/openuniverse2024/roman/preview/roman_rubin_cats_v1.1.2_faint/pointsource_10307.parquet'","content_type":"text/plain"}}}],"key":"Ug1CJHeXq1"}],"key":"YOiBvVZ0ed"},{"type":"block","children":[],"key":"IQyIDF5hFc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Catalog table of galaxy properties (in parquet format)\ngalaxy_cat_path = f\"{BUCKET_NAME}/{TRUTH_FILES_PATH}/galaxy_10307.parquet\"\ngalaxy_cat_path","key":"tWAzKykWZT"},{"type":"output","id":"Gqgg-J9FvP91YtaIzoPrG","data":[{"output_type":"execute_result","execution_count":38,"metadata":{},"data":{"text/plain":{"content":"'nasa-irsa-simulations/openuniverse2024/roman/preview/roman_rubin_cats_v1.1.2_faint/galaxy_10307.parquet'","content_type":"text/plain"}}}],"key":"LnriP6OEra"}],"key":"UrGwsVX3wQ"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":529,"column":1},"end":{"line":529,"column":1}},"children":[{"type":"text","value":"Use Firefly’s show_table to overlay the catalogs on interactive image of coadd","position":{"start":{"line":529,"column":1},"end":{"line":529,"column":1}},"key":"jMp7hiWe03"}],"identifier":"use-fireflys-show-table-to-overlay-the-catalogs-on-interactive-image-of-coadd","label":"Use Firefly’s show_table to overlay the catalogs on interactive image of coadd","html_id":"use-fireflys-show-table-to-overlay-the-catalogs-on-interactive-image-of-coadd","implicit":true,"key":"Coi0HoxkAi"},{"type":"paragraph","position":{"start":{"line":531,"column":1},"end":{"line":531,"column":1}},"children":[{"type":"text","value":"The input truth files cover a region much larger than the data preview, so we define filters on table to constraint the sources in catalog within the ra and dec bounds of preview data. (Note: you can remove filters through the table UI if you wish to see the entire data)","position":{"start":{"line":531,"column":1},"end":{"line":531,"column":1}},"key":"WedokXrf14"}],"key":"WLXdzFEl7l"}],"key":"Os0giFw7iz"},{"type":"block","position":{"start":{"line":533,"column":1},"end":{"line":533,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":535,"column":1},"end":{"line":535,"column":1}},"children":[{"type":"text","value":"You can visualize catalogs interactively with Firefly using ","position":{"start":{"line":535,"column":1},"end":{"line":535,"column":1}},"key":"zsxGmRhh3K"},{"type":"link","url":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.show_table","position":{"start":{"line":535,"column":1},"end":{"line":535,"column":1}},"children":[{"type":"inlineCode","value":"show_table","position":{"start":{"line":535,"column":1},"end":{"line":535,"column":1}},"key":"Gj5SiUHdhs"}],"urlSource":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.show_table","key":"NmsPRyUqXJ"},{"type":"text","value":". This capability can take many parameters. Here we will simply send our catalog to Firefly so that we can (a) see an interactive table; (b) see this table plotted over the image that we’ve already sent; and (c) use the GUI to quickly create exploratory plots. See if you can use the GUI to quickly determine approximately how many galaxies cover the Rubin image and what the redshift distribution of these galaxies is.","position":{"start":{"line":535,"column":1},"end":{"line":535,"column":1}},"key":"JFlZYbij4w"}],"key":"rU9arLFv4l"}],"key":"l6hI02i3Zc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cat_filters = [\n    f'(\"ra\" \u003e= {ra_block_centers.min().value} AND \"ra\" \u003c= {ra_block_centers.max().value})', \n    f'(\"dec\" \u003e= {dec_block_centers.min().value} AND \"dec\" \u003c= {dec_block_centers.max().value})'\n]\ncat_filters","key":"K8hu6SkT7m"},{"type":"output","id":"W8iHzdu6THZ7FZg9m7FxL","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/plain":{"content":"['(\"ra\" \u003e= 9.336711625789874 AND \"ra\" \u003c= 9.76330352298415)',\n '(\"dec\" \u003e= -44.252584927082495 AND \"dec\" \u003c= -43.94703111591591)']","content_type":"text/plain"}}}],"key":"aUaB2cV1A7"}],"key":"jDncKXhZco"},{"type":"block","children":[],"key":"hbYLQSivQz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fc.show_table(url=https_url(pointsource_cat_path),\n              title='Stars Catalog',\n              tbl_id='stars_cat',\n              filters=\" AND \".join(cat_filters))","key":"YBBWJo1n9E"},{"type":"output","id":"jnDTZ8342ZC6rZI_n-nza","data":[{"output_type":"stream","name":"stdout","text":"WARNING: url is deprecated, use file_input parameter instead\n"},{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"text/plain":{"content":"{'success': True}","content_type":"text/plain"}}}],"key":"tyGqrtjAG0"}],"key":"jak7LoXqNS"},{"type":"block","children":[],"key":"JLOzrrUp37"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"gal_cat_tbl_id = 'galaxy_cat'\n\n# may take ~1.25min, because galaxy catalog is a big file\nfc.show_table(url=https_url(galaxy_cat_path),\n              title='Galaxy Catalog',\n              tbl_id=gal_cat_tbl_id,\n              filters=\" AND \".join(cat_filters))","key":"BYRoCwWzWU"},{"type":"output","id":"GXsvgnIXrgiC7wu6UeeRb","data":[{"output_type":"stream","name":"stdout","text":"WARNING: url is deprecated, use file_input parameter instead\n"},{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"text/plain":{"content":"{'success': True}","content_type":"text/plain"}}}],"key":"sjfwzZTvtg"}],"key":"MCgB8XlV1N"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":562,"column":1},"end":{"line":562,"column":1}},"children":[{"type":"text","value":"For each row in the table you can notice a marker in the image. Selecting a row or marker changes the corresponding marker or row, respectively. You can click on “Details” tab in the UI to show properties of each source selected in image/table.","position":{"start":{"line":562,"column":1},"end":{"line":562,"column":1}},"key":"D4N9n6q34M"}],"key":"aedb7ggeol"},{"type":"heading","depth":3,"position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"children":[{"type":"text","value":"Use Firefly’s apply_table_filters to show only high-redshift galaxies","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"a6h9h4jBp4"}],"identifier":"use-fireflys-apply-table-filters-to-show-only-high-redshift-galaxies","label":"Use Firefly’s apply_table_filters to show only high-redshift galaxies","html_id":"use-fireflys-apply-table-filters-to-show-only-high-redshift-galaxies","implicit":true,"key":"aTzyWZBGhT"},{"type":"paragraph","position":{"start":{"line":566,"column":1},"end":{"line":566,"column":1}},"children":[{"type":"text","value":"High redshift galaxies are the most interesting, so let’s filter the table we sent to Firefly to only include z\u003e3 galaxies. Notice how the table display and image overlay change. Notice how the chart becomes a scatterplot from a heatmap because the sources reduce. You can remove this filter or add new ones through the GUI.","position":{"start":{"line":566,"column":1},"end":{"line":566,"column":1}},"key":"WplPoht05s"}],"key":"iZpsfkLeVa"},{"type":"paragraph","position":{"start":{"line":568,"column":1},"end":{"line":568,"column":1}},"children":[{"type":"text","value":"For filtering, we will use ","position":{"start":{"line":568,"column":1},"end":{"line":568,"column":1}},"key":"DTgF8u5AVa"},{"type":"link","url":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.apply_table_filters","position":{"start":{"line":568,"column":1},"end":{"line":568,"column":1}},"children":[{"type":"inlineCode","value":"apply_table_filters","position":{"start":{"line":568,"column":1},"end":{"line":568,"column":1}},"key":"yechtlEPio"}],"urlSource":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.apply_table_filters","key":"M6cYkocD0w"},{"type":"text","value":" method on the galaxy table we loaded above.","position":{"start":{"line":568,"column":1},"end":{"line":568,"column":1}},"key":"Aw0DloUyVl"}],"key":"G4Z8aCPQRK"}],"key":"QQsSfXYPTk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fc.apply_table_filters(tbl_id=gal_cat_tbl_id,\n                       filters=\" AND \".join(cat_filters+['\"redshift\" \u003e 3']))","key":"nvXKEKshbo"},{"type":"output","id":"096cI-xBwiTwzn0BoEJw0","data":[{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"text/plain":{"content":"{'success': True}","content_type":"text/plain"}}}],"key":"lAsJ36BrYh"}],"key":"zhxVybOwYe"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":575,"column":1},"end":{"line":575,"column":1}},"children":[{"type":"text","value":"You can play with the filters directly from the UI as well. Try removing adding more filters in the tables and see how markers change.","position":{"start":{"line":575,"column":1},"end":{"line":575,"column":1}},"key":"Brx4gx91aS"}],"key":"ovArHrHGJO"}],"key":"x5SUuhNIxJ"},{"type":"block","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"children":[{"type":"text","value":"Use Firefly’s show_fits_3color to create a 3 color image of the simulated Rubin images","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"zFhtpMwO8i"}],"identifier":"use-fireflys-show-fits-3color-to-create-a-3-color-image-of-the-simulated-rubin-images","label":"Use Firefly’s show_fits_3color to create a 3 color image of the simulated Rubin images","html_id":"use-fireflys-show-fits-3color-to-create-a-3-color-image-of-the-simulated-rubin-images","implicit":true,"key":"wvRCyZzAgl"}],"key":"u3fRadxVRN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# [R, G, B]\nROMAN_RGB_FILTERS = ['H158', 'J129', 'Y106']\nRUBIN_RGB_FILTERS = ['r', 'g', 'u']","key":"RQaqY3zlBb"},{"type":"output","id":"t35IgfUwD35kq50i9l_o6","data":[],"key":"K6HZvI2wKA"}],"key":"c9FFJ0fFsS"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"children":[{"type":"text","value":"We already have Rubin coadd with catalog overlaid, let’s make a 3 color image to see colors of marked objects more clearly. For this we will use ","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"key":"MY2IRwuZYY"},{"type":"link","url":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.show_fits_3color","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"children":[{"type":"inlineCode","value":"show_fits_3color","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"key":"M7Xy23ww1Y"}],"urlSource":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.show_fits_3color","key":"Fpwa7ztlJM"},{"type":"text","value":" method:","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"key":"gTqeSxlBCi"}],"key":"NHNt6M9GQl"}],"key":"WWG5BGd0v3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"coadd_ff_id_rubin_3color = 'rubin-coadd-3color'\nthreeC = [\n    dict(url=https_url(get_rubin_coadd_fpath(filter_name)),\n         Title=\"Rubin Coadd 3 color\")\n    for filter_name in RUBIN_RGB_FILTERS\n]\n\nfc.show_fits_3color(three_color_params=threeC,\n                    plot_id=coadd_ff_id_rubin_3color)","key":"rUuolNwlcY"},{"type":"output","id":"9gEmJOZmRlmz6dyMaLgGG","data":[{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/plain":{"content":"{'success': True}","content_type":"text/plain"}}}],"key":"pHsSGRePTx"}],"key":"dsZuVfvrBn"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":601,"column":1},"end":{"line":601,"column":1}},"children":[{"type":"text","value":"Use Firefly’s interactivity to identify a region of interest","position":{"start":{"line":601,"column":1},"end":{"line":601,"column":1}},"key":"YOBjclkGeH"}],"identifier":"use-fireflys-interactivity-to-identify-a-region-of-interest","label":"Use Firefly’s interactivity to identify a region of interest","html_id":"use-fireflys-interactivity-to-identify-a-region-of-interest","implicit":true,"key":"PKaCrw7yck"},{"type":"paragraph","position":{"start":{"line":603,"column":1},"end":{"line":603,"column":1}},"children":[{"type":"text","value":"For example, we found a region of the sky that seems to have a high number of high redshift sources and we copy it from the image display:","position":{"start":{"line":603,"column":1},"end":{"line":603,"column":1}},"key":"Xja6OQIgLw"}],"key":"vHPIQt8Wx9"}],"key":"vXllp4Om5T"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# located and copied through UI\nhigh_z_gal_coords = SkyCoord('0h38m00.77s -44d12m10.2s', frame='icrs')\nhigh_z_gal_coords","key":"OV6YwMyiuH"},{"type":"output","id":"3rL7Rbgc98of2kDak-Fve","data":[{"output_type":"execute_result","execution_count":45,"metadata":{},"data":{"text/plain":{"content":"\u003cSkyCoord (ICRS): (ra, dec) in deg\n    (9.50320833, -44.20283333)\u003e","content_type":"text/plain"}}}],"key":"RKmpDbaxc2"}],"key":"v7d8fDlMD8"},{"type":"block","children":[],"key":"u0DS8XdOfZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# let's also mark it in our region layer, so that it's easy to pinpoint later\npoint_region = f'icrs;point {high_z_gal_coords.ra.value}d {high_z_gal_coords.dec.value}d # point=cross 15 text={{z\u003e3 mock galaxies}}'\nfc.add_region_data(region_data=point_region, region_layer_id=roman_regions_id)","key":"LLvpdvNbSn"},{"type":"output","id":"-9kbFPZZXBkRLg4uxavzF","data":[{"output_type":"execute_result","execution_count":46,"metadata":{},"data":{"text/plain":{"content":"{'success': True}","content_type":"text/plain"}}}],"key":"D03DDGO9Qt"}],"key":"gEjnwa7F3P"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":617,"column":1},"end":{"line":617,"column":1}},"children":[{"type":"text","value":"Plot 3-color Roman coadd containing your region of interest","position":{"start":{"line":617,"column":1},"end":{"line":617,"column":1}},"key":"uohQuoBIwU"}],"identifier":"plot-3-color-roman-coadd-containing-your-region-of-interest","label":"Plot 3-color Roman coadd containing your region of interest","html_id":"plot-3-color-roman-coadd-containing-your-region-of-interest","implicit":true,"key":"VeJcVtn4Oh"},{"type":"paragraph","position":{"start":{"line":618,"column":1},"end":{"line":618,"column":1}},"children":[{"type":"text","value":"Let’s inspect WCS of Roman coadd first","position":{"start":{"line":618,"column":1},"end":{"line":618,"column":1}},"key":"EGujHXeJzI"}],"key":"TyOKqKWwos"}],"key":"NQWHOnKUBe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"coadd_roman['wcs']","key":"JSlCLMAJNe"},{"type":"output","id":"T6jPjXmFnDZr0kuEpuWKB","data":[{"output_type":"execute_result","execution_count":47,"metadata":{},"data":{"text/plain":{"content":"WCS Keywords\n\nNumber of WCS axes: 2\nCTYPE : 'RA---STG' 'DEC--STG' \nCRVAL : 9.55 -44.1 \nCRPIX : 5184.5 -7615.5 \nPC1_1 PC1_2  : 1.0 0.0 \nPC2_1 PC2_2  : 0.0 1.0 \nCDELT : -1.0850694444444e-05 1.0850694444444e-05 \nNAXIS : 2688  2688  15  1","content_type":"text/plain"}}}],"key":"qq6GgOOosF"}],"key":"xfZSOgKbzx"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":624,"column":1},"end":{"line":624,"column":1}},"children":[{"type":"text","value":"Prepare Roman coadds for displaying in Firefly","position":{"start":{"line":624,"column":1},"end":{"line":624,"column":1}},"key":"k9wn1klgek"}],"identifier":"prepare-roman-coadds-for-displaying-in-firefly","label":"Prepare Roman coadds for displaying in Firefly","html_id":"prepare-roman-coadds-for-displaying-in-firefly","implicit":true,"key":"Yf1dIxc8M5"},{"type":"paragraph","position":{"start":{"line":626,"column":1},"end":{"line":626,"column":1}},"children":[{"type":"text","value":"Roman coadds have STG projection which cannot be read by Firefly yet. Firefly can display any FITS image but it needs to read the WCS for overlaying catalogs and other interactive features. So unlike Rubin 3 color image where we directly passed URL of coadd files to Firefly, we will read Roman coadd files in Python, reproject them from STG to TAN, and write them back to FITS to pass them to Firefly.","position":{"start":{"line":626,"column":1},"end":{"line":626,"column":1}},"key":"j4ur23pybl"}],"key":"JcPXGLYcW1"},{"type":"paragraph","position":{"start":{"line":628,"column":1},"end":{"line":628,"column":1}},"children":[{"type":"text","value":"Let’s first define functions to do so:","position":{"start":{"line":628,"column":1},"end":{"line":628,"column":1}},"key":"BDz496i5g6"}],"key":"KDmMHPM7nZ"}],"key":"q46nEhkluK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def reproject_to_TAN(coadd_roman):\n    # Define a new WCS with TAN projection (in CTYPE key)\n    output_wcs = coadd_roman['wcs'].deepcopy()\n    output_wcs.wcs.ctype = [ctype.replace('STG', 'TAN') for ctype in coadd_roman['wcs'].wcs.ctype]\n    \n    # Use reproject to convert a given data and wcs, to a desired wcs and shape\n    reprojected_data, _ = reproject_interp(\n        (coadd_roman['data'], coadd_roman['wcs']),\n        output_projection=output_wcs,\n        shape_out=coadd_roman['data'].shape\n    )\n\n    return {'data': reprojected_data, 'wcs': output_wcs}","key":"sLanMKF1WD"},{"type":"output","id":"jimiaZ2cjE0cDm1jKhJdu","data":[],"key":"tgCkf1XpLD"}],"key":"uM9eoJAXYc"},{"type":"block","children":[],"key":"Fa1MyBbv3H"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def get_fits_stream(coadd_roman):\n    # Create a FITS PrimaryHDU object with the coadd data\n    hdu = fits.PrimaryHDU(data=coadd_roman['data'], header=coadd_roman['wcs'].to_header())\n\n    # Write the HDU to the in-memory stream (to save I/O time)\n    fits_stream = BytesIO()\n    hdu.writeto(fits_stream, overwrite=True)\n    fits_stream.seek(0) # to bring reading pointer to the beginning of file\n\n    return fits_stream","key":"X7AsOZ6aeP"},{"type":"output","id":"VIj8BEjJalz9BhwXJpZKn","data":[],"key":"R3cn88s2Le"}],"key":"LihO7o87vl"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":659,"column":1},"end":{"line":659,"column":1}},"children":[{"type":"text","value":"Then we perform all 3 operations we mentioned above for the RGB filters of Roman:","position":{"start":{"line":659,"column":1},"end":{"line":659,"column":1}},"key":"Dur8lYVP5A"}],"key":"YHxpExNHsP"}],"key":"uO0DAIJavL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"coadds_rgb = []\ncoadds_rgb_reprojected = []\ncoadds_rgb_fits_stream = []\n\nfor filter_name in ROMAN_RGB_FILTERS:\n    print(f'\\nFILTER: {filter_name}')\n    print('Retrieving Roman coadd...')\n    coadd_roman = get_roman_coadd(high_z_gal_coords, filter_name)\n    coadds_rgb.append(coadd_roman)\n\n    print('Reprojecting to TAN...')\n    coadd_roman_reprojected = reproject_to_TAN(coadd_roman)\n    coadds_rgb_reprojected.append(coadd_roman_reprojected)\n\n    print('Writing back to fits stream...')\n    coadd_roman_fits_stream = get_fits_stream(coadd_roman_reprojected)\n    coadds_rgb_fits_stream.append(coadd_roman_fits_stream)","key":"e5NmMl6QIF"},{"type":"output","id":"p4nL1vomGakNRE-VIaDiy","data":[{"output_type":"stream","name":"stdout","text":"\nFILTER: H158\nRetrieving Roman coadd...\n"},{"output_type":"stream","name":"stdout","text":"Reprojecting to TAN...\n"},{"output_type":"stream","name":"stdout","text":"Writing back to fits stream...\n\nFILTER: J129\nRetrieving Roman coadd...\n"},{"output_type":"stream","name":"stdout","text":"Reprojecting to TAN...\n"},{"output_type":"stream","name":"stdout","text":"Writing back to fits stream...\n\nFILTER: Y106\nRetrieving Roman coadd...\n"},{"output_type":"stream","name":"stdout","text":"Reprojecting to TAN...\n"},{"output_type":"stream","name":"stdout","text":"Writing back to fits stream...\n"}],"key":"VaSFD0NEgE"}],"key":"DLhoPLuuxf"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"children":[{"type":"text","value":"Use Firefly’s show_fits_3color to create a 3 color image of Roman coadds","position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"key":"IIspCphcCU"}],"identifier":"use-fireflys-show-fits-3color-to-create-a-3-color-image-of-roman-coadds","label":"Use Firefly’s show_fits_3color to create a 3 color image of Roman coadds","html_id":"use-fireflys-show-fits-3color-to-create-a-3-color-image-of-roman-coadds","implicit":true,"key":"zofBkgwZof"},{"type":"paragraph","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":1}},"children":[{"type":"text","value":"Now we upload each fits stream (in-memory fits file) to firefly using ","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":1}},"key":"l8mkHxrpry"},{"type":"link","url":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.upload_fits_data","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":1}},"children":[{"type":"inlineCode","value":"upload_fits_data()","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":1}},"key":"DrvsnruOZb"}],"urlSource":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.upload_fits_data","key":"MyIZjiNHYB"},{"type":"text","value":" and prepare color params to pass to the ","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":1}},"key":"noaUuWo5nd"},{"type":"link","url":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.show_fits_3color","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":1}},"children":[{"type":"inlineCode","value":"show_fits_3color()","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":1}},"key":"EDjchk7TIt"}],"urlSource":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.show_fits_3color","key":"coRFbrOml7"},{"type":"text","value":".","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":1}},"key":"rCBCyzG1Kl"}],"key":"tVjj7Ya8EO"}],"key":"nZ2mjah5iy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"three_color_params = [\n    {\n        'file': fc.upload_fits_data(fits_stream),\n        'Title': \"Roman Coadd 3 color\"\n    } for fits_stream in coadds_rgb_fits_stream]","key":"YIdXI0bLjX"},{"type":"output","id":"gXc49XOAFFm0vTyfG54Mv","data":[],"key":"DQzx7xkFer"}],"key":"Klrz13WXT3"},{"type":"block","children":[],"key":"gi0kj8lb3o"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"coadd_ff_id_roman_3color = 'roman-coadd-3color-high_z_gal'\nfc.show_fits_3color(three_color_params=three_color_params,\n                    plot_id=coadd_ff_id_roman_3color)","key":"FgDPKtqgbG"},{"type":"output","id":"6-UON8_vpof7DqJSoqlJF","data":[{"output_type":"execute_result","execution_count":52,"metadata":{},"data":{"text/plain":{"content":"{'success': True}","content_type":"text/plain"}}}],"key":"IWAvLrLDj1"}],"key":"qspsFGcp5G"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":699,"column":1},"end":{"line":699,"column":1}},"children":[{"type":"text","value":"We can see 3 color image of Roman coadd containing the high-redshift galaxy sources. Try panning and zomming out, you can notice it spans over one block compared to the Rubin coadd which is much larger.","position":{"start":{"line":699,"column":1},"end":{"line":699,"column":1}},"key":"ZnSNILd5li"}],"key":"yjDQNi74jI"},{"type":"heading","depth":3,"position":{"start":{"line":701,"column":1},"end":{"line":701,"column":1}},"children":[{"type":"text","value":"Use Firefly’s pan/zoom/align methods to locate high redshift sources","position":{"start":{"line":701,"column":1},"end":{"line":701,"column":1}},"key":"wYb7M6U6s7"}],"identifier":"use-fireflys-pan-zoom-align-methods-to-locate-high-redshift-sources","label":"Use Firefly’s pan/zoom/align methods to locate high redshift sources","html_id":"use-fireflys-pan-zoom-align-methods-to-locate-high-redshift-sources","implicit":true,"key":"P2pYwDtxEi"},{"type":"paragraph","position":{"start":{"line":702,"column":1},"end":{"line":702,"column":1}},"children":[{"type":"text","value":"Now, let’s pan \u0026 zoom to the region where we located high-redshift galaxy sources. Also align \u0026 lock all images being displayed by WCS. For these operations we use these 3 methods (click on them to see their documentation):","position":{"start":{"line":702,"column":1},"end":{"line":702,"column":1}},"key":"MygB44flXT"}],"key":"d0hylAT1PQ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":703,"column":1},"end":{"line":706,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":703,"column":1},"end":{"line":703,"column":1}},"children":[{"type":"link","url":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.set_pan","position":{"start":{"line":703,"column":1},"end":{"line":703,"column":1}},"children":[{"type":"inlineCode","value":"set_pan","position":{"start":{"line":703,"column":1},"end":{"line":703,"column":1}},"key":"xach26Oy9c"}],"urlSource":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.set_pan","key":"BeKQJquiTY"}],"key":"JDVwBWeN2g"},{"type":"listItem","spread":true,"position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"children":[{"type":"link","url":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.set_zoom","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"children":[{"type":"inlineCode","value":"set_zoom","position":{"start":{"line":704,"column":1},"end":{"line":704,"column":1}},"key":"gttsMwANei"}],"urlSource":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.set_zoom","key":"vTZWgvRXbA"}],"key":"viZyTXlTKC"},{"type":"listItem","spread":true,"position":{"start":{"line":705,"column":1},"end":{"line":706,"column":1}},"children":[{"type":"link","url":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.align_images","position":{"start":{"line":705,"column":1},"end":{"line":705,"column":1}},"children":[{"type":"inlineCode","value":"align_images","position":{"start":{"line":705,"column":1},"end":{"line":705,"column":1}},"key":"FjNStgazwG"}],"urlSource":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.align_images","key":"QTFBzUZS1c"}],"key":"bcF2Ggq6Kb"}],"key":"vLgG0znvNw"}],"key":"nAEI4gPyql"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fc.set_pan(plot_id=coadd_ff_id_roman_3color, x=high_z_gal_coords.ra.deg, y=high_z_gal_coords.dec.deg, coord='j2000')\nfc.set_zoom(plot_id=coadd_ff_id_roman_3color, factor=1)\nfc.align_images(lock_match=True)","key":"LGVa5frzFp"},{"type":"output","id":"Yt-1smOZSEhnswnHfF3p6","data":[{"output_type":"execute_result","execution_count":53,"metadata":{},"data":{"text/plain":{"content":"{'success': True}","content_type":"text/plain"}}}],"key":"QePnl5erqY"}],"key":"f61xkblzll"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":713,"column":1},"end":{"line":713,"column":1}},"children":[{"type":"text","value":"Use Firefly’s set_stretch method to change the stretch of the image display via Python","position":{"start":{"line":713,"column":1},"end":{"line":713,"column":1}},"key":"IaXKuoWHs8"}],"identifier":"use-fireflys-set-stretch-method-to-change-the-stretch-of-the-image-display-via-python","label":"Use Firefly’s set_stretch method to change the stretch of the image display via Python","html_id":"use-fireflys-set-stretch-method-to-change-the-stretch-of-the-image-display-via-python","implicit":true,"key":"E6SFLMlbml"},{"type":"paragraph","position":{"start":{"line":715,"column":1},"end":{"line":715,"column":1}},"children":[{"type":"text","value":"The image has a lot of noise that obscures our high redshift sources of interest. You can use the Firefly GUI to change the stretch of the image display. We identify that squared stretch from -2 to 10 sigma highlights the colors of our sources better. You can also use the Firefly client’s ","position":{"start":{"line":715,"column":1},"end":{"line":715,"column":1}},"key":"SMkSxQaYw5"},{"type":"link","url":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.set_stretch","position":{"start":{"line":715,"column":1},"end":{"line":715,"column":1}},"children":[{"type":"inlineCode","value":"set_stretch","position":{"start":{"line":715,"column":1},"end":{"line":715,"column":1}},"key":"ElpedwEMqh"}],"urlSource":"https://caltech-ipac.github.io/firefly_client/api/firefly_client.FireflyClient.html#firefly_client.FireflyClient.set_stretch","key":"s5qULtBOIh"},{"type":"text","value":" to do this via Python. This is helpful for reproducibility and for scaling up to many images.","position":{"start":{"line":715,"column":1},"end":{"line":715,"column":1}},"key":"YWJxD6XBct"}],"key":"pjENpNRcPx"}],"key":"NltaQo6zm3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fc.set_stretch(plot_id=coadd_ff_id_roman_3color, stype='sigma', algorithm='squared', \n               band='ALL', lower_value=-2, upper_value=10)","key":"eHUV6AXbUn"},{"type":"output","id":"MejDD_Dy8LVvCjFyOaRx8","data":[{"output_type":"execute_result","execution_count":54,"metadata":{},"data":{"text/plain":{"content":"{'success': True,\n 'rv_string': '92,-2.000000,92,10.000000,NaN,2.000000,48,25,600,120,0,NaN,1.000000'}","content_type":"text/plain"}}}],"key":"WmocIXn5g3"}],"key":"ilvHOnFycq"},{"type":"block","children":[{"type":"thematicBreak","position":{"start":{"line":722,"column":1},"end":{"line":722,"column":1}},"key":"zZIMELGjWo"},{"type":"heading","depth":2,"position":{"start":{"line":724,"column":1},"end":{"line":724,"column":1}},"children":[{"type":"text","value":"About This Notebook","position":{"start":{"line":724,"column":1},"end":{"line":724,"column":1}},"key":"MJezXF3Nwi"}],"identifier":"about-this-notebook","label":"About This Notebook","html_id":"about-this-notebook","implicit":true,"key":"LT42U9KWwQ"},{"type":"paragraph","position":{"start":{"line":726,"column":1},"end":{"line":726,"column":1}},"children":[{"type":"strong","position":{"start":{"line":726,"column":1},"end":{"line":726,"column":1}},"children":[{"type":"text","value":"Author:","position":{"start":{"line":726,"column":1},"end":{"line":726,"column":1}},"key":"GiGEiKvc4H"}],"key":"wNzV4LG2fM"},{"type":"text","value":" Jaladh Singhal and Vandana Desai in conjunction with the IRSA Team","position":{"start":{"line":726,"column":1},"end":{"line":726,"column":1}},"key":"hMPFio5IP3"}],"key":"lISJnbI2pg"},{"type":"paragraph","position":{"start":{"line":728,"column":1},"end":{"line":728,"column":1}},"children":[{"type":"strong","position":{"start":{"line":728,"column":1},"end":{"line":728,"column":1}},"children":[{"type":"text","value":"Updated:","position":{"start":{"line":728,"column":1},"end":{"line":728,"column":1}},"key":"s7q4SNyjge"}],"key":"Ng2GBQO8wL"},{"type":"text","value":" 2024-12-19","position":{"start":{"line":728,"column":1},"end":{"line":728,"column":1}},"key":"y8yDCudMUd"}],"key":"e0fv9wN8mO"},{"type":"paragraph","position":{"start":{"line":730,"column":1},"end":{"line":730,"column":1}},"children":[{"type":"strong","position":{"start":{"line":730,"column":1},"end":{"line":730,"column":1}},"children":[{"type":"text","value":"Contact:","position":{"start":{"line":730,"column":1},"end":{"line":730,"column":1}},"key":"T6XVxCTjJ3"}],"key":"RE6uXdWWB3"},{"type":"text","value":" ","position":{"start":{"line":730,"column":1},"end":{"line":730,"column":1}},"key":"hC4E3RcuCU"},{"type":"link","url":"https://irsa.ipac.caltech.edu/docs/help_desk.html","position":{"start":{"line":730,"column":1},"end":{"line":730,"column":1}},"children":[{"type":"text","value":"the IRSA Helpdesk","position":{"start":{"line":730,"column":1},"end":{"line":730,"column":1}},"key":"SUBIKUg1E8"}],"urlSource":"https://irsa.ipac.caltech.edu/docs/help_desk.html","key":"dA0lRcJwMI"},{"type":"text","value":" with questions or reporting problems.","position":{"start":{"line":730,"column":1},"end":{"line":730,"column":1}},"key":"bb3724Ihpc"}],"key":"VYxXBV3nRv"}],"key":"VIupCvVKpo"}],"key":"qWIWQ1Z79J"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Analyzing cloud-hosted simulated Roman coadded images","url":"/openuniverse2024-roman-simulated-wideareasurvey","group":"OpenUniverse 2024"},"next":{"title":"Analyzing cloud-hosted simulated Roman Time Domain Survey images","url":"/openuniverse2024-roman-simulated-timedomainsurvey","group":"OpenUniverse 2024"}}},"domain":"http://localhost:3000"},"project":{"subject":"IRSA Tutorials","settings":{"output_matplotlib_strings":"remove"},"title":"IRSA Tutorials","description":"IRSA Python Notebook tutorials to demostrate accessing data served by the NASA/IPAC Infrared Science Archive (IRSA)","authors":[{"id":"IRSA Scientists and Developers","name":"IRSA Scientists and Developers"}],"github":"https://github.com/Caltech-IPAC/irsa-tutorials/","keywords":["astronomy"],"toc":[{"file":"index.md","title":"IRSA Tutorials"},{"children":[{"file":"tutorials/spherex/spherex_intro.md"}],"title":"SPHEREx"},{"children":[{"children":[{"file":"tutorials/euclid_access/Euclid_ERO.md"}],"title":"Euclid Early Release Observations"},{"children":[{"file":"tutorials/euclid_access/1_Euclid_intro_MER_images.md"},{"file":"tutorials/euclid_access/2_Euclid_intro_MER_catalog.md"},{"file":"tutorials/euclid_access/3_Euclid_intro_1D_spectra.md"},{"file":"tutorials/euclid_access/4_Euclid_intro_PHZ_catalog.md"},{"file":"tutorials/euclid_access/5_Euclid_intro_SPE_catalog.md"},{"file":"tutorials/cloud_access/euclid-cloud-access.md"}],"title":"Euclid Quick Release 1"}],"title":"Euclid"},{"children":[{"children":[{"file":"tutorials/irsa-sia-examples/sia_allwise_atlas.md"},{"file":"tutorials/parquet-catalog-demos/wise-allwise-catalog-demo.md"}],"title":"AllWISE"},{"children":[{"file":"tutorials/firefly/NEOWISE_light_curve_demo.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-strategies.md"},{"file":"tutorials/parquet-catalog-demos/neowise-source-table-lightcurves.md"}],"title":"NEOWISE"}],"title":"WISE"},{"children":[{"file":"tutorials/irsa-sia-examples/siav2_seip.md"}],"title":"Spitzer"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_2mass_allsky.md"}],"title":"2MASS"},{"children":[{"file":"tutorials/irsa-sia-examples/sia_cosmos.md"}],"title":"COSMOS"},{"children":[{"children":[{"file":"tutorials/roman_simulations/roman_hlss_number_density.md"}],"title":"Roman HLSS Galaxy Mock Catalog"},{"children":[{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_wideareasurvey.md"},{"file":"tutorials/firefly/OpenUniverse2024Preview_Firefly.md"},{"file":"tutorials/openuniversesims/openuniverse2024_roman_simulated_timedomainsurvey.md"}],"title":"OpenUniverse 2024"},{"children":[{"file":"tutorials/cosmodc2/cosmoDC2_TAP_access.md"}],"title":"CosmoDC2"}],"title":"Simulated Data"},{"children":[{"file":"tutorials/cloud_access/cloud-access-intro.md"},{"file":"tutorials/firefly/SEDs_in_Firefly.md"},{"file":"tutorials/parallelize/Parallelize_Convolution.md"}],"title":"Special Topics"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"SPHEREx"},{"slug":"spherex-intro","title":"Introduction to SPHEREx Spectral Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Euclid"},{"level":2,"title":"Euclid Early Release Observations"},{"slug":"euclid-ero","title":"Exploring Star Clusters in the Euclid ERO Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Euclid Quick Release 1"},{"slug":"euclid-intro-mer-images","title":"Euclid Q1: MER mosaics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-mer-catalog","title":"Euclid Q1: MER catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-1d-spectra","title":"Euclid Q1: 1D spectra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-phz-catalog","title":"Euclid Q1: PHZ catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-intro-spe-catalog","title":"Euclid Q1: SPE catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"euclid-cloud-access","title":"Euclid Q1: cloud access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"WISE"},{"level":2,"title":"AllWISE"},{"slug":"sia-allwise-atlas","title":"Searching for AllWISE Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"wise-allwise-catalog-demo","title":"Analyzing cloud-hosted AllWISE Source Catalog in Parquet format","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"NEOWISE"},{"slug":"neowise-light-curve-demo","title":"Using Firefly visualization tools to understand the light curves of Solar System objects","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-strategies","title":"Strategies to Efficiently Work with NEOWISE Single-exposure Source Table in Parquet","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"neowise-source-table-lightcurves","title":"Make Light Curves from NEOWISE Single-exposure Source Table","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Spitzer"},{"slug":"siav2-seip","title":"Searching for Spitzer Enhanced Imaging Products","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"2MASS"},{"slug":"sia-2mass-allsky","title":"Searching for 2MASS All-Sky Atlas Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"COSMOS"},{"slug":"sia-cosmos","title":"Searching for contributed COSMOS images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Simulated Data"},{"level":2,"title":"Roman HLSS Galaxy Mock Catalog"},{"slug":"roman-hlss-number-density","title":"Number Density as a Function of Redshift","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"OpenUniverse 2024"},{"slug":"openuniverse2024-roman-simulated-wideareasurvey","title":"Analyzing cloud-hosted simulated Roman coadded images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024preview-firefly","title":"Using Firefly to Explore OpenUniverse2024 Data Preview Simulated Roman and Rubin Images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"openuniverse2024-roman-simulated-timedomainsurvey","title":"Analyzing cloud-hosted simulated Roman Time Domain Survey images","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"CosmoDC2"},{"slug":"cosmodc2-tap-access","title":"Querying CosmoDC2 Mock v1 catalogs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Special Topics"},{"slug":"cloud-access-intro","title":"IRSA cloud access introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"seds-in-firefly","title":"Using Firefly visualization tools in Python to vet SEDs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"parallelize-convolution","title":"Parallelizing image convolution","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/build/manifest-B2B2E6A5.js";
import * as route0 from "/build/root-IB5726YR.js";
import * as route1 from "/build/routes/$-LXLHKVOR.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/build/entry.client-UNPC4GT3.js");</script></body></html>